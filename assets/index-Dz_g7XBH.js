function Z1(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const s=Object.getOwnPropertyDescriptor(r,a);s&&Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ut(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function A4(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var P4={exports:{}},eS={},O4={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev=Symbol.for("react.element"),tZ=Symbol.for("react.portal"),nZ=Symbol.for("react.fragment"),rZ=Symbol.for("react.strict_mode"),aZ=Symbol.for("react.profiler"),sZ=Symbol.for("react.provider"),oZ=Symbol.for("react.context"),iZ=Symbol.for("react.forward_ref"),lZ=Symbol.for("react.suspense"),uZ=Symbol.for("react.memo"),cZ=Symbol.for("react.lazy"),TR=Symbol.iterator;function dZ(t){return t===null||typeof t!="object"?null:(t=TR&&t[TR]||t["@@iterator"],typeof t=="function"?t:null)}var R4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D4=Object.assign,j4={};function kh(t,e,n){this.props=t,this.context=e,this.refs=j4,this.updater=n||R4}kh.prototype.isReactComponent={};kh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};kh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function M4(){}M4.prototype=kh.prototype;function CT(t,e,n){this.props=t,this.context=e,this.refs=j4,this.updater=n||R4}var _T=CT.prototype=new M4;_T.constructor=CT;D4(_T,kh.prototype);_T.isPureReactComponent=!0;var ER=Array.isArray,F4=Object.prototype.hasOwnProperty,$T={current:null},L4={key:!0,ref:!0,__self:!0,__source:!0};function B4(t,e,n){var r,a={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)F4.call(e,r)&&!L4.hasOwnProperty(r)&&(a[r]=e[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var l=Array(i),u=0;u<i;u++)l[u]=arguments[u+2];a.children=l}if(t&&t.defaultProps)for(r in i=t.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:ev,type:t,key:s,ref:o,props:a,_owner:$T.current}}function fZ(t,e){return{$$typeof:ev,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kT(t){return typeof t=="object"&&t!==null&&t.$$typeof===ev}function hZ(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var AR=/\/+/g;function HC(t,e){return typeof t=="object"&&t!==null&&t.key!=null?hZ(""+t.key):e.toString(36)}function T0(t,e,n,r,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ev:case tZ:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+HC(o,0):r,ER(a)?(n="",t!=null&&(n=t.replace(AR,"$&/")+"/"),T0(a,e,n,"",function(u){return u})):a!=null&&(kT(a)&&(a=fZ(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(AR,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",ER(t))for(var i=0;i<t.length;i++){s=t[i];var l=r+HC(s,i);o+=T0(s,e,n,l,a)}else if(l=dZ(t),typeof l=="function")for(t=l.call(t),i=0;!(s=t.next()).done;)s=s.value,l=r+HC(s,i++),o+=T0(s,e,n,l,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Pb(t,e,n){if(t==null)return t;var r=[],a=0;return T0(t,r,"","",function(s){return e.call(n,s,a++)}),r}function pZ(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Oa={current:null},E0={transition:null},mZ={ReactCurrentDispatcher:Oa,ReactCurrentBatchConfig:E0,ReactCurrentOwner:$T};function z4(){throw Error("act(...) is not supported in production builds of React.")}Tt.Children={map:Pb,forEach:function(t,e,n){Pb(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Pb(t,function(){e++}),e},toArray:function(t){return Pb(t,function(e){return e})||[]},only:function(t){if(!kT(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Tt.Component=kh;Tt.Fragment=nZ;Tt.Profiler=aZ;Tt.PureComponent=CT;Tt.StrictMode=rZ;Tt.Suspense=lZ;Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mZ;Tt.act=z4;Tt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=D4({},t.props),a=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=$T.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var i=t.type.defaultProps;for(l in e)F4.call(e,l)&&!L4.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&i!==void 0?i[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){i=Array(l);for(var u=0;u<l;u++)i[u]=arguments[u+2];r.children=i}return{$$typeof:ev,type:t.type,key:a,ref:s,props:r,_owner:o}};Tt.createContext=function(t){return t={$$typeof:oZ,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sZ,_context:t},t.Consumer=t};Tt.createElement=B4;Tt.createFactory=function(t){var e=B4.bind(null,t);return e.type=t,e};Tt.createRef=function(){return{current:null}};Tt.forwardRef=function(t){return{$$typeof:iZ,render:t}};Tt.isValidElement=kT;Tt.lazy=function(t){return{$$typeof:cZ,_payload:{_status:-1,_result:t},_init:pZ}};Tt.memo=function(t,e){return{$$typeof:uZ,type:t,compare:e===void 0?null:e}};Tt.startTransition=function(t){var e=E0.transition;E0.transition={};try{t()}finally{E0.transition=e}};Tt.unstable_act=z4;Tt.useCallback=function(t,e){return Oa.current.useCallback(t,e)};Tt.useContext=function(t){return Oa.current.useContext(t)};Tt.useDebugValue=function(){};Tt.useDeferredValue=function(t){return Oa.current.useDeferredValue(t)};Tt.useEffect=function(t,e){return Oa.current.useEffect(t,e)};Tt.useId=function(){return Oa.current.useId()};Tt.useImperativeHandle=function(t,e,n){return Oa.current.useImperativeHandle(t,e,n)};Tt.useInsertionEffect=function(t,e){return Oa.current.useInsertionEffect(t,e)};Tt.useLayoutEffect=function(t,e){return Oa.current.useLayoutEffect(t,e)};Tt.useMemo=function(t,e){return Oa.current.useMemo(t,e)};Tt.useReducer=function(t,e,n){return Oa.current.useReducer(t,e,n)};Tt.useRef=function(t){return Oa.current.useRef(t)};Tt.useState=function(t){return Oa.current.useState(t)};Tt.useSyncExternalStore=function(t,e,n){return Oa.current.useSyncExternalStore(t,e,n)};Tt.useTransition=function(){return Oa.current.useTransition()};Tt.version="18.3.1";O4.exports=Tt;var N=O4.exports;const K=Ut(N),U4=Z1({__proto__:null,default:K},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gZ=N,yZ=Symbol.for("react.element"),vZ=Symbol.for("react.fragment"),xZ=Object.prototype.hasOwnProperty,bZ=gZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wZ={key:!0,ref:!0,__self:!0,__source:!0};function V4(t,e,n){var r,a={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)xZ.call(e,r)&&!wZ.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:yZ,type:t,key:s,ref:o,props:a,_owner:bZ.current}}eS.Fragment=vZ;eS.jsx=V4;eS.jsxs=V4;P4.exports=eS;var m=P4.exports,W4={exports:{}},Cs={},G4={exports:{}},H4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,Q){var se=V.length;V.push(Q);e:for(;0<se;){var le=se-1>>>1,ue=V[le];if(0<a(ue,Q))V[le]=Q,V[se]=ue,se=le;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var Q=V[0],se=V.pop();if(se!==Q){V[0]=se;e:for(var le=0,ue=V.length,ce=ue>>>1;le<ce;){var re=2*(le+1)-1,ge=V[re],Se=re+1,Ne=V[Se];if(0>a(ge,se))Se<ue&&0>a(Ne,ge)?(V[le]=Ne,V[Se]=se,le=Se):(V[le]=ge,V[re]=se,le=re);else if(Se<ue&&0>a(Ne,se))V[le]=Ne,V[Se]=se,le=Se;else break e}}return Q}function a(V,Q){var se=V.sortIndex-Q.sortIndex;return se!==0?se:V.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,i=o.now();t.unstable_now=function(){return o.now()-i}}var l=[],u=[],c=1,d=null,f=3,h=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(V){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=V)r(u),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(u)}}function w(V){if(g=!1,b(V),!p)if(n(l)!==null)p=!0,H(C);else{var Q=n(u);Q!==null&&te(w,Q.startTime-V)}}function C(V,Q){p=!1,g&&(g=!1,v(k),k=-1),h=!0;var se=f;try{for(b(Q),d=n(l);d!==null&&(!(d.expirationTime>Q)||V&&!O());){var le=d.callback;if(typeof le=="function"){d.callback=null,f=d.priorityLevel;var ue=le(d.expirationTime<=Q);Q=t.unstable_now(),typeof ue=="function"?d.callback=ue:d===n(l)&&r(l),b(Q)}else r(l);d=n(l)}if(d!==null)var ce=!0;else{var re=n(u);re!==null&&te(w,re.startTime-Q),ce=!1}return ce}finally{d=null,f=se,h=!1}}var _=!1,$=null,k=-1,A=5,P=-1;function O(){return!(t.unstable_now()-P<A)}function R(){if($!==null){var V=t.unstable_now();P=V;var Q=!0;try{Q=$(!0,V)}finally{Q?B():(_=!1,$=null)}}else _=!1}var B;if(typeof x=="function")B=function(){x(R)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,L=F.port2;F.port1.onmessage=R,B=function(){L.postMessage(null)}}else B=function(){y(R,0)};function H(V){$=V,_||(_=!0,B())}function te(V,Q){k=y(function(){V(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,H(C))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var se=f;f=Q;try{return V()}finally{f=se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,Q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=f;f=V;try{return Q()}finally{f=se}},t.unstable_scheduleCallback=function(V,Q,se){var le=t.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?le+se:le):se=le,V){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=se+ue,V={id:c++,callback:Q,priorityLevel:V,startTime:se,expirationTime:ue,sortIndex:-1},se>le?(V.sortIndex=se,e(u,V),n(l)===null&&V===n(u)&&(g?(v(k),k=-1):g=!0,te(w,se-le))):(V.sortIndex=ue,e(l,V),p||h||(p=!0,H(C))),V},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(V){var Q=f;return function(){var se=f;f=Q;try{return V.apply(this,arguments)}finally{f=se}}}})(H4);G4.exports=H4;var SZ=G4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CZ=N,Ss=SZ;function ke(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q4=new Set,Tg={};function Xc(t,e){Pf(t,e),Pf(t+"Capture",e)}function Pf(t,e){for(Tg[t]=e,t=0;t<e.length;t++)q4.add(e[t])}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F$=Object.prototype.hasOwnProperty,_Z=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PR={},OR={};function $Z(t){return F$.call(OR,t)?!0:F$.call(PR,t)?!1:_Z.test(t)?OR[t]=!0:(PR[t]=!0,!1)}function kZ(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function NZ(t,e,n,r){if(e===null||typeof e>"u"||kZ(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ra(t,e,n,r,a,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kr[t]=new Ra(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kr[e]=new Ra(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kr[t]=new Ra(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kr[t]=new Ra(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kr[t]=new Ra(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kr[t]=new Ra(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kr[t]=new Ra(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kr[t]=new Ra(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kr[t]=new Ra(t,5,!1,t.toLowerCase(),null,!1,!1)});var NT=/[\-:]([a-z])/g;function IT(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(NT,IT);Kr[e]=new Ra(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(NT,IT);Kr[e]=new Ra(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(NT,IT);Kr[e]=new Ra(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kr[t]=new Ra(t,1,!1,t.toLowerCase(),null,!1,!1)});Kr.xlinkHref=new Ra("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kr[t]=new Ra(t,1,!1,t.toLowerCase(),null,!0,!0)});function TT(t,e,n,r){var a=Kr.hasOwnProperty(e)?Kr[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NZ(e,n,a,r)&&(n=null),r||a===null?$Z(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Qi=CZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ob=Symbol.for("react.element"),Qd=Symbol.for("react.portal"),Jd=Symbol.for("react.fragment"),ET=Symbol.for("react.strict_mode"),L$=Symbol.for("react.profiler"),K4=Symbol.for("react.provider"),X4=Symbol.for("react.context"),AT=Symbol.for("react.forward_ref"),B$=Symbol.for("react.suspense"),z$=Symbol.for("react.suspense_list"),PT=Symbol.for("react.memo"),gl=Symbol.for("react.lazy"),Y4=Symbol.for("react.offscreen"),RR=Symbol.iterator;function bm(t){return t===null||typeof t!="object"?null:(t=RR&&t[RR]||t["@@iterator"],typeof t=="function"?t:null)}var Xn=Object.assign,qC;function Gm(t){if(qC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qC=e&&e[1]||""}return`
`+qC+t}var KC=!1;function XC(t,e){if(!t||KC)return"";KC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=r.stack.split(`
`),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(o!==1||i!==1)do if(o--,i--,0>i||a[o]!==s[i]){var l=`
`+a[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=i);break}}}finally{KC=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Gm(t):""}function IZ(t){switch(t.tag){case 5:return Gm(t.type);case 16:return Gm("Lazy");case 13:return Gm("Suspense");case 19:return Gm("SuspenseList");case 0:case 2:case 15:return t=XC(t.type,!1),t;case 11:return t=XC(t.type.render,!1),t;case 1:return t=XC(t.type,!0),t;default:return""}}function U$(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Jd:return"Fragment";case Qd:return"Portal";case L$:return"Profiler";case ET:return"StrictMode";case B$:return"Suspense";case z$:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case X4:return(t.displayName||"Context")+".Consumer";case K4:return(t._context.displayName||"Context")+".Provider";case AT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case PT:return e=t.displayName||null,e!==null?e:U$(t.type)||"Memo";case gl:e=t._payload,t=t._init;try{return U$(t(e))}catch{}}return null}function TZ(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U$(e);case 8:return e===ET?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Q4(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function EZ(t){var e=Q4(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Rb(t){t._valueTracker||(t._valueTracker=EZ(t))}function J4(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Q4(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function aw(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function V$(t,e){var n=e.checked;return Xn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function DR(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Z4(t,e){e=e.checked,e!=null&&TT(t,"checked",e,!1)}function W$(t,e){Z4(t,e);var n=Xl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?G$(t,e.type,n):e.hasOwnProperty("defaultValue")&&G$(t,e.type,Xl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function jR(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function G$(t,e,n){(e!=="number"||aw(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hm=Array.isArray;function mf(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xl(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function H$(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ke(91));return Xn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function MR(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ke(92));if(Hm(n)){if(1<n.length)throw Error(ke(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xl(n)}}function ez(t,e){var n=Xl(e.value),r=Xl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function FR(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function tz(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q$(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?tz(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Db,nz=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Db=Db||document.createElement("div"),Db.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Db.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Eg(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var sg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AZ=["Webkit","ms","Moz","O"];Object.keys(sg).forEach(function(t){AZ.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sg[e]=sg[t]})});function rz(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||sg.hasOwnProperty(t)&&sg[t]?(""+e).trim():e+"px"}function az(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=rz(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var PZ=Xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function K$(t,e){if(e){if(PZ[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ke(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ke(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ke(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ke(62))}}function X$(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Y$=null;function OT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Q$=null,gf=null,yf=null;function LR(t){if(t=rv(t)){if(typeof Q$!="function")throw Error(ke(280));var e=t.stateNode;e&&(e=sS(e),Q$(t.stateNode,t.type,e))}}function sz(t){gf?yf?yf.push(t):yf=[t]:gf=t}function oz(){if(gf){var t=gf,e=yf;if(yf=gf=null,LR(t),e)for(t=0;t<e.length;t++)LR(e[t])}}function iz(t,e){return t(e)}function lz(){}var YC=!1;function uz(t,e,n){if(YC)return t(e,n);YC=!0;try{return iz(t,e,n)}finally{YC=!1,(gf!==null||yf!==null)&&(lz(),oz())}}function Ag(t,e){var n=t.stateNode;if(n===null)return null;var r=sS(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ke(231,e,typeof n));return n}var J$=!1;if(Ui)try{var wm={};Object.defineProperty(wm,"passive",{get:function(){J$=!0}}),window.addEventListener("test",wm,wm),window.removeEventListener("test",wm,wm)}catch{J$=!1}function OZ(t,e,n,r,a,s,o,i,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var og=!1,sw=null,ow=!1,Z$=null,RZ={onError:function(t){og=!0,sw=t}};function DZ(t,e,n,r,a,s,o,i,l){og=!1,sw=null,OZ.apply(RZ,arguments)}function jZ(t,e,n,r,a,s,o,i,l){if(DZ.apply(this,arguments),og){if(og){var u=sw;og=!1,sw=null}else throw Error(ke(198));ow||(ow=!0,Z$=u)}}function Yc(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function cz(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function BR(t){if(Yc(t)!==t)throw Error(ke(188))}function MZ(t){var e=t.alternate;if(!e){if(e=Yc(t),e===null)throw Error(ke(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return BR(a),t;if(s===r)return BR(a),e;s=s.sibling}throw Error(ke(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,i=a.child;i;){if(i===n){o=!0,n=a,r=s;break}if(i===r){o=!0,r=a,n=s;break}i=i.sibling}if(!o){for(i=s.child;i;){if(i===n){o=!0,n=s,r=a;break}if(i===r){o=!0,r=s,n=a;break}i=i.sibling}if(!o)throw Error(ke(189))}}if(n.alternate!==r)throw Error(ke(190))}if(n.tag!==3)throw Error(ke(188));return n.stateNode.current===n?t:e}function dz(t){return t=MZ(t),t!==null?fz(t):null}function fz(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=fz(t);if(e!==null)return e;t=t.sibling}return null}var hz=Ss.unstable_scheduleCallback,zR=Ss.unstable_cancelCallback,FZ=Ss.unstable_shouldYield,LZ=Ss.unstable_requestPaint,sr=Ss.unstable_now,BZ=Ss.unstable_getCurrentPriorityLevel,RT=Ss.unstable_ImmediatePriority,pz=Ss.unstable_UserBlockingPriority,iw=Ss.unstable_NormalPriority,zZ=Ss.unstable_LowPriority,mz=Ss.unstable_IdlePriority,tS=null,Qo=null;function UZ(t){if(Qo&&typeof Qo.onCommitFiberRoot=="function")try{Qo.onCommitFiberRoot(tS,t,void 0,(t.current.flags&128)===128)}catch{}}var _o=Math.clz32?Math.clz32:GZ,VZ=Math.log,WZ=Math.LN2;function GZ(t){return t>>>=0,t===0?32:31-(VZ(t)/WZ|0)|0}var jb=64,Mb=4194304;function qm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lw(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var i=o&~a;i!==0?r=qm(i):(s&=o,s!==0&&(r=qm(s)))}else o=n&~a,o!==0?r=qm(o):s!==0&&(r=qm(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-_o(e),a=1<<n,r|=t[n],e&=~a;return r}function HZ(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qZ(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-_o(s),i=1<<o,l=a[o];l===-1?(!(i&n)||i&r)&&(a[o]=HZ(i,e)):l<=e&&(t.expiredLanes|=i),s&=~i}}function ek(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gz(){var t=jb;return jb<<=1,!(jb&4194240)&&(jb=64),t}function QC(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function tv(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_o(e),t[e]=n}function KZ(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-_o(n),s=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~s}}function DT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-_o(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var dn=0;function yz(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var vz,jT,xz,bz,wz,tk=!1,Fb=[],Dl=null,jl=null,Ml=null,Pg=new Map,Og=new Map,wl=[],XZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function UR(t,e){switch(t){case"focusin":case"focusout":Dl=null;break;case"dragenter":case"dragleave":jl=null;break;case"mouseover":case"mouseout":Ml=null;break;case"pointerover":case"pointerout":Pg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Og.delete(e.pointerId)}}function Sm(t,e,n,r,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},e!==null&&(e=rv(e),e!==null&&jT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function YZ(t,e,n,r,a){switch(e){case"focusin":return Dl=Sm(Dl,t,e,n,r,a),!0;case"dragenter":return jl=Sm(jl,t,e,n,r,a),!0;case"mouseover":return Ml=Sm(Ml,t,e,n,r,a),!0;case"pointerover":var s=a.pointerId;return Pg.set(s,Sm(Pg.get(s)||null,t,e,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Og.set(s,Sm(Og.get(s)||null,t,e,n,r,a)),!0}return!1}function Sz(t){var e=Ju(t.target);if(e!==null){var n=Yc(e);if(n!==null){if(e=n.tag,e===13){if(e=cz(n),e!==null){t.blockedOn=e,wz(t.priority,function(){xz(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function A0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=nk(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Y$=r,n.target.dispatchEvent(r),Y$=null}else return e=rv(n),e!==null&&jT(e),t.blockedOn=n,!1;e.shift()}return!0}function VR(t,e,n){A0(t)&&n.delete(e)}function QZ(){tk=!1,Dl!==null&&A0(Dl)&&(Dl=null),jl!==null&&A0(jl)&&(jl=null),Ml!==null&&A0(Ml)&&(Ml=null),Pg.forEach(VR),Og.forEach(VR)}function Cm(t,e){t.blockedOn===e&&(t.blockedOn=null,tk||(tk=!0,Ss.unstable_scheduleCallback(Ss.unstable_NormalPriority,QZ)))}function Rg(t){function e(a){return Cm(a,t)}if(0<Fb.length){Cm(Fb[0],t);for(var n=1;n<Fb.length;n++){var r=Fb[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Dl!==null&&Cm(Dl,t),jl!==null&&Cm(jl,t),Ml!==null&&Cm(Ml,t),Pg.forEach(e),Og.forEach(e),n=0;n<wl.length;n++)r=wl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<wl.length&&(n=wl[0],n.blockedOn===null);)Sz(n),n.blockedOn===null&&wl.shift()}var vf=Qi.ReactCurrentBatchConfig,uw=!0;function JZ(t,e,n,r){var a=dn,s=vf.transition;vf.transition=null;try{dn=1,MT(t,e,n,r)}finally{dn=a,vf.transition=s}}function ZZ(t,e,n,r){var a=dn,s=vf.transition;vf.transition=null;try{dn=4,MT(t,e,n,r)}finally{dn=a,vf.transition=s}}function MT(t,e,n,r){if(uw){var a=nk(t,e,n,r);if(a===null)i_(t,e,r,cw,n),UR(t,r);else if(YZ(a,t,e,n,r))r.stopPropagation();else if(UR(t,r),e&4&&-1<XZ.indexOf(t)){for(;a!==null;){var s=rv(a);if(s!==null&&vz(s),s=nk(t,e,n,r),s===null&&i_(t,e,r,cw,n),s===a)break;a=s}a!==null&&r.stopPropagation()}else i_(t,e,r,null,n)}}var cw=null;function nk(t,e,n,r){if(cw=null,t=OT(r),t=Ju(t),t!==null)if(e=Yc(t),e===null)t=null;else if(n=e.tag,n===13){if(t=cz(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cw=t,null}function Cz(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BZ()){case RT:return 1;case pz:return 4;case iw:case zZ:return 16;case mz:return 536870912;default:return 16}default:return 16}}var kl=null,FT=null,P0=null;function _z(){if(P0)return P0;var t,e=FT,n=e.length,r,a="value"in kl?kl.value:kl.textContent,s=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[s-r];r++);return P0=a.slice(t,1<r?1-r:void 0)}function O0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Lb(){return!0}function WR(){return!1}function _s(t){function e(n,r,a,s,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],this[i]=n?n(s):s[i]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Lb:WR,this.isPropagationStopped=WR,this}return Xn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lb)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lb)},persist:function(){},isPersistent:Lb}),e}var Nh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LT=_s(Nh),nv=Xn({},Nh,{view:0,detail:0}),eee=_s(nv),JC,ZC,_m,nS=Xn({},nv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:BT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_m&&(_m&&t.type==="mousemove"?(JC=t.screenX-_m.screenX,ZC=t.screenY-_m.screenY):ZC=JC=0,_m=t),JC)},movementY:function(t){return"movementY"in t?t.movementY:ZC}}),GR=_s(nS),tee=Xn({},nS,{dataTransfer:0}),nee=_s(tee),ree=Xn({},nv,{relatedTarget:0}),e_=_s(ree),aee=Xn({},Nh,{animationName:0,elapsedTime:0,pseudoElement:0}),see=_s(aee),oee=Xn({},Nh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iee=_s(oee),lee=Xn({},Nh,{data:0}),HR=_s(lee),uee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cee={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dee={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fee(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dee[t])?!!e[t]:!1}function BT(){return fee}var hee=Xn({},nv,{key:function(t){if(t.key){var e=uee[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=O0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cee[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:BT,charCode:function(t){return t.type==="keypress"?O0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?O0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pee=_s(hee),mee=Xn({},nS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qR=_s(mee),gee=Xn({},nv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:BT}),yee=_s(gee),vee=Xn({},Nh,{propertyName:0,elapsedTime:0,pseudoElement:0}),xee=_s(vee),bee=Xn({},nS,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wee=_s(bee),See=[9,13,27,32],zT=Ui&&"CompositionEvent"in window,ig=null;Ui&&"documentMode"in document&&(ig=document.documentMode);var Cee=Ui&&"TextEvent"in window&&!ig,$z=Ui&&(!zT||ig&&8<ig&&11>=ig),KR=" ",XR=!1;function kz(t,e){switch(t){case"keyup":return See.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nz(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Zd=!1;function _ee(t,e){switch(t){case"compositionend":return Nz(e);case"keypress":return e.which!==32?null:(XR=!0,KR);case"textInput":return t=e.data,t===KR&&XR?null:t;default:return null}}function $ee(t,e){if(Zd)return t==="compositionend"||!zT&&kz(t,e)?(t=_z(),P0=FT=kl=null,Zd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $z&&e.locale!=="ko"?null:e.data;default:return null}}var kee={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function YR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!kee[t.type]:e==="textarea"}function Iz(t,e,n,r){sz(r),e=dw(e,"onChange"),0<e.length&&(n=new LT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lg=null,Dg=null;function Nee(t){Lz(t,0)}function rS(t){var e=nf(t);if(J4(e))return t}function Iee(t,e){if(t==="change")return e}var Tz=!1;if(Ui){var t_;if(Ui){var n_="oninput"in document;if(!n_){var QR=document.createElement("div");QR.setAttribute("oninput","return;"),n_=typeof QR.oninput=="function"}t_=n_}else t_=!1;Tz=t_&&(!document.documentMode||9<document.documentMode)}function JR(){lg&&(lg.detachEvent("onpropertychange",Ez),Dg=lg=null)}function Ez(t){if(t.propertyName==="value"&&rS(Dg)){var e=[];Iz(e,Dg,t,OT(t)),uz(Nee,e)}}function Tee(t,e,n){t==="focusin"?(JR(),lg=e,Dg=n,lg.attachEvent("onpropertychange",Ez)):t==="focusout"&&JR()}function Eee(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rS(Dg)}function Aee(t,e){if(t==="click")return rS(e)}function Pee(t,e){if(t==="input"||t==="change")return rS(e)}function Oee(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var To=typeof Object.is=="function"?Object.is:Oee;function jg(t,e){if(To(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!F$.call(e,a)||!To(t[a],e[a]))return!1}return!0}function ZR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function eD(t,e){var n=ZR(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ZR(n)}}function Az(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Az(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Pz(){for(var t=window,e=aw();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=aw(t.document)}return e}function UT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ree(t){var e=Pz(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Az(n.ownerDocument.documentElement,n)){if(r!==null&&UT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=r.end===void 0?s:Math.min(r.end,a),!t.extend&&s>r&&(a=r,r=s,s=a),a=eD(n,s);var o=eD(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Dee=Ui&&"documentMode"in document&&11>=document.documentMode,ef=null,rk=null,ug=null,ak=!1;function tD(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ak||ef==null||ef!==aw(r)||(r=ef,"selectionStart"in r&&UT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ug&&jg(ug,r)||(ug=r,r=dw(rk,"onSelect"),0<r.length&&(e=new LT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ef)))}function Bb(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var tf={animationend:Bb("Animation","AnimationEnd"),animationiteration:Bb("Animation","AnimationIteration"),animationstart:Bb("Animation","AnimationStart"),transitionend:Bb("Transition","TransitionEnd")},r_={},Oz={};Ui&&(Oz=document.createElement("div").style,"AnimationEvent"in window||(delete tf.animationend.animation,delete tf.animationiteration.animation,delete tf.animationstart.animation),"TransitionEvent"in window||delete tf.transitionend.transition);function aS(t){if(r_[t])return r_[t];if(!tf[t])return t;var e=tf[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Oz)return r_[t]=e[n];return t}var Rz=aS("animationend"),Dz=aS("animationiteration"),jz=aS("animationstart"),Mz=aS("transitionend"),Fz=new Map,nD="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function au(t,e){Fz.set(t,e),Xc(e,[t])}for(var a_=0;a_<nD.length;a_++){var s_=nD[a_],jee=s_.toLowerCase(),Mee=s_[0].toUpperCase()+s_.slice(1);au(jee,"on"+Mee)}au(Rz,"onAnimationEnd");au(Dz,"onAnimationIteration");au(jz,"onAnimationStart");au("dblclick","onDoubleClick");au("focusin","onFocus");au("focusout","onBlur");au(Mz,"onTransitionEnd");Pf("onMouseEnter",["mouseout","mouseover"]);Pf("onMouseLeave",["mouseout","mouseover"]);Pf("onPointerEnter",["pointerout","pointerover"]);Pf("onPointerLeave",["pointerout","pointerover"]);Xc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Km="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fee=new Set("cancel close invalid load scroll toggle".split(" ").concat(Km));function rD(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,jZ(r,e,void 0,t),t.currentTarget=null}function Lz(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var i=r[o],l=i.instance,u=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;rD(a,i,u),s=l}else for(o=0;o<r.length;o++){if(i=r[o],l=i.instance,u=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;rD(a,i,u),s=l}}}if(ow)throw t=Z$,ow=!1,Z$=null,t}function Mn(t,e){var n=e[uk];n===void 0&&(n=e[uk]=new Set);var r=t+"__bubble";n.has(r)||(Bz(e,t,2,!1),n.add(r))}function o_(t,e,n){var r=0;e&&(r|=4),Bz(n,t,r,e)}var zb="_reactListening"+Math.random().toString(36).slice(2);function Mg(t){if(!t[zb]){t[zb]=!0,q4.forEach(function(n){n!=="selectionchange"&&(Fee.has(n)||o_(n,!1,t),o_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[zb]||(e[zb]=!0,o_("selectionchange",!1,e))}}function Bz(t,e,n,r){switch(Cz(e)){case 1:var a=JZ;break;case 4:a=ZZ;break;default:a=MT}n=a.bind(null,e,n,t),a=void 0,!J$||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function i_(t,e,n,r,a){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;i!==null;){if(o=Ju(i),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}i=i.parentNode}}r=r.return}uz(function(){var u=s,c=OT(n),d=[];e:{var f=Fz.get(t);if(f!==void 0){var h=LT,p=t;switch(t){case"keypress":if(O0(n)===0)break e;case"keydown":case"keyup":h=pee;break;case"focusin":p="focus",h=e_;break;case"focusout":p="blur",h=e_;break;case"beforeblur":case"afterblur":h=e_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=GR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=nee;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=yee;break;case Rz:case Dz:case jz:h=see;break;case Mz:h=xee;break;case"scroll":h=eee;break;case"wheel":h=wee;break;case"copy":case"cut":case"paste":h=iee;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=qR}var g=(e&4)!==0,y=!g&&t==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var x=u,b;x!==null;){b=x;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Ag(x,v),w!=null&&g.push(Fg(x,w,b)))),y)break;x=x.return}0<g.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Y$&&(p=n.relatedTarget||n.fromElement)&&(Ju(p)||p[Vi]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?Ju(p):null,p!==null&&(y=Yc(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(g=GR,w="onMouseLeave",v="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=qR,w="onPointerLeave",v="onPointerEnter",x="pointer"),y=h==null?f:nf(h),b=p==null?f:nf(p),f=new g(w,x+"leave",h,n,c),f.target=y,f.relatedTarget=b,w=null,Ju(c)===u&&(g=new g(v,x+"enter",p,n,c),g.target=b,g.relatedTarget=y,w=g),y=w,h&&p)t:{for(g=h,v=p,x=0,b=g;b;b=Ed(b))x++;for(b=0,w=v;w;w=Ed(w))b++;for(;0<x-b;)g=Ed(g),x--;for(;0<b-x;)v=Ed(v),b--;for(;x--;){if(g===v||v!==null&&g===v.alternate)break t;g=Ed(g),v=Ed(v)}g=null}else g=null;h!==null&&aD(d,f,h,g,!1),p!==null&&y!==null&&aD(d,y,p,g,!0)}}e:{if(f=u?nf(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var C=Iee;else if(YR(f))if(Tz)C=Pee;else{C=Eee;var _=Tee}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=Aee);if(C&&(C=C(t,u))){Iz(d,C,n,c);break e}_&&_(t,f,u),t==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&G$(f,"number",f.value)}switch(_=u?nf(u):window,t){case"focusin":(YR(_)||_.contentEditable==="true")&&(ef=_,rk=u,ug=null);break;case"focusout":ug=rk=ef=null;break;case"mousedown":ak=!0;break;case"contextmenu":case"mouseup":case"dragend":ak=!1,tD(d,n,c);break;case"selectionchange":if(Dee)break;case"keydown":case"keyup":tD(d,n,c)}var $;if(zT)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Zd?kz(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&($z&&n.locale!=="ko"&&(Zd||k!=="onCompositionStart"?k==="onCompositionEnd"&&Zd&&($=_z()):(kl=c,FT="value"in kl?kl.value:kl.textContent,Zd=!0)),_=dw(u,k),0<_.length&&(k=new HR(k,t,null,n,c),d.push({event:k,listeners:_}),$?k.data=$:($=Nz(n),$!==null&&(k.data=$)))),($=Cee?_ee(t,n):$ee(t,n))&&(u=dw(u,"onBeforeInput"),0<u.length&&(c=new HR("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=$))}Lz(d,e)})}function Fg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dw(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Ag(t,n),s!=null&&r.unshift(Fg(t,s,a)),s=Ag(t,e),s!=null&&r.push(Fg(t,s,a))),t=t.return}return r}function Ed(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function aD(t,e,n,r,a){for(var s=e._reactName,o=[];n!==null&&n!==r;){var i=n,l=i.alternate,u=i.stateNode;if(l!==null&&l===r)break;i.tag===5&&u!==null&&(i=u,a?(l=Ag(n,s),l!=null&&o.unshift(Fg(n,l,i))):a||(l=Ag(n,s),l!=null&&o.push(Fg(n,l,i)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Lee=/\r\n?/g,Bee=/\u0000|\uFFFD/g;function sD(t){return(typeof t=="string"?t:""+t).replace(Lee,`
`).replace(Bee,"")}function Ub(t,e,n){if(e=sD(e),sD(t)!==e&&n)throw Error(ke(425))}function fw(){}var sk=null,ok=null;function ik(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lk=typeof setTimeout=="function"?setTimeout:void 0,zee=typeof clearTimeout=="function"?clearTimeout:void 0,oD=typeof Promise=="function"?Promise:void 0,Uee=typeof queueMicrotask=="function"?queueMicrotask:typeof oD<"u"?function(t){return oD.resolve(null).then(t).catch(Vee)}:lk;function Vee(t){setTimeout(function(){throw t})}function l_(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),Rg(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Rg(e)}function Fl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function iD(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ih=Math.random().toString(36).slice(2),Ho="__reactFiber$"+Ih,Lg="__reactProps$"+Ih,Vi="__reactContainer$"+Ih,uk="__reactEvents$"+Ih,Wee="__reactListeners$"+Ih,Gee="__reactHandles$"+Ih;function Ju(t){var e=t[Ho];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Vi]||n[Ho]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=iD(t);t!==null;){if(n=t[Ho])return n;t=iD(t)}return e}t=n,n=t.parentNode}return null}function rv(t){return t=t[Ho]||t[Vi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function nf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ke(33))}function sS(t){return t[Lg]||null}var ck=[],rf=-1;function su(t){return{current:t}}function Bn(t){0>rf||(t.current=ck[rf],ck[rf]=null,rf--)}function En(t,e){rf++,ck[rf]=t.current,t.current=e}var Yl={},ha=su(Yl),Ya=su(!1),wc=Yl;function Of(t,e){var n=t.type.contextTypes;if(!n)return Yl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in n)a[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Qa(t){return t=t.childContextTypes,t!=null}function hw(){Bn(Ya),Bn(ha)}function lD(t,e,n){if(ha.current!==Yl)throw Error(ke(168));En(ha,e),En(Ya,n)}function zz(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(ke(108,TZ(t)||"Unknown",a));return Xn({},n,r)}function pw(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yl,wc=ha.current,En(ha,t),En(Ya,Ya.current),!0}function uD(t,e,n){var r=t.stateNode;if(!r)throw Error(ke(169));n?(t=zz(t,e,wc),r.__reactInternalMemoizedMergedChildContext=t,Bn(Ya),Bn(ha),En(ha,t)):Bn(Ya),En(Ya,n)}var $i=null,oS=!1,u_=!1;function Uz(t){$i===null?$i=[t]:$i.push(t)}function Hee(t){oS=!0,Uz(t)}function ou(){if(!u_&&$i!==null){u_=!0;var t=0,e=dn;try{var n=$i;for(dn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}$i=null,oS=!1}catch(a){throw $i!==null&&($i=$i.slice(t+1)),hz(RT,ou),a}finally{dn=e,u_=!1}}return null}var af=[],sf=0,mw=null,gw=0,Bs=[],zs=0,Sc=null,Ei=1,Ai="";function Mu(t,e){af[sf++]=gw,af[sf++]=mw,mw=t,gw=e}function Vz(t,e,n){Bs[zs++]=Ei,Bs[zs++]=Ai,Bs[zs++]=Sc,Sc=t;var r=Ei;t=Ai;var a=32-_o(r)-1;r&=~(1<<a),n+=1;var s=32-_o(e)+a;if(30<s){var o=a-a%5;s=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ei=1<<32-_o(e)+a|n<<a|r,Ai=s+t}else Ei=1<<s|n<<a|r,Ai=t}function VT(t){t.return!==null&&(Mu(t,1),Vz(t,1,0))}function WT(t){for(;t===mw;)mw=af[--sf],af[sf]=null,gw=af[--sf],af[sf]=null;for(;t===Sc;)Sc=Bs[--zs],Bs[zs]=null,Ai=Bs[--zs],Bs[zs]=null,Ei=Bs[--zs],Bs[zs]=null}var gs=null,hs=null,Wn=!1,vo=null;function Wz(t,e){var n=Ws(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function cD(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,gs=t,hs=Fl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,gs=t,hs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Sc!==null?{id:Ei,overflow:Ai}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ws(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,gs=t,hs=null,!0):!1;default:return!1}}function dk(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fk(t){if(Wn){var e=hs;if(e){var n=e;if(!cD(t,e)){if(dk(t))throw Error(ke(418));e=Fl(n.nextSibling);var r=gs;e&&cD(t,e)?Wz(r,n):(t.flags=t.flags&-4097|2,Wn=!1,gs=t)}}else{if(dk(t))throw Error(ke(418));t.flags=t.flags&-4097|2,Wn=!1,gs=t}}}function dD(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;gs=t}function Vb(t){if(t!==gs)return!1;if(!Wn)return dD(t),Wn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ik(t.type,t.memoizedProps)),e&&(e=hs)){if(dk(t))throw Gz(),Error(ke(418));for(;e;)Wz(t,e),e=Fl(e.nextSibling)}if(dD(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ke(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hs=Fl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hs=null}}else hs=gs?Fl(t.stateNode.nextSibling):null;return!0}function Gz(){for(var t=hs;t;)t=Fl(t.nextSibling)}function Rf(){hs=gs=null,Wn=!1}function GT(t){vo===null?vo=[t]:vo.push(t)}var qee=Qi.ReactCurrentBatchConfig;function $m(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ke(309));var r=n.stateNode}if(!r)throw Error(ke(147,t));var a=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var i=a.refs;o===null?delete i[s]:i[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ke(284));if(!n._owner)throw Error(ke(290,t))}return t}function Wb(t,e){throw t=Object.prototype.toString.call(e),Error(ke(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fD(t){var e=t._init;return e(t._payload)}function Hz(t){function e(v,x){if(t){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function n(v,x){if(!t)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function r(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function a(v,x){return v=Ul(v,x),v.index=0,v.sibling=null,v}function s(v,x,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function i(v,x,b,w){return x===null||x.tag!==6?(x=g_(b,v.mode,w),x.return=v,x):(x=a(x,b),x.return=v,x)}function l(v,x,b,w){var C=b.type;return C===Jd?c(v,x,b.props.children,w,b.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gl&&fD(C)===x.type)?(w=a(x,b.props),w.ref=$m(v,x,b),w.return=v,w):(w=B0(b.type,b.key,b.props,null,v.mode,w),w.ref=$m(v,x,b),w.return=v,w)}function u(v,x,b,w){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=y_(b,v.mode,w),x.return=v,x):(x=a(x,b.children||[]),x.return=v,x)}function c(v,x,b,w,C){return x===null||x.tag!==7?(x=dc(b,v.mode,w,C),x.return=v,x):(x=a(x,b),x.return=v,x)}function d(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=g_(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ob:return b=B0(x.type,x.key,x.props,null,v.mode,b),b.ref=$m(v,null,x),b.return=v,b;case Qd:return x=y_(x,v.mode,b),x.return=v,x;case gl:var w=x._init;return d(v,w(x._payload),b)}if(Hm(x)||bm(x))return x=dc(x,v.mode,b,null),x.return=v,x;Wb(v,x)}return null}function f(v,x,b,w){var C=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:i(v,x,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ob:return b.key===C?l(v,x,b,w):null;case Qd:return b.key===C?u(v,x,b,w):null;case gl:return C=b._init,f(v,x,C(b._payload),w)}if(Hm(b)||bm(b))return C!==null?null:c(v,x,b,w,null);Wb(v,b)}return null}function h(v,x,b,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,i(x,v,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ob:return v=v.get(w.key===null?b:w.key)||null,l(x,v,w,C);case Qd:return v=v.get(w.key===null?b:w.key)||null,u(x,v,w,C);case gl:var _=w._init;return h(v,x,b,_(w._payload),C)}if(Hm(w)||bm(w))return v=v.get(b)||null,c(x,v,w,C,null);Wb(x,w)}return null}function p(v,x,b,w){for(var C=null,_=null,$=x,k=x=0,A=null;$!==null&&k<b.length;k++){$.index>k?(A=$,$=null):A=$.sibling;var P=f(v,$,b[k],w);if(P===null){$===null&&($=A);break}t&&$&&P.alternate===null&&e(v,$),x=s(P,x,k),_===null?C=P:_.sibling=P,_=P,$=A}if(k===b.length)return n(v,$),Wn&&Mu(v,k),C;if($===null){for(;k<b.length;k++)$=d(v,b[k],w),$!==null&&(x=s($,x,k),_===null?C=$:_.sibling=$,_=$);return Wn&&Mu(v,k),C}for($=r(v,$);k<b.length;k++)A=h($,v,k,b[k],w),A!==null&&(t&&A.alternate!==null&&$.delete(A.key===null?k:A.key),x=s(A,x,k),_===null?C=A:_.sibling=A,_=A);return t&&$.forEach(function(O){return e(v,O)}),Wn&&Mu(v,k),C}function g(v,x,b,w){var C=bm(b);if(typeof C!="function")throw Error(ke(150));if(b=C.call(b),b==null)throw Error(ke(151));for(var _=C=null,$=x,k=x=0,A=null,P=b.next();$!==null&&!P.done;k++,P=b.next()){$.index>k?(A=$,$=null):A=$.sibling;var O=f(v,$,P.value,w);if(O===null){$===null&&($=A);break}t&&$&&O.alternate===null&&e(v,$),x=s(O,x,k),_===null?C=O:_.sibling=O,_=O,$=A}if(P.done)return n(v,$),Wn&&Mu(v,k),C;if($===null){for(;!P.done;k++,P=b.next())P=d(v,P.value,w),P!==null&&(x=s(P,x,k),_===null?C=P:_.sibling=P,_=P);return Wn&&Mu(v,k),C}for($=r(v,$);!P.done;k++,P=b.next())P=h($,v,k,P.value,w),P!==null&&(t&&P.alternate!==null&&$.delete(P.key===null?k:P.key),x=s(P,x,k),_===null?C=P:_.sibling=P,_=P);return t&&$.forEach(function(R){return e(v,R)}),Wn&&Mu(v,k),C}function y(v,x,b,w){if(typeof b=="object"&&b!==null&&b.type===Jd&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ob:e:{for(var C=b.key,_=x;_!==null;){if(_.key===C){if(C=b.type,C===Jd){if(_.tag===7){n(v,_.sibling),x=a(_,b.props.children),x.return=v,v=x;break e}}else if(_.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===gl&&fD(C)===_.type){n(v,_.sibling),x=a(_,b.props),x.ref=$m(v,_,b),x.return=v,v=x;break e}n(v,_);break}else e(v,_);_=_.sibling}b.type===Jd?(x=dc(b.props.children,v.mode,w,b.key),x.return=v,v=x):(w=B0(b.type,b.key,b.props,null,v.mode,w),w.ref=$m(v,x,b),w.return=v,v=w)}return o(v);case Qd:e:{for(_=b.key;x!==null;){if(x.key===_)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(v,x.sibling),x=a(x,b.children||[]),x.return=v,v=x;break e}else{n(v,x);break}else e(v,x);x=x.sibling}x=y_(b,v.mode,w),x.return=v,v=x}return o(v);case gl:return _=b._init,y(v,x,_(b._payload),w)}if(Hm(b))return p(v,x,b,w);if(bm(b))return g(v,x,b,w);Wb(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(v,x.sibling),x=a(x,b),x.return=v,v=x):(n(v,x),x=g_(b,v.mode,w),x.return=v,v=x),o(v)):n(v,x)}return y}var Df=Hz(!0),qz=Hz(!1),yw=su(null),vw=null,of=null,HT=null;function qT(){HT=of=vw=null}function KT(t){var e=yw.current;Bn(yw),t._currentValue=e}function hk(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function xf(t,e){vw=t,HT=of=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(qa=!0),t.firstContext=null)}function Js(t){var e=t._currentValue;if(HT!==t)if(t={context:t,memoizedValue:e,next:null},of===null){if(vw===null)throw Error(ke(308));of=t,vw.dependencies={lanes:0,firstContext:t}}else of=of.next=t;return e}var Zu=null;function XT(t){Zu===null?Zu=[t]:Zu.push(t)}function Kz(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,XT(e)):(n.next=a.next,a.next=n),e.interleaved=n,Wi(t,r)}function Wi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var yl=!1;function YT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xz(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ri(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ll(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Bt&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,Wi(t,n)}return a=r.interleaved,a===null?(e.next=e,XT(r)):(e.next=a.next,a.next=e),r.interleaved=e,Wi(t,n)}function R0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,DT(t,n)}}function hD(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?a=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?a=s=e:s=s.next=e}else a=s=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function xw(t,e,n,r){var a=t.updateQueue;yl=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var l=i,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,i=c.lastBaseUpdate,i!==o&&(i===null?c.firstBaseUpdate=u:i.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;o=0,c=u=l=null,i=s;do{var f=i.lane,h=i.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var p=t,g=i;switch(f=e,h=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Xn({},d,f);break e;case 2:yl=!0}}i.callback!==null&&i.lane!==0&&(t.flags|=64,f=a.effects,f===null?a.effects=[i]:f.push(i))}else h={eventTime:h,lane:f,tag:i.tag,payload:i.payload,callback:i.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,o|=f;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;f=i,i=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(c===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);_c|=o,t.lanes=o,t.memoizedState=d}}function pD(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(ke(191,a));a.call(r)}}}var av={},Jo=su(av),Bg=su(av),zg=su(av);function ec(t){if(t===av)throw Error(ke(174));return t}function QT(t,e){switch(En(zg,e),En(Bg,t),En(Jo,av),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:q$(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=q$(e,t)}Bn(Jo),En(Jo,e)}function jf(){Bn(Jo),Bn(Bg),Bn(zg)}function Yz(t){ec(zg.current);var e=ec(Jo.current),n=q$(e,t.type);e!==n&&(En(Bg,t),En(Jo,n))}function JT(t){Bg.current===t&&(Bn(Jo),Bn(Bg))}var qn=su(0);function bw(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var c_=[];function ZT(){for(var t=0;t<c_.length;t++)c_[t]._workInProgressVersionPrimary=null;c_.length=0}var D0=Qi.ReactCurrentDispatcher,d_=Qi.ReactCurrentBatchConfig,Cc=0,Kn=null,vr=null,Pr=null,ww=!1,cg=!1,Ug=0,Kee=0;function na(){throw Error(ke(321))}function eE(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!To(t[n],e[n]))return!1;return!0}function tE(t,e,n,r,a,s){if(Cc=s,Kn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,D0.current=t===null||t.memoizedState===null?Jee:Zee,t=n(r,a),cg){s=0;do{if(cg=!1,Ug=0,25<=s)throw Error(ke(301));s+=1,Pr=vr=null,e.updateQueue=null,D0.current=ete,t=n(r,a)}while(cg)}if(D0.current=Sw,e=vr!==null&&vr.next!==null,Cc=0,Pr=vr=Kn=null,ww=!1,e)throw Error(ke(300));return t}function nE(){var t=Ug!==0;return Ug=0,t}function Vo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pr===null?Kn.memoizedState=Pr=t:Pr=Pr.next=t,Pr}function Zs(){if(vr===null){var t=Kn.alternate;t=t!==null?t.memoizedState:null}else t=vr.next;var e=Pr===null?Kn.memoizedState:Pr.next;if(e!==null)Pr=e,vr=t;else{if(t===null)throw Error(ke(310));vr=t,t={memoizedState:vr.memoizedState,baseState:vr.baseState,baseQueue:vr.baseQueue,queue:vr.queue,next:null},Pr===null?Kn.memoizedState=Pr=t:Pr=Pr.next=t}return Pr}function Vg(t,e){return typeof e=="function"?e(t):e}function f_(t){var e=Zs(),n=e.queue;if(n===null)throw Error(ke(311));n.lastRenderedReducer=t;var r=vr,a=r.baseQueue,s=n.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(a!==null){s=a.next,r=r.baseState;var i=o=null,l=null,u=s;do{var c=u.lane;if((Cc&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(i=l=d,o=r):l=l.next=d,Kn.lanes|=c,_c|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=i,To(r,e.memoizedState)||(qa=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do s=a.lane,Kn.lanes|=s,_c|=s,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function h_(t){var e=Zs(),n=e.queue;if(n===null)throw Error(ke(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,s=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do s=t(s,o.action),o=o.next;while(o!==a);To(s,e.memoizedState)||(qa=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Qz(){}function Jz(t,e){var n=Kn,r=Zs(),a=e(),s=!To(r.memoizedState,a);if(s&&(r.memoizedState=a,qa=!0),r=r.queue,rE(tU.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Pr!==null&&Pr.memoizedState.tag&1){if(n.flags|=2048,Wg(9,eU.bind(null,n,r,a,e),void 0,null),Mr===null)throw Error(ke(349));Cc&30||Zz(n,e,a)}return a}function Zz(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function eU(t,e,n,r){e.value=n,e.getSnapshot=r,nU(e)&&rU(t)}function tU(t,e,n){return n(function(){nU(e)&&rU(t)})}function nU(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!To(t,n)}catch{return!0}}function rU(t){var e=Wi(t,1);e!==null&&$o(e,t,1,-1)}function mD(t){var e=Vo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vg,lastRenderedState:t},e.queue=t,t=t.dispatch=Qee.bind(null,Kn,t),[e.memoizedState,t]}function Wg(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function aU(){return Zs().memoizedState}function j0(t,e,n,r){var a=Vo();Kn.flags|=t,a.memoizedState=Wg(1|e,n,void 0,r===void 0?null:r)}function iS(t,e,n,r){var a=Zs();r=r===void 0?null:r;var s=void 0;if(vr!==null){var o=vr.memoizedState;if(s=o.destroy,r!==null&&eE(r,o.deps)){a.memoizedState=Wg(e,n,s,r);return}}Kn.flags|=t,a.memoizedState=Wg(1|e,n,s,r)}function gD(t,e){return j0(8390656,8,t,e)}function rE(t,e){return iS(2048,8,t,e)}function sU(t,e){return iS(4,2,t,e)}function oU(t,e){return iS(4,4,t,e)}function iU(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function lU(t,e,n){return n=n!=null?n.concat([t]):null,iS(4,4,iU.bind(null,e,t),n)}function aE(){}function uU(t,e){var n=Zs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eE(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function cU(t,e){var n=Zs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&eE(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function dU(t,e,n){return Cc&21?(To(n,e)||(n=gz(),Kn.lanes|=n,_c|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,qa=!0),t.memoizedState=n)}function Xee(t,e){var n=dn;dn=n!==0&&4>n?n:4,t(!0);var r=d_.transition;d_.transition={};try{t(!1),e()}finally{dn=n,d_.transition=r}}function fU(){return Zs().memoizedState}function Yee(t,e,n){var r=zl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},hU(t))pU(e,n);else if(n=Kz(t,e,n,r),n!==null){var a=ka();$o(n,t,r,a),mU(n,e,r)}}function Qee(t,e,n){var r=zl(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(hU(t))pU(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,i=s(o,n);if(a.hasEagerState=!0,a.eagerState=i,To(i,o)){var l=e.interleaved;l===null?(a.next=a,XT(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}n=Kz(t,e,a,r),n!==null&&(a=ka(),$o(n,t,r,a),mU(n,e,r))}}function hU(t){var e=t.alternate;return t===Kn||e!==null&&e===Kn}function pU(t,e){cg=ww=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function mU(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,DT(t,n)}}var Sw={readContext:Js,useCallback:na,useContext:na,useEffect:na,useImperativeHandle:na,useInsertionEffect:na,useLayoutEffect:na,useMemo:na,useReducer:na,useRef:na,useState:na,useDebugValue:na,useDeferredValue:na,useTransition:na,useMutableSource:na,useSyncExternalStore:na,useId:na,unstable_isNewReconciler:!1},Jee={readContext:Js,useCallback:function(t,e){return Vo().memoizedState=[t,e===void 0?null:e],t},useContext:Js,useEffect:gD,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,j0(4194308,4,iU.bind(null,e,t),n)},useLayoutEffect:function(t,e){return j0(4194308,4,t,e)},useInsertionEffect:function(t,e){return j0(4,2,t,e)},useMemo:function(t,e){var n=Vo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Vo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Yee.bind(null,Kn,t),[r.memoizedState,t]},useRef:function(t){var e=Vo();return t={current:t},e.memoizedState=t},useState:mD,useDebugValue:aE,useDeferredValue:function(t){return Vo().memoizedState=t},useTransition:function(){var t=mD(!1),e=t[0];return t=Xee.bind(null,t[1]),Vo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Kn,a=Vo();if(Wn){if(n===void 0)throw Error(ke(407));n=n()}else{if(n=e(),Mr===null)throw Error(ke(349));Cc&30||Zz(r,e,n)}a.memoizedState=n;var s={value:n,getSnapshot:e};return a.queue=s,gD(tU.bind(null,r,s,t),[t]),r.flags|=2048,Wg(9,eU.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Vo(),e=Mr.identifierPrefix;if(Wn){var n=Ai,r=Ei;n=(r&~(1<<32-_o(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ug++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Kee++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Zee={readContext:Js,useCallback:uU,useContext:Js,useEffect:rE,useImperativeHandle:lU,useInsertionEffect:sU,useLayoutEffect:oU,useMemo:cU,useReducer:f_,useRef:aU,useState:function(){return f_(Vg)},useDebugValue:aE,useDeferredValue:function(t){var e=Zs();return dU(e,vr.memoizedState,t)},useTransition:function(){var t=f_(Vg)[0],e=Zs().memoizedState;return[t,e]},useMutableSource:Qz,useSyncExternalStore:Jz,useId:fU,unstable_isNewReconciler:!1},ete={readContext:Js,useCallback:uU,useContext:Js,useEffect:rE,useImperativeHandle:lU,useInsertionEffect:sU,useLayoutEffect:oU,useMemo:cU,useReducer:h_,useRef:aU,useState:function(){return h_(Vg)},useDebugValue:aE,useDeferredValue:function(t){var e=Zs();return vr===null?e.memoizedState=t:dU(e,vr.memoizedState,t)},useTransition:function(){var t=h_(Vg)[0],e=Zs().memoizedState;return[t,e]},useMutableSource:Qz,useSyncExternalStore:Jz,useId:fU,unstable_isNewReconciler:!1};function ho(t,e){if(t&&t.defaultProps){e=Xn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function pk(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var lS={isMounted:function(t){return(t=t._reactInternals)?Yc(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ka(),a=zl(t),s=Ri(r,a);s.payload=e,n!=null&&(s.callback=n),e=Ll(t,s,a),e!==null&&($o(e,t,a,r),R0(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ka(),a=zl(t),s=Ri(r,a);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ll(t,s,a),e!==null&&($o(e,t,a,r),R0(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ka(),r=zl(t),a=Ri(n,r);a.tag=2,e!=null&&(a.callback=e),e=Ll(t,a,r),e!==null&&($o(e,t,r,n),R0(e,t,r))}};function yD(t,e,n,r,a,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!jg(n,r)||!jg(a,s):!0}function gU(t,e,n){var r=!1,a=Yl,s=e.contextType;return typeof s=="object"&&s!==null?s=Js(s):(a=Qa(e)?wc:ha.current,r=e.contextTypes,s=(r=r!=null)?Of(t,a):Yl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lS,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function vD(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&lS.enqueueReplaceState(e,e.state,null)}function mk(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},YT(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=Js(s):(s=Qa(e)?wc:ha.current,a.context=Of(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(pk(t,e,s,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&lS.enqueueReplaceState(a,a.state,null),xw(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Mf(t,e){try{var n="",r=e;do n+=IZ(r),r=r.return;while(r);var a=n}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function p_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gk(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tte=typeof WeakMap=="function"?WeakMap:Map;function yU(t,e,n){n=Ri(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_w||(_w=!0,kk=r),gk(t,e)},n}function vU(t,e,n){n=Ri(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){gk(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){gk(t,e),typeof r!="function"&&(Bl===null?Bl=new Set([this]):Bl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function xD(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new tte;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=mte.bind(null,t,e,n),e.then(t,t))}function bD(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wD(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ri(-1,1),e.tag=2,Ll(n,e,1))),n.lanes|=1),t)}var nte=Qi.ReactCurrentOwner,qa=!1;function Sa(t,e,n,r){e.child=t===null?qz(e,null,n,r):Df(e,t.child,n,r)}function SD(t,e,n,r,a){n=n.render;var s=e.ref;return xf(e,a),r=tE(t,e,n,r,s,a),n=nE(),t!==null&&!qa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Gi(t,e,a)):(Wn&&n&&VT(e),e.flags|=1,Sa(t,e,r,a),e.child)}function CD(t,e,n,r,a){if(t===null){var s=n.type;return typeof s=="function"&&!fE(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,xU(t,e,s,r,a)):(t=B0(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:jg,n(o,r)&&t.ref===e.ref)return Gi(t,e,a)}return e.flags|=1,t=Ul(s,r),t.ref=e.ref,t.return=e,e.child=t}function xU(t,e,n,r,a){if(t!==null){var s=t.memoizedProps;if(jg(s,r)&&t.ref===e.ref)if(qa=!1,e.pendingProps=r=s,(t.lanes&a)!==0)t.flags&131072&&(qa=!0);else return e.lanes=t.lanes,Gi(t,e,a)}return yk(t,e,n,r,a)}function bU(t,e,n){var r=e.pendingProps,a=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(uf,us),us|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,En(uf,us),us|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,En(uf,us),us|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,En(uf,us),us|=r;return Sa(t,e,a,n),e.child}function wU(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function yk(t,e,n,r,a){var s=Qa(n)?wc:ha.current;return s=Of(e,s),xf(e,a),n=tE(t,e,n,r,s,a),r=nE(),t!==null&&!qa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Gi(t,e,a)):(Wn&&r&&VT(e),e.flags|=1,Sa(t,e,n,a),e.child)}function _D(t,e,n,r,a){if(Qa(n)){var s=!0;pw(e)}else s=!1;if(xf(e,a),e.stateNode===null)M0(t,e),gU(e,n,r),mk(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,i=e.memoizedProps;o.props=i;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Js(u):(u=Qa(n)?wc:ha.current,u=Of(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==r||l!==u)&&vD(e,o,r,u),yl=!1;var f=e.memoizedState;o.state=f,xw(e,r,o,a),l=e.memoizedState,i!==r||f!==l||Ya.current||yl?(typeof c=="function"&&(pk(e,n,c,r),l=e.memoizedState),(i=yl||yD(e,n,i,r,f,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=i):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Xz(t,e),i=e.memoizedProps,u=e.type===e.elementType?i:ho(e.type,i),o.props=u,d=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Js(l):(l=Qa(n)?wc:ha.current,l=Of(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==d||f!==l)&&vD(e,o,r,l),yl=!1,f=e.memoizedState,o.state=f,xw(e,r,o,a);var p=e.memoizedState;i!==d||f!==p||Ya.current||yl?(typeof h=="function"&&(pk(e,n,h,r),p=e.memoizedState),(u=yl||yD(e,n,u,r,f,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return vk(t,e,n,r,s,a)}function vk(t,e,n,r,a,s){wU(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&uD(e,n,!1),Gi(t,e,s);r=e.stateNode,nte.current=e;var i=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Df(e,t.child,null,s),e.child=Df(e,null,i,s)):Sa(t,e,i,s),e.memoizedState=r.state,a&&uD(e,n,!0),e.child}function SU(t){var e=t.stateNode;e.pendingContext?lD(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lD(t,e.context,!1),QT(t,e.containerInfo)}function $D(t,e,n,r,a){return Rf(),GT(a),e.flags|=256,Sa(t,e,n,r),e.child}var xk={dehydrated:null,treeContext:null,retryLane:0};function bk(t){return{baseLanes:t,cachePool:null,transitions:null}}function CU(t,e,n){var r=e.pendingProps,a=qn.current,s=!1,o=(e.flags&128)!==0,i;if((i=o)||(i=t!==null&&t.memoizedState===null?!1:(a&2)!==0),i?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),En(qn,a&1),t===null)return fk(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=dS(o,r,0,null),t=dc(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=bk(n),e.memoizedState=xk,t):sE(e,o));if(a=t.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return rte(t,e,o,r,i,a,n);if(s){s=r.fallback,o=e.mode,a=t.child,i=a.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ul(a,l),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?s=Ul(i,s):(s=dc(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?bk(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=xk,r}return s=t.child,t=s.sibling,r=Ul(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function sE(t,e){return e=dS({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Gb(t,e,n,r){return r!==null&&GT(r),Df(e,t.child,null,n),t=sE(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function rte(t,e,n,r,a,s,o){if(n)return e.flags&256?(e.flags&=-257,r=p_(Error(ke(422))),Gb(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,a=e.mode,r=dS({mode:"visible",children:r.children},a,0,null),s=dc(s,a,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Df(e,t.child,null,o),e.child.memoizedState=bk(o),e.memoizedState=xk,s);if(!(e.mode&1))return Gb(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,s=Error(ke(419)),r=p_(s,r,void 0),Gb(t,e,o,r)}if(i=(o&t.childLanes)!==0,qa||i){if(r=Mr,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Wi(t,a),$o(r,t,a,-1))}return dE(),r=p_(Error(ke(421))),Gb(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=gte.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,hs=Fl(a.nextSibling),gs=e,Wn=!0,vo=null,t!==null&&(Bs[zs++]=Ei,Bs[zs++]=Ai,Bs[zs++]=Sc,Ei=t.id,Ai=t.overflow,Sc=e),e=sE(e,r.children),e.flags|=4096,e)}function kD(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hk(t.return,e,n)}function m_(t,e,n,r,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function _U(t,e,n){var r=e.pendingProps,a=r.revealOrder,s=r.tail;if(Sa(t,e,r.children,n),r=qn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&kD(t,n,e);else if(t.tag===19)kD(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(En(qn,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&bw(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),m_(e,!1,a,n,s);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&bw(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}m_(e,!0,n,null,s);break;case"together":m_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function M0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),_c|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ke(153));if(e.child!==null){for(t=e.child,n=Ul(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ul(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ate(t,e,n){switch(e.tag){case 3:SU(e),Rf();break;case 5:Yz(e);break;case 1:Qa(e.type)&&pw(e);break;case 4:QT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;En(yw,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(En(qn,qn.current&1),e.flags|=128,null):n&e.child.childLanes?CU(t,e,n):(En(qn,qn.current&1),t=Gi(t,e,n),t!==null?t.sibling:null);En(qn,qn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return _U(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),En(qn,qn.current),r)break;return null;case 22:case 23:return e.lanes=0,bU(t,e,n)}return Gi(t,e,n)}var $U,wk,kU,NU;$U=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wk=function(){};kU=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,ec(Jo.current);var s=null;switch(n){case"input":a=V$(t,a),r=V$(t,r),s=[];break;case"select":a=Xn({},a,{value:void 0}),r=Xn({},r,{value:void 0}),s=[];break;case"textarea":a=H$(t,a),r=H$(t,r),s=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fw)}K$(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var i=a[u];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Tg.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(i=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&l!==i&&(l!=null||i!=null))if(u==="style")if(i){for(o in i)!i.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&i[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,i=i?i.__html:void 0,l!=null&&i!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Tg.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Mn("scroll",t),s||i===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};NU=function(t,e,n,r){n!==r&&(e.flags|=4)};function km(t,e){if(!Wn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ra(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ste(t,e,n){var r=e.pendingProps;switch(WT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ra(e),null;case 1:return Qa(e.type)&&hw(),ra(e),null;case 3:return r=e.stateNode,jf(),Bn(Ya),Bn(ha),ZT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vb(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vo!==null&&(Tk(vo),vo=null))),wk(t,e),ra(e),null;case 5:JT(e);var a=ec(zg.current);if(n=e.type,t!==null&&e.stateNode!=null)kU(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ke(166));return ra(e),null}if(t=ec(Jo.current),Vb(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Ho]=e,r[Lg]=s,t=(e.mode&1)!==0,n){case"dialog":Mn("cancel",r),Mn("close",r);break;case"iframe":case"object":case"embed":Mn("load",r);break;case"video":case"audio":for(a=0;a<Km.length;a++)Mn(Km[a],r);break;case"source":Mn("error",r);break;case"img":case"image":case"link":Mn("error",r),Mn("load",r);break;case"details":Mn("toggle",r);break;case"input":DR(r,s),Mn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Mn("invalid",r);break;case"textarea":MR(r,s),Mn("invalid",r)}K$(n,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var i=s[o];o==="children"?typeof i=="string"?r.textContent!==i&&(s.suppressHydrationWarning!==!0&&Ub(r.textContent,i,t),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(s.suppressHydrationWarning!==!0&&Ub(r.textContent,i,t),a=["children",""+i]):Tg.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&Mn("scroll",r)}switch(n){case"input":Rb(r),jR(r,s,!0);break;case"textarea":Rb(r),FR(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=fw)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=tz(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Ho]=e,t[Lg]=r,$U(t,e,!1,!1),e.stateNode=t;e:{switch(o=X$(n,r),n){case"dialog":Mn("cancel",t),Mn("close",t),a=r;break;case"iframe":case"object":case"embed":Mn("load",t),a=r;break;case"video":case"audio":for(a=0;a<Km.length;a++)Mn(Km[a],t);a=r;break;case"source":Mn("error",t),a=r;break;case"img":case"image":case"link":Mn("error",t),Mn("load",t),a=r;break;case"details":Mn("toggle",t),a=r;break;case"input":DR(t,r),a=V$(t,r),Mn("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Xn({},r,{value:void 0}),Mn("invalid",t);break;case"textarea":MR(t,r),a=H$(t,r),Mn("invalid",t);break;default:a=r}K$(n,a),i=a;for(s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="style"?az(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&nz(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Eg(t,l):typeof l=="number"&&Eg(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Tg.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Mn("scroll",t):l!=null&&TT(t,s,l,o))}switch(n){case"input":Rb(t),jR(t,r,!1);break;case"textarea":Rb(t),FR(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xl(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?mf(t,!!r.multiple,s,!1):r.defaultValue!=null&&mf(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=fw)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ra(e),null;case 6:if(t&&e.stateNode!=null)NU(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ke(166));if(n=ec(zg.current),ec(Jo.current),Vb(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ho]=e,(s=r.nodeValue!==n)&&(t=gs,t!==null))switch(t.tag){case 3:Ub(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ub(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ho]=e,e.stateNode=r}return ra(e),null;case 13:if(Bn(qn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Wn&&hs!==null&&e.mode&1&&!(e.flags&128))Gz(),Rf(),e.flags|=98560,s=!1;else if(s=Vb(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ke(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[Ho]=e}else Rf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ra(e),s=!1}else vo!==null&&(Tk(vo),vo=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||qn.current&1?Sr===0&&(Sr=3):dE())),e.updateQueue!==null&&(e.flags|=4),ra(e),null);case 4:return jf(),wk(t,e),t===null&&Mg(e.stateNode.containerInfo),ra(e),null;case 10:return KT(e.type._context),ra(e),null;case 17:return Qa(e.type)&&hw(),ra(e),null;case 19:if(Bn(qn),s=e.memoizedState,s===null)return ra(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)km(s,!1);else{if(Sr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=bw(t),o!==null){for(e.flags|=128,km(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return En(qn,qn.current&1|2),e.child}t=t.sibling}s.tail!==null&&sr()>Ff&&(e.flags|=128,r=!0,km(s,!1),e.lanes=4194304)}else{if(!r)if(t=bw(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),km(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Wn)return ra(e),null}else 2*sr()-s.renderingStartTime>Ff&&n!==1073741824&&(e.flags|=128,r=!0,km(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=sr(),e.sibling=null,n=qn.current,En(qn,r?n&1|2:n&1),e):(ra(e),null);case 22:case 23:return cE(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?us&1073741824&&(ra(e),e.subtreeFlags&6&&(e.flags|=8192)):ra(e),null;case 24:return null;case 25:return null}throw Error(ke(156,e.tag))}function ote(t,e){switch(WT(e),e.tag){case 1:return Qa(e.type)&&hw(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jf(),Bn(Ya),Bn(ha),ZT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return JT(e),null;case 13:if(Bn(qn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ke(340));Rf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Bn(qn),null;case 4:return jf(),null;case 10:return KT(e.type._context),null;case 22:case 23:return cE(),null;case 24:return null;default:return null}}var Hb=!1,ua=!1,ite=typeof WeakSet=="function"?WeakSet:Set,We=null;function lf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){er(t,e,r)}else n.current=null}function Sk(t,e,n){try{n()}catch(r){er(t,e,r)}}var ND=!1;function lte(t,e){if(sk=uw,t=Pz(),UT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,i=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||a!==0&&d.nodeType!==3||(i=o+a),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===a&&(i=o),f===s&&++c===r&&(l=o),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=i===-1||l===-1?null:{start:i,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ok={focusedElem:t,selectionRange:n},uw=!1,We=e;We!==null;)if(e=We,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,We=t;else for(;We!==null;){e=We;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:ho(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(w){er(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,We=t;break}We=e.return}return p=ND,ND=!1,p}function dg(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&Sk(e,n,s)}a=a.next}while(a!==r)}}function uS(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ck(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function IU(t){var e=t.alternate;e!==null&&(t.alternate=null,IU(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ho],delete e[Lg],delete e[uk],delete e[Wee],delete e[Gee])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function TU(t){return t.tag===5||t.tag===3||t.tag===4}function ID(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||TU(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _k(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fw));else if(r!==4&&(t=t.child,t!==null))for(_k(t,e,n),t=t.sibling;t!==null;)_k(t,e,n),t=t.sibling}function $k(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($k(t,e,n),t=t.sibling;t!==null;)$k(t,e,n),t=t.sibling}var Gr=null,po=!1;function cl(t,e,n){for(n=n.child;n!==null;)EU(t,e,n),n=n.sibling}function EU(t,e,n){if(Qo&&typeof Qo.onCommitFiberUnmount=="function")try{Qo.onCommitFiberUnmount(tS,n)}catch{}switch(n.tag){case 5:ua||lf(n,e);case 6:var r=Gr,a=po;Gr=null,cl(t,e,n),Gr=r,po=a,Gr!==null&&(po?(t=Gr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Gr.removeChild(n.stateNode));break;case 18:Gr!==null&&(po?(t=Gr,n=n.stateNode,t.nodeType===8?l_(t.parentNode,n):t.nodeType===1&&l_(t,n),Rg(t)):l_(Gr,n.stateNode));break;case 4:r=Gr,a=po,Gr=n.stateNode.containerInfo,po=!0,cl(t,e,n),Gr=r,po=a;break;case 0:case 11:case 14:case 15:if(!ua&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Sk(n,e,o),a=a.next}while(a!==r)}cl(t,e,n);break;case 1:if(!ua&&(lf(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){er(n,e,i)}cl(t,e,n);break;case 21:cl(t,e,n);break;case 22:n.mode&1?(ua=(r=ua)||n.memoizedState!==null,cl(t,e,n),ua=r):cl(t,e,n);break;default:cl(t,e,n)}}function TD(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new ite),e.forEach(function(r){var a=yte.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function co(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var s=t,o=e,i=o;e:for(;i!==null;){switch(i.tag){case 5:Gr=i.stateNode,po=!1;break e;case 3:Gr=i.stateNode.containerInfo,po=!0;break e;case 4:Gr=i.stateNode.containerInfo,po=!0;break e}i=i.return}if(Gr===null)throw Error(ke(160));EU(s,o,a),Gr=null,po=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){er(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)AU(e,t),e=e.sibling}function AU(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(co(e,t),zo(t),r&4){try{dg(3,t,t.return),uS(3,t)}catch(g){er(t,t.return,g)}try{dg(5,t,t.return)}catch(g){er(t,t.return,g)}}break;case 1:co(e,t),zo(t),r&512&&n!==null&&lf(n,n.return);break;case 5:if(co(e,t),zo(t),r&512&&n!==null&&lf(n,n.return),t.flags&32){var a=t.stateNode;try{Eg(a,"")}catch(g){er(t,t.return,g)}}if(r&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,i=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{i==="input"&&s.type==="radio"&&s.name!=null&&Z4(a,s),X$(i,o);var u=X$(i,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?az(a,d):c==="dangerouslySetInnerHTML"?nz(a,d):c==="children"?Eg(a,d):TT(a,c,d,u)}switch(i){case"input":W$(a,s);break;case"textarea":ez(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?mf(a,!!s.multiple,h,!1):f!==!!s.multiple&&(s.defaultValue!=null?mf(a,!!s.multiple,s.defaultValue,!0):mf(a,!!s.multiple,s.multiple?[]:"",!1))}a[Lg]=s}catch(g){er(t,t.return,g)}}break;case 6:if(co(e,t),zo(t),r&4){if(t.stateNode===null)throw Error(ke(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(g){er(t,t.return,g)}}break;case 3:if(co(e,t),zo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rg(e.containerInfo)}catch(g){er(t,t.return,g)}break;case 4:co(e,t),zo(t);break;case 13:co(e,t),zo(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(lE=sr())),r&4&&TD(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(ua=(u=ua)||c,co(e,t),ua=u):co(e,t),zo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(We=t,c=t.child;c!==null;){for(d=We=c;We!==null;){switch(f=We,h=f.child,f.tag){case 0:case 11:case 14:case 15:dg(4,f,f.return);break;case 1:lf(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){er(r,n,g)}}break;case 5:lf(f,f.return);break;case 22:if(f.memoizedState!==null){AD(d);continue}}h!==null?(h.return=f,We=h):AD(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(i=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,i.style.display=rz("display",o))}catch(g){er(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){er(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:co(e,t),zo(t),r&4&&TD(t);break;case 21:break;default:co(e,t),zo(t)}}function zo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(TU(n)){var r=n;break e}n=n.return}throw Error(ke(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Eg(a,""),r.flags&=-33);var s=ID(t);$k(t,s,a);break;case 3:case 4:var o=r.stateNode.containerInfo,i=ID(t);_k(t,i,o);break;default:throw Error(ke(161))}}catch(l){er(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ute(t,e,n){We=t,PU(t)}function PU(t,e,n){for(var r=(t.mode&1)!==0;We!==null;){var a=We,s=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||Hb;if(!o){var i=a.alternate,l=i!==null&&i.memoizedState!==null||ua;i=Hb;var u=ua;if(Hb=o,(ua=l)&&!u)for(We=a;We!==null;)o=We,l=o.child,o.tag===22&&o.memoizedState!==null?PD(a):l!==null?(l.return=o,We=l):PD(a);for(;s!==null;)We=s,PU(s),s=s.sibling;We=a,Hb=i,ua=u}ED(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,We=s):ED(t)}}function ED(t){for(;We!==null;){var e=We;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ua||uS(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ua)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:ho(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&pD(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}pD(e,o,n)}break;case 5:var i=e.stateNode;if(n===null&&e.flags&4){n=i;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Rg(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}ua||e.flags&512&&Ck(e)}catch(f){er(e,e.return,f)}}if(e===t){We=null;break}if(n=e.sibling,n!==null){n.return=e.return,We=n;break}We=e.return}}function AD(t){for(;We!==null;){var e=We;if(e===t){We=null;break}var n=e.sibling;if(n!==null){n.return=e.return,We=n;break}We=e.return}}function PD(t){for(;We!==null;){var e=We;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{uS(4,e)}catch(l){er(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(l){er(e,a,l)}}var s=e.return;try{Ck(e)}catch(l){er(e,s,l)}break;case 5:var o=e.return;try{Ck(e)}catch(l){er(e,o,l)}}}catch(l){er(e,e.return,l)}if(e===t){We=null;break}var i=e.sibling;if(i!==null){i.return=e.return,We=i;break}We=e.return}}var cte=Math.ceil,Cw=Qi.ReactCurrentDispatcher,oE=Qi.ReactCurrentOwner,Xs=Qi.ReactCurrentBatchConfig,Bt=0,Mr=null,cr=null,qr=0,us=0,uf=su(0),Sr=0,Gg=null,_c=0,cS=0,iE=0,fg=null,Wa=null,lE=0,Ff=1/0,Si=null,_w=!1,kk=null,Bl=null,qb=!1,Nl=null,$w=0,hg=0,Nk=null,F0=-1,L0=0;function ka(){return Bt&6?sr():F0!==-1?F0:F0=sr()}function zl(t){return t.mode&1?Bt&2&&qr!==0?qr&-qr:qee.transition!==null?(L0===0&&(L0=gz()),L0):(t=dn,t!==0||(t=window.event,t=t===void 0?16:Cz(t.type)),t):1}function $o(t,e,n,r){if(50<hg)throw hg=0,Nk=null,Error(ke(185));tv(t,n,r),(!(Bt&2)||t!==Mr)&&(t===Mr&&(!(Bt&2)&&(cS|=n),Sr===4&&Sl(t,qr)),Ja(t,r),n===1&&Bt===0&&!(e.mode&1)&&(Ff=sr()+500,oS&&ou()))}function Ja(t,e){var n=t.callbackNode;qZ(t,e);var r=lw(t,t===Mr?qr:0);if(r===0)n!==null&&zR(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zR(n),e===1)t.tag===0?Hee(OD.bind(null,t)):Uz(OD.bind(null,t)),Uee(function(){!(Bt&6)&&ou()}),n=null;else{switch(yz(r)){case 1:n=RT;break;case 4:n=pz;break;case 16:n=iw;break;case 536870912:n=mz;break;default:n=iw}n=BU(n,OU.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function OU(t,e){if(F0=-1,L0=0,Bt&6)throw Error(ke(327));var n=t.callbackNode;if(bf()&&t.callbackNode!==n)return null;var r=lw(t,t===Mr?qr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=kw(t,r);else{e=r;var a=Bt;Bt|=2;var s=DU();(Mr!==t||qr!==e)&&(Si=null,Ff=sr()+500,cc(t,e));do try{hte();break}catch(i){RU(t,i)}while(!0);qT(),Cw.current=s,Bt=a,cr!==null?e=0:(Mr=null,qr=0,e=Sr)}if(e!==0){if(e===2&&(a=ek(t),a!==0&&(r=a,e=Ik(t,a))),e===1)throw n=Gg,cc(t,0),Sl(t,r),Ja(t,sr()),n;if(e===6)Sl(t,r);else{if(a=t.current.alternate,!(r&30)&&!dte(a)&&(e=kw(t,r),e===2&&(s=ek(t),s!==0&&(r=s,e=Ik(t,s))),e===1))throw n=Gg,cc(t,0),Sl(t,r),Ja(t,sr()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(ke(345));case 2:Fu(t,Wa,Si);break;case 3:if(Sl(t,r),(r&130023424)===r&&(e=lE+500-sr(),10<e)){if(lw(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){ka(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=lk(Fu.bind(null,t,Wa,Si),e);break}Fu(t,Wa,Si);break;case 4:if(Sl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-_o(r);s=1<<o,o=e[o],o>a&&(a=o),r&=~s}if(r=a,r=sr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cte(r/1960))-r,10<r){t.timeoutHandle=lk(Fu.bind(null,t,Wa,Si),r);break}Fu(t,Wa,Si);break;case 5:Fu(t,Wa,Si);break;default:throw Error(ke(329))}}}return Ja(t,sr()),t.callbackNode===n?OU.bind(null,t):null}function Ik(t,e){var n=fg;return t.current.memoizedState.isDehydrated&&(cc(t,e).flags|=256),t=kw(t,e),t!==2&&(e=Wa,Wa=n,e!==null&&Tk(e)),t}function Tk(t){Wa===null?Wa=t:Wa.push.apply(Wa,t)}function dte(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!To(s(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sl(t,e){for(e&=~iE,e&=~cS,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_o(e),r=1<<n;t[n]=-1,e&=~r}}function OD(t){if(Bt&6)throw Error(ke(327));bf();var e=lw(t,0);if(!(e&1))return Ja(t,sr()),null;var n=kw(t,e);if(t.tag!==0&&n===2){var r=ek(t);r!==0&&(e=r,n=Ik(t,r))}if(n===1)throw n=Gg,cc(t,0),Sl(t,e),Ja(t,sr()),n;if(n===6)throw Error(ke(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fu(t,Wa,Si),Ja(t,sr()),null}function uE(t,e){var n=Bt;Bt|=1;try{return t(e)}finally{Bt=n,Bt===0&&(Ff=sr()+500,oS&&ou())}}function $c(t){Nl!==null&&Nl.tag===0&&!(Bt&6)&&bf();var e=Bt;Bt|=1;var n=Xs.transition,r=dn;try{if(Xs.transition=null,dn=1,t)return t()}finally{dn=r,Xs.transition=n,Bt=e,!(Bt&6)&&ou()}}function cE(){us=uf.current,Bn(uf)}function cc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,zee(n)),cr!==null)for(n=cr.return;n!==null;){var r=n;switch(WT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hw();break;case 3:jf(),Bn(Ya),Bn(ha),ZT();break;case 5:JT(r);break;case 4:jf();break;case 13:Bn(qn);break;case 19:Bn(qn);break;case 10:KT(r.type._context);break;case 22:case 23:cE()}n=n.return}if(Mr=t,cr=t=Ul(t.current,null),qr=us=e,Sr=0,Gg=null,iE=cS=_c=0,Wa=fg=null,Zu!==null){for(e=0;e<Zu.length;e++)if(n=Zu[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=a,r.next=o}n.pending=r}Zu=null}return t}function RU(t,e){do{var n=cr;try{if(qT(),D0.current=Sw,ww){for(var r=Kn.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}ww=!1}if(Cc=0,Pr=vr=Kn=null,cg=!1,Ug=0,oE.current=null,n===null||n.return===null){Sr=1,Gg=e,cr=null;break}e:{var s=t,o=n.return,i=n,l=e;if(e=qr,i.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=i,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=bD(o);if(h!==null){h.flags&=-257,wD(h,o,i,s,e),h.mode&1&&xD(s,u,e),e=h,l=u;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){xD(s,u,e),dE();break e}l=Error(ke(426))}}else if(Wn&&i.mode&1){var y=bD(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),wD(y,o,i,s,e),GT(Mf(l,i));break e}}s=l=Mf(l,i),Sr!==4&&(Sr=2),fg===null?fg=[s]:fg.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=yU(s,l,e);hD(s,v);break e;case 1:i=l;var x=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Bl===null||!Bl.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=vU(s,i,e);hD(s,w);break e}}s=s.return}while(s!==null)}MU(n)}catch(C){e=C,cr===n&&n!==null&&(cr=n=n.return);continue}break}while(!0)}function DU(){var t=Cw.current;return Cw.current=Sw,t===null?Sw:t}function dE(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Mr===null||!(_c&268435455)&&!(cS&268435455)||Sl(Mr,qr)}function kw(t,e){var n=Bt;Bt|=2;var r=DU();(Mr!==t||qr!==e)&&(Si=null,cc(t,e));do try{fte();break}catch(a){RU(t,a)}while(!0);if(qT(),Bt=n,Cw.current=r,cr!==null)throw Error(ke(261));return Mr=null,qr=0,Sr}function fte(){for(;cr!==null;)jU(cr)}function hte(){for(;cr!==null&&!FZ();)jU(cr)}function jU(t){var e=LU(t.alternate,t,us);t.memoizedProps=t.pendingProps,e===null?MU(t):cr=e,oE.current=null}function MU(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ote(n,e),n!==null){n.flags&=32767,cr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Sr=6,cr=null;return}}else if(n=ste(n,e,us),n!==null){cr=n;return}if(e=e.sibling,e!==null){cr=e;return}cr=e=t}while(e!==null);Sr===0&&(Sr=5)}function Fu(t,e,n){var r=dn,a=Xs.transition;try{Xs.transition=null,dn=1,pte(t,e,n,r)}finally{Xs.transition=a,dn=r}return null}function pte(t,e,n,r){do bf();while(Nl!==null);if(Bt&6)throw Error(ke(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ke(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(KZ(t,s),t===Mr&&(cr=Mr=null,qr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qb||(qb=!0,BU(iw,function(){return bf(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Xs.transition,Xs.transition=null;var o=dn;dn=1;var i=Bt;Bt|=4,oE.current=null,lte(t,n),AU(n,t),Ree(ok),uw=!!sk,ok=sk=null,t.current=n,ute(n),LZ(),Bt=i,dn=o,Xs.transition=s}else t.current=n;if(qb&&(qb=!1,Nl=t,$w=a),s=t.pendingLanes,s===0&&(Bl=null),UZ(n.stateNode),Ja(t,sr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(_w)throw _w=!1,t=kk,kk=null,t;return $w&1&&t.tag!==0&&bf(),s=t.pendingLanes,s&1?t===Nk?hg++:(hg=0,Nk=t):hg=0,ou(),null}function bf(){if(Nl!==null){var t=yz($w),e=Xs.transition,n=dn;try{if(Xs.transition=null,dn=16>t?16:t,Nl===null)var r=!1;else{if(t=Nl,Nl=null,$w=0,Bt&6)throw Error(ke(331));var a=Bt;for(Bt|=4,We=t.current;We!==null;){var s=We,o=s.child;if(We.flags&16){var i=s.deletions;if(i!==null){for(var l=0;l<i.length;l++){var u=i[l];for(We=u;We!==null;){var c=We;switch(c.tag){case 0:case 11:case 15:dg(8,c,s)}var d=c.child;if(d!==null)d.return=c,We=d;else for(;We!==null;){c=We;var f=c.sibling,h=c.return;if(IU(c),c===u){We=null;break}if(f!==null){f.return=h,We=f;break}We=h}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}We=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,We=o;else e:for(;We!==null;){if(s=We,s.flags&2048)switch(s.tag){case 0:case 11:case 15:dg(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,We=v;break e}We=s.return}}var x=t.current;for(We=x;We!==null;){o=We;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,We=b;else e:for(o=x;We!==null;){if(i=We,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:uS(9,i)}}catch(C){er(i,i.return,C)}if(i===o){We=null;break e}var w=i.sibling;if(w!==null){w.return=i.return,We=w;break e}We=i.return}}if(Bt=a,ou(),Qo&&typeof Qo.onPostCommitFiberRoot=="function")try{Qo.onPostCommitFiberRoot(tS,t)}catch{}r=!0}return r}finally{dn=n,Xs.transition=e}}return!1}function RD(t,e,n){e=Mf(n,e),e=yU(t,e,1),t=Ll(t,e,1),e=ka(),t!==null&&(tv(t,1,e),Ja(t,e))}function er(t,e,n){if(t.tag===3)RD(t,t,n);else for(;e!==null;){if(e.tag===3){RD(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Bl===null||!Bl.has(r))){t=Mf(n,t),t=vU(e,t,1),e=Ll(e,t,1),t=ka(),e!==null&&(tv(e,1,t),Ja(e,t));break}}e=e.return}}function mte(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ka(),t.pingedLanes|=t.suspendedLanes&n,Mr===t&&(qr&n)===n&&(Sr===4||Sr===3&&(qr&130023424)===qr&&500>sr()-lE?cc(t,0):iE|=n),Ja(t,e)}function FU(t,e){e===0&&(t.mode&1?(e=Mb,Mb<<=1,!(Mb&130023424)&&(Mb=4194304)):e=1);var n=ka();t=Wi(t,e),t!==null&&(tv(t,e,n),Ja(t,n))}function gte(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),FU(t,n)}function yte(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ke(314))}r!==null&&r.delete(e),FU(t,n)}var LU;LU=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ya.current)qa=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return qa=!1,ate(t,e,n);qa=!!(t.flags&131072)}else qa=!1,Wn&&e.flags&1048576&&Vz(e,gw,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;M0(t,e),t=e.pendingProps;var a=Of(e,ha.current);xf(e,n),a=tE(null,e,r,t,a,n);var s=nE();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qa(r)?(s=!0,pw(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,YT(e),a.updater=lS,e.stateNode=a,a._reactInternals=e,mk(e,r,t,n),e=vk(null,e,r,!0,s,n)):(e.tag=0,Wn&&s&&VT(e),Sa(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(M0(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=xte(r),t=ho(r,t),a){case 0:e=yk(null,e,r,t,n);break e;case 1:e=_D(null,e,r,t,n);break e;case 11:e=SD(null,e,r,t,n);break e;case 14:e=CD(null,e,r,ho(r.type,t),n);break e}throw Error(ke(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ho(r,a),yk(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ho(r,a),_D(t,e,r,a,n);case 3:e:{if(SU(e),t===null)throw Error(ke(387));r=e.pendingProps,s=e.memoizedState,a=s.element,Xz(t,e),xw(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Mf(Error(ke(423)),e),e=$D(t,e,r,n,a);break e}else if(r!==a){a=Mf(Error(ke(424)),e),e=$D(t,e,r,n,a);break e}else for(hs=Fl(e.stateNode.containerInfo.firstChild),gs=e,Wn=!0,vo=null,n=qz(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rf(),r===a){e=Gi(t,e,n);break e}Sa(t,e,r,n)}e=e.child}return e;case 5:return Yz(e),t===null&&fk(e),r=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,o=a.children,ik(r,a)?o=null:s!==null&&ik(r,s)&&(e.flags|=32),wU(t,e),Sa(t,e,o,n),e.child;case 6:return t===null&&fk(e),null;case 13:return CU(t,e,n);case 4:return QT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Df(e,null,r,n):Sa(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ho(r,a),SD(t,e,r,a,n);case 7:return Sa(t,e,e.pendingProps,n),e.child;case 8:return Sa(t,e,e.pendingProps.children,n),e.child;case 12:return Sa(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,s=e.memoizedProps,o=a.value,En(yw,r._currentValue),r._currentValue=o,s!==null)if(To(s.value,o)){if(s.children===a.children&&!Ya.current){e=Gi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var i=s.dependencies;if(i!==null){o=s.child;for(var l=i.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ri(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),hk(s.return,n,e),i.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ke(341));o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),hk(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Sa(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,xf(e,n),a=Js(a),r=r(a),e.flags|=1,Sa(t,e,r,n),e.child;case 14:return r=e.type,a=ho(r,e.pendingProps),a=ho(r.type,a),CD(t,e,r,a,n);case 15:return xU(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ho(r,a),M0(t,e),e.tag=1,Qa(r)?(t=!0,pw(e)):t=!1,xf(e,n),gU(e,r,a),mk(e,r,a,n),vk(null,e,r,!0,t,n);case 19:return _U(t,e,n);case 22:return bU(t,e,n)}throw Error(ke(156,e.tag))};function BU(t,e){return hz(t,e)}function vte(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ws(t,e,n,r){return new vte(t,e,n,r)}function fE(t){return t=t.prototype,!(!t||!t.isReactComponent)}function xte(t){if(typeof t=="function")return fE(t)?1:0;if(t!=null){if(t=t.$$typeof,t===AT)return 11;if(t===PT)return 14}return 2}function Ul(t,e){var n=t.alternate;return n===null?(n=Ws(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function B0(t,e,n,r,a,s){var o=2;if(r=t,typeof t=="function")fE(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Jd:return dc(n.children,a,s,e);case ET:o=8,a|=8;break;case L$:return t=Ws(12,n,e,a|2),t.elementType=L$,t.lanes=s,t;case B$:return t=Ws(13,n,e,a),t.elementType=B$,t.lanes=s,t;case z$:return t=Ws(19,n,e,a),t.elementType=z$,t.lanes=s,t;case Y4:return dS(n,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case K4:o=10;break e;case X4:o=9;break e;case AT:o=11;break e;case PT:o=14;break e;case gl:o=16,r=null;break e}throw Error(ke(130,t==null?t:typeof t,""))}return e=Ws(o,n,e,a),e.elementType=t,e.type=r,e.lanes=s,e}function dc(t,e,n,r){return t=Ws(7,t,r,e),t.lanes=n,t}function dS(t,e,n,r){return t=Ws(22,t,r,e),t.elementType=Y4,t.lanes=n,t.stateNode={isHidden:!1},t}function g_(t,e,n){return t=Ws(6,t,null,e),t.lanes=n,t}function y_(t,e,n){return e=Ws(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bte(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=QC(0),this.expirationTimes=QC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=QC(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function hE(t,e,n,r,a,s,o,i,l){return t=new bte(t,e,n,i,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ws(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},YT(s),t}function wte(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function zU(t){if(!t)return Yl;t=t._reactInternals;e:{if(Yc(t)!==t||t.tag!==1)throw Error(ke(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ke(171))}if(t.tag===1){var n=t.type;if(Qa(n))return zz(t,n,e)}return e}function UU(t,e,n,r,a,s,o,i,l){return t=hE(n,r,!0,t,a,s,o,i,l),t.context=zU(null),n=t.current,r=ka(),a=zl(n),s=Ri(r,a),s.callback=e??null,Ll(n,s,a),t.current.lanes=a,tv(t,a,r),Ja(t,r),t}function fS(t,e,n,r){var a=e.current,s=ka(),o=zl(a);return n=zU(n),e.context===null?e.context=n:e.pendingContext=n,e=Ri(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ll(a,e,o),t!==null&&($o(t,a,o,s),R0(t,a,o)),o}function Nw(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function DD(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pE(t,e){DD(t,e),(t=t.alternate)&&DD(t,e)}function Ste(){return null}var VU=typeof reportError=="function"?reportError:function(t){console.error(t)};function mE(t){this._internalRoot=t}hS.prototype.render=mE.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ke(409));fS(t,e,null,null)};hS.prototype.unmount=mE.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;$c(function(){fS(null,t,null,null)}),e[Vi]=null}};function hS(t){this._internalRoot=t}hS.prototype.unstable_scheduleHydration=function(t){if(t){var e=bz();t={blockedOn:null,target:t,priority:e};for(var n=0;n<wl.length&&e!==0&&e<wl[n].priority;n++);wl.splice(n,0,t),n===0&&Sz(t)}};function gE(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pS(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jD(){}function Cte(t,e,n,r,a){if(a){if(typeof r=="function"){var s=r;r=function(){var u=Nw(o);s.call(u)}}var o=UU(e,r,t,0,null,!1,!1,"",jD);return t._reactRootContainer=o,t[Vi]=o.current,Mg(t.nodeType===8?t.parentNode:t),$c(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var u=Nw(l);i.call(u)}}var l=hE(t,0,!1,null,null,!1,!1,"",jD);return t._reactRootContainer=l,t[Vi]=l.current,Mg(t.nodeType===8?t.parentNode:t),$c(function(){fS(e,l,n,r)}),l}function mS(t,e,n,r,a){var s=n._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var i=a;a=function(){var l=Nw(o);i.call(l)}}fS(e,o,t,a)}else o=Cte(n,e,t,a,r);return Nw(o)}vz=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qm(e.pendingLanes);n!==0&&(DT(e,n|1),Ja(e,sr()),!(Bt&6)&&(Ff=sr()+500,ou()))}break;case 13:$c(function(){var r=Wi(t,1);if(r!==null){var a=ka();$o(r,t,1,a)}}),pE(t,1)}};jT=function(t){if(t.tag===13){var e=Wi(t,134217728);if(e!==null){var n=ka();$o(e,t,134217728,n)}pE(t,134217728)}};xz=function(t){if(t.tag===13){var e=zl(t),n=Wi(t,e);if(n!==null){var r=ka();$o(n,t,e,r)}pE(t,e)}};bz=function(){return dn};wz=function(t,e){var n=dn;try{return dn=t,e()}finally{dn=n}};Q$=function(t,e,n){switch(e){case"input":if(W$(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=sS(r);if(!a)throw Error(ke(90));J4(r),W$(r,a)}}}break;case"textarea":ez(t,n);break;case"select":e=n.value,e!=null&&mf(t,!!n.multiple,e,!1)}};iz=uE;lz=$c;var _te={usingClientEntryPoint:!1,Events:[rv,nf,sS,sz,oz,uE]},Nm={findFiberByHostInstance:Ju,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$te={bundleType:Nm.bundleType,version:Nm.version,rendererPackageName:Nm.rendererPackageName,rendererConfig:Nm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=dz(t),t===null?null:t.stateNode},findFiberByHostInstance:Nm.findFiberByHostInstance||Ste,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kb.isDisabled&&Kb.supportsFiber)try{tS=Kb.inject($te),Qo=Kb}catch{}}Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_te;Cs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gE(e))throw Error(ke(200));return wte(t,e,null,n)};Cs.createRoot=function(t,e){if(!gE(t))throw Error(ke(299));var n=!1,r="",a=VU;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=hE(t,1,!1,null,null,n,!1,r,a),t[Vi]=e.current,Mg(t.nodeType===8?t.parentNode:t),new mE(e)};Cs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ke(188)):(t=Object.keys(t).join(","),Error(ke(268,t)));return t=dz(e),t=t===null?null:t.stateNode,t};Cs.flushSync=function(t){return $c(t)};Cs.hydrate=function(t,e,n){if(!pS(e))throw Error(ke(200));return mS(null,t,e,!0,n)};Cs.hydrateRoot=function(t,e,n){if(!gE(t))throw Error(ke(405));var r=n!=null&&n.hydratedSources||null,a=!1,s="",o=VU;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=UU(e,null,t,1,n??null,a,!1,s,o),t[Vi]=e.current,Mg(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new hS(e)};Cs.render=function(t,e,n){if(!pS(e))throw Error(ke(200));return mS(null,t,e,!1,n)};Cs.unmountComponentAtNode=function(t){if(!pS(t))throw Error(ke(40));return t._reactRootContainer?($c(function(){mS(null,null,t,!1,function(){t._reactRootContainer=null,t[Vi]=null})}),!0):!1};Cs.unstable_batchedUpdates=uE;Cs.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!pS(n))throw Error(ke(200));if(t==null||t._reactInternals===void 0)throw Error(ke(38));return mS(t,e,n,!1,r)};Cs.version="18.3.1-next-f1338f8080-20240426";function WU(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WU)}catch(t){console.error(t)}}WU(),W4.exports=Cs;var gS=W4.exports;const kte=Ut(gS);var GU,MD=gS;GU=MD.createRoot,MD.hydrateRoot;/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hg(){return Hg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hg.apply(this,arguments)}var Il;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Il||(Il={}));const FD="popstate";function Nte(t){t===void 0&&(t={});function e(r,a){let{pathname:s,search:o,hash:i}=r.location;return Ek("",{pathname:s,search:o,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Iw(a)}return Tte(e,n,null,t)}function dr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function HU(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ite(){return Math.random().toString(36).substr(2,8)}function LD(t,e){return{usr:t.state,key:t.key,idx:e}}function Ek(t,e,n,r){return n===void 0&&(n=null),Hg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Th(e):e,{state:n,key:e&&e.key||r||Ite()})}function Iw(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Th(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function Tte(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:s=!1}=r,o=a.history,i=Il.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Hg({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function d(){i=Il.Pop;let y=c(),v=y==null?null:y-u;u=y,l&&l({action:i,location:g.location,delta:v})}function f(y,v){i=Il.Push;let x=Ek(g.location,y,v);u=c()+1;let b=LD(x,u),w=g.createHref(x);try{o.pushState(b,"",w)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(w)}s&&l&&l({action:i,location:g.location,delta:1})}function h(y,v){i=Il.Replace;let x=Ek(g.location,y,v);u=c();let b=LD(x,u),w=g.createHref(x);o.replaceState(b,"",w),s&&l&&l({action:i,location:g.location,delta:0})}function p(y){let v=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof y=="string"?y:Iw(y);return x=x.replace(/ $/,"%20"),dr(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let g={get action(){return i},get location(){return t(a,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(FD,d),l=y,()=>{a.removeEventListener(FD,d),l=null}},createHref(y){return e(a,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:h,go(y){return o.go(y)}};return g}var BD;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(BD||(BD={}));function Ete(t,e,n){return n===void 0&&(n="/"),Ate(t,e,n,!1)}function Ate(t,e,n,r){let a=typeof e=="string"?Th(e):e,s=yE(a.pathname||"/",n);if(s==null)return null;let o=qU(t);Pte(o);let i=null;for(let l=0;i==null&&l<o.length;++l){let u=Vte(s);i=zte(o[l],u,r)}return i}function qU(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(s,o,i)=>{let l={relativePath:i===void 0?s.path||"":i,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(dr(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Vl([r,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(dr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),qU(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:Lte(u,s.index),routesMeta:c})};return t.forEach((s,o)=>{var i;if(s.path===""||!((i=s.path)!=null&&i.includes("?")))a(s,o);else for(let l of KU(s.path))a(s,o,l)}),e}function KU(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let o=KU(r.join("/")),i=[];return i.push(...o.map(l=>l===""?s:[s,l].join("/"))),a&&i.push(...o),i.map(l=>t.startsWith("/")&&l===""?"/":l)}function Pte(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Bte(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Ote=/^:[\w-]+$/,Rte=3,Dte=2,jte=1,Mte=10,Fte=-2,zD=t=>t==="*";function Lte(t,e){let n=t.split("/"),r=n.length;return n.some(zD)&&(r+=Fte),e&&(r+=Dte),n.filter(a=>!zD(a)).reduce((a,s)=>a+(Ote.test(s)?Rte:s===""?jte:Mte),r)}function Bte(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function zte(t,e,n){let{routesMeta:r}=t,a={},s="/",o=[];for(let i=0;i<r.length;++i){let l=r[i],u=i===r.length-1,c=s==="/"?e:e.slice(s.length)||"/",d=UD({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),f=l.route;if(!d&&u&&n&&!r[r.length-1].route.index&&(d=UD({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),o.push({params:a,pathname:Vl([s,d.pathname]),pathnameBase:qte(Vl([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Vl([s,d.pathnameBase]))}return o}function UD(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Ute(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let g=i[d]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const p=i[d];return h&&!p?u[f]=void 0:u[f]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function Ute(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),HU(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,l)=>(r.push({paramName:i,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function Vte(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return HU(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yE(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Wte(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?Th(t):t;return{pathname:n?n.startsWith("/")?n:Gte(n,e):e,search:Kte(r),hash:Xte(a)}}function Gte(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function v_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Hte(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function XU(t,e){let n=Hte(t);return e?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function YU(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=Th(t):(a=Hg({},t),dr(!a.pathname||!a.pathname.includes("?"),v_("?","pathname","search",a)),dr(!a.pathname||!a.pathname.includes("#"),v_("#","pathname","hash",a)),dr(!a.search||!a.search.includes("#"),v_("#","search","hash",a)));let s=t===""||a.pathname==="",o=s?"/":a.pathname,i;if(o==null)i=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}i=d>=0?e[d]:"/"}let l=Wte(a,i),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Vl=t=>t.join("/").replace(/\/\/+/g,"/"),qte=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Kte=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Xte=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Yte(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QU=["post","put","patch","delete"];new Set(QU);const Qte=["get",...QU];new Set(Qte);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qg(){return qg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qg.apply(this,arguments)}const vE=N.createContext(null),Jte=N.createContext(null),Qc=N.createContext(null),yS=N.createContext(null),iu=N.createContext({outlet:null,matches:[],isDataRoute:!1}),JU=N.createContext(null);function Zte(t,e){let{relative:n}=e===void 0?{}:e;sv()||dr(!1);let{basename:r,navigator:a}=N.useContext(Qc),{hash:s,pathname:o,search:i}=eV(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Vl([r,o])),a.createHref({pathname:l,search:i,hash:s})}function sv(){return N.useContext(yS)!=null}function Po(){return sv()||dr(!1),N.useContext(yS).location}function ZU(t){N.useContext(Qc).static||N.useLayoutEffect(t)}function zn(){let{isDataRoute:t}=N.useContext(iu);return t?fne():ene()}function ene(){sv()||dr(!1);let t=N.useContext(vE),{basename:e,future:n,navigator:r}=N.useContext(Qc),{matches:a}=N.useContext(iu),{pathname:s}=Po(),o=JSON.stringify(XU(a,n.v7_relativeSplatPath)),i=N.useRef(!1);return ZU(()=>{i.current=!0}),N.useCallback(function(u,c){if(c===void 0&&(c={}),!i.current)return;if(typeof u=="number"){r.go(u);return}let d=YU(u,JSON.parse(o),s,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Vl([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,o,s,t])}function xE(){let{matches:t}=N.useContext(iu),e=t[t.length-1];return e?e.params:{}}function eV(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(Qc),{matches:a}=N.useContext(iu),{pathname:s}=Po(),o=JSON.stringify(XU(a,r.v7_relativeSplatPath));return N.useMemo(()=>YU(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function tne(t,e){return nne(t,e)}function nne(t,e,n,r){sv()||dr(!1);let{navigator:a}=N.useContext(Qc),{matches:s}=N.useContext(iu),o=s[s.length-1],i=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Po(),c;if(e){var d;let y=typeof e=="string"?Th(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||dr(!1),c=y}else c=u;let f=c.pathname||"/",h=f;if(l!=="/"){let y=l.replace(/^\//,"").split("/");h="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=Ete(t,{pathname:h}),g=ine(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},i,y.params),pathname:Vl([l,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Vl([l,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,n,r);return e&&g?N.createElement(yS.Provider,{value:{location:qg({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Il.Pop}},g):g}function rne(){let t=dne(),e=Yte(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:a},n):null,null)}const ane=N.createElement(rne,null);class sne extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(iu.Provider,{value:this.props.routeContext},N.createElement(JU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function one(t){let{routeContext:e,match:n,children:r}=t,a=N.useContext(vE);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(iu.Provider,{value:e},r)}function ine(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,i=(a=n)==null?void 0:a.errors;if(i!=null){let c=o.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);c>=0||dr(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:f,errors:h}=n,p=d.route.loader&&f[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||p){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,d,f)=>{let h,p=!1,g=null,y=null;n&&(h=i&&d.route.id?i[d.route.id]:void 0,g=d.route.errorElement||ane,l&&(u<0&&f===0?(p=!0,y=null):u===f&&(p=!0,y=d.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),x=()=>{let b;return h?b=g:p?b=y:d.route.Component?b=N.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,N.createElement(one,{match:d,routeContext:{outlet:c,matches:v,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?N.createElement(sne,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var tV=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(tV||{}),Tw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Tw||{});function lne(t){let e=N.useContext(vE);return e||dr(!1),e}function une(t){let e=N.useContext(Jte);return e||dr(!1),e}function cne(t){let e=N.useContext(iu);return e||dr(!1),e}function nV(t){let e=cne(),n=e.matches[e.matches.length-1];return n.route.id||dr(!1),n.route.id}function dne(){var t;let e=N.useContext(JU),n=une(Tw.UseRouteError),r=nV(Tw.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function fne(){let{router:t}=lne(tV.UseNavigateStable),e=nV(Tw.UseNavigateStable),n=N.useRef(!1);return ZU(()=>{n.current=!0}),N.useCallback(function(a,s){s===void 0&&(s={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,qg({fromRouteId:e},s)))},[t,e])}function un(t){dr(!1)}function hne(t){let{basename:e="/",children:n=null,location:r,navigationType:a=Il.Pop,navigator:s,static:o=!1,future:i}=t;sv()&&dr(!1);let l=e.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:l,navigator:s,static:o,future:qg({v7_relativeSplatPath:!1},i)}),[l,i,s,o]);typeof r=="string"&&(r=Th(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,g=N.useMemo(()=>{let y=yE(c,l);return y==null?null:{location:{pathname:y,search:d,hash:f,state:h,key:p},navigationType:a}},[l,c,d,f,h,p,a]);return g==null?null:N.createElement(Qc.Provider,{value:u},N.createElement(yS.Provider,{children:n,value:g}))}function pne(t){let{children:e,location:n}=t;return tne(Ak(e),n)}new Promise(()=>{});function Ak(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,a)=>{if(!N.isValidElement(r))return;let s=[...e,a];if(r.type===N.Fragment){n.push.apply(n,Ak(r.props.children,s));return}r.type!==un&&dr(!1),!r.props.index||!r.props.children||dr(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Ak(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pk(){return Pk=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pk.apply(this,arguments)}function mne(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,s;for(s=0;s<r.length;s++)a=r[s],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function gne(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yne(t,e){return t.button===0&&(!e||e==="_self")&&!gne(t)}const vne=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xne="6";try{window.__reactRouterVersion=xne}catch{}const bne="startTransition",VD=U4[bne];function wne(t){let{basename:e,children:n,future:r,window:a}=t,s=N.useRef();s.current==null&&(s.current=Nte({window:a,v5Compat:!0}));let o=s.current,[i,l]=N.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=N.useCallback(d=>{u&&VD?VD(()=>l(d)):l(d)},[l,u]);return N.useLayoutEffect(()=>o.listen(c),[o,c]),N.createElement(hne,{basename:e,children:n,location:i.location,navigationType:i.action,navigator:o,future:r})}const Sne=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Cne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ys=N.forwardRef(function(e,n){let{onClick:r,relative:a,reloadDocument:s,replace:o,state:i,target:l,to:u,preventScrollReset:c,viewTransition:d}=e,f=mne(e,vne),{basename:h}=N.useContext(Qc),p,g=!1;if(typeof u=="string"&&Cne.test(u)&&(p=u,Sne))try{let b=new URL(window.location.href),w=u.startsWith("//")?new URL(b.protocol+u):new URL(u),C=yE(w.pathname,h);w.origin===b.origin&&C!=null?u=C+w.search+w.hash:g=!0}catch{}let y=Zte(u,{relative:a}),v=_ne(u,{replace:o,state:i,target:l,preventScrollReset:c,relative:a,viewTransition:d});function x(b){r&&r(b),b.defaultPrevented||v(b)}return N.createElement("a",Pk({},f,{href:p||y,onClick:g||s?r:x,ref:n,target:l}))});var WD;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(WD||(WD={}));var GD;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(GD||(GD={}));function _ne(t,e){let{target:n,replace:r,state:a,preventScrollReset:s,relative:o,viewTransition:i}=e===void 0?{}:e,l=zn(),u=Po(),c=eV(t,{relative:o});return N.useCallback(d=>{if(yne(d,n)){d.preventDefault();let f=r!==void 0?r:Iw(u)===Iw(c);l(t,{replace:f,state:a,preventScrollReset:s,relative:o,viewTransition:i})}},[u,l,c,r,a,n,t,s,o,i])}function $ne(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function rV(...t){return e=>t.forEach(n=>$ne(n,e))}function Aa(...t){return N.useCallback(rV(...t),t)}var Lf=N.forwardRef((t,e)=>{const{children:n,...r}=t,a=N.Children.toArray(n),s=a.find(Nne);if(s){const o=s.props.children,i=a.map(l=>l===s?N.Children.count(o)>1?N.Children.only(null):N.isValidElement(o)?o.props.children:null:l);return m.jsx(Ok,{...r,ref:e,children:N.isValidElement(o)?N.cloneElement(o,void 0,i):null})}return m.jsx(Ok,{...r,ref:e,children:n})});Lf.displayName="Slot";var Ok=N.forwardRef((t,e)=>{const{children:n,...r}=t;if(N.isValidElement(n)){const a=Tne(n);return N.cloneElement(n,{...Ine(r,n.props),ref:e?rV(e,a):a})}return N.Children.count(n)>1?N.Children.only(null):null});Ok.displayName="SlotClone";var kne=({children:t})=>m.jsx(m.Fragment,{children:t});function Nne(t){return N.isValidElement(t)&&t.type===kne}function Ine(t,e){const n={...e};for(const r in e){const a=t[r],s=e[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...i)=>{s(...i),a(...i)}:a&&(n[r]=a):r==="style"?n[r]={...a,...s}:r==="className"&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...t,...n}}function Tne(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function aV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=aV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function xt(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=aV(t))&&(r&&(r+=" "),r+=e);return r}const HD=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,qD=xt,bE=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return qD(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:s}=e,o=Object.keys(a).map(u=>{const c=n==null?void 0:n[u],d=s==null?void 0:s[u];if(c===null)return null;const f=HD(c)||HD(d);return a[u][f]}),i=n&&Object.entries(n).reduce((u,c)=>{let[d,f]=c;return f===void 0||(u[d]=f),u},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(p=>{let[g,y]=p;return Array.isArray(y)?y.includes({...s,...i}[g]):{...s,...i}[g]===y})?[...u,d,f]:u},[]);return qD(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},wE="-",Ene=t=>{const e=Pne(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const i=o.split(wE);return i[0]===""&&i.length!==1&&i.shift(),sV(i,e)||Ane(o)},getConflictingClassGroupIds:(o,i)=>{const l=n[o]||[];return i&&r[o]?[...l,...r[o]]:l}}},sV=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),a=r?sV(t.slice(1),r):void 0;if(a)return a;if(e.validators.length===0)return;const s=t.join(wE);return(o=e.validators.find(({validator:i})=>i(s)))==null?void 0:o.classGroupId},KD=/^\[(.+)\]$/,Ane=t=>{if(KD.test(t)){const e=KD.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},Pne=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return Rne(Object.entries(t.classGroups),n).forEach(([s,o])=>{Rk(o,r,s,e)}),r},Rk=(t,e,n,r)=>{t.forEach(a=>{if(typeof a=="string"){const s=a===""?e:XD(e,a);s.classGroupId=n;return}if(typeof a=="function"){if(One(a)){Rk(a(r),e,n,r);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([s,o])=>{Rk(o,XD(e,s),n,r)})})},XD=(t,e)=>{let n=t;return e.split(wE).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},One=t=>t.isThemeGetter,Rne=(t,e)=>e?t.map(([n,r])=>{const a=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,i])=>[e+o,i])):s);return[n,a]}):t,Dne=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const a=(s,o)=>{n.set(s,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(s){let o=n.get(s);if(o!==void 0)return o;if((o=r.get(s))!==void 0)return a(s,o),o},set(s,o){n.has(s)?n.set(s,o):a(s,o)}}},oV="!",jne=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,a=e[0],s=e.length,o=i=>{const l=[];let u=0,c=0,d;for(let y=0;y<i.length;y++){let v=i[y];if(u===0){if(v===a&&(r||i.slice(y,y+s)===e)){l.push(i.slice(c,y)),c=y+s;continue}if(v==="/"){d=y;continue}}v==="["?u++:v==="]"&&u--}const f=l.length===0?i:i.substring(c),h=f.startsWith(oV),p=h?f.substring(1):f,g=d&&d>c?d-c:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:g}};return n?i=>n({className:i,parseClassName:o}):o},Mne=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},Fne=t=>({cache:Dne(t.cacheSize),parseClassName:jne(t),...Ene(t)}),Lne=/\s+/,Bne=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=e,s=[],o=t.trim().split(Lne);let i="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(u);let p=!!h,g=r(p?f.substring(0,h):f);if(!g){if(!p){i=u+(i.length>0?" "+i:i);continue}if(g=r(f),!g){i=u+(i.length>0?" "+i:i);continue}p=!1}const y=Mne(c).join(":"),v=d?y+oV:y,x=v+g;if(s.includes(x))continue;s.push(x);const b=a(g,p);for(let w=0;w<b.length;++w){const C=b[w];s.push(v+C)}i=u+(i.length>0?" "+i:i)}return i};function zne(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=iV(e))&&(r&&(r+=" "),r+=n);return r}const iV=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=iV(t[r]))&&(n&&(n+=" "),n+=e);return n};function Une(t,...e){let n,r,a,s=o;function o(l){const u=e.reduce((c,d)=>d(c),t());return n=Fne(u),r=n.cache.get,a=n.cache.set,s=i,i(l)}function i(l){const u=r(l);if(u)return u;const c=Bne(l,n);return a(l,c),c}return function(){return s(zne.apply(null,arguments))}}const jn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},lV=/^\[(?:([a-z-]+):)?(.+)\]$/i,Vne=/^\d+\/\d+$/,Wne=new Set(["px","full","screen"]),Gne=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Hne=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qne=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Kne=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Xne=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,bi=t=>wf(t)||Wne.has(t)||Vne.test(t),dl=t=>Eh(t,"length",rre),wf=t=>!!t&&!Number.isNaN(Number(t)),x_=t=>Eh(t,"number",wf),Im=t=>!!t&&Number.isInteger(Number(t)),Yne=t=>t.endsWith("%")&&wf(t.slice(0,-1)),St=t=>lV.test(t),fl=t=>Gne.test(t),Qne=new Set(["length","size","percentage"]),Jne=t=>Eh(t,Qne,uV),Zne=t=>Eh(t,"position",uV),ere=new Set(["image","url"]),tre=t=>Eh(t,ere,sre),nre=t=>Eh(t,"",are),Tm=()=>!0,Eh=(t,e,n)=>{const r=lV.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},rre=t=>Hne.test(t)&&!qne.test(t),uV=()=>!1,are=t=>Kne.test(t),sre=t=>Xne.test(t),ore=()=>{const t=jn("colors"),e=jn("spacing"),n=jn("blur"),r=jn("brightness"),a=jn("borderColor"),s=jn("borderRadius"),o=jn("borderSpacing"),i=jn("borderWidth"),l=jn("contrast"),u=jn("grayscale"),c=jn("hueRotate"),d=jn("invert"),f=jn("gap"),h=jn("gradientColorStops"),p=jn("gradientColorStopPositions"),g=jn("inset"),y=jn("margin"),v=jn("opacity"),x=jn("padding"),b=jn("saturate"),w=jn("scale"),C=jn("sepia"),_=jn("skew"),$=jn("space"),k=jn("translate"),A=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",St,e],R=()=>[St,e],B=()=>["",bi,dl],F=()=>["auto",wf,St],L=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",St],se=()=>["auto","avoid","all","avoid-page","page","left","right","column"],le=()=>[wf,St];return{cacheSize:500,separator:":",theme:{colors:[Tm],spacing:[bi,dl],blur:["none","",fl,St],brightness:le(),borderColor:[t],borderRadius:["none","","full",fl,St],borderSpacing:R(),borderWidth:B(),contrast:le(),grayscale:Q(),hueRotate:le(),invert:Q(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[Yne,dl],inset:O(),margin:O(),opacity:le(),padding:R(),saturate:le(),scale:le(),sepia:Q(),skew:le(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",St]}],container:["container"],columns:[{columns:[fl]}],"break-after":[{"break-after":se()}],"break-before":[{"break-before":se()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...L(),St]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Im,St]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",St]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Im,St]}],"grid-cols":[{"grid-cols":[Tm]}],"col-start-end":[{col:["auto",{span:["full",Im,St]},St]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[Tm]}],"row-start-end":[{row:["auto",{span:[Im,St]},St]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",St]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",St]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[$]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[$]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",St,e]}],"min-w":[{"min-w":[St,e,"min","max","fit"]}],"max-w":[{"max-w":[St,e,"none","full","min","max","fit","prose",{screen:[fl]},fl]}],h:[{h:[St,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[St,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[St,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[St,e,"auto","min","max","fit"]}],"font-size":[{text:["base",fl,dl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",x_]}],"font-family":[{font:[Tm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",St]}],"line-clamp":[{"line-clamp":["none",wf,x_]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",bi,St]}],"list-image":[{"list-image":["none",St]}],"list-style-type":[{list:["none","disc","decimal",St]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",bi,dl]}],"underline-offset":[{"underline-offset":["auto",bi,St]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",St]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",St]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...L(),Zne]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Jne]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tre]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:H()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[bi,St]}],"outline-w":[{outline:[bi,dl]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[bi,dl]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",fl,nre]}],"shadow-color":[{shadow:[Tm]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",fl,St]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",St]}],duration:[{duration:le()}],ease:[{ease:["linear","in","out","in-out",St]}],delay:[{delay:le()}],animate:[{animate:["none","spin","ping","pulse","bounce",St]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Im,St]}],"translate-x":[{"translate-x":[k]}],"translate-y":[{"translate-y":[k]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",St]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",St]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",St]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[bi,dl,x_]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ire=Une(ore);function fn(...t){return ire(xt(t))}const lre=bE("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=N.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...a},s)=>{const o=r?Lf:"button";return m.jsx(o,{className:fn(lre({variant:e,size:n,className:t})),ref:s,...a})});pe.displayName="Button";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ure=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),cV=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dre=N.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:s,iconNode:o,...i},l)=>N.createElement("svg",{ref:l,...cre,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:cV("lucide",a),...i},[...o.map(([u,c])=>N.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=(t,e)=>{const n=N.forwardRef(({className:r,...a},s)=>N.createElement(dre,{ref:s,iconNode:e,className:cV(`lucide-${ure(t)}`,r),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fre=Nt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=Nt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=Nt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=Nt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=Nt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hre=Nt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pre=Nt("BicepsFlexed",[["path",{d:"M12.409 13.017A5 5 0 0 1 22 15c0 3.866-4 7-9 7-4.077 0-8.153-.82-10.371-2.462-.426-.316-.631-.832-.62-1.362C2.118 12.723 2.627 2 10 2a3 3 0 0 1 3 3 2 2 0 0 1-2 2c-1.105 0-1.64-.444-2-1",key:"1pmlyh"}],["path",{d:"M15 14a5 5 0 0 0-7.584 2",key:"5rb254"}],["path",{d:"M9.964 6.825C8.019 7.977 9.5 13 8 15",key:"kbvsx9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mre=Nt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gre=Nt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yre=Nt("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dV=Nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fV=Nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vre=Nt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xre=Nt("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bre=Nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wre=Nt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sre=Nt("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=Nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Nt("Dumbbell",[["path",{d:"M14.4 14.4 9.6 9.6",key:"ic80wn"}],["path",{d:"M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z",key:"nnl7wr"}],["path",{d:"m21.5 21.5-1.4-1.4",key:"1f1ice"}],["path",{d:"M3.9 3.9 2.5 2.5",key:"1evmna"}],["path",{d:"M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z",key:"yhosts"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cre=Nt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=Nt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _re=Nt("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=Nt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hV=Nt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pV=Nt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ko=Nt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mV=Nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Nt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=Nt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $re=Nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=Nt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=Nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kre=Nt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yV=Nt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jk=Nt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QD=Nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=Nt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xV=Nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Un=()=>m.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b",children:m.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"h-9 w-9 rounded-lg bg-gradient-primary flex items-center justify-center text-white font-bold text-xl",children:"F"}),m.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-formfit-blue to-formfit-purple bg-clip-text text-transparent",children:"AI Trainer"})]}),m.jsxs("nav",{className:"hidden md:flex items-center gap-8",children:[m.jsx("a",{href:"#features",className:"text-gray-600 hover:text-formfit-blue transition-colors",children:"Recursos"}),m.jsx("a",{href:"#how-it-works",className:"text-gray-600 hover:text-formfit-blue transition-colors",children:"Como Funciona"}),m.jsx("a",{href:"#testimonials",className:"text-gray-600 hover:text-formfit-blue transition-colors",children:"Depoimentos"}),m.jsx("a",{href:"#pricing",className:"text-gray-600 hover:text-formfit-blue transition-colors",children:"Preços"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Ys,{to:"/primeiro-acesso",children:m.jsx(pe,{className:"formfit-btn-primary",children:"Cadastre-se"})}),m.jsx(Ys,{to:"/login",children:m.jsx(pe,{className:"formfit-btn-outline",children:"Login"})}),m.jsx(Ys,{to:"/perfil",children:m.jsx(pe,{variant:"ghost",size:"icon","aria-label":"Perfil",children:m.jsx(jk,{className:"h-5 w-5"})})})]})]})}),bV=({videos:t,className:e="",style:n})=>{const[r,a]=N.useState(0),[s,o]=N.useState(1),[i,l]=N.useState(!1),u=K.useRef({startX:0,lastX:0,dragging:!1});N.useEffect(()=>{const h=setInterval(()=>{o(0),setTimeout(()=>{a(p=>(p+1)%t.length),o(1)},800)},5e3);return()=>clearInterval(h)},[t.length]);const c=h=>{const p="touches"in h?h.touches[0].clientX:h.clientX;u.current.startX=p,u.current.lastX=p,u.current.dragging=!0,l(!0)},d=h=>{if(!u.current.dragging)return;const p="touches"in h?h.touches[0].clientX:h.clientX;u.current.lastX=p},f=()=>{if(!u.current.dragging)return;const h=u.current.lastX-u.current.startX;Math.abs(h)>40&&(o(0),setTimeout(()=>{h<0?a(p=>(p+1)%t.length):a(p=>(p-1+t.length)%t.length),o(1)},200)),u.current.dragging=!1,l(!1)};return m.jsx("section",{className:`formfit-container flex justify-center py-8 ${e}`,style:n,children:m.jsxs("div",{className:"w-[360px] h-[240px] bg-white rounded-2xl shadow-xl flex items-center justify-center text-center mx-auto transition-opacity duration-700 select-none relative",style:{opacity:s},onTouchStart:c,onTouchMove:d,onTouchEnd:f,onMouseDown:c,onMouseMove:i?d:void 0,onMouseUp:f,onMouseLeave:f,children:[m.jsx("video",{src:t[r].src,className:"w-full h-full object-contain rounded-xl",autoPlay:!0,loop:!0,muted:!0,playsInline:!0}),m.jsx("div",{className:"absolute bottom-3 right-4 flex gap-2",children:t.map((h,p)=>m.jsx("span",{className:`w-2.5 h-2.5 rounded-full transition-all duration-300 ${p===r?"bg-formfit-blue scale-125":"bg-gray-300"}`},p))})]})})},Nre=()=>{const[t,e]=N.useState(0),[n,r]=N.useState(0),[a,s]=N.useState(1),o=[{type:"image",src:"/images/workout.png",alt:"Exercício com halteres"},{type:"video",src:"/videos/demo1.mp4",alt:"Demonstração de exercício",poster:"/images/poster1.png"},{type:"image",src:"/images/workout2.png",alt:"Exercício com halteres 2"},{type:"video",src:"/videos/demo2.mp4",alt:"Demonstração de exercício 2",poster:"/images/poster2.png"}],i=["Seu Personal Trainer de IA na Palma da sua Mão","Treine com Inteligência Artificial, onde e quando quiser","O primeiro aplicativo Brasileiro com análise biomecânica baseada em IA","Modelos de IA treinados com treinos de atletas IFBB Pro","Iniciantes: Treino com apoio profissional, mesmo sem academia","Nossos modelos de IA foram treinados com milhares de horas de vídeo de atletas profissionais","Correções em tempo real com base em biomecânica avançada","Tenha acesso a treinos personalizados com base em análise de dados reais de atletas e personais trainers"],l=[{src:"/videos/videos1/demo1.mp4",alt:"Demonstração 1"}];return N.useEffect(()=>{const u=setInterval(()=>{s(0),setTimeout(()=>{e(c=>(c+1)%o.length),r(c=>(c+1)%i.length),s(1)},1500)},5e3);return()=>clearInterval(u)},[o.length,i.length]),m.jsx("section",{className:"bg-gradient-to-b from-blue-50 to-white formfit-section pt-2 md:pt-4",children:m.jsx("div",{className:"formfit-container",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center",children:[m.jsx("div",{className:"order-1 md:order-1",children:m.jsx(bV,{videos:l})}),m.jsxs("div",{className:"order-2 md:order-2",children:[m.jsx("div",{className:"inline-block bg-blue-100 text-formfit-blue px-4 py-1 rounded-full mb-4 font-medium text-sm",children:"Versão Beta · Acesso Antecipado"}),m.jsx("h1",{className:"formfit-heading",children:m.jsx("span",{className:"bg-gradient-to-r from-formfit-blue to-formfit-purple bg-clip-text text-transparent",children:i[n]})}),m.jsx("p",{className:"text-gray-600 text-lg mb-8",children:"AI Trainer analisa sua postura em tempo real, corrige seus movimentos e transforma seu smartphone em um personal trainer particular, acessível 24/7."}),m.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[m.jsxs("a",{href:"#early-access",className:"formfit-btn-primary flex items-center justify-center gap-2",children:["Experimente já ",m.jsx(ov,{size:16})]}),m.jsx("a",{href:"#how-it-works",className:"formfit-btn-outline flex items-center justify-center",children:"Como Funciona"})]})]})]})})})},Ad=({icon:t,title:e,description:n})=>m.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border hover:shadow-md transition-shadow",children:[m.jsx("div",{className:"h-12 w-12 bg-gradient-primary rounded-xl flex items-center justify-center text-white mb-4",children:t}),m.jsx("h3",{className:"formfit-subheading",children:e}),m.jsx("p",{className:"text-gray-600",children:n})]}),Ire=()=>m.jsx("section",{id:"features",className:"formfit-section bg-gray-50",children:m.jsxs("div",{className:"formfit-container",children:[m.jsxs("div",{className:"text-center mb-16",children:[m.jsxs("h2",{className:"formfit-heading",children:["Por que escolher o ",m.jsx("span",{className:"bg-gradient-to-r from-formfit-blue to-formfit-purple bg-clip-text text-transparent",children:"AI Trainer"}),"?"]}),m.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto",children:"Nosso aplicativo usa tecnologia avançada de IA para trazer o melhor da experiência de treino personalizado para seu smartphone."})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[m.jsx(Ad,{icon:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-activity",children:m.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})}),title:"Análise de Postura em Tempo Real",description:"Nossa IA analisa sua postura durante os exercícios e fornece feedback instantâneo para evitar lesões e maximizar resultados."}),m.jsx(Ad,{icon:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-trending-up",children:[m.jsx("polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17"}),m.jsx("polyline",{points:"16 7 22 7 22 13"})]}),title:"Acompanhamento de Progresso",description:"Acompanhe suas melhorias ao longo do tempo com estatísticas detalhadas e visualizações do seu desenvolvimento físico."}),m.jsx(Ad,{icon:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-list-check",children:[m.jsx("path",{d:"m3 5 2 2 4-4"}),m.jsx("path",{d:"m3 12 2 2 4-4"}),m.jsx("path",{d:"m3 19 2 2 4-4"}),m.jsx("line",{x1:"13",x2:"22",y1:"6",y2:"6"}),m.jsx("line",{x1:"13",x2:"22",y1:"13",y2:"13"}),m.jsx("line",{x1:"13",x2:"22",y1:"20",y2:"20"})]}),title:"Planos de Treino Personalizados",description:"Receba planos de treino adaptados ao seu nível de condicionamento, objetivos e equipamentos disponíveis."}),m.jsx(Ad,{icon:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-repeat",children:[m.jsx("path",{d:"m17 2 4 4-4 4"}),m.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),m.jsx("path",{d:"m7 22-4-4 4-4"}),m.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]}),title:"Contador de Repetições",description:"Deixe o AI Trainer contar suas repetições automaticamente enquanto você se concentra na qualidade dos movimentos."}),m.jsx(Ad,{icon:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-timer",children:[m.jsx("line",{x1:"10",x2:"10",y1:"2",y2:"4"}),m.jsx("line",{x1:"14",x2:"14",y1:"2",y2:"4"}),m.jsx("line",{x1:"12",x2:"12",y1:"14",y2:"16"}),m.jsx("line",{x1:"12",x2:"12.01",y1:"20",y2:"20"}),m.jsx("path",{d:"M5.37 5.37 4.3 4.3"}),m.jsx("path",{d:"m18.63 5.37 1.07-1.07"}),m.jsx("path",{d:"M10.42 10.42a3 3 0 1 0 4.24 4.24 3 3 0 0 0-4.24-4.24Z"}),m.jsx("path",{d:"M7 12a5 5 0 0 1 5-5"}),m.jsx("path",{d:"M17 12a5 5 0 0 0-5-5"}),m.jsx("path",{d:"M12 17a5 5 0 0 0 5-5"})]}),title:"Treinos Cronometrados",description:"Utilize nossos temporizadores inteligentes para intervalos de descanso e treinos de alta intensidade otimizados."}),m.jsx(Ad,{icon:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-heart",children:m.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),title:"Comunidade de Apoio",description:"Conecte-se com outros usuários, compartilhe conquistas e participe de desafios para manter a motivação."})]})]})}),Xb=({number:t,title:e,description:n,isLast:r=!1})=>m.jsx("div",{className:"relative",children:m.jsxs("div",{className:"flex gap-6",children:[m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"h-12 w-12 bg-gradient-primary rounded-full flex items-center justify-center text-white font-bold text-lg",children:t}),!r&&m.jsx("div",{className:"absolute top-12 bottom-0 left-1/2 -translate-x-1/2 w-1 bg-gradient-to-b from-formfit-purple to-formfit-blue/10"})]}),m.jsxs("div",{className:"pb-12",children:[m.jsx("h3",{className:"text-xl font-semibold mb-2",children:e}),m.jsx("p",{className:"text-gray-600",children:n})]})]})}),Tre=()=>m.jsx("section",{id:"how-it-works",className:"formfit-section",children:m.jsxs("div",{className:"formfit-container",children:[m.jsxs("div",{className:"text-center mb-16",children:[m.jsxs("h2",{className:"formfit-heading",children:["Como o ",m.jsx("span",{className:"bg-gradient-to-r from-formfit-blue to-formfit-purple bg-clip-text text-transparent",children:"AI Trainer"})," funciona"]}),m.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto",children:"Transforme seu smartphone em um personal trainer com apenas alguns passos simples"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center",children:[m.jsxs("div",{children:[m.jsx(Xb,{number:"1",title:"Escolha seu exercício",description:"Selecione entre nossa biblioteca de exercícios com mais de 100 opções e níveis de dificuldade variados."}),m.jsx(Xb,{number:"2",title:"Posicione seu smartphone",description:"Coloque seu telefone no chão em modo selfie ou use um suporte para que a câmera possa ver seu corpo inteiro."}),m.jsx(Xb,{number:"3",title:"Receba feedback em tempo real",description:"Nossa IA analisa sua postura e movimentos, fornecendo correções em tempo real para garantir a forma perfeita."}),m.jsx(Xb,{number:"4",title:"Acompanhe seu progresso",description:"Veja estatísticas detalhadas do seu treino, incluindo repetições, tempo e melhoria na qualidade do movimento ao longo do tempo.",isLast:!0})]}),m.jsx("div",{className:"relative",children:m.jsx("div",{className:"bg-white p-3 rounded-2xl shadow-xl",children:m.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl overflow-hidden aspect-[9/16] relative",children:m.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center px-6",children:m.jsxs("div",{className:"w-full max-w-xs",children:[m.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-4 relative",children:[m.jsx("div",{className:"absolute -top-2 -left-2 h-8 w-8 bg-formfit-blue rounded-lg flex items-center justify-center text-white font-bold",children:"1"}),m.jsx("h4",{className:"font-medium mb-1 mt-2 ml-4",children:"Posição Inicial"}),m.jsx("div",{className:"h-24 bg-gray-100 rounded-md flex items-center justify-center",children:m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-user text-gray-400",children:[m.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),m.jsx("circle",{cx:"12",cy:"7",r:"4"})]})})]}),m.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-4 relative",children:[m.jsx("div",{className:"absolute -top-2 -left-2 h-8 w-8 bg-formfit-purple rounded-lg flex items-center justify-center text-white font-bold",children:"2"}),m.jsx("h4",{className:"font-medium mb-1 mt-2 ml-4",children:"Movimento"}),m.jsx("div",{className:"h-24 bg-gray-100 rounded-md flex items-center justify-center",children:m.jsxs("div",{className:"relative",children:[m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-user text-gray-400 transform -rotate-15",children:[m.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),m.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),m.jsx("div",{className:"absolute inset-0 border-2 border-formfit-pink rounded-full animate-pulse-light opacity-60"})]})})]}),m.jsxs("div",{className:"flex justify-between mb-4",children:[m.jsxs("div",{className:"bg-white px-3 py-2 rounded-lg shadow-md text-center flex-1 mr-2",children:[m.jsx("p",{className:"text-xs text-gray-500",children:"Repetições"}),m.jsx("p",{className:"font-bold text-lg",children:"8/12"})]}),m.jsxs("div",{className:"bg-white px-3 py-2 rounded-lg shadow-md text-center flex-1 ml-2",children:[m.jsx("p",{className:"text-xs text-gray-500",children:"Precisão"}),m.jsx("p",{className:"font-bold text-lg",children:"93%"})]})]}),m.jsx("div",{className:"bg-white p-3 rounded-lg shadow-md",children:m.jsxs("div",{className:"bg-blue-50 rounded-md p-2 flex items-center",children:[m.jsx("div",{className:"h-8 w-8 bg-formfit-blue rounded-full flex items-center justify-center text-white mr-2",children:m.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-check",children:m.jsx("path",{d:"M20 6 9 17l-5-5"})})}),m.jsx("p",{className:"text-sm",children:"Levante os braços um pouco mais!"})]})})]})})})})})]})]})}),Ere=()=>null,JD=({name:t,price:e,period:n,description:r,features:a,isPopular:s=!1,buttonText:o})=>m.jsxs("div",{className:`bg-white rounded-2xl overflow-hidden border transition-all ${s?"shadow-lg border-formfit-blue transform scale-105 z-10":"shadow-sm hover:shadow-md"}`,children:[s&&m.jsx("div",{className:"bg-formfit-blue text-white text-center py-2 text-sm font-semibold",children:"MAIS POPULAR"}),m.jsxs("div",{className:"p-6",children:[m.jsx("h3",{className:"text-xl font-bold mb-2",children:t}),m.jsxs("div",{className:"flex items-end mb-4",children:[m.jsx("span",{className:"text-4xl font-bold",children:e}),m.jsx("span",{className:"text-gray-500 ml-2",children:n})]}),m.jsx("p",{className:"text-gray-600 mb-6",children:r}),m.jsx("a",{href:"#early-access",className:`block text-center py-3 px-4 rounded-lg mb-6 transition-colors ${s?"bg-gradient-primary text-white":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,children:o}),m.jsx("div",{className:"space-y-3",children:a.map((i,l)=>m.jsxs("div",{className:"flex items-center",children:[i.included?m.jsx("div",{className:"h-5 w-5 rounded-full bg-formfit-blue/10 flex items-center justify-center mr-3",children:m.jsx(sa,{className:"h-3 w-3 text-formfit-blue"})}):m.jsx("div",{className:"h-5 w-5 rounded-full bg-gray-100 flex items-center justify-center mr-3",children:m.jsx("div",{className:"h-1.5 w-1.5 bg-gray-400 rounded-full"})}),m.jsx("span",{className:i.included?"text-gray-800":"text-gray-500",children:i.feature})]},l))})]})]}),Are=()=>{const t=[{feature:"Análise básica de postura",included:!0},{feature:"Biblioteca com 20 exercícios",included:!0},{feature:"Contador de repetições",included:!0},{feature:"1 plano de treino",included:!0},{feature:"Feedback de postura limitado",included:!0},{feature:"Planos de treino personalizados",included:!1},{feature:"Suporte prioritário",included:!1},{feature:"Análise avançada de postura",included:!1}],e=[{feature:"Análise básica de postura",included:!0},{feature:"Biblioteca com +100 exercícios",included:!0},{feature:"Contador de repetições",included:!0},{feature:"Planos de treino ilimitados",included:!0},{feature:"Feedback de postura avançado",included:!0},{feature:"Planos de treino personalizados",included:!0},{feature:"Suporte prioritário",included:!0},{feature:"Análise avançada de postura",included:!0}];return m.jsx("section",{id:"pricing",className:"formfit-section",children:m.jsxs("div",{className:"formfit-container",children:[m.jsxs("div",{className:"text-center mb-16",children:[m.jsx("h2",{className:"formfit-heading",children:"Planos simples e transparentes"}),m.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto",children:"Escolha o plano que melhor se adapta às suas necessidades"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4 max-w-4xl mx-auto",children:[m.jsx(JD,{name:"Plano inicial",price:"R$ 29,90",period:"/mês",description:"Perfeito para experimentar e conhecer a plataforma.",features:t,buttonText:"Começar Agora"}),m.jsx(JD,{name:"Pro",price:"R$ 79,90",period:"/mês",description:"Acesso completo a todos os recursos e novidades.",features:e,isPopular:!0,buttonText:"Obter Acesso Antecipado"})]}),m.jsx("div",{className:"mt-12 text-center",children:m.jsxs("p",{className:"text-gray-500",children:["Tem dúvidas sobre qual plano escolher?"," ",m.jsx("a",{href:"#",className:"text-formfit-blue hover:underline",children:"Entre em contato"})]})})]})})},So=N.forwardRef(({className:t,type:e,...n},r)=>m.jsx("input",{type:e,className:fn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));So.displayName="Input";const Pre=1,Ore=1e6;let S_=0;function Rre(){return S_=(S_+1)%Number.MAX_SAFE_INTEGER,S_.toString()}const C_=new Map,ZD=t=>{if(C_.has(t))return;const e=setTimeout(()=>{C_.delete(t),pg({type:"REMOVE_TOAST",toastId:t})},Ore);C_.set(t,e)},Dre=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,Pre)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?ZD(n):t.toasts.forEach(r=>{ZD(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},z0=[];let U0={toasts:[]};function pg(t){U0=Dre(U0,t),z0.forEach(e=>{e(U0)})}function jre({...t}){const e=Rre(),n=a=>pg({type:"UPDATE_TOAST",toast:{...a,id:e}}),r=()=>pg({type:"DISMISS_TOAST",toastId:e});return pg({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||r()}}}),{id:e,dismiss:r,update:n}}function Xr(){const[t,e]=N.useState(U0);return N.useEffect(()=>(z0.push(e),()=>{const n=z0.indexOf(e);n>-1&&z0.splice(n,1)}),[t]),{...t,toast:jre,dismiss:n=>pg({type:"DISMISS_TOAST",toastId:n})}}const Mre=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(!1),{toast:a}=Xr(),s=o=>{o.preventDefault(),r(!0),setTimeout(()=>{a({title:"Inscrição realizada com sucesso!",description:"Você receberá atualizações sobre o lançamento do AI Trainer."}),e(""),r(!1)},1e3)};return m.jsx("section",{id:"early-access",className:"formfit-section bg-gradient-to-br from-formfit-blue to-formfit-darkblue text-white",children:m.jsx("div",{className:"formfit-container",children:m.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[m.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Pronto para transformar seus treinos?"}),m.jsx("p",{className:"text-lg md:text-xl mb-8 opacity-90",children:"Junte-se à nossa lista de espera e seja um dos primeiros a experimentar o AI Trainer"}),m.jsxs("form",{onSubmit:s,className:"flex flex-col sm:flex-row gap-4 max-w-lg mx-auto",children:[m.jsx(So,{type:"email",placeholder:"Seu melhor e-mail",value:t,onChange:o=>e(o.target.value),required:!0,className:"bg-white/20 border-white/20 text-white placeholder:text-white/70 focus:ring-white/50"}),m.jsx(pe,{type:"submit",className:"bg-white text-formfit-blue hover:bg-white/90",disabled:n,children:n?"Enviando...":"Entrar para lista de espera"})]}),m.jsx("p",{className:"mt-6 text-sm opacity-80",children:"Seja notificado quando lançarmos. Sem spam, prometemos."})]})})})},rr=()=>m.jsx("footer",{className:"bg-gray-900 text-white py-12 px-6",children:m.jsxs("div",{className:"max-w-7xl mx-auto",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[m.jsxs("div",{className:"col-span-1 md:col-span-1",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[m.jsx("div",{className:"h-9 w-9 rounded-lg bg-gradient-primary flex items-center justify-center text-white font-bold text-xl",children:"F"}),m.jsx("h2",{className:"text-xl font-bold",children:"AI Trainer"})]}),m.jsx("p",{className:"text-gray-400 mb-4",children:"Transforme seu smartphone em um personal trainer inteligente com nossa tecnologia de IA."}),m.jsxs("div",{className:"flex space-x-4",children:[m.jsxs("a",{href:"#",className:"text-gray-400 hover:text-white",children:[m.jsx("span",{className:"sr-only",children:"Instagram"}),m.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{d:"M12 2C6.477 2 2 6.477 2 12C2 17.523 6.477 22 12 22C17.523 22 22 17.523 22 12C22 6.477 17.523 2 12 2ZM17.5 8.5H15.5C15.224 8.5 15 8.724 15 9V11H17.5V13.5H15V19H12.5V13.5H10V11H12.5V9.5C12.5 7.57 14.07 6 16 6H17.5V8.5Z"})})]}),m.jsxs("a",{href:"#",className:"text-gray-400 hover:text-white",children:[m.jsx("span",{className:"sr-only",children:"Instagram"}),m.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{d:"M12 2C6.477 2 2 6.477 2 12C2 17.523 6.477 22 12 22C17.523 22 22 17.523 22 12C22 6.477 17.523 2 12 2ZM12 7C14.761 7 17 9.239 17 12C17 14.761 14.761 17 12 17C9.239 17 7 14.761 7 12C7 9.239 9.239 7 12 7ZM18.5 6.5C18.5 7.328 17.828 8 17 8C16.172 8 15.5 7.328 15.5 6.5C15.5 5.672 16.172 5 17 5C17.828 5 18.5 5.672 18.5 6.5Z"})})]}),m.jsxs("a",{href:"#",className:"text-gray-400 hover:text-white",children:[m.jsx("span",{className:"sr-only",children:"Twitter"}),m.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})]})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider",children:"Produto"}),m.jsxs("ul",{className:"mt-4 space-y-2",children:[m.jsx("li",{children:m.jsx("a",{href:"#features",className:"text-gray-400 hover:text-white",children:"Recursos"})}),m.jsx("li",{children:m.jsx("a",{href:"#how-it-works",className:"text-gray-400 hover:text-white",children:"Como funciona"})}),m.jsx("li",{children:m.jsx("a",{href:"#pricing",className:"text-gray-400 hover:text-white",children:"Preços"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"FAQ"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider",children:"Empresa"}),m.jsxs("ul",{className:"mt-4 space-y-2",children:[m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Sobre nós"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Blog"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Carreiras"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Contato"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider",children:"Legal"}),m.jsxs("ul",{className:"mt-4 space-y-2",children:[m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Termos de uso"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Política de privacidade"})}),m.jsx("li",{children:m.jsx("a",{href:"#",className:"text-gray-400 hover:text-white",children:"Cookies"})})]})]})]}),m.jsx("div",{className:"mt-12 pt-8 border-t border-gray-800",children:m.jsx("p",{className:"text-gray-400 text-sm text-center",children:"© 2025 AI Trainer. Todos os direitos reservados."})})]})}),wV=()=>{const[t,e]=N.useState(!1),n=()=>{window.scrollY>300?e(!0):e(!1)},r=()=>{window.scrollTo({top:0,behavior:"smooth"})};return N.useEffect(()=>(window.addEventListener("scroll",n),()=>{window.removeEventListener("scroll",n)}),[]),m.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:t&&m.jsx(pe,{onClick:r,className:"h-12 w-12 rounded-full bg-formfit-blue hover:bg-formfit-blue/90 p-0",children:m.jsx(CE,{className:"h-5 w-5"})})})},Fre=()=>{const t=["Desenvolvido com base em movimentos de atletas IFBB, Wellness e Classic Physique","Tecnologia inspirada nos treinos dos melhores treinadores funcionais","Modelos de IA treinados para iniciantes e avançados","Análises de milhares de vídeos das redes sociais de atletas Aesthetics"],[e,n]=N.useState(0),[r,a]=N.useState(1),[s,o]=N.useState(!1),i=K.useRef({startX:0,lastX:0,dragging:!1});N.useEffect(()=>{const d=setInterval(()=>{a(0),setTimeout(()=>{n(f=>(f+1)%t.length),a(1)},800)},5e3);return()=>clearInterval(d)},[t.length]);const l=d=>{const f="touches"in d?d.touches[0].clientX:d.clientX;i.current.startX=f,i.current.lastX=f,i.current.dragging=!0,o(!0)},u=d=>{if(!i.current.dragging)return;const f="touches"in d?d.touches[0].clientX:d.clientX;i.current.lastX=f},c=()=>{if(!i.current.dragging)return;const d=i.current.lastX-i.current.startX;Math.abs(d)>40&&(a(0),setTimeout(()=>{d<0?n(f=>(f+1)%t.length):n(f=>(f-1+t.length)%t.length),a(1)},200)),i.current.dragging=!1,o(!1)};return m.jsx("section",{className:"formfit-container flex justify-center py-2",children:m.jsx("div",{className:"w-[360px] h-[80px] bg-white rounded-2xl shadow-xl flex items-center justify-center text-center mx-auto transition-opacity duration-700 select-none relative",style:{opacity:r},onTouchStart:l,onTouchMove:u,onTouchEnd:c,onMouseDown:l,onMouseMove:s?u:void 0,onMouseUp:c,onMouseLeave:c,children:m.jsx("span",{className:"text-xl md:text-2xl font-semibold text-gray-700 px-6",children:t[e]})})})},Lre=()=>{const t=[{src:"/videos/videos2/demo2.mp4",alt:"Demonstração 2"}];return m.jsxs("div",{className:"min-h-screen bg-gray-50",children:[m.jsx(Un,{}),m.jsxs("main",{children:[m.jsx(Nre,{}),m.jsx("div",{className:"formfit-container py-8 px-4",children:m.jsxs("div",{className:"flex flex-col justify-center gap-4 max-w-md mx-auto",children:[m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Bem-vindo"}),m.jsx(Ys,{to:"/treino-guiado",children:m.jsx(pe,{className:"w-full bg-formfit-blue hover:bg-formfit-blue/90 text-white font-medium py-3 rounded-lg text-lg",children:"Experiência Guiada"})}),m.jsx(Ys,{to:"/primeiro-acesso",children:m.jsx(pe,{className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-lg text-lg",children:"Primeiro Acesso"})}),m.jsx(Ys,{to:"/login",children:m.jsx(pe,{className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 rounded-lg text-lg",children:"Login"})})]})}),m.jsx(bV,{videos:t,className:"py-4"}),m.jsx(Fre,{}),m.jsx(Ire,{}),m.jsx(Tre,{}),m.jsx(Ere,{}),m.jsx(Are,{}),m.jsx(Mre,{})]}),m.jsx(rr,{}),m.jsx(wV,{})]})},Bre=()=>{const t=Po();return N.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),m.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:m.jsxs("div",{className:"text-center",children:[m.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),m.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found!"}),m.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};var zre={};(function(){var t;function e(S){var I=0;return function(){return I<S.length?{done:!1,value:S[I++]}:{done:!0}}}var n=typeof Object.defineProperties=="function"?Object.defineProperty:function(S,I,E){return S==Array.prototype||S==Object.prototype||(S[I]=E.value),S};function r(S){S=[typeof globalThis=="object"&&globalThis,S,typeof window=="object"&&window,typeof self=="object"&&self,typeof gn=="object"&&gn];for(var I=0;I<S.length;++I){var E=S[I];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var a=r(this);function s(S,I){if(I)e:{var E=a;S=S.split(".");for(var D=0;D<S.length-1;D++){var z=S[D];if(!(z in E))break e;E=E[z]}S=S[S.length-1],D=E[S],I=I(D),I!=D&&I!=null&&n(E,S,{configurable:!0,writable:!0,value:I})}}s("Symbol",function(S){function I(q){if(this instanceof I)throw new TypeError("Symbol is not a constructor");return new E(D+(q||"")+"_"+z++,q)}function E(q,W){this.h=q,n(this,"description",{configurable:!0,writable:!0,value:W})}if(S)return S;E.prototype.toString=function(){return this.h};var D="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",z=0;return I}),s("Symbol.iterator",function(S){if(S)return S;S=Symbol("Symbol.iterator");for(var I="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),E=0;E<I.length;E++){var D=a[I[E]];typeof D=="function"&&typeof D.prototype[S]!="function"&&n(D.prototype,S,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return S});function o(S){return S={next:S},S[Symbol.iterator]=function(){return this},S}function i(S){var I=typeof Symbol<"u"&&Symbol.iterator&&S[Symbol.iterator];return I?I.call(S):{next:e(S)}}function l(S){if(!(S instanceof Array)){S=i(S);for(var I,E=[];!(I=S.next()).done;)E.push(I.value);S=E}return S}var u=typeof Object.assign=="function"?Object.assign:function(S,I){for(var E=1;E<arguments.length;E++){var D=arguments[E];if(D)for(var z in D)Object.prototype.hasOwnProperty.call(D,z)&&(S[z]=D[z])}return S};s("Object.assign",function(S){return S||u});var c=typeof Object.create=="function"?Object.create:function(S){function I(){}return I.prototype=S,new I},d;if(typeof Object.setPrototypeOf=="function")d=Object.setPrototypeOf;else{var f;e:{var h={a:!0},p={};try{p.__proto__=h,f=p.a;break e}catch{}f=!1}d=f?function(S,I){if(S.__proto__=I,S.__proto__!==I)throw new TypeError(S+" is not extensible");return S}:null}var g=d;function y(S,I){if(S.prototype=c(I.prototype),S.prototype.constructor=S,g)g(S,I);else for(var E in I)if(E!="prototype")if(Object.defineProperties){var D=Object.getOwnPropertyDescriptor(I,E);D&&Object.defineProperty(S,E,D)}else S[E]=I[E];S.za=I.prototype}function v(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function x(S){if(S.m)throw new TypeError("Generator is already running");S.m=!0}v.prototype.u=function(S){this.i=S};function b(S,I){S.l={ma:I,na:!0},S.h=S.s||S.v}v.prototype.return=function(S){this.l={return:S},this.h=this.v};function w(S,I,E){return S.h=E,{value:I}}function C(S){this.h=new v,this.i=S}function _(S,I){x(S.h);var E=S.h.j;return E?$(S,"return"in E?E.return:function(D){return{value:D,done:!0}},I,S.h.return):(S.h.return(I),k(S))}function $(S,I,E,D){try{var z=I.call(S.h.j,E);if(!(z instanceof Object))throw new TypeError("Iterator result "+z+" is not an object");if(!z.done)return S.h.m=!1,z;var q=z.value}catch(W){return S.h.j=null,b(S.h,W),k(S)}return S.h.j=null,D.call(S.h,q),k(S)}function k(S){for(;S.h.h;)try{var I=S.i(S.h);if(I)return S.h.m=!1,{value:I.value,done:!1}}catch(E){S.h.i=void 0,b(S.h,E)}if(S.h.m=!1,S.h.l){if(I=S.h.l,S.h.l=null,I.na)throw I.ma;return{value:I.return,done:!0}}return{value:void 0,done:!0}}function A(S){this.next=function(I){return x(S.h),S.h.j?I=$(S,S.h.j.next,I,S.h.u):(S.h.u(I),I=k(S)),I},this.throw=function(I){return x(S.h),S.h.j?I=$(S,S.h.j.throw,I,S.h.u):(b(S.h,I),I=k(S)),I},this.return=function(I){return _(S,I)},this[Symbol.iterator]=function(){return this}}function P(S){function I(D){return S.next(D)}function E(D){return S.throw(D)}return new Promise(function(D,z){function q(W){W.done?D(W.value):Promise.resolve(W.value).then(I,E).then(q,z)}q(S.next())})}function O(S){return P(new A(new C(S)))}s("Promise",function(S){function I(W){this.i=0,this.j=void 0,this.h=[],this.u=!1;var Z=this.l();try{W(Z.resolve,Z.reject)}catch(fe){Z.reject(fe)}}function E(){this.h=null}function D(W){return W instanceof I?W:new I(function(Z){Z(W)})}if(S)return S;E.prototype.i=function(W){if(this.h==null){this.h=[];var Z=this;this.j(function(){Z.m()})}this.h.push(W)};var z=a.setTimeout;E.prototype.j=function(W){z(W,0)},E.prototype.m=function(){for(;this.h&&this.h.length;){var W=this.h;this.h=[];for(var Z=0;Z<W.length;++Z){var fe=W[Z];W[Z]=null;try{fe()}catch(Ce){this.l(Ce)}}}this.h=null},E.prototype.l=function(W){this.j(function(){throw W})},I.prototype.l=function(){function W(Ce){return function(je){fe||(fe=!0,Ce.call(Z,je))}}var Z=this,fe=!1;return{resolve:W(this.I),reject:W(this.m)}},I.prototype.I=function(W){if(W===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(W instanceof I)this.L(W);else{e:switch(typeof W){case"object":var Z=W!=null;break e;case"function":Z=!0;break e;default:Z=!1}Z?this.F(W):this.s(W)}},I.prototype.F=function(W){var Z=void 0;try{Z=W.then}catch(fe){this.m(fe);return}typeof Z=="function"?this.M(Z,W):this.s(W)},I.prototype.m=function(W){this.v(2,W)},I.prototype.s=function(W){this.v(1,W)},I.prototype.v=function(W,Z){if(this.i!=0)throw Error("Cannot settle("+W+", "+Z+"): Promise already settled in state"+this.i);this.i=W,this.j=Z,this.i===2&&this.K(),this.H()},I.prototype.K=function(){var W=this;z(function(){if(W.D()){var Z=a.console;typeof Z<"u"&&Z.error(W.j)}},1)},I.prototype.D=function(){if(this.u)return!1;var W=a.CustomEvent,Z=a.Event,fe=a.dispatchEvent;return typeof fe>"u"?!0:(typeof W=="function"?W=new W("unhandledrejection",{cancelable:!0}):typeof Z=="function"?W=new Z("unhandledrejection",{cancelable:!0}):(W=a.document.createEvent("CustomEvent"),W.initCustomEvent("unhandledrejection",!1,!0,W)),W.promise=this,W.reason=this.j,fe(W))},I.prototype.H=function(){if(this.h!=null){for(var W=0;W<this.h.length;++W)q.i(this.h[W]);this.h=null}};var q=new E;return I.prototype.L=function(W){var Z=this.l();W.T(Z.resolve,Z.reject)},I.prototype.M=function(W,Z){var fe=this.l();try{W.call(Z,fe.resolve,fe.reject)}catch(Ce){fe.reject(Ce)}},I.prototype.then=function(W,Z){function fe(Je,Ue){return typeof Je=="function"?function(lt){try{Ce(Je(lt))}catch(kt){je(kt)}}:Ue}var Ce,je,it=new I(function(Je,Ue){Ce=Je,je=Ue});return this.T(fe(W,Ce),fe(Z,je)),it},I.prototype.catch=function(W){return this.then(void 0,W)},I.prototype.T=function(W,Z){function fe(){switch(Ce.i){case 1:W(Ce.j);break;case 2:Z(Ce.j);break;default:throw Error("Unexpected state: "+Ce.i)}}var Ce=this;this.h==null?q.i(fe):this.h.push(fe),this.u=!0},I.resolve=D,I.reject=function(W){return new I(function(Z,fe){fe(W)})},I.race=function(W){return new I(function(Z,fe){for(var Ce=i(W),je=Ce.next();!je.done;je=Ce.next())D(je.value).T(Z,fe)})},I.all=function(W){var Z=i(W),fe=Z.next();return fe.done?D([]):new I(function(Ce,je){function it(lt){return function(kt){Je[lt]=kt,Ue--,Ue==0&&Ce(Je)}}var Je=[],Ue=0;do Je.push(void 0),Ue++,D(fe.value).T(it(Je.length-1),je),fe=Z.next();while(!fe.done)})},I});function R(S,I){S instanceof String&&(S+="");var E=0,D=!1,z={next:function(){if(!D&&E<S.length){var q=E++;return{value:I(q,S[q]),done:!1}}return D=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}s("Array.prototype.keys",function(S){return S||function(){return R(this,function(I){return I})}}),s("Array.prototype.fill",function(S){return S||function(I,E,D){var z=this.length||0;for(0>E&&(E=Math.max(0,z+E)),(D==null||D>z)&&(D=z),D=Number(D),0>D&&(D=Math.max(0,z+D)),E=Number(E||0);E<D;E++)this[E]=I;return this}});function B(S){return S||Array.prototype.fill}s("Int8Array.prototype.fill",B),s("Uint8Array.prototype.fill",B),s("Uint8ClampedArray.prototype.fill",B),s("Int16Array.prototype.fill",B),s("Uint16Array.prototype.fill",B),s("Int32Array.prototype.fill",B),s("Uint32Array.prototype.fill",B),s("Float32Array.prototype.fill",B),s("Float64Array.prototype.fill",B),s("Object.is",function(S){return S||function(I,E){return I===E?I!==0||1/I===1/E:I!==I&&E!==E}}),s("Array.prototype.includes",function(S){return S||function(I,E){var D=this;D instanceof String&&(D=String(D));var z=D.length;for(E=E||0,0>E&&(E=Math.max(E+z,0));E<z;E++){var q=D[E];if(q===I||Object.is(q,I))return!0}return!1}}),s("String.prototype.includes",function(S){return S||function(I,E){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(I instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(I,E||0)!==-1}});var F=this||self;function L(S,I){S=S.split(".");var E=F;S[0]in E||typeof E.execScript>"u"||E.execScript("var "+S[0]);for(var D;S.length&&(D=S.shift());)S.length||I===void 0?E[D]&&E[D]!==Object.prototype[D]?E=E[D]:E=E[D]={}:E[D]=I}function H(S){var I;e:{if((I=F.navigator)&&(I=I.userAgent))break e;I=""}return I.indexOf(S)!=-1}var te=Array.prototype.map?function(S,I){return Array.prototype.map.call(S,I,void 0)}:function(S,I){for(var E=S.length,D=Array(E),z=typeof S=="string"?S.split(""):S,q=0;q<E;q++)q in z&&(D[q]=I.call(void 0,z[q],q,S));return D},V={},Q=null;function se(S){var I=S.length,E=3*I/4;E%3?E=Math.floor(E):"=.".indexOf(S[I-1])!=-1&&(E="=.".indexOf(S[I-2])!=-1?E-2:E-1);var D=new Uint8Array(E),z=0;return le(S,function(q){D[z++]=q}),z!==E?D.subarray(0,z):D}function le(S,I){function E(fe){for(;D<S.length;){var Ce=S.charAt(D++),je=Q[Ce];if(je!=null)return je;if(!/^[\s\xa0]*$/.test(Ce))throw Error("Unknown base64 encoding at char: "+Ce)}return fe}ue();for(var D=0;;){var z=E(-1),q=E(0),W=E(64),Z=E(64);if(Z===64&&z===-1)break;I(z<<2|q>>4),W!=64&&(I(q<<4&240|W>>2),Z!=64&&I(W<<6&192|Z))}}function ue(){if(!Q){Q={};for(var S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),I=["+/=","+/","-_=","-_.","-_"],E=0;5>E;E++){var D=S.concat(I[E].split(""));V[E]=D;for(var z=0;z<D.length;z++){var q=D[z];Q[q]===void 0&&(Q[q]=z)}}}}var ce=typeof Uint8Array<"u",re=!(H("Trident")||H("MSIE"))&&typeof F.btoa=="function";function ge(S){if(!re){var I;I===void 0&&(I=0),ue(),I=V[I];for(var E=Array(Math.floor(S.length/3)),D=I[64]||"",z=0,q=0;z<S.length-2;z+=3){var W=S[z],Z=S[z+1],fe=S[z+2],Ce=I[W>>2];W=I[(W&3)<<4|Z>>4],Z=I[(Z&15)<<2|fe>>6],fe=I[fe&63],E[q++]=Ce+W+Z+fe}switch(Ce=0,fe=D,S.length-z){case 2:Ce=S[z+1],fe=I[(Ce&15)<<2]||D;case 1:S=S[z],E[q]=I[S>>2]+I[(S&3)<<4|Ce>>4]+fe+D}return E.join("")}for(I="";10240<S.length;)I+=String.fromCharCode.apply(null,S.subarray(0,10240)),S=S.subarray(10240);return I+=String.fromCharCode.apply(null,S),btoa(I)}var Se=RegExp("[-_.]","g");function Ne(S){switch(S){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function we(S){if(!re)return se(S);Se.test(S)&&(S=S.replace(Se,Ne)),S=atob(S);for(var I=new Uint8Array(S.length),E=0;E<S.length;E++)I[E]=S.charCodeAt(E);return I}var de;function J(){return de||(de=new Uint8Array(0))}var ae={},U=typeof Uint8Array.prototype.slice=="function",oe=0,ye=0;function be(S){var I=0>S;S=Math.abs(S);var E=S>>>0;S=Math.floor((S-E)/4294967296),I&&(E=i(De(E,S)),I=E.next().value,S=E.next().value,E=I),oe=E>>>0,ye=S>>>0}var he=typeof BigInt=="function";function De(S,I){return I=~I,S?S=~S+1:I+=1,[S,I]}function Ve(S,I){this.i=S>>>0,this.h=I>>>0}function Ye(S){if(!S)return Ze||(Ze=new Ve(0,0));if(!/^-?\d+$/.test(S))return null;if(16>S.length)be(Number(S));else if(he)S=BigInt(S),oe=Number(S&BigInt(4294967295))>>>0,ye=Number(S>>BigInt(32)&BigInt(4294967295));else{var I=+(S[0]==="-");ye=oe=0;for(var E=S.length,D=I,z=(E-I)%6+I;z<=E;D=z,z+=6)D=Number(S.slice(D,z)),ye*=1e6,oe=1e6*oe+D,4294967296<=oe&&(ye+=oe/4294967296|0,oe%=4294967296);I&&(I=i(De(oe,ye)),S=I.next().value,I=I.next().value,oe=S,ye=I)}return new Ve(oe,ye)}var Ze;function It(S,I){return Error("Invalid wire type: "+S+" (at position "+I+")")}function rn(){return Error("Failed to read varint, encoding is invalid.")}function an(S,I){return Error("Tried to read past the end of the data "+I+" > "+S)}function ar(){throw Error("Invalid UTF8")}function Nr(S,I){return I=String.fromCharCode.apply(null,I),S==null?I:S+I}var Zr=void 0,Te,st=typeof TextDecoder<"u",pt,$n=typeof TextEncoder<"u",Jn;function ya(S){if(S!==ae)throw Error("illegal external caller")}function wt(S,I){if(ya(I),this.V=S,S!=null&&S.length===0)throw Error("ByteString should be constructed with non-empty values")}function Vt(){return Jn||(Jn=new wt(null,ae))}function sn(S){ya(ae);var I=S.V;return I=I==null||ce&&I!=null&&I instanceof Uint8Array?I:typeof I=="string"?we(I):null,I==null?I:S.V=I}function Is(S){if(typeof S=="string")return{buffer:we(S),C:!1};if(Array.isArray(S))return{buffer:new Uint8Array(S),C:!1};if(S.constructor===Uint8Array)return{buffer:S,C:!1};if(S.constructor===ArrayBuffer)return{buffer:new Uint8Array(S),C:!1};if(S.constructor===wt)return{buffer:sn(S)||J(),C:!0};if(S instanceof Uint8Array)return{buffer:new Uint8Array(S.buffer,S.byteOffset,S.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function _u(S,I){this.i=null,this.m=!1,this.h=this.j=this.l=0,il(this,S,I)}function il(S,I,E){E=E===void 0?{}:E,S.S=E.S===void 0?!1:E.S,I&&(I=Is(I),S.i=I.buffer,S.m=I.C,S.l=0,S.j=S.i.length,S.h=S.l)}_u.prototype.reset=function(){this.h=this.l};function Ts(S,I){if(S.h=I,I>S.j)throw an(S.j,I)}function va(S){var I=S.i,E=S.h,D=I[E++],z=D&127;if(D&128&&(D=I[E++],z|=(D&127)<<7,D&128&&(D=I[E++],z|=(D&127)<<14,D&128&&(D=I[E++],z|=(D&127)<<21,D&128&&(D=I[E++],z|=D<<28,D&128&&I[E++]&128&&I[E++]&128&&I[E++]&128&&I[E++]&128&&I[E++]&128)))))throw rn();return Ts(S,E),z}function yi(S,I){if(0>I)throw Error("Tried to read a negative byte length: "+I);var E=S.h,D=E+I;if(D>S.j)throw an(I,S.j-E);return S.h=D,E}var $u=[];function io(){this.h=[]}io.prototype.length=function(){return this.h.length},io.prototype.end=function(){var S=this.h;return this.h=[],S};function Lo(S,I,E){for(;0<E||127<I;)S.h.push(I&127|128),I=(I>>>7|E<<25)>>>0,E>>>=7;S.h.push(I)}function Es(S,I){for(;127<I;)S.h.push(I&127|128),I>>>=7;S.h.push(I)}function me(S,I){if($u.length){var E=$u.pop();il(E,S,I),S=E}else S=new _u(S,I);this.h=S,this.j=this.h.h,this.i=this.l=-1,this.setOptions(I)}me.prototype.setOptions=function(S){S=S===void 0?{}:S,this.ca=S.ca===void 0?!1:S.ca},me.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function $e(S){var I=S.h;if(I.h==I.j)return!1;S.j=S.h.h;var E=va(S.h)>>>0;if(I=E>>>3,E&=7,!(0<=E&&5>=E))throw It(E,S.j);if(1>I)throw Error("Invalid field number: "+I+" (at position "+S.j+")");return S.l=I,S.i=E,!0}function Qe(S){switch(S.i){case 0:if(S.i!=0)Qe(S);else e:{S=S.h;for(var I=S.h,E=I+10,D=S.i;I<E;)if(!(D[I++]&128)){Ts(S,I);break e}throw rn()}break;case 1:S=S.h,Ts(S,S.h+8);break;case 2:S.i!=2?Qe(S):(I=va(S.h)>>>0,S=S.h,Ts(S,S.h+I));break;case 5:S=S.h,Ts(S,S.h+4);break;case 3:I=S.l;do{if(!$e(S))throw Error("Unmatched start-group tag: stream EOF");if(S.i==4){if(S.l!=I)throw Error("Unmatched end-group tag");break}Qe(S)}while(!0);break;default:throw It(S.i,S.j)}}var Oe=[];function on(){this.j=[],this.i=0,this.h=new io}function Wt(S,I){I.length!==0&&(S.j.push(I),S.i+=I.length)}function mt(S,I){if(I=I.R){Wt(S,S.h.end());for(var E=0;E<I.length;E++)Wt(S,sn(I[E])||J())}}var et=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function ln(S,I){return et?S[et]|=I:S.A!==void 0?S.A|=I:(Object.defineProperties(S,{A:{value:I,configurable:!0,writable:!0,enumerable:!1}}),I)}function ea(S,I){et?S[et]&&(S[et]&=~I):S.A!==void 0&&(S.A&=~I)}function Qt(S){var I;return et?I=S[et]:I=S.A,I??0}function xa(S,I){et?S[et]=I:S.A!==void 0?S.A=I:Object.defineProperties(S,{A:{value:I,configurable:!0,writable:!0,enumerable:!1}})}function vi(S){return ln(S,1),S}function vd(S,I){xa(I,(S|0)&-51)}function Zn(S,I){xa(I,(S|18)&-41)}var As={};function xi(S){return S!==null&&typeof S=="object"&&!Array.isArray(S)&&S.constructor===Object}var ku,xd=[];xa(xd,23),ku=Object.freeze(xd);function om(S){if(Qt(S.o)&2)throw Error("Cannot mutate an immutable Message")}function im(S){var I=S.length;(I=I?S[I-1]:void 0)&&xi(I)?I.g=1:(I={},S.push((I.g=1,I)))}function yb(S){var I=S.i+S.G;return S.B||(S.B=S.o[I]={})}function zr(S,I){return I===-1?null:I>=S.i?S.B?S.B[I]:void 0:S.o[I+S.G]}function Ps(S,I,E,D){om(S),Nu(S,I,E,D)}function Nu(S,I,E,D){S.j&&(S.j=void 0),I>=S.i||D?yb(S)[I]=E:(S.o[I+S.G]=E,(S=S.B)&&I in S&&delete S[I])}function bd(S,I,E,D){var z=zr(S,I);Array.isArray(z)||(z=ku);var q=Qt(z);if(q&1||vi(z),D)q&2||ln(z,2),E&1||Object.freeze(z);else{D=!(E&2);var W=q&2;E&1||!W?D&&q&16&&!W&&ea(z,16):(z=vi(Array.prototype.slice.call(z)),Nu(S,I,z))}return z}function lm(S,I){var E=zr(S,I),D=E==null?E:typeof E=="number"||E==="NaN"||E==="Infinity"||E==="-Infinity"?Number(E):void 0;return D!=null&&D!==E&&Nu(S,I,D),D}function wd(S,I,E,D,z){S.h||(S.h={});var q=S.h[E],W=bd(S,E,3,z);if(!q){var Z=W;q=[];var fe=!!(Qt(S.o)&16);W=!!(Qt(Z)&2);var Ce=Z;!z&&W&&(Z=Array.prototype.slice.call(Z));for(var je=W,it=0;it<Z.length;it++){var Je=Z[it],Ue=I,lt=!1;if(lt=lt===void 0?!1:lt,Je=Array.isArray(Je)?new Ue(Je):lt?new Ue:void 0,Je!==void 0){Ue=Je.o;var kt=lt=Qt(Ue);W&&(kt|=2),fe&&(kt|=16),kt!=lt&&xa(Ue,kt),Ue=kt,je=je||!!(2&Ue),q.push(Je)}}return S.h[E]=q,fe=Qt(Z),I=fe|33,I=je?I&-9:I|8,fe!=I&&(je=Z,Object.isFrozen(je)&&(je=Array.prototype.slice.call(je)),xa(je,I),Z=je),Ce!==Z&&Nu(S,E,Z),(z||D&&W)&&ln(q,2),D&&Object.freeze(q),q}return z||(z=Object.isFrozen(q),D&&!z?Object.freeze(q):!D&&z&&(q=Array.prototype.slice.call(q),S.h[E]=q)),q}function um(S,I,E){var D=!!(Qt(S.o)&2);if(I=wd(S,I,E,D,D),S=bd(S,E,3,D),!(D||Qt(S)&8)){for(D=0;D<I.length;D++){if(E=I[D],Qt(E.o)&2){var z=fm(E,!1);z.j=E}else z=E;E!==z&&(I[D]=z,S[D]=z.o)}ln(S,8)}return I}function Os(S,I,E){if(E!=null&&typeof E!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof E+": "+E);Ps(S,I,E)}function vb(S,I,E,D,z){om(S);var q=wd(S,E,I,!1,!1);return E=D??new E,S=bd(S,I,2,!1),z!=null?(q.splice(z,0,E),S.splice(z,0,E.o)):(q.push(E),S.push(E.o)),E.C()&&ea(S,8),E}function lo(S,I){return S??I}function ja(S,I,E){return E=E===void 0?0:E,lo(lm(S,I),E)}var Sd;function zC(S){switch(typeof S){case"number":return isFinite(S)?S:String(S);case"object":if(S)if(Array.isArray(S)){if(Qt(S)&128)return S=Array.prototype.slice.call(S),im(S),S}else{if(ce&&S!=null&&S instanceof Uint8Array)return ge(S);if(S instanceof wt){var I=S.V;return I==null?"":typeof I=="string"?I:S.V=ge(I)}}}return S}function xb(S,I,E,D){if(S!=null){if(Array.isArray(S))S=cm(S,I,E,D!==void 0);else if(xi(S)){var z={},q;for(q in S)z[q]=xb(S[q],I,E,D);S=z}else S=I(S,D);return S}}function cm(S,I,E,D){var z=Qt(S);D=D?!!(z&16):void 0,S=Array.prototype.slice.call(S);for(var q=0;q<S.length;q++)S[q]=xb(S[q],I,E,D);return E(z,S),S}function bb(S){return S.ja===As?S.toJSON():zC(S)}function wb(S,I){S&128&&im(I)}function Sb(S,I,E){if(E=E===void 0?Zn:E,S!=null){if(ce&&S instanceof Uint8Array)return S.length?new wt(new Uint8Array(S),ae):Vt();if(Array.isArray(S)){var D=Qt(S);return D&2?S:I&&!(D&32)&&(D&16||D===0)?(xa(S,D|2),S):(S=cm(S,Sb,D&4?Zn:E,!0),I=Qt(S),I&4&&I&2&&Object.freeze(S),S)}return S.ja===As?dm(S):S}}function Cb(S,I,E,D,z,q,W){if(S=S.h&&S.h[E]){if(D=Qt(S),D&2?D=S:(q=te(S,dm),Zn(D,q),Object.freeze(q),D=q),om(I),W=D==null?ku:vi([]),D!=null){for(q=!!D.length,S=0;S<D.length;S++){var Z=D[S];q=q&&!(Qt(Z.o)&2),W[S]=Z.o}q=(q?8:0)|1,S=Qt(W),(S&q)!==q&&(Object.isFrozen(W)&&(W=Array.prototype.slice.call(W)),xa(W,S|q)),I.h||(I.h={}),I.h[E]=D}else I.h&&(I.h[E]=void 0);Nu(I,E,W,z)}else Ps(I,E,Sb(D,q,W),z)}function dm(S){return Qt(S.o)&2||(S=fm(S,!0),ln(S.o,2)),S}function fm(S,I){var E=S.o,D=[];ln(D,16);var z=S.constructor.h;if(z&&D.push(z),z=S.B,z){D.length=E.length,D.fill(void 0,D.length,E.length);var q={};D[D.length-1]=q}Qt(E)&128&&im(D),I=I||S.C()?Zn:vd,q=S.constructor,Sd=D,D=new q(D),Sd=void 0,S.R&&(D.R=S.R.slice()),q=!!(Qt(E)&16);for(var W=z?E.length-1:E.length,Z=0;Z<W;Z++)Cb(S,D,Z-S.G,E[Z],!1,q,I);if(z)for(var fe in z)Cb(S,D,+fe,z[fe],!0,q,I);return D}function ta(S,I,E){S==null&&(S=Sd),Sd=void 0;var D=this.constructor.i||0,z=0<D,q=this.constructor.h,W=!1;if(S==null){S=q?[q]:[];var Z=48,fe=!0;z&&(D=0,Z|=128),xa(S,Z)}else{if(!Array.isArray(S)||q&&q!==S[0])throw Error();var Ce=Z=ln(S,0);if((fe=(16&Ce)!==0)&&((W=(32&Ce)!==0)||(Ce|=32)),z){if(128&Ce)D=0;else if(0<S.length){var je=S[S.length-1];if(xi(je)&&"g"in je){D=0,Ce|=128,delete je.g;var it=!0,Je;for(Je in je){it=!1;break}it&&S.pop()}}}else if(128&Ce)throw Error();Z!==Ce&&xa(S,Ce)}this.G=(q?0:-1)-D,this.h=void 0,this.o=S;e:{if(q=this.o.length,D=q-1,q&&(q=this.o[D],xi(q))){this.B=q,this.i=D-this.G;break e}I!==void 0&&-1<I?(this.i=Math.max(I,D+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!z&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(E){I=fe&&!W&&!0,z=this.i;var Ue;for(fe=0;fe<E.length;fe++)W=E[fe],W<z?(W+=this.G,(D=S[W])?_b(D,I):S[W]=ku):(Ue||(Ue=yb(this)),(D=Ue[W])?_b(D,I):Ue[W]=ku)}}ta.prototype.toJSON=function(){return cm(this.o,bb,wb)},ta.prototype.C=function(){return!!(Qt(this.o)&2)};function _b(S,I){if(Array.isArray(S)){var E=Qt(S),D=1;!I||E&2||(D|=16),(E&D)!==D&&xa(S,E|D)}}ta.prototype.ja=As,ta.prototype.toString=function(){return this.o.toString()};function $b(S,I,E){if(E){var D={},z;for(z in E){var q=E[z],W=q.ra;W||(D.J=q.xa||q.oa.W,q.ia?(D.aa=mm(q.ia),W=function(Z){return function(fe,Ce,je){return Z.J(fe,Ce,je,Z.aa)}}(D)):q.ka?(D.Z=$d(q.da.P,q.ka),W=function(Z){return function(fe,Ce,je){return Z.J(fe,Ce,je,Z.Z)}}(D)):W=D.J,q.ra=W),W(I,S,q.da),D={J:D.J,aa:D.aa,Z:D.Z}}}mt(I,S)}var Cd=Symbol();function hm(S,I,E){return S[Cd]||(S[Cd]=function(D,z){return I(D,z,E)})}function Iu(S){var I=S[Cd];if(!I){var E=ot(S);I=function(D,z){return dt(D,z,E)},S[Cd]=I}return I}function kb(S){var I=S.ia;if(I)return Iu(I);if(I=S.wa)return hm(S.da.P,I,S.ka)}function Nb(S){var I=kb(S),E=S.da,D=S.oa.U;return I?function(z,q){return D(z,q,E,I)}:function(z,q){return D(z,q,E)}}function pm(S,I){var E=S[I];return typeof E=="function"&&E.length===0&&(E=E(),S[I]=E),Array.isArray(E)&&(Eu in E||Bo in E||0<E.length&&typeof E[0]=="function")?E:void 0}function _d(S,I,E,D,z,q){I.P=S[0];var W=1;if(S.length>W&&typeof S[W]!="number"){var Z=S[W++];E(I,Z)}for(;W<S.length;){E=S[W++];for(var fe=W+1;fe<S.length&&typeof S[fe]!="number";)fe++;switch(Z=S[W++],fe-=W,fe){case 0:D(I,E,Z);break;case 1:(fe=pm(S,W))?(W++,z(I,E,Z,fe)):D(I,E,Z,S[W++]);break;case 2:fe=W++,fe=pm(S,fe),z(I,E,Z,fe,S[W++]);break;case 3:q(I,E,Z,S[W++],S[W++],S[W++]);break;case 4:q(I,E,Z,S[W++],S[W++],S[W++],S[W++]);break;default:throw Error("unexpected number of binary field arguments: "+fe)}}return I}var Tu=Symbol();function mm(S){var I=S[Tu];if(!I){var E=ll(S);I=function(D,z){return ze(D,z,E)},S[Tu]=I}return I}function $d(S,I){var E=S[Tu];return E||(E=function(D,z){return $b(D,z,I)},S[Tu]=E),E}var Bo=Symbol();function kd(S,I){S.push(I)}function Nd(S,I,E){S.push(I,E.W)}function Ib(S,I,E,D){var z=mm(D),q=ll(D).P,W=E.W;S.push(I,function(Z,fe,Ce){return W(Z,fe,Ce,q,z)})}function Id(S,I,E,D,z,q){var W=$d(D,q),Z=E.W;S.push(I,function(fe,Ce,je){return Z(fe,Ce,je,D,W)})}function ll(S){var I=S[Bo];return I||(I=_d(S,S[Bo]=[],kd,Nd,Ib,Id),Eu in S&&Bo in S&&(S.length=0),I)}var Eu=Symbol();function G(S,I){S[0]=I}function ie(S,I,E,D){var z=E.U;S[I]=D?function(q,W,Z){return z(q,W,Z,D)}:z}function Ie(S,I,E,D,z){var q=E.U,W=Iu(D),Z=ot(D).P;S[I]=function(fe,Ce,je){return q(fe,Ce,je,Z,W,z)}}function tt(S,I,E,D,z,q,W){var Z=E.U,fe=hm(D,z,q);S[I]=function(Ce,je,it){return Z(Ce,je,it,D,fe,W)}}function ot(S){var I=S[Eu];return I||(I=_d(S,S[Eu]={},G,ie,Ie,tt),Eu in S&&Bo in S&&(S.length=0),I)}function dt(S,I,E){for(;$e(I)&&I.i!=4;){var D=I.l,z=E[D];if(!z){var q=E[0];q&&(q=q[D])&&(z=E[D]=Nb(q))}if(!z||!z(I,S,D)){z=I,D=S,q=z.j,Qe(z);var W=z;if(!W.ca){if(z=W.h.h-q,W.h.h=q,W=W.h,z==0)z=Vt();else{if(q=yi(W,z),W.S&&W.m)z=W.i.subarray(q,q+z);else{W=W.i;var Z=q;z=q+z,z=Z===z?J():U?W.slice(Z,z):new Uint8Array(W.subarray(Z,z))}z=z.length==0?Vt():new wt(z,ae)}(q=D.R)?q.push(z):D.R=[z]}}}return S}function ze(S,I,E){for(var D=E.length,z=D%2==1,q=z?1:0;q<D;q+=2)(0,E[q+1])(I,S,E[q]);$b(S,I,z?E[0]:void 0)}function qe(S,I){return{U:S,W:I}}var Et=qe(function(S,I,E){if(S.i!==5)return!1;S=S.h;var D=S.i,z=S.h,q=D[z],W=D[z+1],Z=D[z+2];return D=D[z+3],Ts(S,S.h+4),W=(q<<0|W<<8|Z<<16|D<<24)>>>0,S=2*(W>>31)+1,q=W>>>23&255,W&=8388607,Ps(I,E,q==255?W?NaN:1/0*S:q==0?S*Math.pow(2,-149)*W:S*Math.pow(2,q-150)*(W+Math.pow(2,23))),!0},function(S,I,E){if(I=lm(I,E),I!=null){Es(S.h,8*E+5),S=S.h;var D=+I;D===0?0<1/D?oe=ye=0:(ye=0,oe=2147483648):isNaN(D)?(ye=0,oe=2147483647):(D=(E=0>D?-2147483648:0)?-D:D,34028234663852886e22<D?(ye=0,oe=(E|2139095040)>>>0):11754943508222875e-54>D?(D=Math.round(D/Math.pow(2,-149)),ye=0,oe=(E|D)>>>0):(I=Math.floor(Math.log(D)/Math.LN2),D*=Math.pow(2,-I),D=Math.round(8388608*D),16777216<=D&&++I,ye=0,oe=(E|I+127<<23|D&8388607)>>>0)),E=oe,S.h.push(E>>>0&255),S.h.push(E>>>8&255),S.h.push(E>>>16&255),S.h.push(E>>>24&255)}}),ba=qe(function(S,I,E){if(S.i!==0)return!1;var D=S.h,z=0,q=S=0,W=D.i,Z=D.h;do{var fe=W[Z++];z|=(fe&127)<<q,q+=7}while(32>q&&fe&128);for(32<q&&(S|=(fe&127)>>4),q=3;32>q&&fe&128;q+=7)fe=W[Z++],S|=(fe&127)<<q;if(Ts(D,Z),128>fe)D=z>>>0,fe=S>>>0,(S=fe&2147483648)&&(D=~D+1>>>0,fe=~fe>>>0,D==0&&(fe=fe+1>>>0)),D=4294967296*fe+(D>>>0);else throw rn();return Ps(I,E,S?-D:D),!0},function(S,I,E){I=zr(I,E),I!=null&&(typeof I=="string"&&Ye(I),I!=null&&(Es(S.h,8*E),typeof I=="number"?(S=S.h,be(I),Lo(S,oe,ye)):(E=Ye(I),Lo(S.h,E.i,E.h))))}),uo=qe(function(S,I,E){return S.i!==0?!1:(Ps(I,E,va(S.h)),!0)},function(S,I,E){if(I=zr(I,E),I!=null&&I!=null)if(Es(S.h,8*E),S=S.h,E=I,0<=E)Es(S,E);else{for(I=0;9>I;I++)S.h.push(E&127|128),E>>=7;S.h.push(1)}}),gm=qe(function(S,I,E){if(S.i!==2)return!1;var D=va(S.h)>>>0;S=S.h;var z=yi(S,D);if(S=S.i,st){var q=S,W;(W=Te)||(W=Te=new TextDecoder("utf-8",{fatal:!0})),S=z+D,q=z===0&&S===q.length?q:q.subarray(z,S);try{var Z=W.decode(q)}catch(it){if(Zr===void 0){try{W.decode(new Uint8Array([128]))}catch{}try{W.decode(new Uint8Array([97])),Zr=!0}catch{Zr=!1}}throw!Zr&&(Te=void 0),it}}else{Z=z,D=Z+D,z=[];for(var fe=null,Ce,je;Z<D;)Ce=S[Z++],128>Ce?z.push(Ce):224>Ce?Z>=D?ar():(je=S[Z++],194>Ce||(je&192)!==128?(Z--,ar()):z.push((Ce&31)<<6|je&63)):240>Ce?Z>=D-1?ar():(je=S[Z++],(je&192)!==128||Ce===224&&160>je||Ce===237&&160<=je||((q=S[Z++])&192)!==128?(Z--,ar()):z.push((Ce&15)<<12|(je&63)<<6|q&63)):244>=Ce?Z>=D-2?ar():(je=S[Z++],(je&192)!==128||(Ce<<28)+(je-144)>>30||((q=S[Z++])&192)!==128||((W=S[Z++])&192)!==128?(Z--,ar()):(Ce=(Ce&7)<<18|(je&63)<<12|(q&63)<<6|W&63,Ce-=65536,z.push((Ce>>10&1023)+55296,(Ce&1023)+56320))):ar(),8192<=z.length&&(fe=Nr(fe,z),z.length=0);Z=Nr(fe,z)}return Ps(I,E,Z),!0},function(S,I,E){if(I=zr(I,E),I!=null){var D=!1;if(D=D===void 0?!1:D,$n){if(D&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(I))throw Error("Found an unpaired surrogate");I=(pt||(pt=new TextEncoder)).encode(I)}else{for(var z=0,q=new Uint8Array(3*I.length),W=0;W<I.length;W++){var Z=I.charCodeAt(W);if(128>Z)q[z++]=Z;else{if(2048>Z)q[z++]=Z>>6|192;else{if(55296<=Z&&57343>=Z){if(56319>=Z&&W<I.length){var fe=I.charCodeAt(++W);if(56320<=fe&&57343>=fe){Z=1024*(Z-55296)+fe-56320+65536,q[z++]=Z>>18|240,q[z++]=Z>>12&63|128,q[z++]=Z>>6&63|128,q[z++]=Z&63|128;continue}else W--}if(D)throw Error("Found an unpaired surrogate");Z=65533}q[z++]=Z>>12|224,q[z++]=Z>>6&63|128}q[z++]=Z&63|128}}I=z===q.length?q:q.subarray(0,z)}Es(S.h,8*E+2),Es(S.h,I.length),Wt(S,S.h.end()),Wt(S,I)}}),Td=qe(function(S,I,E,D,z){if(S.i!==2)return!1;I=vb(I,E,D),E=S.h.j,D=va(S.h)>>>0;var q=S.h.h+D,W=q-E;if(0>=W&&(S.h.j=q,z(I,S,void 0,void 0,void 0),W=q-S.h.h),W)throw Error("Message parsing ended unexpectedly. Expected to read "+(D+" bytes, instead read "+(D-W)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return S.h.h=q,S.h.j=E,!0},function(S,I,E,D,z){if(I=um(I,D,E),I!=null)for(D=0;D<I.length;D++){var q=S;Es(q.h,8*E+2);var W=q.h.end();Wt(q,W),W.push(q.i),q=W,z(I[D],S),W=S;var Z=q.pop();for(Z=W.i+W.h.length()-Z;127<Z;)q.push(Z&127|128),Z>>>=7,W.i++;q.push(Z),W.i++}});function ym(S){return function(I,E){e:{if(Oe.length){var D=Oe.pop();D.setOptions(E),il(D.h,I,E),I=D}else I=new me(I,E);try{var z=ot(S),q=dt(new z.P,I,z);break e}finally{z=I.h,z.i=null,z.m=!1,z.l=0,z.j=0,z.h=0,z.S=!1,I.l=-1,I.i=-1,100>Oe.length&&Oe.push(I)}q=void 0}return q}}function Ir(S){return function(){var I=new on;ze(this,I,ll(S)),Wt(I,I.h.end());for(var E=new Uint8Array(I.i),D=I.j,z=D.length,q=0,W=0;W<z;W++){var Z=D[W];E.set(Z,q),q+=Z.length}return I.j=[E],E}}function ss(S){ta.call(this,S)}y(ss,ta);var vm=[ss,1,uo,2,Et,3,gm,4,gm];ss.prototype.l=Ir(vm);function UC(S){ta.call(this,S,-1,AJ)}y(UC,ta),UC.prototype.addClassification=function(S,I){return vb(this,1,ss,S,I),this};var AJ=[1],PJ=ym([UC,1,Td,vm]);function xm(S){ta.call(this,S)}y(xm,ta);var wR=[xm,1,Et,2,Et,3,Et,4,Et,5,Et];xm.prototype.l=Ir(wR);function SR(S){ta.call(this,S,-1,OJ)}y(SR,ta);var OJ=[1],RJ=ym([SR,1,Td,wR]);function Tb(S){ta.call(this,S)}y(Tb,ta);var CR=[Tb,1,Et,2,Et,3,Et,4,Et,5,Et,6,ba],DJ=ym(CR);Tb.prototype.l=Ir(CR);function _R(S,I,E){if(E=S.createShader(E===0?S.VERTEX_SHADER:S.FRAGMENT_SHADER),S.shaderSource(E,I),S.compileShader(E),!S.getShaderParameter(E,S.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+S.getShaderInfoLog(E));return E}function jJ(S){return um(S,ss,1).map(function(I){var E=zr(I,1);return{index:E??0,qa:ja(I,2),label:zr(I,3)!=null?lo(zr(I,3),""):void 0,displayName:zr(I,4)!=null?lo(zr(I,4),""):void 0}})}function MJ(S){return{x:ja(S,1),y:ja(S,2),z:ja(S,3),visibility:lm(S,4)!=null?ja(S,4):void 0}}function VC(S){return um(RJ(S),xm,1).map(MJ)}function WC(S,I){this.i=S,this.h=I,this.m=0}function $R(S,I,E){return FJ(S,I),typeof S.h.canvas.transferToImageBitmap=="function"?Promise.resolve(S.h.canvas.transferToImageBitmap()):E?Promise.resolve(S.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(S.h.canvas):(S.j===void 0&&(S.j=document.createElement("canvas")),new Promise(function(D){S.j.height=S.h.canvas.height,S.j.width=S.h.canvas.width,S.j.getContext("2d",{}).drawImage(S.h.canvas,0,0,S.h.canvas.width,S.h.canvas.height),D(S.j)}))}function FJ(S,I){var E=S.h;if(S.s===void 0){var D=_R(E,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),z=_R(E,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),q=E.createProgram();if(E.attachShader(q,D),E.attachShader(q,z),E.linkProgram(q),!E.getProgramParameter(q,E.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+E.getProgramInfoLog(q));D=S.s=q,E.useProgram(D),z=E.getUniformLocation(D,"sampler0"),S.l={O:E.getAttribLocation(D,"aVertex"),N:E.getAttribLocation(D,"aTex"),ya:z},S.v=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,S.v),E.enableVertexAttribArray(S.l.O),E.vertexAttribPointer(S.l.O,2,E.FLOAT,!1,0,0),E.bufferData(E.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),E.STATIC_DRAW),E.bindBuffer(E.ARRAY_BUFFER,null),S.u=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,S.u),E.enableVertexAttribArray(S.l.N),E.vertexAttribPointer(S.l.N,2,E.FLOAT,!1,0,0),E.bufferData(E.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),E.STATIC_DRAW),E.bindBuffer(E.ARRAY_BUFFER,null),E.uniform1i(z,0)}D=S.l,E.useProgram(S.s),E.canvas.width=I.width,E.canvas.height=I.height,E.viewport(0,0,I.width,I.height),E.activeTexture(E.TEXTURE0),S.i.bindTexture2d(I.glName),E.enableVertexAttribArray(D.O),E.bindBuffer(E.ARRAY_BUFFER,S.v),E.vertexAttribPointer(D.O,2,E.FLOAT,!1,0,0),E.enableVertexAttribArray(D.N),E.bindBuffer(E.ARRAY_BUFFER,S.u),E.vertexAttribPointer(D.N,2,E.FLOAT,!1,0,0),E.bindFramebuffer(E.DRAW_FRAMEBUFFER?E.DRAW_FRAMEBUFFER:E.FRAMEBUFFER,null),E.clearColor(0,0,0,0),E.clear(E.COLOR_BUFFER_BIT),E.colorMask(!0,!0,!0,!0),E.drawArrays(E.TRIANGLE_FAN,0,4),E.disableVertexAttribArray(D.O),E.disableVertexAttribArray(D.N),E.bindBuffer(E.ARRAY_BUFFER,null),S.i.bindTexture2d(0)}function LJ(S){this.h=S}var BJ=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function zJ(S,I){return I+S}function kR(S,I){window[S]=I}function UJ(S){var I=document.createElement("script");return I.setAttribute("src",S),I.setAttribute("crossorigin","anonymous"),new Promise(function(E){I.addEventListener("load",function(){E()},!1),I.addEventListener("error",function(){E()},!1),document.body.appendChild(I)})}function VJ(){return O(function(S){switch(S.h){case 1:return S.s=2,w(S,WebAssembly.instantiate(BJ),4);case 4:S.h=3,S.s=0;break;case 2:return S.s=0,S.l=null,S.return(!1);case 3:return S.return(!0)}})}function GC(S){if(this.h=S,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=S&&S.locateFile||zJ,typeof window=="object")var I=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")I=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=I,S.options){I=i(Object.keys(S.options));for(var E=I.next();!E.done;E=I.next()){E=E.value;var D=S.options[E].default;D!==void 0&&(this.l[E]=typeof D=="function"?D():D)}}}t=GC.prototype,t.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function WJ(S){var I,E,D,z,q,W,Z,fe,Ce,je,it;return O(function(Je){switch(Je.h){case 1:return S.ga?(I=S.h.files===void 0?[]:typeof S.h.files=="function"?S.h.files(S.l):S.h.files,w(Je,VJ(),2)):Je.return();case 2:if(E=Je.i,typeof window=="object")return kR("createMediapipeSolutionsWasm",{locateFile:S.locateFile}),kR("createMediapipeSolutionsPackedAssets",{locateFile:S.locateFile}),W=I.filter(function(Ue){return Ue.data!==void 0}),Z=I.filter(function(Ue){return Ue.data===void 0}),fe=Promise.all(W.map(function(Ue){var lt=Eb(S,Ue.url);if(Ue.path!==void 0){var kt=Ue.path;lt=lt.then(function(Dn){return S.overrideFile(kt,Dn),Promise.resolve(Dn)})}return lt})),Ce=Promise.all(Z.map(function(Ue){return Ue.simd===void 0||Ue.simd&&E||!Ue.simd&&!E?UJ(S.locateFile(Ue.url,S.ha)):Promise.resolve()})).then(function(){var Ue,lt,kt;return O(function(Dn){if(Dn.h==1)return Ue=window.createMediapipeSolutionsWasm,lt=window.createMediapipeSolutionsPackedAssets,kt=S,w(Dn,Ue(lt),2);kt.i=Dn.i,Dn.h=0})}),je=function(){return O(function(Ue){return S.h.graph&&S.h.graph.url?Ue=w(Ue,Eb(S,S.h.graph.url),0):(Ue.h=0,Ue=void 0),Ue})}(),w(Je,Promise.all([Ce,fe,je]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return D=I.filter(function(Ue){return Ue.simd===void 0||Ue.simd&&E||!Ue.simd&&!E}).map(function(Ue){return S.locateFile(Ue.url,S.ha)}),importScripts.apply(null,l(D)),z=S,w(Je,createMediapipeSolutionsWasm(Module),6);case 6:z.i=Je.i,S.m=new OffscreenCanvas(1,1),S.i.canvas=S.m,q=S.i.GL.createContext(S.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),S.i.GL.makeContextCurrent(q),Je.h=4;break;case 7:if(S.m=document.createElement("canvas"),it=S.m.getContext("webgl2",{}),!it&&(it=S.m.getContext("webgl",{}),!it))return alert("Failed to create WebGL canvas context when passing video frame."),Je.return();S.K=it,S.i.canvas=S.m,S.i.createContext(S.m,!0,!0,{});case 4:S.j=new S.i.SolutionWasm,S.ga=!1,Je.h=0}})}function GJ(S){var I,E,D,z,q,W,Z,fe;return O(function(Ce){if(Ce.h==1){if(S.h.graph&&S.h.graph.url&&S.fa===S.h.graph.url)return Ce.return();if(S.u=!0,!S.h.graph||!S.h.graph.url){Ce.h=2;return}return S.fa=S.h.graph.url,w(Ce,Eb(S,S.h.graph.url),3)}for(Ce.h!=2&&(I=Ce.i,S.j.loadGraph(I)),E=i(Object.keys(S.D)),D=E.next();!D.done;D=E.next())z=D.value,S.j.overrideFile(z,S.D[z]);if(S.D={},S.h.listeners)for(q=i(S.h.listeners),W=q.next();!W.done;W=q.next())Z=W.value,XJ(S,Z);fe=S.l,S.l={},S.setOptions(fe),Ce.h=0})}t.reset=function(){var S=this;return O(function(I){S.j&&(S.j.reset(),S.s={},S.v={}),I.h=0})},t.setOptions=function(S,I){var E=this;if(I=I||this.h.options){for(var D=[],z=[],q={},W=i(Object.keys(S)),Z=W.next();!Z.done;q={X:q.X,Y:q.Y},Z=W.next())if(Z=Z.value,!(Z in this.l&&this.l[Z]===S[Z])){this.l[Z]=S[Z];var fe=I[Z];fe!==void 0&&(fe.onChange&&(q.X=fe.onChange,q.Y=S[Z],D.push(function(Ce){return function(){var je;return O(function(it){if(it.h==1)return w(it,Ce.X(Ce.Y),2);je=it.i,je===!0&&(E.u=!0),it.h=0})}}(q))),fe.graphOptionXref&&(Z=Object.assign({},{calculatorName:"",calculatorIndex:0},fe.graphOptionXref,{valueNumber:fe.type===1?S[Z]:0,valueBoolean:fe.type===0?S[Z]:!1,valueString:fe.type===2?S[Z]:""}),z.push(Z)))}(D.length!==0||z.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(z),this.F=(this.F===void 0?[]:this.F).concat(D))}};function HJ(S){var I,E,D,z,q,W,Z;return O(function(fe){switch(fe.h){case 1:if(!S.u)return fe.return();if(!S.F){fe.h=2;break}I=i(S.F),E=I.next();case 3:if(E.done){fe.h=5;break}return D=E.value,w(fe,D(),4);case 4:E=I.next(),fe.h=3;break;case 5:S.F=void 0;case 2:if(S.H){for(z=new S.i.GraphOptionChangeRequestList,q=i(S.H),W=q.next();!W.done;W=q.next())Z=W.value,z.push_back(Z);S.j.changeOptions(z),z.delete(),S.H=void 0}S.u=!1,fe.h=0}})}t.initialize=function(){var S=this;return O(function(I){return I.h==1?w(I,WJ(S),2):I.h!=3?w(I,GJ(S),3):w(I,HJ(S),0)})};function Eb(S,I){var E,D;return O(function(z){return I in S.L?z.return(S.L[I]):(E=S.locateFile(I,""),D=fetch(E).then(function(q){return q.arrayBuffer()}),S.L[I]=D,z.return(D))})}t.overrideFile=function(S,I){this.j?this.j.overrideFile(S,I):this.D[S]=I},t.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},t.send=function(S,I){var E=this,D,z,q,W,Z,fe,Ce,je,it;return O(function(Je){switch(Je.h){case 1:return E.h.inputs?(D=1e3*(I??performance.now()),w(Je,E.I,2)):Je.return();case 2:return w(Je,E.initialize(),3);case 3:for(z=new E.i.PacketDataList,q=i(Object.keys(S)),W=q.next();!W.done;W=q.next())if(Z=W.value,fe=E.h.inputs[Z]){e:{var Ue=S[Z];switch(fe.type){case"video":var lt=E.s[fe.stream];if(lt||(lt=new WC(E.i,E.K),E.s[fe.stream]=lt),lt.m===0&&(lt.m=lt.i.createTexture()),typeof HTMLVideoElement<"u"&&Ue instanceof HTMLVideoElement)var kt=Ue.videoWidth,Dn=Ue.videoHeight;else typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement?(kt=Ue.naturalWidth,Dn=Ue.naturalHeight):(kt=Ue.width,Dn=Ue.height);Dn={glName:lt.m,width:kt,height:Dn},kt=lt.h,kt.canvas.width=Dn.width,kt.canvas.height=Dn.height,kt.activeTexture(kt.TEXTURE0),lt.i.bindTexture2d(lt.m),kt.texImage2D(kt.TEXTURE_2D,0,kt.RGBA,kt.RGBA,kt.UNSIGNED_BYTE,Ue),lt.i.bindTexture2d(0),lt=Dn;break e;case"detections":for(lt=E.s[fe.stream],lt||(lt=new LJ(E.i),E.s[fe.stream]=lt),lt.data||(lt.data=new lt.h.DetectionListData),lt.data.reset(Ue.length),Dn=0;Dn<Ue.length;++Dn){kt=Ue[Dn];var kn=lt.data,Ur=kn.setBoundingBox,Rs=Dn,Ma=kt.la,Gt=new Tb;if(Os(Gt,1,Ma.sa),Os(Gt,2,Ma.ta),Os(Gt,3,Ma.height),Os(Gt,4,Ma.width),Os(Gt,5,Ma.rotation),Ps(Gt,6,Ma.pa),Ma=Gt.l(),Ur.call(kn,Rs,Ma),kt.ea)for(kn=0;kn<kt.ea.length;++kn){Gt=kt.ea[kn],Ur=lt.data,Rs=Ur.addNormalizedLandmark,Ma=Dn,Gt=Object.assign({},Gt,{visibility:Gt.visibility?Gt.visibility:0});var Vr=new xm;Os(Vr,1,Gt.x),Os(Vr,2,Gt.y),Os(Vr,3,Gt.z),Gt.visibility&&Os(Vr,4,Gt.visibility),Gt=Vr.l(),Rs.call(Ur,Ma,Gt)}if(kt.ba)for(kn=0;kn<kt.ba.length;++kn)Ur=lt.data,Rs=Ur.addClassification,Ma=Dn,Gt=kt.ba[kn],Vr=new ss,Os(Vr,2,Gt.qa),Gt.index&&Ps(Vr,1,Gt.index),Gt.label&&Ps(Vr,3,Gt.label),Gt.displayName&&Ps(Vr,4,Gt.displayName),Gt=Vr.l(),Rs.call(Ur,Ma,Gt)}lt=lt.data;break e;default:lt={}}}switch(Ce=lt,je=fe.stream,fe.type){case"video":z.pushTexture2d(Object.assign({},Ce,{stream:je,timestamp:D}));break;case"detections":it=Ce,it.stream=je,it.timestamp=D,z.pushDetectionList(it);break;default:throw Error("Unknown input config type: '"+fe.type+"'")}}return E.j.send(z),w(Je,E.I,4);case 4:z.delete(),Je.h=0}})};function qJ(S,I,E){var D,z,q,W,Z,fe,Ce,je,it,Je,Ue,lt,kt,Dn;return O(function(kn){switch(kn.h){case 1:if(!E)return kn.return(I);for(D={},z=0,q=i(Object.keys(E)),W=q.next();!W.done;W=q.next())Z=W.value,fe=E[Z],typeof fe!="string"&&fe.type==="texture"&&I[fe.stream]!==void 0&&++z;1<z&&(S.M=!1),Ce=i(Object.keys(E)),W=Ce.next();case 2:if(W.done){kn.h=4;break}if(je=W.value,it=E[je],typeof it=="string")return kt=D,Dn=je,w(kn,KJ(S,je,I[it]),14);if(Je=I[it.stream],it.type==="detection_list"){if(Je){for(var Ur=Je.getRectList(),Rs=Je.getLandmarksList(),Ma=Je.getClassificationsList(),Gt=[],Vr=0;Vr<Ur.size();++Vr){var ul=DJ(Ur.get(Vr)),YJ=ja(ul,1),QJ=ja(ul,2),JJ=ja(ul,3),ZJ=ja(ul,4),eZ=ja(ul,5,0),Ab=void 0;Ab=Ab===void 0?0:Ab,ul={la:{sa:YJ,ta:QJ,height:JJ,width:ZJ,rotation:eZ,pa:lo(zr(ul,6),Ab)},ea:VC(Rs.get(Vr)),ba:jJ(PJ(Ma.get(Vr)))},Gt.push(ul)}Ur=Gt}else Ur=[];D[je]=Ur,kn.h=7;break}if(it.type==="proto_list"){if(Je){for(Ur=Array(Je.size()),Rs=0;Rs<Je.size();Rs++)Ur[Rs]=Je.get(Rs);Je.delete()}else Ur=[];D[je]=Ur,kn.h=7;break}if(Je===void 0){kn.h=3;break}if(it.type==="float_list"){D[je]=Je,kn.h=7;break}if(it.type==="proto"){D[je]=Je,kn.h=7;break}if(it.type!=="texture")throw Error("Unknown output config type: '"+it.type+"'");return Ue=S.v[je],Ue||(Ue=new WC(S.i,S.K),S.v[je]=Ue),w(kn,$R(Ue,Je,S.M),13);case 13:lt=kn.i,D[je]=lt;case 7:it.transform&&D[je]&&(D[je]=it.transform(D[je])),kn.h=3;break;case 14:kt[Dn]=kn.i;case 3:W=Ce.next(),kn.h=2;break;case 4:return kn.return(D)}})}function KJ(S,I,E){var D;return O(function(z){return typeof E=="number"||E instanceof Uint8Array||E instanceof S.i.Uint8BlobList?z.return(E):E instanceof S.i.Texture2dDataOut?(D=S.v[I],D||(D=new WC(S.i,S.K),S.v[I]=D),z.return($R(D,E,S.M))):z.return(void 0)})}function XJ(S,I){for(var E=I.name||"$",D=[].concat(l(I.wants)),z=new S.i.StringList,q=i(I.wants),W=q.next();!W.done;W=q.next())z.push_back(W.value);q=S.i.PacketListener.implement({onResults:function(Z){for(var fe={},Ce=0;Ce<I.wants.length;++Ce)fe[D[Ce]]=Z.get(Ce);var je=S.listeners[E];je&&(S.I=qJ(S,fe,I.outs).then(function(it){it=je(it);for(var Je=0;Je<I.wants.length;++Je){var Ue=fe[D[Je]];typeof Ue=="object"&&Ue.hasOwnProperty&&Ue.hasOwnProperty("delete")&&Ue.delete()}it&&(S.I=it)}))}}),S.j.attachMultiListener(z,q),z.delete()}t.onResults=function(S,I){this.listeners[I||"$"]=S},L("Solution",GC),L("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function NR(S){switch(S===void 0&&(S=0),S){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function IR(S){var I=this;S=S||{},this.h=new GC({locateFile:S.locateFile,files:function(E){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:NR(E.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:VC},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:VC},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(E){var D,z,q;return O(function(W){return W.h==1?(D=NR(E),z="third_party/mediapipe/modules/pose_landmark/"+D,w(W,Eb(I.h,D),2)):(q=W.i,I.h.overrideFile(z,q),W.return(!0))})}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}t=IR.prototype,t.reset=function(){this.h.reset()},t.close=function(){return this.h.close(),Promise.resolve()},t.onResults=function(S){this.h.onResults(S)},t.initialize=function(){var S=this;return O(function(I){return w(I,S.h.initialize(),0)})},t.send=function(S,I){var E=this;return O(function(D){return w(D,E.h.send(S,I),0)})},t.setOptions=function(S){this.h.setOptions(S)},L("Pose",IR),L("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),L("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),L("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),L("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),L("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),L("VERSION","0.5.1675469404")}).call(gn);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure=1e-7,Vre=1e-4;class xS{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class iv{refCount(e){return Fa("refCount")}incRef(e){return Fa("incRef")}timerAvailable(){return!0}time(e){return Fa("time")}read(e){return Fa("read")}readSync(e){return Fa("readSync")}readToGPU(e,n){return Fa("readToGPU")}numDataIds(){return Fa("numDataIds")}disposeData(e,n){return Fa("disposeData")}write(e,n,r){return Fa("write")}move(e,n,r,a,s){return Fa("move")}createTensorFromGPUData(e,n,r){return Fa("createTensorFromGPUData")}memory(){return Fa("memory")}floatPrecision(){return Fa("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ure:Vre}dispose(){return Fa("dispose")}}function Fa(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Ii(t,e,n)}function Wre(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,Ii(t,n,r),Ii(e,n,r)}function Kg(t,e,n){return Math.max(t,Math.min(e,n))}function bS(t){return t%2===0?t:t+1}function Ii(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function $E(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function Gre(t,e){const n=Math.random();return e*n+(1-n)*t}function Hre(t,e){let n=0;for(let r=0;r<t.length;r++){const a=Number(t[r])-Number(e[r]);n+=a*a}return n}function j(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function _r(t,e,n=""){j(Kt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Jc(t){j(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ne(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Mk(t){return t.length===0}function CV(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Kt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function kc(t){return t%1===0}function qre(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Ew(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Kre(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return SV(e),e}function fc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Fk(t,e=a=>0,n,r){return new Promise((a,s)=>{let o=0;const i=()=>{if(t()){a();return}o++;const l=e(o);if(n!=null&&o>=n){s();return}r!=null?r(i,l):setTimeout(i,l)};i()})}function wS(t,e){let n=1,r=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(t[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[r]=e/n,a}function Yt(t,e){const n=e.length;return t=t==null?e.map((r,a)=>a):[].concat(t),j(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),j(t.every(r=>kc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function Ji(t,e){const n=[],r=[],a=e!=null&&Array.isArray(e)&&e.length===0,s=e==null||a?null:Yt(e,t).sort();let o=0;for(let i=0;i<t.length;++i){if(s!=null){if(s[o]===i&&t[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${t[i]}' is not 1`);(s[o]==null||s[o]>i)&&t[i]===1&&(n.push(t[i]),r.push(i)),s[o]<=i&&o++}t[i]!==1&&(n.push(t[i]),r.push(i))}return{newShape:n,keptDims:r}}function Eo(t,e){return or(t,e)}function or(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function _V(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function $V(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function kE(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Nc(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function kV(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Ko(t){return typeof t=="string"||t instanceof String}function NV(t){return typeof t=="boolean"}function IV(t){return typeof t=="number"}function lu(t){return Array.isArray(t)?lu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":IV(t)?"float32":Ko(t)?"string":NV(t)?"bool":"float32"}function Ql(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Aw(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Dt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function TV(t,e,n,r=!1){const a=new Array;if(e.length===1){const s=e[0]*(r?2:1);for(let o=0;o<s;o++)a[o]=n[t+o]}else{const s=e[0],o=e.slice(1),i=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<s;l++)a[l]=TV(t+l*i,o,n,r)}return a}function hc(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((a,s)=>a*s)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return TV(0,t,e,n)}function V0(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function NE(t,e){const n=ai(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function ai(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function Xre(t,e){const n=t.reduce((r,a)=>r*a,1);if(e==null||e==="float32")return hc(t,new Float32Array(n));if(e==="int32")return hc(t,new Int32Array(n));if(e==="bool")return hc(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ns(t){t.forEach(e=>{j(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Pw(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function SS(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function Jl(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e3="tfjsflags";class EV{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Yre,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const a=this.urlFlags[e];ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Jl(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);e3 in e&&e[e3].split(",").forEach(r=>{const[a,s]=r.split(":");this.urlFlags[a]=Jre(a,s)})}}function Yre(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(Qre(e,r[0],r[1]),r.join("="))),e}function Qre(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Jre(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function ee(){return IE}let IE=null;function Zre(t){IE=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let __;function AV(){if(__==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");__=t}return __}function eae(){const t=AV();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function TE(t,e){const n=eae();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const lv="Abs",uv="Acos",cv="Acosh",Ah="Add",Ph="AddN",Oh="All",Rh="Any",dv="ArgMax",fv="ArgMin",hv="Asin",pv="Asinh",mv="Atan",gv="Atanh",yv="Atan2",Dh="AvgPool",CS="AvgPoolGrad",vv="AvgPool3D",_S="AvgPool3DGrad",jh="BatchMatMul",xv="BatchToSpaceND",Mh="Bincount",$S="BitwiseAnd",tae="BroadcastTo",bv="BroadcastArgs",Fh="Cast",wv="Ceil",Lh="ClipByValue",kS="Complex",NS="ComplexAbs",Sv="Concat",Bh="Conv2D",IS="Conv2DBackpropFilter",zh="Conv2DBackpropInput",Uh="Conv3D",Cv="Conv3DBackpropFilterV2",Vh="Conv3DBackpropInputV2",_v="Cos",$v="Cosh",Wh="Cumprod",Gh="Cumsum",Hh="CropAndResize",kv="DenseBincount",qh="DepthToSpace",Kh="DepthwiseConv2dNative",TS="DepthwiseConv2dNativeBackpropFilter",ES="DepthwiseConv2dNativeBackpropInput",Nv="Diag",Xh="Dilation2D",AS="Dilation2DBackpropInput",PS="Dilation2DBackpropFilter",OS="Draw",Iv="RealDiv",RS="Einsum",Tv="Elu",Ev="EluGrad",Av="Erf",Pv="Equal",Ov="Exp",Rv="ExpandDims",Dv="Expm1",DS="FFT",jv="Fill",Yh="FlipLeftRight",Mv="Floor",Fv="FloorDiv",Qh="FusedBatchNorm",Lv="GatherV2",Jh="GatherNd",Bv="Greater",zv="GreaterEqual",Zh="Identity",jS="IFFT",MS="Imag",Uv="IsFinite",Vv="IsInf",Wv="IsNan",ep="LeakyRelu",Gv="Less",Hv="LessEqual",tp="LinSpace",qv="Log",Kv="Log1p",Xv="LogicalAnd",Yv="LogicalNot",Qv="LogicalOr",PV="LogicalXor",nae="LogSoftmax",rae="LowerBound",np="LRN",Jv="LRNGrad",aae="MatrixBandPart",rp="Max",Zv="Maximum",ap="MaxPool",FS="MaxPoolGrad",ex="MaxPool3D",LS="MaxPool3DGrad",tx="MaxPoolWithArgmax",sp="Mean",op="Min",nx="Minimum",ip="MirrorPad",rx="Mod",lp="Multinomial",ax="Multiply",sx="Neg",ox="NotEqual",up="NonMaxSuppressionV3",ix="NonMaxSuppressionV4",cp="NonMaxSuppressionV5",lx="OnesLike",dp="OneHot",ux="Pack",fp="PadV2",sae="Pool",cx="Pow",hp="Prelu",pp="Prod",EE="RaggedGather",AE="RaggedRange",PE="RaggedTensorToTensor",dx="Range",BS="Real",fx="Reciprocal",hx="Relu",px="Reshape",mp="ResizeNearestNeighbor",mx="ResizeNearestNeighborGrad",gp="ResizeBilinear",gx="ResizeBilinearGrad",yx="Relu6",yp="Reverse",vx="Round",xx="Rsqrt",vp="ScatterNd",xp="TensorScatterUpdate",bp="SearchSorted",bx="Select",wx="Selu",Sx="Slice",Cx="Sin",_x="Sinh",$x="Sign",kx="Sigmoid",Nx="Softplus",Ix="Sqrt",wp="Sum",Tx="SpaceToBatchND",Ex="SplitV",Sp="Softmax",zS="SparseFillEmptyRows",Ax="SparseReshape",Px="SparseSegmentMean",Ox="SparseSegmentSum",Cp="SparseToDense",Rx="SquaredDifference",US="Square",OE="StaticRegexReplace",_p="StridedSlice",Dx="StringNGrams",VS="StringSplit",WS="StringToHashBucketFast",jx="Sub",Mx="Tan",Fx="Tanh",Zc="Tile",$p="TopK",kp="Transform",Wl="Transpose",GS="Unique",Lx="Unpack",HS="UnsortedSegmentSum",oae="UpperBound",Bx="ZerosLike",Np="Step",Xg="FromPixels",Ip="RotateWithOffset",Ic="_FusedMatMul",Tc="FusedConv2D",Ec="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Us(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.warn(...t)}function iae(...t){ee().getBool("IS_TEST")||ee().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bf=TE("kernelRegistry",()=>new Map),Yg=TE("gradRegistry",()=>new Map);function Qg(t,e){const n=RE(t,e);return Bf.get(n)}function Lk(t){return Yg.get(t)}function Ow(t){const e=Bf.entries(),n=[];for(;;){const{done:r,value:a}=e.next();if(r)break;const[s,o]=a,[i]=s.split("_");i===t&&n.push(o)}return n}function zx(t){const{kernelName:e,backendName:n}=t,r=RE(e,n);Bf.has(r)&&Us(`The kernel '${e}' for backend '${n}' is already registered`),Bf.set(r,t)}function lae(t){const{kernelName:e}=t;Yg.has(e)&&ee().getBool("DEBUG")&&Us(`Overriding the gradient for '${e}'`),Yg.set(e,t)}function uae(t,e){const n=RE(t,e);if(!Bf.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Bf.delete(n)}function cae(t){if(!Yg.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Yg.delete(t)}function dae(t,e){Ow(t).forEach(r=>{const a=Object.assign({},r,{backendName:e});zx(a)})}function RE(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var RV=Pn,Gs=null;try{Gs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Pn(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Pn.prototype.__isLong__;Object.defineProperty(Pn.prototype,"__isLong__",{value:!0});function rs(t){return(t&&t.__isLong__)===!0}Pn.isLong=rs;var t3={},n3={};function ed(t,e){var n,r,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(r=n3[t],r)?r:(n=On(t,(t|0)<0?-1:0,!0),a&&(n3[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(r=t3[t],r)?r:(n=On(t,t<0?-1:0,!1),a&&(t3[t]=n),n))}Pn.fromInt=ed;function Hs(t,e){if(isNaN(t))return e?tc:qs;if(e){if(t<0)return tc;if(t>=DV)return FV}else{if(t<=-a3)return Ka;if(t+1>=a3)return MV}return t<0?Hs(-t,e).neg():On(t%zf|0,t/zf|0,e)}Pn.fromNumber=Hs;function On(t,e,n){return new Pn(t,e,n)}Pn.fromBits=On;var Rw=Math.pow;function DE(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return qs;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return DE(t.substring(1),e,n).neg();for(var a=Hs(Rw(n,8)),s=qs,o=0;o<t.length;o+=8){var i=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+i),n);if(i<8){var u=Hs(Rw(n,i));s=s.mul(u).add(Hs(l))}else s=s.mul(a),s=s.add(Hs(l))}return s.unsigned=e,s}Pn.fromString=DE;function Oo(t,e){return typeof t=="number"?Hs(t,e):typeof t=="string"?DE(t,e):On(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Pn.fromValue=Oo;var r3=65536,fae=1<<24,zf=r3*r3,DV=zf*zf,a3=DV/2,s3=ed(fae),qs=ed(0);Pn.ZERO=qs;var tc=ed(0,!0);Pn.UZERO=tc;var cf=ed(1);Pn.ONE=cf;var jV=ed(1,!0);Pn.UONE=jV;var Bk=ed(-1);Pn.NEG_ONE=Bk;var MV=On(-1,2147483647,!1);Pn.MAX_VALUE=MV;var FV=On(-1,-1,!0);Pn.MAX_UNSIGNED_VALUE=FV;var Ka=On(0,-2147483648,!1);Pn.MIN_VALUE=Ka;var Fe=Pn.prototype;Fe.toInt=function(){return this.unsigned?this.low>>>0:this.low};Fe.toNumber=function(){return this.unsigned?(this.high>>>0)*zf+(this.low>>>0):this.high*zf+(this.low>>>0)};Fe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Ka)){var n=Hs(e),r=this.div(n),a=r.mul(n).sub(this);return r.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Hs(Rw(e,6),this.unsigned),o=this,i="";;){var l=o.div(s),u=o.sub(l.mul(s)).toInt()>>>0,c=u.toString(e);if(o=l,o.isZero())return c+i;for(;c.length<6;)c="0"+c;i=""+c+i}};Fe.getHighBits=function(){return this.high};Fe.getHighBitsUnsigned=function(){return this.high>>>0};Fe.getLowBits=function(){return this.low};Fe.getLowBitsUnsigned=function(){return this.low>>>0};Fe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ka)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};Fe.isZero=function(){return this.high===0&&this.low===0};Fe.eqz=Fe.isZero;Fe.isNegative=function(){return!this.unsigned&&this.high<0};Fe.isPositive=function(){return this.unsigned||this.high>=0};Fe.isOdd=function(){return(this.low&1)===1};Fe.isEven=function(){return(this.low&1)===0};Fe.equals=function(e){return rs(e)||(e=Oo(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Fe.eq=Fe.equals;Fe.notEquals=function(e){return!this.eq(e)};Fe.neq=Fe.notEquals;Fe.ne=Fe.notEquals;Fe.lessThan=function(e){return this.comp(e)<0};Fe.lt=Fe.lessThan;Fe.lessThanOrEqual=function(e){return this.comp(e)<=0};Fe.lte=Fe.lessThanOrEqual;Fe.le=Fe.lessThanOrEqual;Fe.greaterThan=function(e){return this.comp(e)>0};Fe.gt=Fe.greaterThan;Fe.greaterThanOrEqual=function(e){return this.comp(e)>=0};Fe.gte=Fe.greaterThanOrEqual;Fe.ge=Fe.greaterThanOrEqual;Fe.compare=function(e){if(rs(e)||(e=Oo(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Fe.comp=Fe.compare;Fe.negate=function(){return!this.unsigned&&this.eq(Ka)?Ka:this.not().add(cf)};Fe.neg=Fe.negate;Fe.add=function(e){rs(e)||(e=Oo(e));var n=this.high>>>16,r=this.high&65535,a=this.low>>>16,s=this.low&65535,o=e.high>>>16,i=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,f=0,h=0;return h+=s+u,f+=h>>>16,h&=65535,f+=a+l,d+=f>>>16,f&=65535,d+=r+i,c+=d>>>16,d&=65535,c+=n+o,c&=65535,On(f<<16|h,c<<16|d,this.unsigned)};Fe.subtract=function(e){return rs(e)||(e=Oo(e)),this.add(e.neg())};Fe.sub=Fe.subtract;Fe.multiply=function(e){if(this.isZero())return qs;if(rs(e)||(e=Oo(e)),Gs){var n=Gs.mul(this.low,this.high,e.low,e.high);return On(n,Gs.get_high(),this.unsigned)}if(e.isZero())return qs;if(this.eq(Ka))return e.isOdd()?Ka:qs;if(e.eq(Ka))return this.isOdd()?Ka:qs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(s3)&&e.lt(s3))return Hs(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,a=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,f=0,h=0,p=0;return p+=o*c,h+=p>>>16,p&=65535,h+=s*c,f+=h>>>16,h&=65535,h+=o*u,f+=h>>>16,h&=65535,f+=a*c,d+=f>>>16,f&=65535,f+=s*u,d+=f>>>16,f&=65535,f+=o*l,d+=f>>>16,f&=65535,d+=r*c+a*u+s*l+o*i,d&=65535,On(h<<16|p,d<<16|f,this.unsigned)};Fe.mul=Fe.multiply;Fe.divide=function(e){if(rs(e)||(e=Oo(e)),e.isZero())throw Error("division by zero");if(Gs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Gs.div_u:Gs.div_s)(this.low,this.high,e.low,e.high);return On(n,Gs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?tc:qs;var r,a,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return tc;if(e.gt(this.shru(1)))return jV;s=tc}else{if(this.eq(Ka)){if(e.eq(cf)||e.eq(Bk))return Ka;if(e.eq(Ka))return cf;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(qs)?e.isNegative()?cf:Bk:(a=this.sub(e.mul(r)),s=r.add(a.div(e)),s)}else if(e.eq(Ka))return this.unsigned?tc:qs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=qs}for(a=this;a.gte(e);){r=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(r)/Math.LN2),l=i<=48?1:Rw(2,i-48),u=Hs(r),c=u.mul(e);c.isNegative()||c.gt(a);)r-=l,u=Hs(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=cf),s=s.add(u),a=a.sub(c)}return s};Fe.div=Fe.divide;Fe.modulo=function(e){if(rs(e)||(e=Oo(e)),Gs){var n=(this.unsigned?Gs.rem_u:Gs.rem_s)(this.low,this.high,e.low,e.high);return On(n,Gs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Fe.mod=Fe.modulo;Fe.rem=Fe.modulo;Fe.not=function(){return On(~this.low,~this.high,this.unsigned)};Fe.and=function(e){return rs(e)||(e=Oo(e)),On(this.low&e.low,this.high&e.high,this.unsigned)};Fe.or=function(e){return rs(e)||(e=Oo(e)),On(this.low|e.low,this.high|e.high,this.unsigned)};Fe.xor=function(e){return rs(e)||(e=Oo(e)),On(this.low^e.low,this.high^e.high,this.unsigned)};Fe.shiftLeft=function(e){return rs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?On(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):On(0,this.low<<e-32,this.unsigned)};Fe.shl=Fe.shiftLeft;Fe.shiftRight=function(e){return rs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?On(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):On(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Fe.shr=Fe.shiftRight;Fe.shiftRightUnsigned=function(e){if(rs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return On(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?On(n,0,this.unsigned):On(n>>>e-32,0,this.unsigned)};Fe.shru=Fe.shiftRightUnsigned;Fe.shr_u=Fe.shiftRightUnsigned;Fe.toSigned=function(){return this.unsigned?On(this.low,this.high,!1):this};Fe.toUnsigned=function(){return this.unsigned?this:On(this.low,this.high,!0)};Fe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Fe.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Fe.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Pn.fromBytes=function(e,n,r){return r?Pn.fromBytesLE(e,n):Pn.fromBytesBE(e,n)};Pn.fromBytesLE=function(e,n){return new Pn(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Pn.fromBytesBE=function(e,n){return new Pn(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const LV=Ut(RV),hae=Z1({__proto__:null,default:LV},[RV]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gu=LV||hae;function Ux(t){return Gu.fromString(t,!0,16)}const BV=Ux("c3a5c85c97cb3127"),Lu=Ux("b492b66fbe98f273"),ca=Ux("9ae16a3b2f90404f");function zk(t){return t.xor(t.shru(47))}function zV(t,e,n){const r=t.slice(e,e+n);return Gu.fromBytes(Array.from(r),!0,!0)}function vn(t,e){return zV(t,e,8)}function o3(t,e){return zV(t,e,4)}function xr(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Gl(t,e,n=Ux("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let a=e.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function pae(t,e,n,r,a,s){a=a.add(t),s=xr(s.add(a).add(r),21);const o=a;return a=a.add(e),a=a.add(n),s=s.add(xr(a,44)),[a.add(r),s.add(o)]}function Yb(t,e,n,r){return pae(vn(t,e),vn(t,e+8),vn(t,e+16),vn(t,e+24),n,r)}function mae(t,e=t.length){if(e>=8){const n=ca.add(e*2),r=vn(t,0).add(ca),a=vn(t,e-8),s=xr(a,37).mul(n).add(r),o=xr(r,25).add(a).mul(n);return Gl(s,o,n)}if(e>=4){const n=ca.add(e*2),r=o3(t,0);return Gl(r.shl(3).add(e),o3(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],a=t[e-1],s=n+(r<<8),o=e+(a<<2);return zk(ca.mul(s).xor(BV.mul(o))).mul(ca)}return ca}function gae(t,e=t.length){const n=ca.add(e*2),r=vn(t,0).mul(Lu),a=vn(t,8),s=vn(t,e-8).mul(n),o=vn(t,e-16).mul(ca);return Gl(xr(r.add(a),43).add(xr(s,30)).add(o),r.add(xr(a.add(ca),18)).add(s),n)}function yae(t,e=t.length){const n=ca.add(e*2),r=vn(t,0).mul(ca),a=vn(t,8),s=vn(t,e-8).mul(n),o=vn(t,e-16).mul(ca),i=xr(r.add(a),43).add(xr(s,30)).add(o),l=Gl(i,r.add(xr(a.add(ca),18)).add(s),n),u=vn(t,16).mul(n),c=vn(t,24),d=i.add(vn(t,e-32)).mul(n),f=l.add(vn(t,e-24)).mul(n);return Gl(xr(u.add(c),43).add(xr(d,30)).add(f),u.add(xr(c.add(r),18)).add(d),n)}function UV(t,e=t.length){const n=Gu.fromNumber(81,!0);if(e<=32)return e<=16?mae(t,e):gae(t,e);if(e<=64)return yae(t,e);let r=n,a=n.mul(Lu).add(113),s=zk(a.mul(ca).add(113)).mul(ca),o=[Gu.UZERO,Gu.UZERO],i=[Gu.UZERO,Gu.UZERO];r=r.mul(ca).add(vn(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=xr(r.add(a).add(o[0]).add(vn(t,l+8)),37).mul(Lu),a=xr(a.add(o[1]).add(vn(t,l+48)),42).mul(Lu),r=r.xor(i[1]),a=a.add(o[0]).add(vn(t,l+40)),s=xr(s.add(i[0]),33).mul(Lu),o=Yb(t,l,o[1].mul(Lu),r.add(i[0])),i=Yb(t,l+32,s.add(i[1]),a.add(vn(t,l+16))),[s,r]=[r,s],l+=64;while(l!==u);const d=Lu.add(s.and(255).shl(1));return l=c,i[0]=i[0].add(e-1&63),o[0]=o[0].add(i[0]),i[0]=i[0].add(o[0]),r=xr(r.add(a).add(o[0]).add(vn(t,l+8)),37).mul(d),a=xr(a.add(o[1]).add(vn(t,l+48)),42).mul(d),r=r.xor(i[1].mul(9)),a=a.add(o[0].mul(9).add(vn(t,l+40))),s=xr(s.add(i[0]),33).mul(d),o=Yb(t,l,o[1].mul(d),r.add(i[0])),i=Yb(t,l+32,s.add(i[1]),a.add(vn(t,l+16))),[s,r]=[r,s],Gl(Gl(o[0],i[0],d).add(zk(a).mul(BV)).add(s),Gl(o[1],i[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function td(t,e){return e==="string"?Zo(t):Vx([t],e)}function vae(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Vx(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=eo(t)),ee().getBool("DEBUG")&&_V(t,e),vae(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Va(){return ee().platform.now()}function xae(t,e){return ee().platform.fetch(t,e)}function Zo(t,e="utf-8"){return e=e||"utf-8",ee().platform.encode(t,e)}function si(t,e="utf-8"){return e=e||"utf-8",ee().platform.decode(t,e)}function br(t){return ee().platform.isTypedArray!=null?ee().platform.isTypedArray(t):OV(t)}function eo(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Jl(t)||t==null||br(t)&&n)e.push(t);else if(Array.isArray(t)||br(t))for(let r=0;r<t.length;++r)eo(t[r],e,n);else{let r=-1;for(const a of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(a)&&(r=Math.max(r,Number(a)));for(let a=0;a<=r;a++)eo(t[a],e,n)}return e}const bae=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Kt,arraysEqualWithNull:CV,assert:j,assertNonNegativeIntegerDimensions:ns,assertNonNull:Jc,assertShapesMatch:_r,bytesFromStringArray:kV,bytesPerElement:Nc,checkConversionForErrors:_V,clamp:Kg,computeStrides:Dt,convertBackendValuesAndArrayBuffer:V0,createScalarValue:td,createShuffledIndices:Kre,decodeString:si,distSquared:Hre,encodeString:Zo,fetch:xae,fingerPrint64:UV,flatten:eo,getArrayFromDType:or,getTypedArrayFromDType:Eo,hasEncodingLoss:kE,hexToLong:Ux,indexToLoc:SS,inferDtype:lu,inferFromImplicitShape:wS,isBoolean:NV,isFunction:Ql,isInt:kc,isNumber:IV,isPromise:Jl,isScalarShape:Mk,isString:Ko,isTypedArray:br,isValidDtype:$V,locToIndex:Pw,makeOnesTypedArray:NE,makeZerosNestedTypedArray:Xre,makeZerosTypedArray:ai,nearestDivisor:Aw,nearestLargerEven:bS,now:Va,parseAxisParam:Yt,randUniform:Gre,repeatedTry:Fk,rightPad:fc,shuffle:SV,shuffleCombo:Wre,sizeFromShape:ne,sizeToSquarishShape:Ew,squeezeShape:Ji,sum:$E,swap:Ii,tanh:qre,toNestedArray:hc,toTypedArray:Vx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wae{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Cae)}profileKernel(e,n,r){let a;const s=()=>{a=r()};let o;const i=Va();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(s);else{s();for(const u of a)u.dataSync();o=Promise.resolve({kernelMs:Va()-i})}if(ee().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<a.length;u++){const c=a[u];c.data().then(d=>{Sae(d,c.dtype,e)})}return{kernelName:e,outputs:a,inputs:n,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:a,inputs:s,extraInfo:o}=e;r.forEach(i=>{Promise.all([i.data(),a,o]).then(l=>{this.logger.logKernelProfile(n,i,l[0],l[1],s,l[2])})})}}function Sae(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const a=t[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}class Cae{logKernelProfile(e,n,r,a,s,o){const i=typeof a=="number"?fc(`${a}ms`,9):a.error,l=fc(e,25),u=n.rank,c=n.size,d=fc(n.shape.toString(),14);let f="";for(const h in s){const p=s[h];if(p!=null){const g=p.shape||n.shape,y=g.length;f+=`${h}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${i}	%c${u}D ${d}	%c${c}	%c${f}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ae(t,e,n){const r={},a={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const f=c[d];let h=!1;for(let p=0;p<e.length;p++)if(r[f.id]){u.outputs.forEach(g=>r[g.id]=!0),h=!0,a[u.id]=!0;break}if(h)break}}const s={};s[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(s[u.outputs[d].id]){for(const f in c)s[c[f].id]=!0,o[u.id]=!0;break}}const i=[];for(let l=0;l<t.length;l++){const u=t[l];if(a[u.id]&&o[u.id]){const c={};for(const f in u.inputs){const h=u.inputs[f];r[h.id]&&(c[f]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,i.push(d)}}return i}function $ae(t,e,n,r){for(let a=e.length-1;a>=0;a--){const s=e[a],o=[];if(s.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const i=s.gradient(o);for(const l in s.inputs){if(!(l in i))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(i)}.`);const u=n(()=>i[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=s.inputs[l];if(!Kt(u.shape,c.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3=20,Em=3,$_=7;function kae(t,e,n,r){const a=Dt(e),s=Nae(t,e,n,a),o=e.length,i=W0(t,e,n,a,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(i.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Nae(t,e,n,r){const a=ne(e),s=r[r.length-1],o=new Array(s).fill(0),i=e.length,l=n==="complex64"?Ym(t):t;if(i>1)for(let u=0;u<a/s;u++){const c=u*s;for(let d=0;d<s;d++)o[d]=Math.max(o[d],Xm(l[c+d],0,n).length)}return o}function Xm(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed($_))} + ${parseFloat(t[1].toFixed($_))}j`:Ko(t)?r=`'${t}'`:n==="bool"?r=VV(t):r=parseFloat(t.toFixed($_)).toString(),fc(r,e)}function VV(t){return t===0?"false":"true"}function W0(t,e,n,r,a,s=!0){const o=n==="complex64"?2:1,i=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=Ym(t);return[Xm(g[0],0,n)]}return n==="bool"?[VV(t[0])]:[t[0].toString()]}if(l===1){if(i>i3){const y=Em*o;let v=Array.from(t.slice(0,y)),x=Array.from(t.slice((i-Em)*o,i*o));return n==="complex64"&&(v=Ym(v),x=Ym(x)),["["+v.map((b,w)=>Xm(b,a[w],n)).join(", ")+", ..., "+x.map((b,w)=>Xm(b,a[i-Em+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?Ym(t):Array.from(t)).map((y,v)=>Xm(y,a[v],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*o,f=[];if(i>i3){for(let g=0;g<Em;g++){const y=g*d,v=y+d;f.push(...W0(t.slice(y,v),u,n,c,a,!1))}f.push("...");for(let g=i-Em;g<i;g++){const y=g*d,v=y+d;f.push(...W0(t.slice(y,v),u,n,c,a,g===i-1))}}else for(let g=0;g<i;g++){const y=g*d,v=y+d;f.push(...W0(t.slice(y,v),u,n,c,a,g===i-1))}const h=l===2?",":"";f[0]="["+(i>0?f[0]+h:"");for(let g=1;g<f.length-1;g++)f[g]=" "+f[g]+h;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(s?"":p),f}function Ym(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ac{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=ne(e),r!=null){const a=r.length;j(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||or(n,this.size),this.strides=Dt(e)}set(e,...n){n.length===0&&(n=[0]),j(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const a of e){if(a<0||a>=this.shape[n]){const s=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=this.strides[a]*e[a];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return xo().makeTensor(this.values,this.shape,this.dtype)}}let xo=null,qd=null;function Iae(t){xo=t}function Tae(t){qd=t}class cn{constructor(e,n,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ne(e),this.strides=Dt(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return qd.buffer(this.shape,this.dtype,e)}bufferSync(){return qd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return hc(this.shape,e,this.dtype==="complex64")}arraySync(){return hc(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=xo().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>si(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),xo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=xo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>si(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await xo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),xo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return qd.print(this,e)}clone(){return this.throwIfDisposed(),qd.clone(this)}toString(e=!1){const n=this.dataSync();return kae(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),qd.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),xo().makeVariable(this,e,n,r)}}Object.defineProperty(cn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function WV(){return TE("Tensor",()=>cn)}WV();class Jg extends cn{constructor(e,n,r,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Kt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);xo().disposeTensor(this),this.dataId=e.dataId,xo().incRef(this,null)}dispose(){xo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Jg,Symbol.hasInstance,{value:t=>t instanceof cn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Uk;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Uk||(Uk={}));var Vk;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Vk||(Vk={}));var Wk;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Wk||(Wk={}));var Gk;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Gk||(Gk={}));var Hk;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Hk||(Hk={}));const Eae={float32:Gk,int32:Vk,bool:Wk,complex64:Hk};function pa(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Eae[t][e]}function Wx(t){return pa(t,"int32")}function GV(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function HV(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(t,e){if(t.dtype===e.dtype)return[t,e];const n=pa(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function qV(t,e){j(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function Aae(t,e){return e.some(n=>n.id===t.id)}function jE(t){const e=[];return KV(t,e,new Set),e}function KV(t,e,n){if(t==null)return;if(t instanceof cn){e.push(t);return}if(!Pae(t))return;const r=t;for(const a in r){const s=r[a];n.has(s)||(n.add(s),KV(s,e,n))}}function Pae(t){return Array.isArray(t)||typeof t=="object"}const Oae=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:qV,getTensorsInContainer:jE,isTensorInList:Aae,makeTypesMatch:Hn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_(t){return t.kernelName!=null}class l3{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Uf{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new l3}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Us(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new wae(this.backendInstance),!0}setupRegisteredKernels(){Ow(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Ow(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof iv)&&typeof r.then=="function"){const a=++this.pendingBackendInitId,s=r.then(o=>a<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,Us(`Initialization of backend ${e} failed`),Us(o.stack||o.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Us(`Initialization of backend ${e} failed`),Us(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:a,asyncInit:s}=this.initializeBackend(r);if(s||a)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),a=r.backend,s=this.readSync(n),o=a.refCount(n);a.disposeData(n,!0),r.backend=e,e.move(n,s,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let a;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,n,r){e();try{const a=r();return n(),a}catch(a){throw n(),a}}nextTensorId(){return Uf.nextTensorId++}nextVariableId(){return Uf.nextVariableId++}clone(e){const n=Y.runKernel(Zh,{x:e}),r={x:e},a=o=>({x:()=>{const i="float32",l={x:o},u={dtype:i};return Y.runKernel(Fh,l,u)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],a,s,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(Qg(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const a=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=a-n-s-o;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const a=this.isTapeOn(),s=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let l;const u=k_(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(k_(e)){const{kernelName:p,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const v=Qg(p,this.backendName);j(v!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),i=()=>{const x=this.backend.numDataIds();l=v.kernelFunc({inputs:g,attrs:y,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,b);const w=b.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(a){const C=this.getTensorsForGradient(p,g,w);r=this.saveTensorsForBackwardMode(C)}return w}}else{const{forwardFunc:p}=e,g=y=>{a&&(r=y.map(v=>this.keep(this.clone(v))))};i=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const v=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,v),v}}const{inputs:c,attrs:d}=e,f=k_(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=i():(h=this.profiler.profileKernel(u,c,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),a&&this.addTapeNode(u,c,n,f,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const a=Lk(e);if(a!=null){const s=a.inputsToSave||[],o=a.outputsToSave||[];let i;a.saveAllInputs?(j(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(n).map(u=>n[u])):i=s.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return i.concat(l)}return[]}makeTensor(e,n,r,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;let s=e;r==="string"&&Ko(e[0])&&(s=e.map(l=>Zo(l)));const o=a.write(s,n,r),i=new cn(n,r,o,this.nextTensorId());if(this.trackTensor(i,a),r==="string"){const l=this.state.tensorInfo.get(o),u=kV(s);this.state.numBytes+=u-l.bytes,l.bytes=u}return i}makeTensorFromDataId(e,n,r,a){r=r||"float32";const s={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,a)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:a,dtype:s}=e,o=new cn(a,s,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,a){r=r||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const s=new Jg(e,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Nc(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Jg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Nc(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,a,s,o){const i={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:s},l=Lk(e);l!=null&&(a=l.gradFunc),a!=null&&(i.gradient=u=>(u=u.map((c,d)=>{if(c==null){const f=r[d],h=ai(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return c}),a(u.length>1?u:u[0],s,o))),this.state.activeTape.push(i)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=jE(e),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const o=this.state.activeScope.track[s];!o.kept&&!r.has(o.id)&&o.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===a.id&&this.track(s)})}gradients(e,n,r,a=!1){if(j(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));j(s instanceof cn,()=>"The result y returned by f() must be a tensor.");const o=_ae(this.state.activeTape,n,s);if(!a&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[s.id]=r??Rae(s.shape),$ae(i,o,u=>this.tidy(u),Dae);const l=n.map(u=>i[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(e){return j(Ql(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{j(n.every(i=>i instanceof cn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const a={};n.forEach((i,l)=>{a[l]=i});const s=(i,l)=>(r=e(...n,l),j(r.value instanceof cn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),j(Ql(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(i,l)=>{const u=r.gradFunc(i,l),c=Array.isArray(u)?u:[u];j(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),j(c.every(f=>f instanceof cn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:s,backwardsFunc:o,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Va(),r=await this.backend.time(e);return r.wallMs=Va()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new l3;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Uf.nextTensorId=0;Uf.nextVariableId=0;function Rae(t){const e=NE(ne(t),"float32");return Y.makeTensor(e,t,"float32")}function XV(){const t=AV();if(t._tfengine==null){const e=new EV(t);t._tfengine=new Uf(e)}return Zre(t._tfengine.ENV),Iae(()=>t._tfengine),t._tfengine}const Y=XV();function Dae(t,e){const n={a:t,b:e};return Y.runKernel(Ah,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(){return typeof navigator<"u"&&navigator!=null}let qk;function Mae(t){qk=t}function ME(t){if(qk!==void 0)return qk;if(t||jae()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function FE(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const Fae=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:FE,isMobile:ME,mockIsMobile:Mae},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pa=ee();Pa.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Pa.registerFlag("IS_BROWSER",()=>FE());Pa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Pa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Pa.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Pa.registerFlag("PROD",()=>!1);Pa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Pa.getBool("DEBUG"));Pa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Pa.registerFlag("IS_TEST",()=>!1);Pa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Pa.getBool("DEBUG"));Pa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Pa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Pa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oi(t,e){let n=t;if(br(t))return e==="string"?[]:[t.length];if(GV(t)){const a=t.channels||"RGBA";return[t.height,t.width*a.length]}else if(HV(t))return[t.buffer.size/(e==null?4:Nc(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||br(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&ee().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&YV(t,r,[]),r}function YV(t,e,n){if(n=n||[],!Array.isArray(t)&&!br(t)){j(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}j(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),j(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let a=0;a<t.length;++a)YV(t[a],r,n.concat(a))}function u3(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function M(t,e,n,r="numeric"){if(t instanceof WV())return u3(r,t.dtype,e,n),t;let a=lu(t);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),u3(r,a,e,n),t==null||!br(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const s=oi(t,a);!br(t)&&!Array.isArray(t)&&(t=[t]);const i=a!=="string"?Vx(t,a):eo(t,[],!0);return Y.makeTensor(i,s,a)}function Zg(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((s,o)=>M(s,`${e}[${o}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LE="__op";function X(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+LE;const a=(...s)=>{Y.startScope(n);try{const o=r(...s);return Jl(o)&&console.error("Cannot return a Promise inside of tidy."),Y.endScope(o),o}catch(o){throw Y.endScope(null),o}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(t,e){const n=M(t,"real","complex"),r=M(e,"imag","complex");_r(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:n,imag:r};return Y.runKernel(kS,a)}const Hi=X({complex_:Lae});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uu(t,e,n,r){if(r==null)r=lu(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(HV(t)||GV(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return Y.backend.createTensorFromGPUData(t,e||n,r)}if(!br(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ns(e);const a=ne(e),s=ne(n);j(a===s,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${s}`);for(let o=0;o<n.length;++o){const i=n[o],l=o===n.length-1?i!==ne(e.slice(o)):!0;j(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!br(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Vx(t,r):eo(t,[],!0),Y.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qs(t,e,n){const r=oi(t,n);return uu(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pc={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ro{static join(e){return new Ro(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>br(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const a=e[r];r!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+a.byteLength;this.shards.push({buffer:a,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const a=n-e,s=new ArrayBuffer(a),o=new Uint8Array(s);let i=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+i-u.start,f=i,p=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,d,p-d);if(o.set(g,f),i+=g.length,n<u.end)break}return s}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(a){return e<a.start?-1:e>=a.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=Bae(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function Bae(t,e){let n=0,r=t.length;for(;n<=r;){const a=Math.floor((r-n)/2)+n,s=e(t[a]);if(s===0)return a;s<0?r=a:n=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zae(){ee().set("PROD",!0)}function Uae(){ee().set("DEBUG",!0)}function Vae(){ee().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Wae(t){ee().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Gae(){Y.disposeVariables()}function ia(){return Y}function Hae(){return Y.memory()}function qae(t){return Y.profile(t)}function at(t,e){return Y.tidy(t,e)}function Jt(t){jE(t).forEach(n=>n.dispose())}function Co(t){return Y.keep(t)}function Kae(t){return Y.time(t)}function QV(t){return Y.setBackend(t)}function JV(){return Y.ready()}function Vf(){return Y.backendName}function Xae(t){Y.removeBackend(t)}function Yae(t){return Y.findBackend(t)}function Qae(t){return Y.findBackendFactory(t)}function qS(t,e,n=1){return Y.registerBackend(t,e,n)}function Oc(){return Y.backend}function Jae(t,e){ee().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zl=4;async function Zae(t,e){const n=[],r=[],a=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<a.length;++o){const i=a[o],l=Array.isArray(t)?t[o].tensor:t[i];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${l.dtype}`);const u={name:i,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const f=await l.bytes(),h=f.reduce((y,v)=>y+v.length,0)+Zl*f.length,p=new Uint8Array(h);let g=0;for(let y=0;y<f.length;y++){const v=f[y],x=new Uint8Array(new Uint32Array([v.length]).buffer);p.set(x,g),g+=Zl,p.set(v,g),g+=v.length}d(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const s=await Promise.all(r);return{data:nse(s),specs:n}}function ZV(t,e){const n=new Ro(t),r={};let a=0;for(const s of e){const o=ese(s,(i,l)=>n.slice(a+i,a+l));r[s.name]=eW(s,n.slice(a,a+o)),a+=o}return r}function ese(t,e){const n=ne(t.shape);let r;if("quantization"in t){const a=t.quantization;r=Pc[a.dtype]}else if(t.dtype==="string"){let a=0;for(let s=0;s<n;s++)a+=Zl+new Uint32Array(e(a,a+Zl))[0];return a}else r=Pc[t.dtype];return n*r}async function tse(t,e){const n=ne(t.shape);let r;if("quantization"in t){const a=t.quantization;r=Pc[a.dtype]}else if(t.dtype==="string"){let a=0;for(let s=0;s<n;s++)a+=Zl+new Uint32Array(await e(a,a+Zl))[0];return a}else r=Pc[t.dtype];return n*r}function eW(t,e){const n=t.name,r=t.dtype,a=t.shape,s=ne(a);let o,i=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Pc[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){o=new Float32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=f*l.scale+l.min}}else if(l.dtype==="float16")o=use()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);o=new Int32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];o[d]=Math.round(f*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);i+=s*u}else if(r==="string"){const l=ne(t.shape);o=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(i,i+Zl))[0];i+=Zl;const d=new Uint8Array(e.slice(i,i+c));o.push(d),i+=c}}else{const l=Pc[r];if(r==="float32")o=new Float32Array(e);else if(r==="int32")o=new Int32Array(e);else if(r==="bool")o=new Uint8Array(e);else if(r==="complex64"){o=new Float32Array(e);const u=new Float32Array(o.length/2),c=new Float32Array(o.length/2);for(let p=0;p<u.length;p++)u[p]=o[p*2],c[p]=o[p*2+1];const d=Qs(u,a,"float32"),f=Qs(c,a,"float32"),h=Hi(d,f);return d.dispose(),f.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);i+=s*l}return Qs(o,a,r)}async function c3(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:a,value:s}=await t.read();if(a&&s==null){const i=n-r.byteLength;throw new Error(`Reader is done but ${i} bytes are still expected`)}const o=new Uint8Array(r.length+s.byteLength);o.set(r,0),o.set(new Uint8Array(s),r.length),r=o}return r.buffer}async function tW(t,e){const n={},r=t.getReader();let a=new ArrayBuffer(0);for(const s of e){const o=await tse(s,async(u,c)=>(a=await c3(r,a,c),a.slice(u,c)));a=await c3(r,a,o);const i=a.slice(0,o);a=a.slice(o);const l=eW(s,i);if(n[s.name]=l,Vf()==="webgpu"){const u=Oc();"uploadToGPU"in u&&ne(l.shape)>=ee().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function nse(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(s=>{if(e+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(e);let a=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),a),a+=s.byteLength}),r.buffer}const BE=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function d3(t){return BE?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function rse(t){if(BE)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function ase(t){if(BE){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function sse(t){return Ro.join(t)}function f3(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function nW(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function rW(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function zE(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),rW(t,n,r)}function Gx(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:d3(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:d3(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Ro(t.weightData).byteLength}}function Kk(t){const e=[];for(const n of t)e.push(...n.weights);return e}function ose(){const t=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function ise(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function lse(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function use(){const t=ose(),e=ise(),n=lse();return r=>{const a=new ArrayBuffer(4*r.length),s=new Uint32Array(a);for(let o=0;o<r.length;o++){const i=r[o],l=t[n[i>>10]+(i&1023)]+e[i>>10];s[o]=l}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Vn.instance==null&&(Vn.instance=new Vn),Vn.instance}static registerSaveRouter(e){Vn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Vn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Vn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Vn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const a=[];return(n==="load"?Vn.getInstance().loadRouters:Vn.getInstance().saveRouters).forEach(o=>{const i=o(e,r);i!==null&&a.push(i)}),a}}const cse=t=>Vn.registerSaveRouter(t),dse=t=>Vn.registerLoadRouter(t),fse=t=>Vn.getSaveHandlers(t),hse=(t,e)=>Vn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xk="tensorflowjs",Yk=1,nc="models_store",Tl="model_info_store";function aW(){if(!ee().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Qk(t){const e=t.result;e.createObjectStore(nc,{keyPath:"modelPath"}),e.createObjectStore(Tl,{keyPath:"modelPath"})}class Rc{constructor(e){if(this.indexedDB=aW(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,a)=>{const s=this.indexedDB.open(Xk,Yk);s.onupgradeneeded=()=>Qk(s),s.onsuccess=()=>{const o=s.result;if(n==null){const i=o.transaction(nc,"readonly"),u=i.objectStore(nc).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(o.close(),a(u.error)),i.oncomplete=()=>o.close()}else{n.weightData=Ro.join(n.weightData);const i=Gx(n),l=o.transaction(Tl,"readwrite");let u=l.objectStore(Tl),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(f){return a(f)}let d;c.onsuccess=()=>{d=o.transaction(nc,"readwrite");const f=d.objectStore(nc);let h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:i})}catch(p){return a(p)}h.onsuccess=()=>r({modelArtifactsInfo:i}),h.onerror=p=>{u=l.objectStore(Tl);const g=u.delete(this.modelPath);g.onsuccess=()=>(o.close(),a(h.error)),g.onerror=y=>(o.close(),a(h.error))}},c.onerror=f=>(o.close(),a(c.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},s.onerror=o=>a(s.error)})}}Rc.URL_SCHEME="indexeddb://";const sW=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Rc.URL_SCHEME)?pse(t.slice(Rc.URL_SCHEME.length)):null;Vn.registerSaveRouter(sW);Vn.registerLoadRouter(sW);function pse(t){return new Rc(t)}function mse(t){return t.startsWith(Rc.URL_SCHEME)?t.slice(Rc.URL_SCHEME.length):t}class gse{constructor(){this.indexedDB=aW()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Xk,Yk);r.onupgradeneeded=()=>Qk(r),r.onsuccess=()=>{const a=r.result,s=a.transaction(Tl,"readonly"),i=s.objectStore(Tl).getAll();i.onsuccess=()=>{const l={};for(const u of i.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},i.onerror=l=>(a.close(),n(i.error)),s.oncomplete=()=>a.close()},r.onerror=a=>n(r.error)})}async removeModel(e){return e=mse(e),new Promise((n,r)=>{const a=this.indexedDB.open(Xk,Yk);a.onupgradeneeded=()=>Qk(a),a.onsuccess=()=>{const s=a.result,o=s.transaction(Tl,"readwrite"),i=o.objectStore(Tl),l=i.get(e);let u;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=i.delete(e),d=()=>{u=s.transaction(nc,"readwrite");const h=u.objectStore(nc).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=p=>r(l.error)};c.onsuccess=d,c.onerror=f=>(d(),s.close(),r(l.error))}},l.onerror=c=>(s.close(),r(l.error)),o.oncomplete=()=>{u==null?s.close():u.oncomplete=()=>s.close()}},a.onerror=s=>r(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ti="/",Kd="tensorflowjs_models",oW="info",yse="model_topology",vse="weight_specs",xse="weight_data",bse="model_metadata";function iW(t){return{info:[Kd,t,oW].join(Ti),topology:[Kd,t,yse].join(Ti),weightSpecs:[Kd,t,vse].join(Ti),weightData:[Kd,t,xse].join(Ti),modelMetadata:[Kd,t,bse].join(Ti)}}function lW(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function wse(t){const e=t.split(Ti);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ti)}function Sse(t){return t.startsWith(Dc.URL_SCHEME)?t.slice(Dc.URL_SCHEME.length):t}class Dc{constructor(e){if(!ee().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=iW(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=Gx(e),s=Ro.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,rse(s));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:a}}catch{throw lW(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=a;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const i=JSON.parse(s);n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,i.signature!=null&&(n.signature=i.signature),i.userDefinedMetadata!=null&&(n.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(n.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(n.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(n.trainingConfig=i.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=ase(o),n}}Dc.URL_SCHEME="localstorage://";const uW=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Dc.URL_SCHEME)?Cse(t.slice(Dc.URL_SCHEME.length)):null;Vn.registerSaveRouter(uW);Vn.registerLoadRouter(uW);function Cse(t){return new Dc(t)}class _se{constructor(){j(ee().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),j(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Kd+Ti,r=Ti+oW;for(let a=0;a<this.LS.length;++a){const s=this.LS.key(a);if(s.startsWith(n)&&s.endsWith(r)){const o=wse(s);e[o]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){e=Sse(e);const n=iW(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return lW(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cf="://";class la{constructor(){this.managers={}}static getInstance(){return la.instance==null&&(la.instance=new la),la.instance}static registerManager(e,n){j(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Cf)&&(e=e.slice(0,e.indexOf(Cf))),j(e.length>0,()=>"scheme must not be an empty string.");const r=la.getInstance();j(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=la.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(la.getInstance().managers)}}function G0(t){if(t.indexOf(Cf)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${la.getSchemes().join(",")}`);return{scheme:t.split(Cf)[0],path:t.split(Cf)[1]}}async function cW(t,e,n=!1){j(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Vn.getLoadHandlers(t);j(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),j(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const a=r[0],s=Vn.getSaveHandlers(e);j(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),j(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=s[0],i=G0(t).scheme,l=G0(t).path,u=i===G0(t).scheme,c=await a.load();n&&u&&await la.getManager(i).removeModel(l);const d=await o.save(c);return n&&!u&&await la.getManager(i).removeModel(l),d.modelArtifactsInfo}async function $se(){const t=la.getSchemes(),e={};for(const n of t){const r=await la.getManager(n).listModels();for(const a in r){const s=n+Cf+a;e[s]=r[a]}}return e}async function kse(t){const e=G0(t);return la.getManager(e.scheme).removeModel(e.path)}async function Nse(t,e){return cW(t,e,!1)}async function Ise(t,e){return cW(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tse{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ee().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const a=this.functionRefs[r.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return OV(e)}}if(ee().get("IS_BROWSER")){ee().setPlatform("browser",new Tse);try{la.registerManager(Dc.URL_SCHEME,new _se)}catch{}try{la.registerManager(Rc.URL_SCHEME,new gse)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ese={importFetch:()=>require("node-fetch")};let N_;class Ase{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ee().global.fetch!=null?ee().global.fetch(e,n):(N_==null&&(N_=Ese.importFetch()),N_(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ee().get("IS_NODE")&&!ee().get("IS_BROWSER")&&ee().setPlatform("node",new Ase);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function en(t,e="float32",n){return e=e||"float32",ns(t),new Ac(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t,e){const n=M(t,"x","cast");if(!$V(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:e};return Y.runKernel(Fh,r,a)}const zt=X({cast_:Pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ose(t){const n={x:M(t,"x","clone","string_or_numeric")};return Y.runKernel(Zh,n)}const Di=X({clone_:Ose});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UE(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */XV();const Rse={buffer:en,cast:zt,clone:Di,print:UE};Tae(Rse);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t,e){let n=M(t,"a","add"),r=M(e,"b","add");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(Ah,a)}const Ke=X({add_:Dse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t,e){let n=M(t,"a","floorDiv"),r=M(e,"b","floorDiv");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(Fv,a)}const VE=X({floorDiv_:jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mse(t,e){let n=M(t,"a","div"),r=M(e,"b","div");if([n,r]=Hn(n,r),n.dtype==="int32"&&r.dtype==="int32")return VE(n,r);const a={a:n,b:r},s={};return Y.runKernel(Iv,a,s)}const $t=X({div_:Mse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t,e){let n=M(t,"a","mul"),r=M(e,"b","mul");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(ax,a)}const _e=X({mul_:Fse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t){const e=M(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return Y.runKernel(NS,n)}else{const n={x:e};return Y.runKernel(lv,n)}}const Ua=X({abs_:Lse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(t){const n={x:M(t,"x","acos")};return Y.runKernel(uv,n)}const dW=X({acos_:Bse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zse(t){const n={x:M(t,"x","acosh")};return Y.runKernel(cv,n)}const fW=X({acosh_:zse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t){j(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),j(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((a,s)=>M(a,`tensors${s}`,"addN")),n=e[0];e.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!Kt(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return Y.runKernel(Ph,r)}const hW=X({addN_:Use});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t,e=null,n=!1){const a={x:M(t,"x","all","bool")},s={axis:e,keepDims:n};return Y.runKernel(Oh,a,s)}const pW=X({all_:Vse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t,e=null,n=!1){const a={x:M(t,"x","any","bool")},s={axis:e,keepDims:n};return Y.runKernel(Rh,a,s)}const mW=X({any_:Wse});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t,e=0){const r={x:M(t,"x","argMax")},a={axis:e};return Y.runKernel(dv,r,a)}const WE=X({argMax_:Gse});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t,e=0){const r={x:M(t,"x","argMin")},a={axis:e};return Y.runKernel(fv,r,a)}const gW=X({argMin_:Hse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t){const n={x:M(t,"x","asin")};return Y.runKernel(hv,n)}const yW=X({asin_:qse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t){const n={x:M(t,"x","asinh")};return Y.runKernel(pv,n)}const vW=X({asinh_:Kse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xse(t){const n={x:M(t,"x","atan")};return Y.runKernel(mv,n)}const xW=X({atan_:Xse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t,e){let n=M(t,"a","atan2"),r=M(e,"b","atan2");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(yv,a)}const bW=X({atan2_:Yse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t){const n={x:M(t,"x","atanh")};return Y.runKernel(gv,n)}const wW=X({atanh_:Qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cu(t,e,n,r,a="NHWC",s){const o=t[3],i=[...e,o],l=ks(a);return Rn(t,i,n,s,r,null,null,l)}function Yr(t,e,n,r,a,s,o="channelsLast"){const[i,l]=ey(e);let u;if(o==="channelsLast")u=[i,l,t[3],t[3]];else if(o==="channelsFirst")u=[i,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Rn(t,u,n,r,a,s,!1,o)}function $s(t,e,n,r,a,s,o="NDHWC"){const[i,l,u]=Jk(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[i,l,u,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[i,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Do(t,c,n,r,a,!1,d,s)}function Rn(t,e,n,r,a,s,o=!1,i="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d]=t;else if(i==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,h,,p]=e,[g,y]=ey(n),[v,x]=ey(r),b=_f(f,v),w=_f(h,x),{padInfo:C,outHeight:_,outWidth:$}=eoe(a,u,c,g,y,b,w,s,i),k=o?p*d:p;let A;return i==="channelsFirst"?A=[l,k,_,$]:i==="channelsLast"&&(A=[l,_,$,k]),{batchSize:l,dataFormat:i,inHeight:u,inWidth:c,inChannels:d,outHeight:_,outWidth:$,outChannels:k,padInfo:C,strideHeight:g,strideWidth:y,filterHeight:f,filterWidth:h,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:v,dilationWidth:x,inShape:t,outShape:A,filterShape:e}}function Do(t,e,n,r,a,s=!1,o="channelsLast",i){let[l,u,c,d,f]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d,f]=t;else if(o==="channelsFirst")[l,f,u,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[h,p,g,,y]=e,[v,x,b]=Jk(n),[w,C,_]=Jk(r),$=_f(h,w),k=_f(p,C),A=_f(g,_),{padInfo:P,outDepth:O,outHeight:R,outWidth:B}=toe(a,u,c,d,v,x,b,$,k,A,i),F=s?y*f:y;let L;return o==="channelsFirst"?L=[l,F,O,R,B]:o==="channelsLast"&&(L=[l,O,R,B,F]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:d,inChannels:f,outDepth:O,outHeight:R,outWidth:B,outChannels:F,padInfo:P,strideDepth:v,strideHeight:x,strideWidth:b,filterDepth:h,filterHeight:p,filterWidth:g,effectiveFilterDepth:$,effectiveFilterHeight:k,effectiveFilterWidth:A,dilationDepth:w,dilationHeight:C,dilationWidth:_,inShape:t,outShape:L,filterShape:e}}function Jse(t,e,n,r,a){r==null&&(r=GE(t,e,n));const s=t[0],o=t[1],i=ty((s-e+2*r)/n+1,a),l=ty((o-e+2*r)/n+1,a);return[i,l]}function Zse(t,e,n,r,a,s){a==null&&(a=GE(t,e[0],r[0]));const o=[0,0,0,n];for(let i=0;i<3;i++)t[i]+2*a>=e[i]&&(o[i]=ty((t[i]-e[i]+2*a)/r[i]+1,s));return o}function GE(t,e,n,r=1){const a=_f(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function ey(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Jk(t){return typeof t=="number"?[t,t,t]:t}function _f(t,e){return e<=1?t:t+(t-1)*(e-1)}function eoe(t,e,n,r,a,s,o,i,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=Jse([e,n],s,r,t,i);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/a);const f=Math.max(0,(c-1)*r+s-e),h=Math.max(0,(d-1)*a+o-n),p=Math.floor(f/2),g=f-p,y=Math.floor(h/2),v=h-y;u={top:p,bottom:g,left:y,right:v,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-s+1)/r),d=Math.ceil((n-o+1)/a);else if(typeof t=="object"){const f=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:f,bottom:h,left:p,right:g,type:f===0&&h===0&&p===0&&g===0?"VALID":"EXPLICIT"},c=ty((e-s+f+h)/r+1,i),d=ty((n-o+p+g)/a+1,i)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function toe(t,e,n,r,a,s,o,i,l,u,c){let d,f,h,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=Zse([e,n,r,1],[i,l,u],1,[a,s,o],t,c);f=y[0],h=y[1],p=y[2]}else if(t==="same"){f=Math.ceil(e/a),h=Math.ceil(n/s),p=Math.ceil(r/o);const g=(f-1)*a+i-e,y=(h-1)*s+l-n,v=(p-1)*o+u-r,x=Math.floor(g/2),b=g-x,w=Math.floor(y/2),C=y-w,_=Math.floor(v/2),$=v-_;d={top:w,bottom:C,left:_,right:$,front:x,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:h,outWidth:p}}function ty(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function ny(t){const[e,n,r]=ey(t);return e===1&&n===1&&r===1}function Qr(t,e){return ny(t)||ny(e)}function jc(t){return ey(t).every(e=>e>0)}function ks(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function ro(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")j(kc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(a=>{j(kc(a),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t,e){const r={x:M(t,"x","reshape","string_or_numeric")},a={shape:e};return Y.runKernel(px,r,a)}const xe=X({reshape_:noe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(t,e,n,r,a){const s=M(t,"x","avgPool","float32"),o=1;j(Qr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let i=s,l=!1;s.rank===3&&(l=!0,i=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),j(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),ro("avgPool",r,a);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let d=Y.runKernel(Dh,u,c);return d=zt(d,s.dtype),l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const HE=X({avgPool_:roe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t,e,n,r,a,s="NDHWC"){const o=M(t,"x","avgPool3d","float32");let i=o,l=!1;o.rank===4&&(l=!0,i=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),j(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),j(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),ro("avgPool3d",r,a);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:s};let d=Y.runKernel(vv,u,c);return d=zt(d,i.dtype),l?xe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const SW=X({avgPool3d_:aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(t,e=0){j(t.length>=1,()=>"Pass at least one tensor to concat");const n=Zg(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return Di(n[0]);const r=n,a={axis:e};return Y.runKernel(Sv,r,a)}const fr=X({concat_:soe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(t,e,n=!1,r=!1){let a=M(t,"a","matMul"),s=M(e,"b","matMul");[a,s]=Hn(a,s);const o={a,b:s},i={transposeA:n,transposeB:r};return Y.runKernel(jh,o,i)}const Zt=X({matMul_:ooe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t){const n={x:M(t,"x","sigmoid","float32")};return Y.runKernel(kx,n)}const ei=X({sigmoid_:ioe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t,e,n){const r=M(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const a={x:r},s={begin:e,size:n};return Y.runKernel(Sx,a,s)}const gt=X({slice_:loe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t){const n={x:M(t,"x","tanh","float32")};return Y.runKernel(Fx,n)}const Dw=X({tanh_:uoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t,e,n,r,a,s){const o=M(t,"forgetBias","basicLSTMCell"),i=M(e,"lstmKernel","basicLSTMCell"),l=M(n,"lstmBias","basicLSTMCell"),u=M(r,"data","basicLSTMCell"),c=M(a,"c","basicLSTMCell"),d=M(s,"h","basicLSTMCell"),f=fr([u,d],1),h=Zt(f,i),p=Ke(h,l),g=p.shape[0],y=p.shape[1]/4,v=[g,y],x=gt(p,[0,0],v),b=gt(p,[0,y],v),w=gt(p,[0,y*2],v),C=gt(p,[0,y*3],v),_=Ke(_e(ei(x),Dw(b)),_e(c,ei(Ke(o,w)))),$=_e(Dw(_),ei(C));return[_,$]}const CW=X({basicLSTMCell_:coe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t,e,n){const r=M(t,"x","batchToSpaceND"),a=e.reduce((i,l)=>i*l);j(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),j(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),j(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const s={x:r},o={blockShape:e,crops:n};return Y.runKernel(xv,s,o)}const qE=X({batchToSpaceND_:doe});function foe(t){let e;return t.rank===0||t.rank===1?e=xe(t,[1,1,1,t.size]):t.rank===2?e=xe(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hoe(t,e,n,r,a,s){s==null&&(s=.001);const o=M(t,"x","batchNorm"),i=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;a!=null&&(u=M(a,"scale","batchNorm"));let c;r!=null&&(c=M(r,"offset","batchNorm")),j(i.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(c==null||i.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(u==null||i.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:foe(o),scale:u,offset:c,mean:i,variance:l},h={varianceEpsilon:s},p=Y.runKernel(Qh,f,h);return xe(p,o.shape)}const Hx=X({batchNorm_:hoe});function poe(t,e,n,r,a,s){const o=M(t,"x","batchNorm"),i=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;a!=null&&(u=M(a,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),j(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),j(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),j(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Hx(o,i,l,c,u,s)}const _W=X({batchNorm2d_:poe});function moe(t,e,n,r,a,s){const o=M(t,"x","batchNorm"),i=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;a!=null&&(u=M(a,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),j(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),j(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),j(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Hx(o,i,l,c,u,s)}const $W=X({batchNorm3d_:moe});function goe(t,e,n,r,a,s){const o=M(t,"x","batchNorm"),i=M(e,"mean","batchNorm"),l=M(n,"variance","batchNorm");let u;a!=null&&(u=M(a,"scale","batchNorm"));let c;return r!=null&&(c=M(r,"offset","batchNorm")),j(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),j(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),j(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Hx(o,i,l,c,u,s)}const kW=X({batchNorm4d_:goe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yoe(t,e,n){const r=M(t,"x","bincount"),a=M(e,"weights","bincount");j(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);const s={x:r,weights:a},o={size:n};return Y.runKernel(Mh,s,o)}const KE=X({bincount_:yoe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t,e){const n=M(t,"x","bitwiseAnd"),r=M(e,"y","bitwiseAnd");if(!Kt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const a={a:n,b:r};return Y.runKernel($S,a)}const NW=X({bitwiseAnd_:voe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t,e){const n=M(t,"s0","broadcastArgs","int32"),r=M(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const a={s0:n,s1:r};return Y.runKernel(bv,a)}const IW=X({broadcastArgs_:xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(t,e){let n=M(t,"broadcastTo","x");const r=n.shape;if(ns(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=xe(n,u)}const a=n.shape,s=Array.from(e);for(let u=e.length-1;u>=0;u--)if(a[u]===e[u])s[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(s.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Di(n);const i={x:n},l={reps:s};return Y.runKernel(Zc,i,l)}const $f=X({broadcastTo_:boe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t){const n={x:M(t,"x","ceil","float32")};return Y.runKernel(wv,n)}const TW=X({ceil_:woe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tp(t,e,n){ns(t),n=n||lu(e);const r={shape:t,value:e,dtype:n};return Y.runKernel(jv,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(t,e,n){const r=M(t,"x","clipByValue");if(j(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Tp(r.shape,e,r.dtype);const a={x:r},s={clipValueMin:e,clipValueMax:n};return Y.runKernel(Lh,a,s)}const XE=X({clipByValue_:Soe});function Coe(t){return fr(t,0)}const EW=X({concat1d_:Coe});function _oe(t,e){return fr(t,e)}const AW=X({concat2d_:_oe});function $oe(t,e){return fr(t,e)}const PW=X({concat3d_:$oe});function koe(t,e){return fr(t,e)}const OW=X({concat4d_:koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t,e,n,r,a="NHWC",s=[1,1],o){const i=M(t,"x","conv2d","float32"),l=M(e,"filter","conv2d","float32");let u=i,c=!1;i.rank===3&&(c=!0,u=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),j(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),j(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),ro("conv2d",r,o);const d=a==="NHWC"?u.shape[3]:u.shape[1];j(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),j(Qr(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),j(jc(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),j(jc(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o},p=Y.runKernel(Bh,f,h);return c?xe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qx=X({conv2d_:Noe});function Ioe(t,e,n,r,a="NWC",s=1,o){const i=M(t,"x","conv1d"),l=M(e,"filter","conv1d");let u=i,c=!1;i.rank===2&&(c=!0,u=xe(i,[1,i.shape[0],i.shape[1]])),j(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),j(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),ro("conv1d",r,o),j(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),j(Qr(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),j(jc(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),j(jc(n),()=>"Error in conv1D: Stride should be larger than 0."),j(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=xe(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=xe(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=qx(f,d,[1,n],r,"NHWC",[1,s],o);return c?xe(y,[y.shape[2],y.shape[3]]):xe(y,[y.shape[0],y.shape[2],y.shape[3]])}const RW=X({conv1d_:Ioe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e,n,r,a,s="NHWC",o){j(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,l=e,u=!1;e.rank===3&&(u=!0,l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]),i=[1,t[0],t[1],t[2]]),j(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),j(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),j(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=s==="NHWC"?i[3]:i[1],d=s==="NHWC"?l.shape[3]:l.shape[1];j(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),j(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),ro("conv2dDerInput",a,o);const f={dy:l,filter:n},h={strides:r,pad:a,dataFormat:s,dimRoundingMode:o,inputShape:i},p=Y.runKernel(zh,f,h);return u?xe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const DW=X({conv2DBackpropInput_:Toe});function Eoe(t,e,n,r,a,s){const o=M(t,"x","conv2dTranspose"),i=M(e,"filter","conv2dTranspose");return DW(n,o,i,r,a,"NHWC",s)}const jW=X({conv2dTranspose_:Eoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t,e,n,r,a="NDHWC",s=[1,1,1]){const o=M(t,"x","conv3d"),i=M(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),j(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),j(l.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${i.shape[3]}.`),j(Qr(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),j(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),j(jc(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),j(jc(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:i},d={strides:n,pad:r,dataFormat:a,dilations:s},f=Y.runKernel(Uh,c,d);return u?xe(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const MW=X({conv3d_:Aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t,e,n,r,a){j(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,o=e,i=!1;e.rank===4&&(i=!0,o=xe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const l=s[4],u=o.shape[4];j(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),j(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),j(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),j(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),j(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:a,strides:r,inputShape:s},f=Y.runKernel(Vh,c,d);return i?xe(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Ooe=X({conv3DBackpropInput_:Poe});function Roe(t,e,n,r,a){const s=M(t,"x","conv3dTranspose"),o=M(e,"filter","conv3dTranspose");return Ooe(n,s,o,r,a)}const FW=X({conv3dTranspose_:Roe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(t){const n={x:M(t,"x","cos","float32")};return Y.runKernel(_v,n)}const LW=X({cos_:Doe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(t){const n={x:M(t,"x","cosh","float32")};return Y.runKernel($v,n)}const BW=X({cosh_:joe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe(t,e=0,n=!1,r=!1){const s={x:M(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:r};return Y.runKernel(Wh,s,o)}const zW=X({cumprod_:Moe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t,e=0,n=!1,r=!1){const s={x:M(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:r};return Y.runKernel(Gh,s,o)}const UW=X({cumsum_:Foe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t,e,n,r=!1){const a=M(t,"x","denseBincount"),s=M(e,"weights","denseBincount");j(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),j(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(s.size===a.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${s.shape}.`);const o={x:a,weights:s},i={size:n,binaryOutput:r};return Y.runKernel(kv,o,i)}const VW=X({denseBincount_:Loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t,e,n="NHWC"){const r=M(t,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];j(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),j(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${r.shape}`),j(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e} for depthToSpace with input shape
        ${r.shape}`),j(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const i={x:r},l={blockSize:e,dataFormat:n};return Y.runKernel(qh,i,l)}const WW=X({depthToSpace_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t,e,n,r,a="NHWC",s=[1,1],o){const i=M(t,"x","depthwiseConv2d","float32"),l=M(e,"filter","depthwiseConv2d","float32");let u=i,c=!1;i.rank===3&&(c=!0,u=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),j(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),j(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=a==="NHWC"?u.shape[3]:u.shape[1];j(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),ro("depthwiseConv2d",r,o);const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o},p=Y.runKernel(Kh,f,h);return c?xe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const KS=X({depthwiseConv2d_:zoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t){const n={x:M(t,"x","diag")};return Y.runKernel(Nv,n)}const GW=X({diag_:Uoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t,e,n,r,a=[1,1],s="NHWC"){const o=M(t,"x","dilation2d"),i=M(e,"filter","dilation2d");j(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),j(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),j(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=o,u=!1;o.rank===3&&(l=xe(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),j(l.shape[3]===i.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${i.shape[2]}`);const c={x:l,filter:i},d={strides:n,pad:r,dilations:a},f=Y.runKernel(Xh,c,d);return u?xe(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const HW=X({dilation2d_:Voe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(t,e){const n=t.length,r=[];for(let a=0;a<n;a++){const s=n-1-a,o=t[s]||1;(e[e.length-1-a]||1)>1&&o===1&&r.unshift(s)}return r}function YE(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],s=e.length-r-1,o=e[s];(a==null||a===1&&o>1)&&n.unshift(s)}return n}function ct(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let a=0;a<n;a++){let s=t[t.length-a-1];s==null&&(s=1);let o=e[e.length-a-1];if(o==null&&(o=1),s===1)r[n-a-1]=o;else if(o===1)r[n-a-1]=s;else if(s!==o){const i=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(i)}else r[n-a-1]=s}return r}const Woe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:ct,getBroadcastDims:Mc,getReductionAxes:YE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t,e){let n=M(t,"a","equal","string_or_numeric"),r=M(e,"b","equal","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Pv,a)}const QE=X({equal_:Goe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(t,e,n){const r=M(e,"a","where"),a=M(n,"b","where"),s=M(t,"condition","where","bool"),o=ct(ct(s.shape,r.shape),a.shape),i=$f(s,o),l=$f(r,o),u=$f(a,o),c={condition:i,t:l,e:u};return Y.runKernel(bx,c)}const ji=X({where_:Hoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(t){const n={x:M(t,"x","zerosLike")};return Y.runKernel(Bx,n)}const Za=X({zerosLike_:qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t,e){let n=M(t,"a","div"),r=M(e,"b","div");[n,r]=Hn(n,r);const a=$t(n,r),s=Za(a),o=QE(r,s);return ji(o,s,a)}const qW=X({divNoNan_:Koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t,e){const n=M(t,"t1","dot"),r=M(e,"t2","dot");j((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const a=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(j(a===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${s}.`),n.rank===1&&r.rank===1){const o=xe(n,[1,-1]),i=xe(r,[-1,1]),l=Zt(o,i);return xe(l,[])}else if(n.rank===1&&r.rank===2){const o=xe(n,[1,-1]),i=xe(r,[r.shape[0],r.shape[1]]),l=Zt(o,i);return xe(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=xe(r,[-1,1]),i=Zt(n,o);return xe(i,[i.size])}else{const o=xe(r,[r.shape[0],r.shape[1]]);return Zt(n,o)}}const KW=X({dot_:Xoe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yoe(t,...e){const n=e.map((a,s)=>M(a,`tensors${s}`,"einsum")),r={equation:t};return Y.runKernel(RS,n,r)}const Hu=X({einsum_:Yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t){const n={x:M(t,"x","elu","float32")};return Y.runKernel(Tv,n)}const JE=X({elu_:Qoe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(t,e){const n=M(t,"x","ensureShape","string_or_numeric");if(!CV(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const XW=X({ensureShape_:Joe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t){let e=M(t,"x","erf");j(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=zt(e,"float32"));const n={x:e};return Y.runKernel(Av,n)}const YW=X({erf_:Zoe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZE(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function QW(t,e,n){const r=t.length+e.length,a=[];let s=0,o=0;for(let i=0;i<r;i++)n.indexOf(i)===-1?a.push(t[s++]):a.push(e[o++]);return a}function mr(t,e){const n=[],r=t.length;for(let s=0;s<r;s++)e.indexOf(s)===-1&&n.push(t[s]);const a=e.map(s=>t[s]);return[n,a]}function ir(t,e){const n=e.map(r=>1);return QW(t,n,e)}function Yn(t,e,n){j(ZE(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function gr(t,e){if(ZE(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function nd(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Qn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eie(t,e=null,n=!1){const a={x:M(t,"x","max")},s={reductionIndices:e,keepDims:n};return Y.runKernel(rp,a,s)}const pc=X({max_:eie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(t,e=null,n=!1){const a={x:M(t,"x","min")},s={axis:e,keepDims:n};return Y.runKernel(op,a,s)}const jw=X({min_:tie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nie(t,e){let n=M(t,"base","pow"),r=M(e,"exp","pow");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(cx,a)}const Wf=X({pow_:nie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bt(t,e){if((br(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&br(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return uu(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rie(t){const n={x:M(t,"x","sqrt","float32")};return Y.runKernel(Ix,n)}const ii=X({sqrt_:rie});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(t){const e=M(t,"x","square"),n={};return Y.runKernel("Square",{x:e},n)}const ys=X({square_:aie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(t,e=null,n=!1){let r=M(t,"x","sum");r.dtype==="bool"&&(r=zt(r,"int32"));const a={x:r},s={axis:e,keepDims:n};return Y.runKernel(wp,a,s)}const xn=X({sum_:sie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(t,e="euclidean",n=null,r=!1){t=M(t,"x","norm");const a=JW(t,e,n);let s=a.shape;if(r){const o=Yt(n,t.shape);s=ir(a.shape,o)}return xe(a,s)}function JW(t,e,n=null){if(t.rank===0)return Ua(t);if(t.rank!==1&&n===null)return JW(xe(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return xn(Ua(t),n);if(e===1/0)return pc(Ua(t),n);if(e===-1/0)return jw(Ua(t),n);if(e==="euclidean"||e===2)return ii(xn(Wf(Ua(t),bt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return pc(xn(Ua(t),n[0]),n[1]-1);if(e===1/0)return pc(xn(Ua(t),n[1]),n[0]);if(e===-1/0)return jw(xn(Ua(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return ii(xn(ys(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Kx=X({norm_:oie});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iie(t,e=null,n=!1){return Kx(t,"euclidean",e,n)}const ZW=X({euclideanNorm_:iie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lie(t){const n={x:M(t,"x","exp")};return Y.runKernel(Ov,n)}const li=X({exp_:lie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(t,e=0){const n=M(t,"x","expandDims","string_or_numeric");j(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:e};return Y.runKernel(Rv,r,a)}const Ga=X({expandDims_:uie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t){const n={x:M(t,"x","expm1")};return Y.runKernel(Dv,n)}const e6=X({expm1_:cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(t,e){const n=M(t,"x","tile","string_or_numeric");j(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},a={reps:e};return Y.runKernel(Zc,r,a)}const kf=X({tile_:die});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fie(t,e,n,r="float32"){e==null&&(e=t);const a=en([t,e],r),s=t<=e?t:e;for(let i=0;i<s;++i)a.set(1,i,i);const o=xe(a.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return kf(Ga(o,0),[n[0],1,1]);if(n.length===2)return kf(Ga(Ga(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return kf(Ga(Ga(Ga(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const eA=X({eye_:fie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(t){const n={x:M(t,"x","floor","float32")};return Y.runKernel(Mv,n)}const tA=X({floor_:hie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pie(t,e,n=0,r=0){const a=M(t,"x","gather"),s=M(e,"indices","gather","int32"),o={x:a,indices:s},i={axis:n,batchDims:r};return Y.runKernel(Lv,o,i)}const nA=X({gather_:pie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mie(t,e){let n=M(t,"a","greater","string_or_numeric"),r=M(e,"b","greater","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Bv,a)}const Xx=X({greater_:mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(t,e){let n=M(t,"a","greaterEqual","string_or_numeric"),r=M(e,"b","greaterEqual","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(zv,a)}const rA=X({greaterEqual_:gie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yie(t){const n={input:M(t,"input","imag")};return Y.runKernel(MS,n)}const Yx=X({imag_:yie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t){const n={x:M(t,"x","isFinite")};return Y.runKernel(Uv,n)}const t6=X({isFinite_:vie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t){const n={x:M(t,"x","isInf")};return Y.runKernel(Vv,n)}const n6=X({isInf_:xie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t){const n={x:M(t,"x","isNaN")};return Y.runKernel(Wv,n)}const r6=X({isNaN_:bie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(t,e=.2){const r={x:M(t,"x","leakyRelu")},a={alpha:e};return Y.runKernel(ep,r,a)}const aA=X({leakyRelu_:wie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e){let n=M(t,"a","less","string_or_numeric"),r=M(e,"b","less","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Gv,a)}const Mw=X({less_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t,e){let n=M(t,"a","lessEqual","string_or_numeric"),r=M(e,"b","lessEqual","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Hv,a)}const XS=X({lessEqual_:Cie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return Y.runKernel(tp,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(t,e=5,n=1,r=1,a=.5){const s=M(t,"x","localResponseNormalization");j(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),j(kc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=s,i=!1;s.rank===3&&(i=!0,o=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:a},c=Y.runKernel(np,l,u);return i?xe(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const s6=X({localResponseNormalization_:_ie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t){const n={x:M(t,"x","log","float32")};return Y.runKernel(qv,n)}const Gf=X({log_:$ie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(t){const n={x:M(t,"x","log1p")};return Y.runKernel(Kv,n)}const sA=X({log1p_:kie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t){return j(Ql(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const r=M(e,"x","tf.grad","string_or_numeric"),a=n!=null?M(n,"dy","tf.grad"):null;return Y.tidy(()=>{const{value:s,grads:o}=Y.gradients(()=>t(r),[r],a);return a!=null&&_r(s.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),YS(o),o[0]})}}function Iie(t){return j(Ql(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{j(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=Zg(e,"args","tf.grads","string_or_numeric"),a=n!=null?M(n,"dy","tf.grads"):null;return Y.tidy(()=>{const{value:s,grads:o}=Y.gradients(()=>t(...r),r,a);return a!=null&&_r(s.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),YS(o),o})}}function Tie(t){return j(Ql(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{j(e instanceof cn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),j(n==null||n instanceof cn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:a}=Y.gradients(()=>t(e),[e],n);return YS(r),{grad:r[0],value:a}}}function Eie(t){return j(Ql(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{j(Array.isArray(e)&&e.every(a=>a instanceof cn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),j(n==null||n instanceof cn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=Y.gradients(()=>t(...e),e,n);return n!=null&&_r(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),YS(r.grads),r}}function o6(t,e){j(Ql(t),()=>"The f passed in variableGrads(f) must be a function"),j(e==null||Array.isArray(e)&&e.every(u=>u instanceof Jg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in Y.registeredVariables)e.push(Y.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,a=e.length;e=e.filter(u=>u.trainable),j(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const s=!0,{value:o,grads:i}=Y.gradients(t,e,null,s);j(i.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),j(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{i[c]!=null&&(l[u.name]=i[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:o,grads:l}}function ui(t){return Y.customGrad(t)}function YS(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t){const n={x:M(t,"x","neg")};return Y.runKernel(sx,n)}const No=X({neg_:Aie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pie(t){const n={x:M(t,"x","softplus")};return Y.runKernel(Nx,n)}const oA=X({softplus_:Pie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(t){const e=M(t,"x","logSigmoid");return ui(r=>({value:No(oA(No(r))),gradFunc:o=>_e(o,ei(No(r)))}))(e)}const i6=X({logSigmoid_:Oie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(t,e){let n=M(t,"a","sub"),r=M(e,"b","sub");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(jx,a)}const ft=X({sub_:Rie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Die(t,e=-1){const n=M(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return ui((a,s)=>{const i=pc(a,e,!0),l=ft(a,i),u=ft(zt(l,"float32"),Gf(xn(li(l),e,!0)));return s([u]),{value:u,gradFunc:(d,f)=>{const[h]=f,p=!0,g=li(h);return ft(d,_e(xn(d,e,p),g))}}})(n)}const l6=X({logSoftmax_:Die});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jie(t,e=null,n=!1){const r=M(t,"x","logSumExp"),a=Yt(e,r.shape),s=pc(r,a,!0),o=ft(r,s),i=li(o),l=xn(i,a),u=Gf(l),c=Ke(xe(s,u.shape),u);if(n){const d=ir(c.shape,a);return xe(c,d)}return c}const iA=X({logSumExp_:jie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(t,e){const n=M(t,"a","logicalAnd","bool"),r=M(e,"b","logicalAnd","bool");ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Xv,a)}const ry=X({logicalAnd_:Mie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t){const n={x:M(t,"x","logicalNot","bool")};return Y.runKernel(Yv,n)}const lA=X({logicalNot_:Fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(t,e){const n=M(t,"a","logicalOr","bool"),r=M(e,"b","logicalOr","bool");ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Qv,a)}const uA=X({logicalOr_:Lie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(t,e){const n=M(t,"a","logicalXor","bool"),r=M(e,"b","logicalXor","bool");return ct(n.shape,r.shape),ry(uA(t,e),lA(ry(t,e)))}const u6=X({logicalXor_:Bie});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qb=2147483648;function zie(t,e,n="left"){const r=M(t,"sortedSequence","searchSorted"),a=M(e,"values","searchSorted"),s=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],i=xe(r,[-1,s]),l=xe(a,[-1,o]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ne(l.shape)>=Qb)throw new Error(`values tensor size must less than ${Qb}`);if(i.shape[1]>=Qb)throw new Error(`trailing dim_size must less than ${Qb} for int32 output type, was ${i.shape[1]}`);const u={sortedSequence:i,values:l},c={side:n};return Y.runKernel(bp,u,c)}const QS=X({searchSorted_:zie});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(t,e){return QS(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(t,e,n,r,a){const s=M(t,"x","maxPool"),o=1;let i=s,l=!1;s.rank===3&&(l=!0,i=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),j(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),j(Qr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),ro("maxPool",r,a);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=Y.runKernel(ap,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const cA=X({maxPool_:Uie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vie(t,e=[1,1,1],n,r,a,s="NDHWC"){const o=M(t,"x","maxPool3d");let i=o,l=!1;o.rank===4&&(l=!0,i=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),j(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),ro("maxPool3d",r,a);const u={x:i},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:s},d=Y.runKernel(ex,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const d6=X({maxPool3d_:Vie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wie(t,e,n,r,a=!1){const o={x:M(t,"x","maxPoolWithArgmax")},i={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},l=Y.runKernel(tx,o,i);return{result:l[0],indexes:l[1]}}const f6=X({maxPoolWithArgmax_:Wie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(t,e){let n=M(t,"a","maximum"),r=M(e,"b","maximum");[n,r]=Hn(n,r),n.dtype==="bool"&&(n=zt(n,"int32"),r=zt(r,"int32")),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(Zv,a)}const dA=X({maximum_:Gie});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hie(t,e=null,n=!1){const a={x:M(t,"x","mean")},s={axis:e,keepDims:n};return Y.runKernel(sp,a,s)}const ay=X({mean_:Hie});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ci(t,e="float32"){if(ns(t),e==="complex64"){const r=ci(t,"float32"),a=ci(t,"float32");return Hi(r,a)}const n=ai(ne(t),e);return Y.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(t,e="float32"){if(ns(t),e==="complex64"){const r=El(t,"float32"),a=ci(t,"float32");return Hi(r,a)}const n=NE(ne(t),e);return Y.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=M(t,"x","meshgrid",t instanceof cn?t.dtype:"float32");if(e===void 0)return[r];let a=M(e,"y","meshgrid",e instanceof cn?e.dtype:"float32");const s=ne(r.shape),o=ne(a.shape);return n==="xy"?(r=xe(r,[1,-1]),a=xe(a,[-1,1]),[Zt(El([o,1],r.dtype),r),Zt(a,El([1,s],a.dtype))]):(r=xe(r,[-1,1]),a=xe(a,[1,-1]),[Zt(r,El([1,o],r.dtype)),Zt(El([s,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qie(t,e){let n=M(t,"a","minimum"),r=M(e,"b","minimum");[n,r]=Hn(n,r),n.dtype==="bool"&&(n=zt(n,"int32"),r=zt(r,"int32")),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(nx,a)}const Hf=X({minimum_:qie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t,e,n){j(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=M(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");j(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a=n==="reflect"?1:0;for(let i=0;i<r.rank;i++)j(e[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),j(e[i][0]>=0&&e[i][0]<=r.shape[i]-a&&e[i][1]>=0&&e[i][1]<=r.shape[i]-a,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-a} or less than 0 for input of shape ${r.shape}`);const s={paddings:e,mode:n},o={x:r};return Y.runKernel(ip,o,s)}const fA=X({mirrorPad_:Kie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(t,e){let n=M(t,"a","mod"),r=M(e,"b","mod");[n,r]=Hn(n,r);const a={a:n,b:r};return Y.runKernel(rx,a)}const p6=X({mod_:Xie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yie(t,e=null,n=!1){t=M(t,"x","moments");const r=Yt(e,t.shape),a=ay(t,r,n);let s=a.shape;n||(s=ir(a.shape,r));const o=ys(ft(zt(t,"float32"),xe(a,s))),i=ay(o,r,n);return{mean:a,variance:i}}const m6=X({moments_:Yie});function Qie(t,e,n,r){const a=M(e,"data","multiRNNCell"),s=Zg(n,"c","multiRNNCell"),o=Zg(r,"h","multiRNNCell");let i=a;const l=[];for(let d=0;d<t.length;d++){const f=t[d](i,s[d],o[d]);l.push(f[0]),l.push(f[1]),i=f[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const g6=X({multiRNNCell_:Qie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(t,e,n,r=!1){const a=M(t,"logits","multinomial"),s=a.size,o=a.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?xe(a,[1,-1]):a},u={numSamples:e,seed:n,normalized:r},c=Y.runKernel(lp,l,u);return o===1?xe(c,[c.size]):c}const y6=X({multinomial_:Jie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(t,e){let n=M(t,"a","notEqual","string_or_numeric"),r=M(e,"b","notEqual","string_or_numeric");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r};return Y.runKernel(ox,a)}const hA=X({notEqual_:Zie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ele(t,e,n=1,r=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:M(t,"indices","oneHot","int32")},i={dtype:a,depth:e,onValue:n,offValue:r};return Y.runKernel(dp,o,i)}const Fw=X({oneHot_:ele});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(t){const n={x:M(t,"x","onesLike")};return Y.runKernel(lx,n)}const v6=X({onesLike_:tle});function nle(t,e){const n=M(t,"v1","outerProduct"),r=M(e,"v2","outerProduct");j(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const a=xe(n,[-1,1]),s=xe(r,[1,-1]);return Zt(a,s)}const x6=X({outerProduct_:nle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(t,e,n=0){const r=M(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},s={x:r};return Y.runKernel(fp,s,a)}const qi=X({pad_:rle});function ale(t,e,n=0){return j(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),qi(t,[e],n)}const b6=X({pad1d_:ale});function sle(t,e,n=0){return j(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qi(t,e,n)}const w6=X({pad2d_:sle});function ole(t,e,n=0){return j(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qi(t,e,n)}const S6=X({pad3d_:ole});function ile(t,e,n=0){return j(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),qi(t,e,n)}const C6=X({pad4d_:ile});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lle(t,e,n){const r=M(t,"x","spaceToBatchND");j(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),j(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),j(r.shape.reduce((o,i,l)=>l>0&&l<=e.length?o&&(i+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:r},s={blockShape:e,paddings:n};return Y.runKernel(Tx,a,s)}const pA=X({spaceToBatchND_:lle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ule(t,e,n,r,a,s,o){a==null&&(a=[1,1]),s==null&&(s=1),r===0&&(r="valid");const i=M(t,"x","maxPool");let l=i,u=!1;i.rank===3&&(u=!0,l=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),j(Qr(s,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${a}'`);const c=Yr(l.shape,e,s,a,r),d=[c.dilationHeight,c.dilationWidth];let f;r==="same"?f=dle([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[p,g]=cle([c.inHeight,c.inWidth],d,f),y=h?r:"valid",v=h?l:pA(l,d,p),b=(n==="avg"?()=>HE(v,e,s,y,o):()=>cA(v,e,s,y,o))(),w=h?b:qE(b,d,g);return u?xe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function cle(t,e,n){const r=n.map(c=>c[0]),a=n.map(c=>c[1]),s=t.concat(r,a),o=e.map((c,d)=>(c-s[d]%c)%c),i=a.map((c,d)=>c+o[d]),l=e.map((c,d)=>[r[d],i[d]]),u=e.map((c,d)=>[0,o[d]]);return[l,u]}function dle(t,e){const r=t.map((o,i)=>o+(o-1)*(e[i]-1)).map(o=>o-1),a=r.map(o=>Math.floor(o/2)),s=r.map((o,i)=>o-a[i]);return r.map((o,i)=>[a[i],s[i]])}const _6=X({pool_:ule});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(t,e){const n=M(t,"x","prelu"),r=M(e,"alpha","prelu"),a={x:n,alpha:r};return Y.runKernel(hp,a)}const mA=X({prelu_:fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t,e=null,n=!1){let r=M(t,"x","prod");r.dtype==="bool"&&(r=zt(r,"int32"));const a={x:r},s={axis:e,keepDims:n};return Y.runKernel(pp,a,s)}const $6=X({prod_:hle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ple(t,e,n,r){const a=t.map((c,d)=>M(c,`tensors${d}`,"raggedGather","int32")),s=M(e,"paramsDenseValues","raggedGather"),o=M(n,"indices","raggedGather","int32"),i={paramsNestedSplits:a,paramsDenseValues:s,indices:o},l={outputRaggedRank:r},u=Y.runKernel(EE,i,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const k6=X({raggedGather_:ple});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(t,e,n){const r=M(t,"starts","raggedRange"),a=M(e,"limits","raggedRange",r.dtype),s=M(n,"deltas","raggedRange",r.dtype),o={starts:r,limits:a,deltas:s},i=Y.runKernel(AE,o);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}const N6=X({raggedRange_:mle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t,e,n,r,a){const s=M(t,"shape","raggedTensorToTensor","int32"),o=M(e,"values","raggedTensorToTensor"),i=M(n,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,f)=>M(d,`tensors${f}`,"raggedTensorToTensor","int32")),u={shape:s,values:o,defaultValue:i,rowPartitionTensors:l},c={rowPartitionTypes:a};return Y.runKernel(PE,u,c)}const I6=X({raggedTensorToTensor_:gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t,e,n){ns(t);const r=ne(t);let a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)a[s]=e();return Y.makeTensor(a,t,n)}const T6=X({rand_:yle});var gA={exports:{}};gA.exports;(function(t){(function(e,n,r){function a(l){var u=this,c=i();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function s(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new a(l),d=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&s(d,c),f.state=function(){return s(c,{})}),f}function i(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(gn,t)})(gA);var vle=gA.exports,yA={exports:{}};yA.exports;(function(t){(function(e,n,r){function a(i){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},i===(i|0)?l.x=i:u+=i;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function s(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l}function o(i,l){var u=new a(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&s(c,u),d.state=function(){return s(u,{})}),d}n&&n.exports?n.exports=o:this.xor128=o})(gn,t)})(yA);var xle=yA.exports,vA={exports:{}};vA.exports;(function(t){(function(e,n,r){function a(i){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,i===(i|0)?l.x=i:u+=i;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(i,l){return l.x=i.x,l.y=i.y,l.z=i.z,l.w=i.w,l.v=i.v,l.d=i.d,l}function o(i,l){var u=new a(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&s(c,u),d.state=function(){return s(u,{})}),d}n&&n.exports?n.exports=o:this.xorwow=o})(gn,t)})(vA);var ble=vA.exports,xA={exports:{}};xA.exports;(function(t){(function(e,n,r){function a(i){var l=this;l.next=function(){var c=l.x,d=l.i,f,h;return f=c[d],f^=f>>>7,h=f^f<<24,f=c[d+1&7],h^=f^f>>>10,f=c[d+3&7],h^=f^f>>>3,f=c[d+4&7],h^=f^f<<7,f=c[d+7&7],f=f^f<<13,h^=f^f<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var f,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,f=0;f<d.length;++f)h[f&7]=h[f&7]<<15^d.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],c.x=h,c.i=0,f=256;f>0;--f)c.next()}u(l,i)}function s(i,l){return l.x=i.x.slice(),l.i=i.i,l}function o(i,l){i==null&&(i=+new Date);var u=new a(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.x&&s(c,u),d.state=function(){return s(u,{})}),d}n&&n.exports?n.exports=o:this.xorshift7=o})(gn,t)})(xA);var wle=xA.exports,bA={exports:{}};bA.exports;(function(t){(function(e,n,r){function a(i){var l=this;l.next=function(){var c=l.w,d=l.X,f=l.i,h,p;return l.w=c=c+1640531527|0,p=d[f+34&127],h=d[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=d[f]=p^h,l.i=f,p+(c^c>>>16)|0};function u(c,d){var f,h,p,g,y,v=[],x=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,x=Math.max(x,d.length)),p=0,g=-32;g<x;++g)d&&(h^=d.charCodeAt((g+32)%d.length)),g===0&&(y=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(y=y+1640531527|0,f=v[g&127]^=h+y,p=f==0?p+1:0);for(p>=128&&(v[(d&&d.length||0)&127]=-1),p=127,g=4*128;g>0;--g)h=v[p+34&127],f=v[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,v[p]=h^f;c.w=y,c.X=v,c.i=p}u(l,i)}function s(i,l){return l.i=i.i,l.w=i.w,l.X=i.X.slice(),l}function o(i,l){i==null&&(i=+new Date);var u=new a(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.X&&s(c,u),d.state=function(){return s(u,{})}),d}n&&n.exports?n.exports=o:this.xor4096=o})(gn,t)})(bA);var Sle=bA.exports,wA={exports:{}};wA.exports;(function(t){(function(e,n,r){function a(i){var l=this,u="";l.next=function(){var d=l.b,f=l.c,h=l.d,p=l.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-h|0,l.d=h<<16^f>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,i===Math.floor(i)?(l.a=i/4294967296|0,l.b=i|0):u+=i;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function s(i,l){return l.a=i.a,l.b=i.b,l.c=i.c,l.d=i.d,l}function o(i,l){var u=new a(i),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&s(c,u),d.state=function(){return s(u,{})}),d}n&&n.exports?n.exports=o:this.tychei=o})(gn,t)})(wA);var Cle=wA.exports,E6={exports:{}};const _le={},$le=Object.freeze(Object.defineProperty({__proto__:null,default:_le},Symbol.toStringTag,{value:"Module"})),Cl=A4($le);(function(t){(function(e,n,r){var a=256,s=6,o=52,i="random",l=r.pow(a,s),u=r.pow(2,o),c=u*2,d=a-1,f;function h(w,C,_){var $=[];C=C==!0?{entropy:!0}:C||{};var k=v(y(C.entropy?[w,b(n)]:w??x(),3),$),A=new p($),P=function(){for(var O=A.g(s),R=l,B=0;O<u;)O=(O+B)*a,R*=a,B=A.g(1);for(;O>=c;)O/=2,R/=2,B>>>=1;return(O+B)/R};return P.int32=function(){return A.g(4)|0},P.quick=function(){return A.g(4)/4294967296},P.double=P,v(b(A.S),n),(C.pass||_||function(O,R,B,F){return F&&(F.S&&g(F,A),O.state=function(){return g(A,{})}),B?(r[i]=O,R):O})(P,k,"global"in C?C.global:this==r,C.state)}function p(w){var C,_=w.length,$=this,k=0,A=$.i=$.j=0,P=$.S=[];for(_||(w=[_++]);k<a;)P[k]=k++;for(k=0;k<a;k++)P[k]=P[A=d&A+w[k%_]+(C=P[k])],P[A]=C;($.g=function(O){for(var R,B=0,F=$.i,L=$.j,H=$.S;O--;)R=H[F=d&F+1],B=B*a+H[d&(H[F]=H[L=d&L+R])+(H[L]=R)];return $.i=F,$.j=L,B})(a)}function g(w,C){return C.i=w.i,C.j=w.j,C.S=w.S.slice(),C}function y(w,C){var _=[],$=typeof w,k;if(C&&$=="object")for(k in w)try{_.push(y(w[k],C-1))}catch{}return _.length?_:$=="string"?w:w+"\0"}function v(w,C){for(var _=w+"",$,k=0;k<_.length;)C[d&k]=d&($^=C[d&k]*19)+_.charCodeAt(k++);return b(C)}function x(){try{var w;return f&&(w=f.randomBytes)?w=w(a):(w=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(w)),b(w)}catch{var C=e.navigator,_=C&&C.plugins;return[+new Date,e,_,e.screen,b(n)]}}function b(w){return String.fromCharCode.apply(0,w)}if(v(r.random(),n),t.exports){t.exports=h;try{f=Cl}catch{}}else r["seed"+i]=h})(typeof self<"u"?self:gn,[],Math)})(E6);var kle=E6.exports,Nle=vle,Ile=xle,Tle=ble,Ele=wle,Ale=Sle,Ple=Cle,rd=kle;rd.alea=Nle;rd.xor128=Ile;rd.xorwow=Tle;rd.xorshift7=Ele;rd.xor4096=Ale;rd.tychei=Ple;var SA=rd;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=.001,A6=.1;function Rle(t,e,n){return n==null&&(n=CA()),Zk(t,e,(r,a)=>_A(r,a,n))}function CA(){return Y.backend.floatPrecision()===32?Ole:A6}function Zk(t,e,n){let r=!0;if((br(t)||br(e))&&(r=!1),br(t)&&br(e)&&(r=!0),r){const o=t.constructor.name,i=e.constructor.name;if(o!==i)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${i}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=oi(t),i=oi(e);if(!Kt(o,i))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${i}]`)}const a=br(t)?t:eo(t),s=br(e)?e:eo(e);if(a.length!==s.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${s.length}.
Actual:   ${a}.
Expected: ${s}.`);for(let o=0;o<s.length;++o){const i=a[o],l=s[o];if(!n(i,l))throw new Error(`Arrays differ: actual[${o}] = ${i}, expected[${o}] = ${l}.
Actual:   ${a}.
Expected: ${s}.`)}typeof expect<"u"&&expect().nothing()}function Dle(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function jle(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Ko(t)||Ko(t[0])||Ko(e)||Ko(e[0])?Zk(t,n,(r,a)=>r==a):Zk(t,e,(r,a)=>_A(r,a,0))}function Mle(t,e,n){if(n==null&&(n=CA()),!_A(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function _A(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Fle(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function Lle(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function P6(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?P6(n):t[e]=Zo(n)}return t}function Ble(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",r=>n(e)),e.load()})}async function zle(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Ule=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:A6,createVideoElement:Ble,encodeStrings:P6,expectArrayBuffersEqual:Lle,expectArraysClose:Rle,expectArraysEqual:jle,expectNumbersClose:Mle,expectPromiseToFail:Dle,expectValuesInRange:Fle,play:zle,testEpsilon:CA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $A{constructor(e,n,r,a,s){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=s||Math.random();this.random=SA.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,n,r=!1;for(;!r;){let a,s,o;do a=2*this.random()-1,s=2*this.random()-1,o=a*a+s*s;while(o>=1||o===0);const i=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*i,n=this.mean+this.stdDev*s*i,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Vle{constructor(e,n,r,a){this.alpha=e,this.beta=1/n,this.dtype=r;const s=a||Math.random();this.randu=SA.alea(s.toString()),this.randn=new $A(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,a,s,o;for(;;){do a=this.randn.nextValue(),o=1+this.c*a;while(o<=0);if(o*=o*o,e=a*a,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),s=this.randu(),s<n||Math.log(s)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Wle{constructor(e=0,n=1,r,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=SA.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(t,e,n=1,r="float32",a){if(ns(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new Vle(e,n,r,a),o=en(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=s.nextValue();return o.toTensor()}const O6=X({randomGamma_:Gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t,e=0,n=1,r,a){if(ns(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new $A(e,n,r,!1,a),o=en(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=s.nextValue();return o.toTensor()}const kA=X({randomNormal_:Hle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return kA(t,0,1,e,n)}const R6=X({randomStandardNormal_:qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t,e=0,n=1,r="float32",a){ns(t);const s=en(t,r),o=new Wle(e,n,null,a);for(let i=0;i<s.values.length;i++)s.values[i]=o.nextValue();return s.toTensor()}const JS=X({randomUniform_:Kle});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(t,e,n,r){return JS(t,e,n,"int32",r)}const D6=X({randomUniformInt_:Xle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return Y.runKernel(dx,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(t){const n={input:M(t,"input","real")};return Y.runKernel(BS,n)}const Kf=X({real_:Yle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const n={x:M(t,"x","reciprocal")};return Y.runKernel(fx,n)}const j6=X({reciprocal_:Qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(t){const n={x:M(t,"x","relu")};return Y.runKernel(hx,n)}const Qx=X({relu_:Jle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zle(t){const n={x:M(t,"x","relu6")};return Y.runKernel(yx,n)}const NA=X({relu6_:Zle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t,e){const r={x:M(t,"x","reverse")},a={dims:e};return Y.runKernel(yp,r,a)}const eu=X({reverse_:eue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(t){const e=M(t,"x","reverse");return j(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),eu(e,0)}const M6=X({reverse1d_:tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t,e){const n=M(t,"x","reverse");return j(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),eu(n,e)}const F6=X({reverse2d_:nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(t,e){const n=M(t,"x","reverse");return j(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),eu(n,e)}const L6=X({reverse3d_:rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(t,e){const n=M(t,"x","reverse");return j(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),eu(n,e)}const B6=X({reverse4d_:aue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sue(t){const n={x:M(t,"x","round")};return Y.runKernel(vx,n)}const IA=X({round_:sue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(t){const n={x:M(t,"x","rsqrt","float32")};return Y.runKernel(xx,n)}const z6=X({rsqrt_:oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iue(t){const n={x:M(t,"x","selu")};return Y.runKernel(wx,n)}const U6=X({selu_:iue});function lue(t,e,n,r,a,s=[1,1],o="NHWC"){const i=M(t,"x","separableConv2d"),l=M(e,"depthwiseFilter","separableConv2d"),u=M(n,"pointwiseFilter","separableConv2d");let c=i,d=!1;if(i.rank===3&&(d=!0,c=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");j(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),j(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),j(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),j(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),j(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],h=l.shape[3];j(u.shape[2]===f*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*h}, but got ${u.shape[2]}.`);const p=KS(c,l,r,a,o,s),y=qx(p,u,1,"valid",o);return d?xe(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const V6=X({separableConv2d_:lue});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function uue(t,e){const n=M(t,"x","setdiff1d"),r=M(e,"y","setdiff1d");j(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),j(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),j(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const a=await n.data(),s=await r.data(),o=new Set(s);let i=0;for(let c=0;c<a.length;c++)o.has(a[c])||i++;const l=new Ac([i],n.dtype),u=new Ac([i],"int32");for(let c=0,d=0;c<a.length;c++)o.has(a[c])||(l.values[d]=a[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const W6=uue;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const n={x:M(t,"x","sign")};return Y.runKernel($x,n)}const G6=X({sign_:cue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function due(t){const n={x:M(t,"x","sin","float32")};return Y.runKernel(Cx,n)}const H6=X({sin_:due});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t){const n={x:M(t,"x","sinh")};return Y.runKernel(_x,n)}const q6=X({sinh_:fue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(t,e,n){const r=M(t,"x","slice1d");return j(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),gt(r,[e],[n])}const K6=X({slice1d_:hue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t,e,n){const r=M(t,"x","slice2d");return j(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),gt(r,e,n)}const X6=X({slice2d_:pue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mue(t,e,n){const r=M(t,"x","slice3d");return j(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),gt(r,e,n)}const Y6=X({slice3d_:mue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(t,e,n){const r=M(t,"x","slice4d");return j(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),gt(r,e,n)}const Q6=X({slice4d_:gue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t,e=-1){const n=M(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},a={dim:e};return Y.runKernel(Sp,r,a)}const J6=X({softmax_:yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){j(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Y.runKernel(DS,e)}const ZS=X({fft_:vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(t){j(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return Y.runKernel(jS,e)}const sy=X({ifft_:xue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bue(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=xe(t,[n,e]);r=sy(a)}else{const a=[n,2*(e-1)],s=xe(Kf(t),[n,e]),o=xe(Yx(t),[n,e]),i=eu(gt(s,[0,1],[n,e-2]),1),l=_e(eu(gt(o,[0,1],[n,e-2]),1),bt(-1)),u=fr([s,i],1),c=fr([o,l],1),d=xe(Hi(u,c),[a[0],a[1]]);r=sy(d)}if(r=Kf(r),t.rank===3&&t.shape[0]!==0){const a=r,s=t.shape[0];r=xe(r,[s,r.shape[0]/s,r.shape[1]]),a.dispose()}return r}const TA=X({irfft_:bue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t,e,n=0){const a={x:M(t,"x","split")},s={numOrSizeSplits:e,axis:n};return Y.runKernel(Ex,a,s)}const Xf=X({split_:wue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(t,e){j(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(e!=null&&e<n){const p=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,a=gt(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,a=fr([t,ci(p)],t.shape.length-1),n=e}else a=t;const s=Za(a),o=xe(Hi(a,s),[r,n]),i=ZS(o),l=Math.floor(n/2)+1,u=Kf(i),c=Yx(i),d=Xf(u,[l,n-l],u.shape.length-1),f=Xf(c,[l,n-l],c.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=l,xe(Hi(d[0],f[0]),h)}const e2=X({rfft_:Sue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(t,e){let n=M(t,"a","squaredDifference"),r=M(e,"b","squaredDifference");[n,r]=Hn(n,r),ct(n.shape,r.shape);const a={a:n,b:r},s={};return Y.runKernel(Rx,a,s)}const EA=X({squaredDifference_:Cue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t,e){const n=M(t,"x","squeeze","string_or_numeric");return xe(n,Ji(n.shape,e).newShape)}const tn=X({squeeze_:_ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t,e=0){const n=Zg(t,"tensors","stack","string_or_numeric");j(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&j(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:e};return Y.runKernel(ux,r,a)}const di=X({stack_:$ue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kue(t,e=0){const r={x:M(t,"x","step")},a={alpha:e};return Y.runKernel(Np,r,a)}const AA=X({step_:kue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t,e,n,r,a=0,s=0,o=0,i=0,l=0){const c={x:M(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:a,endMask:s,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:l};return Y.runKernel(_p,c,d)}const Z6=X({stridedSlice_:Nue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const n={x:M(t,"x","tan","float32")};return Y.runKernel(Mx,n)}const e5=X({tan_:Iue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jr(t,e){Jc(t);const n=oi(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return uu(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(t,e,n){if(Jc(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=oi(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return uu(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PA(t,e,n){if(Jc(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=oi(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return uu(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t5(t,e,n){if(Jc(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=oi(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return uu(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t,e,n){if(Jc(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=oi(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return uu(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(t,e,n){if(Jc(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=oi(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,uu(t,e,r,n)}function OA(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(s+` update.rank < ${a}. `);if(t.length<r+(n.rank-a))throw new Error(s+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+t.length-r)throw new Error(s+` update.rank != ${a+t.length-r}`);for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(s+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(s+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${t[o+a]})`)}function t2(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}OA(n,e,t)}function jo(t,e,n){const r=e.shape.length,a=r>1?e.shape[r-1]:1,s=n.length;let o=1;for(let d=a;d<s;++d)o*=n[d];const i=a<1?1:a,l=ne(e.shape)/i,u=[...Dt(n.slice(0,a)),1],c=ne(n);return{sliceRank:a,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}const Tue=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:jo,validateInput:t2,validateUpdateShape:OA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t,e,n){const r=M(t,"tensor","tensorScatterupdate"),a=M(e,"indices","tensorScatterupdate","int32"),s=M(n,"updates","tensorScatterupdate");if(t2(s,a,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const o={tensor:r,indices:a,updates:s},i={};return Y.runKernel(xp,o,i)}const a5=X({tensorScatterUpdate_:Eue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(t,e=1,n=!0){const r=M(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const s={x:r},o={k:e,sorted:n},[i,l]=Y.runKernel($p,s,o);return{values:i,indices:l}}const s5=X({topk_:Aue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t,e=0,n=1,r,a){if(ns(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new $A(e,n,r,!0,a),o=en(t,r);for(let i=0;i<o.values.length;i++)o.values[i]=s.nextValue();return o.toTensor()}const o5=X({truncatedNormal_:Pue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oue(t,e=0){const n=M(t,"x","unique","string_or_numeric");j(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[s,o]=Y.runKernel(GS,r,a);return{values:s,indices:o}}const i5=X({unique_:Oue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t,e,n){const r=M(t,"x","unsortedSegmentSum"),a=M(e,"segmentIds","unsortedSegmentSum","int32");j(kc(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:a},o={numSegments:n};return Y.runKernel(HS,s,o)}const l5=X({unsortedSegmentSum_:Rue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(t,e=0){const n=M(t,"x","unstack","string_or_numeric");j(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},a={axis:e};return Y.runKernel(Lx,r,a)}const du=X({unstack_:Due});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u5(t,e){return QS(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t,e=!0,n,r){return Y.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RA(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const r=en(t,"int32"),a=en([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const o=r.indexToLoc(n[s]),i=s*t.length;a.values.set(o,i)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function jue(t){const e=M(t,"condition","whereAsync","bool"),n=await e.data(),r=RA(e.shape,n);return t!==e&&e.dispose(),r}const DA=jue;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mue(t,e,n){const r=M(t,"tensor","boolMask"),a=M(e,"mask","boolMask","bool"),s=n??0,o=a.rank,i=r.shape;j(o>0,()=>"mask cannot be scalar"),_r(i.slice(s,s+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=s;g<s+o;g++)l*=i[g];const u=i.slice(0,s).concat([l],i.slice(s+o)),c=xe(r,u),d=xe(a,[-1]),f=await DA(d),h=tn(f,[1]),p=nA(c,h,s);return t!==r&&r.dispose(),e!==a&&a.dispose(),h.dispose(),c.dispose(),d.dispose(),f.dispose(),p}const d5=Mue;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fue(t,e,n){const r=M(t,"x","transpose");if(e==null&&(e=r.shape.map((o,i)=>i).reverse()),j(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{j(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const a={x:r},s={perm:e};return r.dtype==="complex64"?at(()=>{let o=Kf(r),i=Yx(r);return o=Y.runKernel(Wl,{x:o},s),i=Y.runKernel(Wl,{x:i},s),n&&(i=No(i)),Hi(o,i)}):Y.runKernel(Wl,a,s)}const oy=X({transpose_:Fue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t,e,n,r,a=!0){const s=M(t,"v","movingAverage"),o=M(e,"x","movingAverage"),i=M(n,"decay","movingAverage");qV(s,o),j(Kt(s.shape,o.shape),()=>"Shape mismatch in v and x");const l=bt(1),u=ft(l,i);let c=_e(ft(o,s),u);if(a){j(r!=null,()=>"When using zeroDebias: true, step is required.");const d=M(r,"step","movingAverage");c=$t(c,ft(l,Wf(i,d)))}return Ke(s,c)}const f5=X({movingAverage_:Lue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(t,e,n){ns(n);const r=M(t,"indices","scatterND","int32"),a=M(e,"updates","scatterND");t2(a,r,n);const s={indices:r,updates:a},o={shape:n};return Y.runKernel(vp,s,o)}const h5=X({scatterND_:Bue});function zue(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,s=t.rank>1?t.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t,e,n,r=0){ns(n);const a=M(t,"sparseIndices","sparseToDense","int32"),s=M(e,"sparseValues","sparseToDense","string_or_numeric"),o=M(r,"defaultValue","sparseToDense",s.dtype);zue(a,s,n,o);const i={sparseIndices:a,sparseValues:s,defaultValue:o},l={outputShape:n};return Y.runKernel(Cp,i,l)}const p5=X({sparseToDense_:Uue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t,e){const n=M(e,"indices","gatherND","int32"),a={params:M(t,"x","gatherND","string_or_numeric"),indices:n};return Y.runKernel(Jh,a)}const m5=X({gatherND_:Vue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t,e){if(e==null)return t.shape.slice();if(Kt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t,e,n,r){const a=M(t,"x","dropout");if(j(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),j(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof cn?a.clone():a;const s=Wue(a,n),o=1-e,i=$t(tA(Ke(JS(s,0,1,"float32",r),o)),o);return _e(a,i)}const g5=X({dropout_:Gue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jA(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function n2(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let s=0;s<t;++s){const o=2*Math.PI*s/(t+r-1);a[s]=e-n*Math.cos(o)}return jr(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Hue(t,e,n=1){const r=M(t,"predictions","inTopK"),a=M(e,"targets","inTopK");j(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),j(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),_r(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];j(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const o=await r.data(),i=await a.data(),[l,u]=[o.length/s,s],c=Eo("bool",l);for(let d=0;d<l;d++){const f=d*u,h=o.subarray(f,f+u),p=[];for(let g=0;g<h.length;g++)p.push({value:h[g],index:g});p.sort((g,y)=>y.value-g.value),c[d]=0;for(let g=0;g<n;g++)if(p[g].index===i[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),Qs(c,a.shape,"bool")}const y5=Hue;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function que(t,e,n,r,a,s="NHWC",o){let i=t;t.rank===3&&(i=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]])),j(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),j(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),j(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=s==="NHWC"?i.shape[3]:i.shape[1],c=s==="NHWC"?l.shape[3]:l.shape[1];j(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),j(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),ro("conv2dDerFilter",a,o);const d={x:i,dy:l},f={strides:r,pad:a,dataFormat:s,dimRoundingMode:o,filterShape:n};return Y.runKernel(IS,d,f)}const Kue=X({conv2DBackpropFilter_:que});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r2(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return _e(t,AA(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function a2(t,e){let n=e;const r=YE(t.shape,e.shape);return r.length>0&&(n=xn(n,r)),xe(n,t.shape)}function s2(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Qx(t);if(e==="elu")return JE(t);if(e==="relu6")return NA(t);if(e==="prelu")return mA(t,n);if(e==="leakyrelu")return aA(t,r);if(e==="sigmoid")return ei(t);throw new Error(`Unknown fused activation ${e}.`)}const o2=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",o2(Y.state.gradientDepth,l)===!1){j(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let _=qx(t,e,n,r,a,s,o);return i!=null&&(_=Ke(_,i)),s2(_,l,u,c)}const d=M(t,"x","conv2d","float32"),f=M(e,"filter","conv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=xe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),j(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),j(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),ro("fused conv2d",r,o);const g=a==="NHWC"?h.shape[3]:h.shape[1];j(f.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${f.shape[2]}.`),j(Qr(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const y=Rn(h.shape,f.shape,n,s,r,o);let v;i!=null&&(v=M(i,"bias","fused conv2d"),[v]=Hn(v,d),a==="NHWC"?ct(y.outShape,v.shape):(j(v.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`),j(v.shape.length===0||v.shape[0]===y.outChannels||v.shape[0]===1,()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let x;if(u!=null){const _=u.shape;if(j(_.length<=1||_.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${_.length}.`),_.length===1)j(_[0]===1||_[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the number of output channels (${y.outChannels}).`);else if(_.length===3)try{ct(_,y.outShape)}catch{const k=`Error in fused conv2d: PReLU activation weights (${_}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(k)}x=M(u,"prelu weights","fused conv2d")}const b=(_,$)=>{j(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[k,A,P,O]=$,R=r2(_,P,l);j(ny(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const B=DW(A.shape,R,k,n,r),F=Kue(A,R,k.shape,n,r),L=[B,F];if(O!=null){const H=a2(O,R);L.push(H)}return L},w={x:h,filter:f,bias:v,preluActivationWeights:x},C={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return i==null?ui(($,k,A)=>{let P=Y.runKernel(Tc,w,C);return A([k,$,P]),p&&(P=xe(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:b}})(h,f):ui(($,k,A,P)=>{let O=Y.runKernel(Tc,w,C);return P([k,$,O,A]),p&&(O=xe(O,[O.shape[1],O.shape[2],O.shape[3]])),{value:O,gradFunc:b}})(h,f,v)}const Yue=X({fusedConv2d_:Xue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(t,e,n,r,a,s=[1,1],o){let i=t;t.rank===3&&(i=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:i,dy:l},c={strides:r,pad:a,dimRoundingMode:o,dilations:s,filterShape:n};return Y.runKernel(TS,u,c)}const Jue=X({depthwiseConv2dNativeBackpropFilter_:Que});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zue(t,e,n,r,a,s=[1,1],o){let i=e,l=!1;e.rank===3&&(l=!0,i=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:i,filter:n},c={strides:r,pad:a,dimRoundingMode:o,dilations:s,inputShape:t},d=Y.runKernel(ES,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const ece=X({depthwiseConv2dNativeBackpropInput_:Zue});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tce({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(o2(Y.state.gradientDepth,l)===!1){let C=KS(t,e,n,r,a,s,o);return i!=null&&(C=Ke(C,i)),s2(C,l,u,c)}const d=M(t,"x","depthwiseConv2d","float32"),f=M(e,"filter","depthwiseConv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=xe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),j(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),j(f.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`),j(h.shape[3]===f.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${f.shape[2]}.`),s==null&&(s=[1,1]),j(Qr(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),ro("fused depthwiseConv2d",r,o);const g=Rn(h.shape,f.shape,n,s,r,o,!0);let y;i!=null&&(y=M(i,"bias","fused conv2d"),[y]=Hn(y,d),ct(g.outShape,y.shape));let v;u!=null&&(v=M(u,"prelu weights","fused depthwiseConv2d"));const x=(C,_)=>{j(ny(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[$,k,A,P]=_,O=r2(C,A,l),R=ece(k.shape,O,$,n,r,s,o),B=Jue(k,O,$.shape,n,r,s,o);if(P!=null){const F=a2(y,O);return[R,B,F]}return[R,B]},b={x:h,filter:f,bias:y,preluActivationWeights:v},w={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return i==null?ui((_,$,k)=>{let A=Y.runKernel(Ec,b,w);return k([$,_,A]),p&&(A=xe(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:x}})(h,f):ui((_,$,k,A)=>{let P=Y.runKernel(Ec,b,w);return A([$,_,P,k]),p&&(P=xe(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:x}})(h,f,y)}const nce=X({fusedDepthwiseConv2d_:tce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:a,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:i=.2}){if(o2(Y.state.gradientDepth,s)===!1){let O=Zt(t,e,n,r);return a!=null&&(O=Ke(O,a)),s2(O,s,o,i)}let l=M(t,"a","fused matMul"),u=M(e,"b","fused matMul");[l,u]=Hn(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=ne(p),v=ne(g);j(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=ct(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,h]),w=n?xe(l,[y,c,f]):xe(l,[y,f,c]),C=r?xe(u,[v,h,d]):xe(u,[v,d,h]);let _;a!=null&&(_=M(a,"bias","fused matMul"),[_]=Hn(_,l),ct(b,_.shape));let $;o!=null&&($=M(o,"prelu weights","fused matMul"));const k=(O,R)=>{const[B,F,L,H]=R,te=r2(xe(O,L.shape),L,s);let V,Q;if(!n&&!r?(V=Zt(te,F,!1,!0),Q=Zt(B,te,!0,!1)):!n&&r?(V=Zt(te,F,!1,!1),Q=Zt(te,B,!0,!1)):n&&!r?(V=Zt(F,te,!1,!0),Q=Zt(B,te,!1,!1)):(V=Zt(F,te,!0,!0),Q=Zt(te,B,!0,!0)),a!=null){const se=a2(H,te);return[V,Q,se]}else return[V,Q]},A={a:w,b:C,bias:_,preluActivationWeights:$},P={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:i};return a==null?ui((R,B,F)=>{const L=Y.runKernel(Ic,A,P);return F([R,B,L]),{value:xe(L,b),gradFunc:k}})(w,C):ui((R,B,F,L)=>{const H=Y.runKernel(Ic,A,P);return L([R,B,H,F]),{value:xe(H,b),gradFunc:k}})(w,C,_)}const ace=X({fusedMatMul_:rce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Yue,depthwiseConv2d:nce,matMul:ace},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(t){return n2(t,.54,.46)}const oce=X({hammingWindow_:sce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t){return n2(t,.5,.5)}const x5=X({hannWindow_:ice});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t,e,n,r=!1,a=0){let s=0;const o=[];for(;s+e<=t.size;)o.push(gt(t,s,e)),s+=n;if(r)for(;s<t.size;){const i=s+e-t.size,l=fr([gt(t,s,e-i),Tp([i],a)]);o.push(l),s+=n}return o.length===0?vs([],[0,e]):xe(fr(o),[o.length,e])}const b5=X({frame_:lce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n,r,a=x5){r==null&&(r=jA(e));const s=b5(t,e,n),o=_e(s,a(e));return e2(o,r)}const cce=X({stft_:uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t,e,n,r,a="bilinear",s=0){const o=M(t,"image","cropAndResize"),i=M(e,"boxes","cropAndResize","float32"),l=M(n,"boxInd","cropAndResize","int32"),u=i.shape[0];j(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),j(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${i.shape}.`),j(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${i.shape}.`),j(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),j(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),j(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const c={image:o,boxes:i,boxInd:l},d={method:a,extrapolationValue:s,cropSize:r};return Y.runKernel(Hh,c,d)}const fce=X({cropAndResize_:dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t){const e=M(t,"image","flipLeftRight","float32");j(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return Y.runKernel(Yh,n,{})}const pce=X({flipLeftRight_:hce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t){const e=M(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];j(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),j(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,kf(e,a)}const gce=X({grayscaleToRGB_:mce});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t){const e=M(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];j(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),j(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const a=e.dtype,s=zt(e,"float32"),o=jr([.2989,.587,.114]);let i;switch(e.rank){case 2:i=Hu("ij,j->i",s,o);break;case 3:i=Hu("ijk,k->ij",s,o);break;case 4:i=Hu("ijkl,l->ijk",s,o);break;case 5:i=Hu("ijklm,m->ijkl",s,o);break;case 6:i=Hu("ijklmn,n->ijklm",s,o);break;default:throw new Error("Not a valid tensor rank.")}return i=Ga(i,-1),zt(i,a)}const vce=X({rgbToGrayscale_:yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xce(t,e,n=0,r=.5){const a=M(t,"image","rotateWithOffset","float32");j(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const s={image:a},o={radians:e,fillValue:n,center:r};return Y.runKernel(Ip,s,o)}const bce=X({rotateWithOffset_:xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(t,e,n,r,a,s){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),s==null&&(s=0);const o=t.shape[0];return n=Math.min(n,o),j(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),j(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),j(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),j(e.rank===1,()=>"scores must be a 1D tensor"),j(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),j(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const s=M(t,"boxes","nonMaxSuppression","float32"),o=M(e,"scores","nonMaxSuppression","float32"),i=Ep(s,o,n,r,a);n=i.maxOutputSize,r=i.iouThreshold,a=i.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Y.runKernel(up,{boxes:s,scores:o},l)}const Sce=X({nonMaxSuppression_:wce});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(t,e,n){const r=_ce(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function _ce(t,e,n){return kce(t,e,n||$ce)}function $ce(t,e){return t>e?1:t<e?-1:0}function kce(t,e,n){let r=0,a=t.length,s=0,o=!1;for(;r<a;){s=r+(a-r>>>1);const i=n(e,t[s]);i>0?r=s+1:(a=s,o=!i)}return o?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2(t,e,n,r,a){return FA(t,e,n,r,a,0)}function MA(t,e,n,r,a,s){return FA(t,e,n,r,a,0,!1,s,!0)}function l2(t,e,n,r,a,s){return FA(t,e,n,r,a,s,!0)}function FA(t,e,n,r,a,s,o=!1,i=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>a&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(h3);const c=s>0?-.5/s:0,d=[],f=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:v,boxIndex:x,suppressBeginIndex:b}=y;if(v<a)break;let w=!1;for(let C=d.length-1;C>=b;--C){const _=Nce(t,x,d[C]);if(_>=r){w=!0;break}if(y.score=y.score*Ice(r,c,_),y.score<=a)break}y.suppressBeginIndex=d.length,w||(y.score===v?(d.push(x),f.push(y.score)):y.score>a&&Cce(u,y,h3))}const h=d.length,p=n-h;i&&p>0&&(d.push(...new Array(p).fill(0)),f.push(...new Array(p).fill(0)));const g={selectedIndices:d};return o&&(g.selectedScores=f),l&&(g.validOutputs=h),g}function Nce(t,e,n){const r=t.subarray(e*4,e*4+4),a=t.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),i=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),h=(i-s)*(l-o),p=(d-u)*(f-c);if(h<=0||p<=0)return 0;const g=Math.max(s,u),y=Math.max(o,c),v=Math.min(i,d),x=Math.min(l,f),b=Math.max(v-g,0)*Math.max(x-y,0);return b/(h+p-b)}function Ice(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function h3(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Tce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const s=M(t,"boxes","nonMaxSuppressionAsync"),o=M(e,"scores","nonMaxSuppressionAsync"),i=Ep(s,o,n,r,a);n=i.maxOutputSize,r=i.iouThreshold,a=i.scoreThreshold;const l=await Promise.all([s.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:d}=i2(u,c,n,r,a);return s!==t&&s.dispose(),o!==e&&o.dispose(),jr(d,"int32")}const Ece=Tce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){const o=M(t,"boxes","nonMaxSuppression"),i=M(e,"scores","nonMaxSuppression"),l=Ep(o,i,n,r,a,s);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,s=l.softNmsSigma;const u={boxes:o,scores:i},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:s},d=Y.runKernel(cp,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const Pce=X({nonMaxSuppressionWithScore_:Ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Oce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){const o=M(t,"boxes","nonMaxSuppressionAsync"),i=M(e,"scores","nonMaxSuppressionAsync"),l=Ep(o,i,n,r,a,s);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,s=l.softNmsSigma;const u=await Promise.all([o.data(),i.data()]),c=u[0],d=u[1],{selectedIndices:f,selectedScores:h}=l2(c,d,n,r,a,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),{selectedIndices:jr(f,"int32"),selectedScores:jr(h)}}const Rce=Oce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){const o=M(t,"boxes","nonMaxSuppression"),i=M(e,"scores","nonMaxSuppression"),l=Ep(o,i,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,f={boxes:o,scores:i},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:s},p=Y.runKernel(ix,f,h);return{selectedIndices:p[0],validOutputs:p[1]}}const jce=X({nonMaxSuppressionPadded_:Dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){const o=M(t,"boxes","nonMaxSuppressionAsync"),i=M(e,"scores","nonMaxSuppressionAsync"),l=Ep(o,i,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[f,h]=await Promise.all([o.data(),i.data()]),{selectedIndices:p,validOutputs:g}=MA(f,h,u,c,d,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),{selectedIndices:jr(p,"int32"),validOutputs:bt(g,"int32")}}const Fce=Mce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(t,e,n=!1,r=!1){const a=M(t,"images","resizeBilinear");j(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),j(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),j(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=a,o=!1;a.rank===3&&(o=!0,s=xe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const i={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},u=Y.runKernel(gp,i,l);return o?xe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Bce=X({resizeBilinear_:Lce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t,e,n=!1,r=!1){const a=M(t,"images","resizeNearestNeighbor");j(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),j(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),j(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),j(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=a,o=!1;a.rank===3&&(o=!0,s=xe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const i={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},u=Y.runKernel(mp,i,l);return o?xe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Uce=X({resizeNearestNeighbor_:zce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t,e="binary",n=!1,r=.5){const a=M(t,"image","threshold"),s=.2989,o=.587,i=.114,l=a.shape[0]*a.shape[1];let u=_e(jr([r]),255),c,d,f,h;if(j(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),j(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),j(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),j(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[c,d,f]=Xf(a,[1,1,1],-1);const y=_e(c,s),v=_e(d,o),x=_e(f,i);h=Ke(Ke(y,v),x)}else h=t;if(e==="otsu"){const y=KE(zt(IA(h),"int32"),Qs([]),256);u=Wce(y,l)}const p=n?XS(h,u):Xx(h,u);return zt(_e(p,255),"int32")}function Wce(t,e){let n=jr([-1]),r=jr([0]),a=jr([0]),s,o,i,l,u,c;for(let d=0;d<t.size-1;d++){s=gt(t,0,d+1),o=gt(t,d+1),u=$t(xn(s),e),c=$t(xn(o),e);const f=xn(_e(s,qf(0,s.size)));i=$t(f,xn(s));const h=Tp(o.shape,s.size),p=Ke(qf(0,o.size),h),g=_e(o,p);l=$t(xn(g),xn(o));const y=ft(i,l),v=ft(i,l),x=_e(u,c);a=_e(_e(x,y),v);const b=Xx(a,r);r=ji(b,a,r),n=ji(b,jr([d]),n)}return n}const Gce=X({threshold_:Vce});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n="nearest",r="constant",a=0,s){const o=M(t,"image","transform","float32"),i=M(e,"transforms","transform","float32");j(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),j(i.rank===2&&(i.shape[0]===o.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),j(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:o,transforms:i},u={interpolation:n,fillMode:r,fillValue:a,outputShape:s};return Y.runKernel(kp,l,u)}const qce=X({transform_:Hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(t,e,n){const r=M(t,"a","bandPart");j(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[s,o]=r.shape.slice(-2);let i,l;typeof e=="number"?(j(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),j(e<=s,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${s}).`),i=M(e<0?s:e,"numLower","bandPart")):(j(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),i=ji(Mw(e,0),s,Hf(e,s))),typeof n=="number"?(j(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),j(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),l=M(n<0?o:n,"numUpper","bandPart")):(j(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=ji(Mw(n,0),o,Hf(n,o)));const u=xe(qf(0,s,1,"int32"),[-1,1]),c=qf(0,o,1,"int32"),d=ft(u,c),f=ry(XS(d,i),rA(d,No(l))),h=ci([s,o],r.dtype);return xe(di(du(xe(r,[-1,s,o])).map(p=>ji(f,p,h))),a)}const Xce=X({bandPart_:Kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){let e;if(Array.isArray(t)){e=!1,j(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=t[0].shape[0];for(let s=1;s<t.length;++s)j(t[s].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[s].shape[0]} vs. ${a})`)}else e=!0,t=Xf(t,t.shape[0],0).map(a=>tn(a,[0]));j(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let a=0;a<t.length;++a)n.push(Y.tidy(()=>{let s=r[a];if(a>0)for(let o=0;o<a;++o){const i=_e(xn(_e(n[o],s)),n[o]);s=ft(s,i)}return $t(s,Kx(s,"euclidean"))}));return e?di(n,0):n}const Qce=X({gramSchmidt_:Yce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t,e=!1){if(j(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return p3(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=du(xe(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],s=[];r.forEach(l=>{const[u,c]=p3(l,e);a.push(u),s.push(c)});const o=xe(di(a,0),t.shape),i=xe(di(s,0),t.shape);return[o,i]}}function p3(t,e=!1){return Y.tidy(()=>{j(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let a=eA(n),s=Di(t);const o=vs([[1]],[1,1]);let i=Di(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=s,d=i,f=a;[i,s,a]=Y.tidy(()=>{const h=gt(s,[u,u],[n-u,1]),p=Kx(h),g=gt(s,[u,u],[1,1]),y=ji(Xx(g,0),vs([[-1]]),vs([[1]])),v=ft(g,_e(y,p)),x=$t(h,v);x.shape[0]===1?i=Di(o):i=fr([o,gt(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const b=No($t(Zt(y,v),p)),w=gt(s,[u,0],[n-u,r]),C=_e(b,i),_=oy(i);if(u===0)s=ft(w,Zt(C,Zt(_,w)));else{const A=ft(w,Zt(C,Zt(_,w)));s=fr([gt(s,[0,0],[u,r]),A],0)}const $=oy(C),k=gt(a,[0,u],[n,a.shape[1]-u]);if(u===0)a=ft(k,Zt(Zt(k,i),$));else{const A=ft(k,Zt(Zt(k,i),$));a=fr([gt(a,[0,0],[n,u]),A],1)}return[i,s,a]}),Jt([c,d,f])}return!e&&n>r&&(a=gt(a,[0,0],[n,r]),s=gt(s,[0,0],[r,r])),[a,s]})}const Zce=X({qr_:Jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var da;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(da||(da={}));function ede(t,e,n=da.SUM_BY_NONZERO_WEIGHTS){const r=M(t,"losses","computeWeightedLoss");let a=null;e!=null&&(a=M(e,"weights","computeWeightedLoss"));const s=a==null?r:_e(r,a);if(n===da.NONE)return s;if(n===da.SUM)return xn(s);if(n===da.MEAN){if(a==null)return ay(s);{const o=r.size/a.size,i=$t(xn(s),xn(a));return o>1?$t(i,bt(o)):i}}if(n===da.SUM_BY_NONZERO_WEIGHTS){if(a==null)return $t(xn(s),bt(r.size));{const o=_e(a,El(r.shape)),i=zt(xn(hA(o,bt(0))),"float32");return $t(xn(s),i)}}throw Error(`Unknown reduction: ${n}`)}const Zi=X({computeWeightedLoss_:ede});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(t,e,n,r=da.SUM_BY_NONZERO_WEIGHTS){const a=M(t,"labels","absoluteDifference"),s=M(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=M(n,"weights","absoluteDifference")),_r(a.shape,s.shape,"Error in absoluteDifference: ");const i=Ua(ft(a,s));return Zi(i,o,r)}const nde=X({absoluteDifference_:tde});function rde(t,e,n,r,a=da.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","cosineDistance"),o=M(e,"predictions","cosineDistance");let i=null;r!=null&&(i=M(r,"weights","cosineDistance")),_r(s.shape,o.shape,"Error in cosineDistance: ");const l=bt(1),u=ft(l,xn(_e(s,o),n,!0));return Zi(u,i,a)}const ade=X({cosineDistance_:rde});function sde(t,e,n,r=da.SUM_BY_NONZERO_WEIGHTS){let a=M(t,"labels","hingeLoss");const s=M(e,"predictions","hingeLoss");let o=null;n!=null&&(o=M(n,"weights","hingeLoss")),_r(a.shape,s.shape,"Error in hingeLoss: ");const i=bt(1);a=ft(_e(bt(2),a),i);const l=Qx(ft(i,_e(a,s)));return Zi(l,o,r)}const ode=X({hingeLoss_:sde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(t,e,n,r=1,a=da.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","huberLoss"),o=M(e,"predictions","huberLoss");let i=null;n!=null&&(i=M(n,"weights","huberLoss")),_r(s.shape,o.shape,"Error in huberLoss: ");const l=bt(r),u=Ua(ft(o,s)),c=Hf(u,l),d=ft(u,c),f=Ke(_e(bt(.5),ys(c)),_e(l,d));return Zi(f,i,a)}const lde=X({huberLoss_:ide});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(t,e,n,r=1e-7,a=da.SUM_BY_NONZERO_WEIGHTS){const s=M(t,"labels","logLoss"),o=M(e,"predictions","logLoss");let i=null;n!=null&&(i=M(n,"weights","logLoss")),_r(s.shape,o.shape,"Error in logLoss: ");const l=bt(1),u=bt(r),c=No(_e(s,Gf(Ke(o,u)))),d=_e(ft(l,s),Gf(Ke(ft(l,o),u))),f=ft(c,d);return Zi(f,i,a)}const cde=X({logLoss_:ude});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t,e,n,r=da.SUM_BY_NONZERO_WEIGHTS){const a=M(t,"labels","meanSquaredError"),s=M(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=M(n,"weights","meanSquaredError")),_r(a.shape,s.shape,"Error in meanSquaredError: ");const i=EA(a,s);return Zi(i,o,r)}const fde=X({meanSquaredError_:dde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(t,e){const n=M(t,"labels","sigmoidCrossEntropyWithLogits"),r=M(e,"logits","sigmoidCrossEntropyWithLogits");_r(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Qx(r),s=_e(r,n),o=sA(li(No(Ua(r))));return Ke(ft(a,s),o)}function pde(t,e,n,r=0,a=da.SUM_BY_NONZERO_WEIGHTS){let s=M(t,"multiClassLabels","sigmoidCrossEntropy");const o=M(e,"logits","sigmoidCrossEntropy");let i=null;if(n!=null&&(i=M(n,"weights","sigmoidCrossEntropy")),_r(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=bt(r),c=bt(1),d=bt(.5);s=Ke(_e(s,ft(c,u)),_e(d,u))}const l=hde(s,o);return Zi(l,i,a)}const mde=X({sigmoidCrossEntropy_:pde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return ui((a,s,o)=>{const l=iA(s,[n],!0),u=ft(zt(s,"float32"),l);o([a,u]);const c=No(_e(u,a));return{value:xn(c,[n]),gradFunc:(h,p)=>{const[g,y]=p,v=ir(h.shape,[n]);return[_e(xe(h,v),ft(zt(g,"float32"),li(y))),_e(xe(h,v),ft(li(y),zt(g,"float32")))]}}})(t,e)}function yde(t,e,n,r=0,a=da.SUM_BY_NONZERO_WEIGHTS){let s=M(t,"onehotLabels","softmaxCrossEntropy");const o=M(e,"logits","softmaxCrossEntropy");let i=null;if(n!=null&&(i=M(n,"weights","softmaxCrossEntropy")),_r(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=bt(r),c=bt(1),d=bt(s.shape[1]);s=Ke(_e(s,ft(c,u)),$t(u,d))}const l=gde(s,o);return Zi(l,i,a)}const vde=X({softmaxCrossEntropy_:yde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xde(t,e,n,r){const a=M(t,"indices","sparseFillEmptyRows","int32"),s=M(e,"values","sparseFillEmptyRows"),o=M(n,"denseShape","sparseFillEmptyRows","int32"),i=M(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const l={indices:a,values:s,denseShape:o,defaultValue:i},u=Y.runKernel(zS,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const bde=X({sparseFillEmptyRows_:xde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t,e,n){const r=M(t,"inputIndices","sparseReshape","int32"),a=M(e,"inputShape","sparseReshape","int32"),s=M(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const o={inputIndices:r,inputShape:a,newShape:s},i=Y.runKernel(Ax,o);return{outputIndices:i[0],outputShape:i[1]}}const Sde=X({sparseReshape_:wde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t,e,n){const r=M(t,"data","sparseSegmentMean"),a=M(e,"indices","sparseSegmentMean","int32"),s=M(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const o={data:r,indices:a,segmentIds:s};return Y.runKernel(Px,o)}const _de=X({sparseSegmentMean_:Cde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(t,e,n){const r=M(t,"data","sparseSegmentSum"),a=M(e,"indices","sparseSegmentSum","int32"),s=M(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const o={data:r,indices:a,segmentIds:s};return Y.runKernel(Ox,o)}const kde=X({sparseSegmentSum_:$de});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t,e,n,r,a,s,o,i){const l=M(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=M(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:a,rightPad:s,padWidth:o,preserveShortSequences:i},d={data:l,dataSplits:u},f=Y.runKernel(Dx,d,c);return{nGrams:f[0],nGramsSplits:f[1]}}const Ide=X({stringNGrams_:Nde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tde(t,e,n=!0){const r=M(t,"input","stringSplit","string"),a=M(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const s={skipEmpty:n},o={input:r,delimiter:a},i=Y.runKernel(VS,o,s);return{indices:i[0],values:i[1],shape:i[2]}}const Ede=X({stringSplit_:Tde});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ade(t,e){const n=M(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return Y.runKernel(WS,a,r)}const Pde=X({stringToHashBucketFast_:Ade});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(t,e,n,r=!0){const a=M(t,"input","staticRegexReplace","string"),s={pattern:e,rewrite:n,replaceGlobal:r};return Y.runKernel(OE,{x:a},s)}const Rde=X({staticRegexReplace_:Ode});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5={fft:ZS,ifft:sy,rfft:e2,irfft:TA},S5={hammingWindow:oce,hannWindow:x5,frame:b5,stft:cce},Hl={flipLeftRight:pce,grayscaleToRGB:gce,resizeNearestNeighbor:Uce,resizeBilinear:Bce,rgbToGrayscale:vce,rotateWithOffset:bce,cropAndResize:fce,nonMaxSuppression:Sce,nonMaxSuppressionAsync:Ece,nonMaxSuppressionWithScore:Pce,nonMaxSuppressionWithScoreAsync:Rce,nonMaxSuppressionPadded:jce,nonMaxSuppressionPaddedAsync:Fce,threshold:Gce,transform:qce},C5={bandPart:Xce,gramSchmidt:Qce,qr:Zce},_5={absoluteDifference:nde,computeWeightedLoss:Zi,cosineDistance:ade,hingeLoss:ode,huberLoss:lde,logLoss:cde,meanSquaredError:fde,sigmoidCrossEntropy:mde,softmaxCrossEntropy:vde},$5={sparseFillEmptyRows:bde,sparseReshape:Sde,sparseSegmentMean:_de,sparseSegmentSum:kde},k5={stringNGrams:Ide,stringSplit:Ede,stringToHashBucketFast:Pde,staticRegexReplace:Rde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde=new Map,eN=new Map;class N5{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class _l{constructor(){this.classNameMap={}}static getMap(){return _l.instance==null&&(_l.instance=new _l),_l.instance}static register(e){_l.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function I5(t,e,n){j(t.className!=null,()=>"Class being registered does not have the static className property defined."),j(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),j(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,a=e+">"+r;return _l.register(t),Dde.set(a,t),eN.set(t,a),t}function jde(t){return eN.has(t)?eN.get(t):t.className}const Mde=Object.freeze(Object.defineProperty({__proto__:null,Serializable:N5,SerializationMap:_l,getRegisteredName:jde,registerClass:I5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fu extends N5{minimize(e,n=!1,r){const{value:a,grads:s}=this.computeGradients(e,r);if(r!=null){const o=r.map(i=>({name:i.name,tensor:s[i.name]}));this.applyGradients(o)}else this.applyGradients(s);return Jt(s),n?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return o6(e,n)}dispose(){this.iterations_!=null&&Jt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:bt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(fu,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LA extends fu{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const s=Y.registeredVariables[r],o=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${r}/accum_grad`,variable:at(()=>Za(s).variable(o))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:`${r}/accum_var`,variable:at(()=>Za(s).variable(o))});const i=Array.isArray(e)?e[a].tensor:e[r];if(i==null)return;const l=this.accumulatedGrads[a].variable,u=this.accumulatedUpdates[a].variable;at(()=>{const c=Ke(_e(l,this.rho),_e(ys(i),1-this.rho)),d=_e($t(ii(Ke(u,this.epsilon)),ii(Ke(l,this.epsilon))),i),f=Ke(_e(u,this.rho),_e(ys(d),1-this.rho));l.assign(c),u.assign(f);const h=Ke(_e(d,-this.learningRate),s);s.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Jt(this.accumulatedGrads.map(e=>e.variable)),Jt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BA extends fu{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const s=Y.registeredVariables[r];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${r}/accumulator`,variable:at(()=>Tp(s.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[a].tensor:e[r];if(o==null)return;const i=this.accumulatedGrads[a].variable;at(()=>{const l=Ke(i,ys(o));i.assign(l);const u=Ke(_e($t(o,ii(Ke(l,Y.backend.epsilon()))),-this.learningRate),s);s.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Jt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zA extends fu{static get className(){return"Adam"}constructor(e,n,r,a=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],at(()=>{this.accBeta1=bt(n).variable(),this.accBeta2=bt(r).variable()}),a==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);at(()=>{const r=ft(1,this.accBeta1),a=ft(1,this.accBeta2);n.forEach((s,o)=>{const i=Y.registeredVariables[s],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:at(()=>Za(i).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${s}/v`,variable:at(()=>Za(i).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[s];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,f=Ke(_e(c,this.beta1),_e(u,1-this.beta1)),h=Ke(_e(d,this.beta2),_e(ys(u),1-this.beta2)),p=$t(f,r),g=$t(h,a);c.assign(f),d.assign(h);const y=Ke(_e($t(p,Ke(ii(g),this.epsilon)),-this.learningRate),i);i.assign(y)}),this.accBeta1.assign(_e(this.accBeta1,this.beta1)),this.accBeta2.assign(_e(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Jt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Jt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),at(()=>{this.accBeta1.assign(Wf(this.beta1,this.iterations_+1)),this.accBeta2.assign(Wf(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UA extends fu{static get className(){return"Adamax"}constructor(e,n,r,a=null,s=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],at(()=>{this.iteration=bt(0).variable(),this.accBeta1=bt(n).variable()}),a==null&&(this.epsilon=Y.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);at(()=>{const r=ft(1,this.accBeta1),a=$t(-this.learningRate,Ke(_e(this.iteration,this.decay),1));n.forEach((s,o)=>{const i=Y.registeredVariables[s],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${s}/m`,variable:Za(i).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${s}/v`,variable:Za(i).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[s];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,f=Ke(_e(c,this.beta1),_e(u,1-this.beta1)),h=_e(d,this.beta2),p=Ua(u),g=dA(h,p);c.assign(f),d.assign(g);const y=Ke(_e($t(a,r),$t(f,Ke(g,this.epsilon))),i);i.assign(y)}),this.iteration.assign(Ke(this.iteration,1)),this.accBeta1.assign(_e(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Jt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Jt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u2 extends fu{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const s=Array.isArray(e)?e[a].tensor:e[r];if(s==null)return;const o=Y.registeredVariables[r];at(()=>{const i=Ke(_e(this.c,s),o);o.assign(i)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Co(bt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VA extends u2{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=bt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const s=Y.registeredVariables[r];this.accumulations[a]==null&&(this.accumulations[a]={originalName:`${r}/momentum`,variable:at(()=>Za(s).variable(!1))});const o=this.accumulations[a].variable,i=Array.isArray(e)?e[a].tensor:e[r];i!=null&&at(()=>{let l;const u=Ke(_e(this.m,o),i);this.useNesterov?l=Ke(_e(this.c,Ke(i,_e(u,this.m))),s):l=Ke(_e(this.c,u),s),o.assign(u),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Jt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WA extends fu{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,a=null,s=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,a==null&&(this.epsilon=Y.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,a)=>{const s=Y.registeredVariables[r],o=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:`${r}/rms`,variable:at(()=>Za(s).variable(o))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:`${r}/momentum`,variable:at(()=>Za(s).variable(o))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:`${r}/mg`,variable:at(()=>Za(s).variable(o))});const i=Array.isArray(e)?e[a].tensor:e[r];if(i==null)return;const l=this.accumulatedMeanSquares[a].variable,u=this.accumulatedMoments[a].variable;at(()=>{const c=Ke(_e(l,this.decay),_e(ys(i),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[a].variable,f=Ke(_e(d,this.decay),_e(i,1-this.decay)),h=$t(_e(i,this.learningRate),ii(ft(c,Ke(ys(f),this.epsilon)))),p=Ke(_e(u,this.momentum),h);l.assign(c),d.assign(f),u.assign(p);const g=ft(s,p);s.assign(g)}else{const d=Ke(_e(l,this.decay),_e(ys(i),1-this.decay)),f=Ke(_e(u,this.momentum),$t(_e(i,this.learningRate),ii(Ke(d,this.epsilon))));l.assign(d),u.assign(f);const h=ft(s,f);s.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Jt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Jt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Jt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fde=[LA,BA,zA,UA,VA,WA,u2];function Lde(){for(const t of Fde)I5(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bde="model",zde=".json",Ude=".weights.bin";function m3(t){return new Promise(e=>setTimeout(e)).then(t)}class Fc{constructor(e){if(!ee().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Fc.URL_SCHEME)&&(e=e.slice(Fc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Bde),this.modelJsonFileName=e+zde,this.weightDataFileName=e+Ude}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Ro.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=nW(e,a),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await m3(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await m3(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Gx(e)}}}}Fc.URL_SCHEME="downloads://";class Vde{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=a=>{const s=JSON.parse(a.target.result),o=s.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const l=zE(s,u=>this.loadWeights(u));e(l)},r.onerror=a=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const a=this.checkManifestAndWeightFiles(e),s=r.map(o=>this.loadWeightsFile(o,a[o]));return Promise.all(s).then(o=>[n,o])}loadWeightsFile(e,n){return new Promise((r,a)=>{const s=new FileReader;s.onload=o=>{const i=o.target.result;r(i)},s.onerror=o=>a(`Failed to weights data from file of path '${e}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(s=>f3(s.name)),a={};for(const s of e)s.paths.forEach(o=>{const i=f3(o);if(n.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),r.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);a[o]=this.weightsFiles[r.indexOf(i)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const Wde=t=>ee().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Fc.URL_SCHEME)?Gde(t.slice(Fc.URL_SCHEME.length)):null;Vn.registerSaveRouter(Wde);function Gde(t="model"){return new Fc(t)}function Hde(t){return new Vde(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3(t,e,n,r){o(t),n=n??0,r=r??1,i(n,r);let a=0;const s=l=>(l.then(u=>{const c=n+ ++a/t.length*(r-n);return e(c),u}),l);function o(l){j(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function i(l,u){j(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),j(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),j(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function T5(t,e){e==null&&(e={});const n=e.fetchFunc==null?ee().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),i=(e.onProgress==null?await Promise.all(r):await g3(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(i):await g3(i,e.onProgress,.5,1)}function qde(t,e){var n;const r=e.fetchFunc==null?ee().platform.fetch:e.fetchFunc;let a=0,s;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var i;a<t.length;){s||(s=(await r(t[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await s.read();if(l){a++,s=void 0,(i=e.onProgress)===null||i===void 0||i.call(e,a/t.length);continue}o.enqueue(u);return}o.close()}})}async function Kde(t,e="",n,r){return E5(o=>T5(o,{requestInit:r}))(t,e,n)}function E5(t){return async(e,n="",r)=>{const a=e.map(()=>!1),s={},o=r!=null?r.map(()=>!1):[],i=[];if(e.forEach((h,p)=>{let g=0;h.weights.forEach(y=>{const v="quantization"in y?y.quantization.dtype:y.dtype,x=Pc[v]*ne(y.shape),b=()=>{a[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:y,groupOffset:g,sizeBytes:x})};r!=null?r.forEach((w,C)=>{w===y.name&&(b(),o[C]=!0)}):b(),i.push(y.name),g+=x})}),!o.every(h=>h)){const h=r.filter((p,g)=>!o[g]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const l=a.reduce((h,p,g)=>(p&&h.push(g),h),[]),u=[];l.forEach(h=>{e[h].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;u.push(g)})});const c=await t(u),d={};let f=0;return l.forEach(h=>{const p=e[h].paths.length,g=new Ro(c.slice(f,f+p));s[h].forEach(v=>{const x=g.slice(v.groupOffset,v.groupOffset+v.sizeBytes),b=ZV(x,[v.manifestEntry]);for(const w in b)d[w]=b[w]}),f+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde="application/octet-stream",Yde="application/json";class GA{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(j(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ee().platform.fetch,j(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&j(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=nW(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(a)],{type:Yde}),"model.json"),e.weightData!=null){const o=Ro.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:Xde}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:Gx(e),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const r=n.modelTopology,a=n.weightsManifest;if(r==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return zE(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=Kk(e.weightsManifest),a=()=>qde(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:a})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,a]=Qde(n),s=this.weightPathPrefix||r,o=[],i=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(u)):o.push(s+u+a);return this.weightUrlConverter&&o.push(...await Promise.all(i)),o}async loadWeights(e){const n=await this.getWeightUrls(e),r=Kk(e),a=await T5(n,this.loadOptions);return[r,a]}}GA.URL_SCHEME_REGEX=/^https?:\/\//;function Qde(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}function tN(t){return t.match(GA.URL_SCHEME_REGEX)!=null}const A5=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>tN(r)):n=tN(t),n)return HA(t,e)}return null};Vn.registerSaveRouter(A5);Vn.registerLoadRouter(A5);function HA(t,e){return new GA(t,e)}function Jde(t,e){return HA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I_{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class P5{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Zde{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function efe(t,e,n,r){const a=arguments;return new Zde(O5(...a))}function O5(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new I_(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I_({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new I_({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function tfe(t){return new P5(t)}function nfe(t){return new P5(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qA=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ro,browserFiles:Hde,browserHTTPRequest:Jde,concatenateArrayBuffers:sse,copyModel:Nse,decodeWeights:ZV,decodeWeightsStream:tW,encodeWeights:Zae,fromMemory:efe,fromMemorySync:O5,getLoadHandlers:hse,getModelArtifactsForJSON:zE,getModelArtifactsForJSONSync:rW,getModelArtifactsInfoForJSON:Gx,getSaveHandlers:fse,getWeightSpecs:Kk,http:HA,isHTTPScheme:tN,listModels:$se,loadWeights:Kde,moveModel:Ise,registerLoadRouter:dse,registerSaveRouter:cse,removeModel:kse,weightsLoaderFactory:E5,withSaveHandler:tfe,withSaveHandlerSync:nfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t,e,n){const r=M(t,"labels","confusionMatrix"),a=M(e,"predictions","confusionMatrix");j(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),j(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),j(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),j(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),j(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const s=Fw(zt(r,"int32"),n),o=Fw(zt(a,"int32"),n),i=oy(s),l=Zt(i,o);return zt(l,"int32")}const afe=X({confusionMatrix_:rfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sfe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:afe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Au,y3=!1;function R5(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,s=!1,o=!1,i=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)s=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Qg(Xg,Y.backendName)!=null){const p={pixels:t},g={numChannels:e};return Y.runKernel(Xg,p,g)}const[u,c]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(o)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(s||a||i){if(Au==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Au=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Au=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Au.canvas.width=u,Au.canvas.height=c,Au.drawImage(t,0,0,u,c),d=Au.getImageData(0,0,u,c).data}let f;if(e===4)f=new Int32Array(d);else{const p=u*c;f=new Int32Array(p*e);for(let g=0;g<p;g++)for(let y=0;y<e;++y)f[g*e+y]=d[g*4+y]}return PA(f,[c,u,e],"int32")}function ofe(t){return t!=null&&t.data instanceof Uint8Array}function ife(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function lfe(t){return t!=null&&t.width!==0&&t.height!==0}function ufe(t){return ife()&&!(t instanceof ImageBitmap)&&lfe(t)&&!ofe(t)}async function cfe(t,e=3){let n=null;if(ee().getBool("WRAP_TO_IMAGEBITMAP")&&ufe(t)){let r;try{r=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===t.width&&r.height===t.height?n=r:n=t}else n=t;return R5(n,e)}function D5(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function dfe(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function c2(t,e){let n=M(t,"img","toPixels");if(!(t instanceof cn)){const u=n;n=zt(u,"int32"),u.dispose()}D5(n);const[r,a]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],o=await n.data(),i=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let u=0;u<r*a;++u){const c=[0,0,0,255];for(let f=0;f<s;f++){const h=o[u*s+f];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);s===1?(c[0]=h*i,c[1]=h*i,c[2]=h*i):c[f]=h*i}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){y3||Qg(OS,Y.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),y3=!0),e.width=a,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,a,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}function ffe(t,e,n){let r=M(t,"img","draw");if(!(t instanceof cn)){const o=r;r=zt(o,"int32"),o.dispose()}D5(r),dfe(n==null?void 0:n.imageOptions);const a={image:r},s={canvas:e,options:n};Y.runKernel(OS,a,s)}const KA=X({fromPixels_:R5}),hfe=Object.freeze(Object.defineProperty({__proto__:null,draw:ffe,fromPixels:KA,fromPixelsAsync:cfe,toPixels:c2},Symbol.toStringTag,{value:"Module"}));function Jx(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(ne(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,s=a[a.length-1];let o=1;for(let d=0;d<a.length-1;++d)o*=a[d];const i=t.shape,l=a.slice();l.pop();let u=1;for(let d=s;d<n;++d)u*=i[d],l.push(i[d]);const c=[...Dt(t.shape).map(d=>d/u),1].slice(0,s);return[l,o,u,c]}const pfe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Jx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nN=-2,mfe=-1;function XA(t,e,n){const r=t.shape.length;j(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),j(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)j(e[a]+n[a]<=t.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`)}function gfe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function d2(t,e,n){const r=[];for(let a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function j5(t,e,n,r){const a=[...t];for(let s=a.length;s<r.length;s++)a.push(1);for(let s=0;s<n;s++)s===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function M5(t,e,n){return n<=t?n:n-(e-1)}function F5(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function yfe(t,e,n,r,a,s,o,i,l){const u=t.length;let c=new Array(u),d=new Array(u),f=new Array(u);if(e.length&&n>0){const h=e[0],p=n+1;c=L5(o,h,p,r,t),d=B5(i,h,p,a,t),f=j5(s,h,p,t)}else for(let h=0;h<u;h++)c[h]=U5(o,r,s,t,h,l),d[h]=V5(i,a,s,t,h,l),f[h]=z5(s,h,l);return{begin:c,end:d,strides:f}}function L5(t,e,n,r,a){const s=[...a],o=F5(n,e);for(let i=0;i<s.length;i++)if(o.indexOf(i)>-1)s[i]=0;else{const l=M5(e,n,i);let u=r[l];t&1<<l&&(u=0),s[i]=u}return s}function B5(t,e,n,r,a){const s=[...a],o=F5(n,e);for(let i=0;i<s.length;i++)if(o.indexOf(i)>-1)s[i]=Number.MAX_SAFE_INTEGER;else{const l=M5(e,n,i);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),s[i]=u}for(let i=0;i<s.length;i++){const l=a[i];s[i]<0&&(s[i]+=l),s[i]=Kg(0,s[i],a[i])}return s}function z5(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function U5(t,e,n,r,a,s){let o=e[a];const i=n[a]||1;(t&1<<a||s&1<<a||o==null)&&(i>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),o=Kg(0,o,l-1),o}function V5(t,e,n,r,a,s){let o=e[a];const i=n[a]||1;(t&1<<a||s&1<<a||o==null)&&(i>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),i>0?o=Kg(0,o,l):o=Kg(-1,o,l-1),o}function f2(t,e,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function h2(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function p2(t,e,n){let r;const a=t.shape.length;typeof e=="number"?r=[e,...new Array(a-1).fill(0)]:e.length<a?r=e.concat(new Array(a-e.length).fill(0)):r=e.slice(),r.forEach(o=>{j(o!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(a).fill(-1):typeof n=="number"?s=[n,...new Array(a-1).fill(-1)]:n.length<a?s=n.concat(new Array(a-n.length).fill(-1)):s=n,s=s.map((o,i)=>o>=0?o:(j(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${i}.`),t.shape[i]-r[i])),[r,s]}function m2(t,e,n,r,a,s,o,i,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:s,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&i&&d.numAddAxisAfterEllipsis++,1<<b&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};vfe(d,f);let h=!0,p=!0,g=!0;const y=[],v=[];for(let b=0;b<t.length;++b){if(f.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const w=!!(f.shrinkAxisMask&1<<b),C=t[b];if(C===-1){y.push(w?1:-1);continue}const _=[f.beginMask&1<<b,f.endMask&1<<b],$=[f.strides[b]>0?0:-1,f.strides[b]>0?C:C-1];if(w&&f.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&f.strides[b]===1;const k=!!(f.beginMask&1<<b&&f.endMask&1<<b);if(f.beginValid&&f.endValid){if(w){const R=f.begin[b]<0?C+f.begin[b]:f.begin[b];if(f.begin[b]=R,f.end[b]=f.begin[b]+1,R<0||R>=C)throw Error(`slice index ${f.begin[b]} of dimension ${b} out of bounds.`)}else f.begin[b]=v3(f.begin[b],0,f.strides[b],C,_,$),f.end[b]=v3(f.end[b],1,f.strides[b],C,_,$);const O=f.strides[b]===1&&f.begin[b]===0&&f.end[b]===C;h=h&&O,p=p&&(b===0&&f.strides[b]===1||O)}else h=h&&f.strides[b]===1&&k,p=p&&(b===0&&f.strides[b]===1||k);let A,P=!1;if(f.beginValid&&f.endValid?(A=f.end[b]-f.begin[b],P=!0):w?(A=1,P=!0):k&&C>=0&&(f.strides[b]<0?A=-C:A=C,P=!0),P){let O;A===0||A<0!=f.strides[b]<0?O=0:O=Math.trunc(A/f.strides[b])+(A%f.strides[b]!==0?1:0),y.push(O)}else y.push(-1)}for(let b=0;b<f.finalShapeGatherIndices.length;++b){const w=f.finalShapeGatherIndices[b];w>=0?v.push(y[w]):w===nN&&v.push(1)}return{finalShapeSparse:v.filter((b,w)=>f.finalShapeGatherIndices[w]!==nN),finalShape:v,isIdentity:h,sliceDim0:p,isSimpleSlice:g,begin:f.begin,end:f.end,strides:f.strides}}function vfe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(nN),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(mfe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function v3(t,e,n,r,a,s){if(a[e])return n>0?s[e]:s[e+1&1];{const o=t<0?r+t:t;return o<s[0]?s[0]:o>s[1]?s[1]:o}}const W5=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:XA,computeFlatOffset:h2,computeOutShape:d2,getNormalizedAxes:yfe,isSliceContinous:f2,maskToAxes:gfe,parseSliceParams:p2,sliceInfo:m2,startForAxis:U5,startIndicesWithElidedDims:L5,stopForAxis:V5,stopIndicesWithElidedDims:B5,stridesForAxis:z5,stridesWithElidedDims:j5},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const xfe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G5{static sgd(e){return new u2(e)}static momentum(e,n,r=!1){return new VA(e,n,r)}static rmsprop(e,n=.9,r=0,a=null,s=!1){return new WA(e,n,r,a,s)}static adam(e=.001,n=.9,r=.999,a=null){return new zA(e,n,r,a)}static adadelta(e=.001,n=.95,r=null){return new LA(e,n,r)}static adamax(e=.002,n=.9,r=.999,a=null,s=0){return new UA(e,n,r,a,s)}static adagrad(e,n=.1){return new BA(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bfe=G5;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wfe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function YA(){return new Promise(t=>wfe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(t,e){const n=t[0].length;t.forEach((a,s)=>{j(a.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),j(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((a,s)=>{for(let o=0;o<n;o++)j(o===e||a[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${s}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Na(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(bo||(bo={}));function H5(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){const s=n[a],o=r[r.length-n.length+a],i=r[o];if(s>=0)if(i>=0){if(i!==s)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${s} but shape[${a+t}] = ${i}`)}else r[o]=s}return r}function q5(t){const e={FIRST_DIM_SIZE:bo.FIRST_DIM_SIZE,VALUE_ROWIDS:bo.VALUE_ROWIDS,ROW_LENGTHS:bo.ROW_LENGTHS,ROW_SPLITS:bo.ROW_SPLITS,ROW_LIMITS:bo.ROW_LIMITS,ROW_STARTS:bo.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function K5(t){return t.length===0?0:t[0]===bo.FIRST_DIM_SIZE?t.length-1:t.length}function X5(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){const s=t[a],o=e[a+1];if(s>=0&&o>=0&&s!==1&&s!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${s} but ragged tensor input.flatValues.shape[${a-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QA=30;function y2(t){return t<=QA?t:Aw(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2(t,e,n){const r=n*(typeof t=="number"?t:t[0]),a=e*(typeof t=="number"?t:t[1]);return[r,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ad(t,e,n,r=!0){let a=[];if(r)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const s=e.length;for(let o=0;o<s;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(s+1))}return a}function sd(t,e,n=!0){const r=[];if(n){r.push(e);for(let a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{const a=[],s=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?s.push(o):a.push(o);r.push(...a),r.push(0),r.push(...s)}return r}function od(t,e,n,r=!0){const a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(let s=1;s<t.length;++s)s<=e.length?r?a.push(e[s-1]*t[s]):a.push(t[s]/e[s-1]):a.push(t[s]);return a}function x2(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function b2(t,e,n){const r=t.slice(0,1);for(let a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JA=1.7580993408473768,ZA=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP=.3275911,tP=.254829592,nP=-.284496736,rP=1.421413741,aP=-1.453152027,sP=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iy(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Sfe(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Cfe(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function _fe(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function $fe(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function kfe(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function Nfe(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const s=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(s),r[a]=Math.sin(s)}return{real:n,imag:r}}function Ife(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),a=Math.cos(r),s=Math.sin(r);return{real:a,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_="->",Tfe=/->/g,x3=",",b3="...";function oP(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Tfe,"").length)/T_.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${T_}").`);const[r,a]=t.split(T_);j(r.indexOf(b3)===-1,()=>`The ellipsis notation ("${b3}") is not supported yet.`);const s=r.split(x3),o=s.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let f=0;f<a.length;++f){const h=a[f];if(!s.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);i.indexOf(h)===-1&&i.push(h)}for(let f=0;f<r.length;++f){const h=r[f];i.indexOf(h)===-1&&h!==x3&&i.push(h)}const l=new Array(s.length);for(let f=0;f<o;++f){if(new Set(s[f].split("")).size!==s[f].length)throw new Error(`Found duplicate axes in input component ${s[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let h=0;h<s[f].length;++h)l[f].push(i.indexOf(s[f][h]))}const u=i.length,c=a.length,d=[];for(let f=c;f<u;++f)d.push(f);return{allDims:i,summedDims:d,idDims:l}}function iP(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const r=[];for(let a=0;a<t;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function lP(t,e,n){const r=new Array(t);for(let a=0;a<n.length;++a){const s=n[a].shape;for(let o=0;o<e[a].length;++o)r[e[a][o]]===void 0?r[e[a][o]]=s[o]:j(r[e[a][o]]===s[o],()=>`Expected dimension ${r[e[a][o]]} at axis ${o} of input shaped ${JSON.stringify(s)}, but got dimension ${s[o]}`)}}function uP(t,e){const n=t,r=[];let a=0;t.length===0&&n.push(-1),a=t.length+1;for(let o=0;o<a;++o)r.push([]);const s=[];for(let o=0;o<n.length;++o){const i=n[o],l=Efe(e,i);for(const u of l)s.indexOf(u)===-1&&(r[o].push(u),s.push(u))}return{path:n,steps:r}}function cP(t){return t.every((e,n)=>e===n)}function Efe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function w2(t,e,n=0){let r=[];if(typeof e=="number")j(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((o,i)=>(i===-1&&(o+=1),o),0);j(a<=1,()=>"There should be only one negative value in split array.");const s=e.indexOf(-1);if(s!==-1){const o=e.reduce((i,l)=>l>0?i+l:i);e[s]=t.shape[n]-o}j(t.shape[n]===e.reduce((o,i)=>o+i),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dP(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function fP(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function hP(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function mP(t,e){return`size ${t} must be non-negative, not ${e}`}function gP(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function yP(t,e){const n=ne(t),r=ne(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function vP(t,e){const n=ne(t),r=ne(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ly(){return"segment ids must be >= 0"}function xP(){return"segment ids are not increasing"}function bP(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function wP(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(t,e){let n=!1,r;for(t<=QA?(r=t,n=!0):r=Aw(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Aw(t,r+1);return r}function SP(t,e,n){const r=[],a=t.length;for(let s=0;s<a;s++)s!==e?r.push(t[s]):r.push(n);return r}function S2(t,e,n,r){const a=e.shape.length,s=t.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],i=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)i.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)i.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<a;d++)i.push(e.shape[d]);for(let d=n+1;d<s;d++)i.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:i}}const Afe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:S2,computeOutShape:SP,segOpComputeOptimalWindowSize:Y5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t){try{return t.map(e=>si(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function CP(t){return t.map(e=>Zo(e))}const Q5=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:tP,ERF_A2:nP,ERF_A3:rP,ERF_A4:aP,ERF_A5:sP,ERF_P:eP,PARALLELIZE_THRESHOLD:QA,get RowPartitionType(){return bo},SELU_SCALE:ZA,SELU_SCALEALPHA:JA,applyActivation:s2,assertAndGetBroadcastShape:ct,assertAxesAreInnerMostDims:Yn,assertParamsConsistent:g2,assignToTypedArray:kfe,axesAreInnerMostDims:ZE,calculateShapes:jo,checkEinsumDimSizes:lP,checkPadOnDimRoundingMode:ro,combineLocations:QW,combineRaggedTensorToTensorShapes:H5,complexWithEvenIndex:Cfe,complexWithOddIndex:_fe,computeConv2DInfo:Rn,computeConv3DInfo:Do,computeDefaultPad:GE,computeDilation2DInfo:cu,computeOptimalWindowSize:y2,computeOutAndReduceShapes:mr,computeOutShape:Na,computePool2DInfo:Yr,computePool3DInfo:$s,convertConv2DDataFormat:ks,decodeEinsumEquation:oP,eitherStridesOrDilationsAreOne:Qr,expandShapeToKeepDim:ir,exponent:Ife,exponents:Nfe,fromStringArrayToUint8:CP,fromUint8ToStringArray:tu,getAxesPermutation:gr,getBroadcastDims:Mc,getComplexWithIndex:$fe,getEinsumComputePath:uP,getEinsumPermutation:iP,getFusedBiasGradient:a2,getFusedDyActivation:r2,getImageCenter:v2,getInnerMostAxes:Qn,getPermuted:sd,getRaggedRank:K5,getReductionAxes:YE,getReshaped:ad,getReshapedPermuted:od,getRowPartitionTypesHelper:q5,getSliceBeginCoords:x2,getSliceSize:b2,getSparseFillEmptyRowsIndicesDenseShapeMismatch:dP,getSparseFillEmptyRowsNegativeIndexErrorMessage:fP,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:hP,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:gP,getSparseReshapeInputOutputMismatchErrorMessage:vP,getSparseReshapeInputOutputMultipleErrorMessage:yP,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:pP,getSparseReshapeNegativeOutputDimErrorMessage:mP,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:wP,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:ly,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:xP,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:bP,getUndoAxesPermutation:nd,isIdentityPermutation:cP,log:iae,mergeRealAndImagArrays:iy,prepareAndValidate:Jx,prepareSplitSize:w2,segment_util:Afe,shouldFuse:o2,slice_util:W5,splitRealAndImagArrays:Sfe,stridesOrDilationsArePositive:jc,tupleValuesAreOne:ny,upcastType:pa,validateDefaultValueShape:X5,validateInput:t2,validateUpdateShape:OA,warn:Us},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:i2,nonMaxSuppressionV4Impl:MA,nonMaxSuppressionV5Impl:l2,whereImpl:RA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Lde();const Ofe=Object.freeze(Object.defineProperty({__proto__:null,Abs:lv,Acos:uv,Acosh:cv,AdadeltaOptimizer:LA,AdagradOptimizer:BA,AdamOptimizer:zA,AdamaxOptimizer:UA,Add:Ah,AddN:Ph,All:Oh,Any:Rh,ArgMax:dv,ArgMin:fv,Asin:hv,Asinh:pv,Atan:mv,Atan2:yv,Atanh:gv,AvgPool:Dh,AvgPool3D:vv,AvgPool3DGrad:_S,AvgPoolGrad:CS,BatchMatMul:jh,BatchToSpaceND:xv,Bincount:Mh,BitwiseAnd:$S,BroadcastArgs:bv,BroadcastTo:tae,Cast:Fh,Ceil:wv,ClipByValue:Lh,Complex:kS,ComplexAbs:NS,Concat:Sv,Conv2D:Bh,Conv2DBackpropFilter:IS,Conv2DBackpropInput:zh,Conv3D:Uh,Conv3DBackpropFilterV2:Cv,Conv3DBackpropInputV2:Vh,Cos:_v,Cosh:$v,CropAndResize:Hh,Cumprod:Wh,Cumsum:Gh,DataStorage:xS,DenseBincount:kv,DepthToSpace:qh,DepthwiseConv2dNative:Kh,DepthwiseConv2dNativeBackpropFilter:TS,DepthwiseConv2dNativeBackpropInput:ES,Diag:Nv,Dilation2D:Xh,Dilation2DBackpropFilter:PS,Dilation2DBackpropInput:AS,Draw:OS,get ENV(){return IE},Einsum:RS,Elu:Tv,EluGrad:Ev,Environment:EV,Equal:Pv,Erf:Av,Exp:Ov,ExpandDims:Rv,Expm1:Dv,FFT:DS,Fill:jv,FlipLeftRight:Yh,Floor:Mv,FloorDiv:Fv,FromPixels:Xg,FusedBatchNorm:Qh,FusedConv2D:Tc,FusedDepthwiseConv2D:Ec,GatherNd:Jh,GatherV2:Lv,Greater:Bv,GreaterEqual:zv,IFFT:jS,Identity:Zh,Imag:MS,IsFinite:Uv,IsInf:Vv,IsNan:Wv,KernelBackend:iv,LRN:np,LRNGrad:Jv,LeakyRelu:ep,Less:Gv,LessEqual:Hv,LinSpace:tp,Log:qv,Log1p:Kv,LogSoftmax:nae,LogicalAnd:Xv,LogicalNot:Yv,LogicalOr:Qv,LogicalXor:PV,LowerBound:rae,MatrixBandPart:aae,Max:rp,MaxPool:ap,MaxPool3D:ex,MaxPool3DGrad:LS,MaxPoolGrad:FS,MaxPoolWithArgmax:tx,Maximum:Zv,Mean:sp,Min:op,Minimum:nx,MirrorPad:ip,Mod:rx,MomentumOptimizer:VA,Multinomial:lp,Multiply:ax,Neg:sx,NonMaxSuppressionV3:up,NonMaxSuppressionV4:ix,NonMaxSuppressionV5:cp,NotEqual:ox,OP_SCOPE_SUFFIX:LE,OneHot:dp,OnesLike:lx,Optimizer:fu,OptimizerConstructors:G5,Pack:ux,PadV2:fp,Pool:sae,Pow:cx,Prelu:hp,Prod:pp,RMSPropOptimizer:WA,RaggedGather:EE,RaggedRange:AE,RaggedTensorToTensor:PE,Range:dx,get Rank(){return Uk},Real:BS,RealDiv:Iv,Reciprocal:fx,get Reduction(){return da},Relu:hx,Relu6:yx,Reshape:px,ResizeBilinear:gp,ResizeBilinearGrad:gx,ResizeNearestNeighbor:mp,ResizeNearestNeighborGrad:mx,Reverse:yp,RotateWithOffset:Ip,Round:vx,Rsqrt:xx,SGDOptimizer:u2,ScatterNd:vp,SearchSorted:bp,Select:bx,Selu:wx,Sigmoid:kx,Sign:$x,Sin:Cx,Sinh:_x,Slice:Sx,Softmax:Sp,Softplus:Nx,SpaceToBatchND:Tx,SparseFillEmptyRows:zS,SparseReshape:Ax,SparseSegmentMean:Px,SparseSegmentSum:Ox,SparseToDense:Cp,SplitV:Ex,Sqrt:Ix,Square:US,SquaredDifference:Rx,StaticRegexReplace:OE,Step:Np,StridedSlice:_p,StringNGrams:Dx,StringSplit:VS,StringToHashBucketFast:WS,Sub:jx,Sum:wp,Tan:Mx,Tanh:Fx,Tensor:cn,TensorBuffer:Ac,TensorScatterUpdate:xp,Tile:Zc,TopK:$p,Transform:kp,Transpose:Wl,Unique:GS,Unpack:Lx,UnsortedSegmentSum:HS,UpperBound:oae,Variable:Jg,ZerosLike:Bx,_FusedMatMul:Ic,abs:Ua,acos:dW,acosh:fW,add:Ke,addN:hW,all:pW,any:mW,argMax:WE,argMin:gW,asin:yW,asinh:vW,atan:xW,atan2:bW,atanh:wW,avgPool:HE,avgPool3d:SW,backend:Oc,backend_util:Q5,basicLSTMCell:CW,batchNorm:Hx,batchNorm2d:_W,batchNorm3d:$W,batchNorm4d:kW,batchToSpaceND:qE,bincount:KE,bitwiseAnd:NW,booleanMaskAsync:d5,broadcastArgs:IW,broadcastTo:$f,broadcast_util:Woe,browser:hfe,buffer:en,cast:zt,ceil:TW,clipByValue:XE,clone:Di,complex:Hi,concat:fr,concat1d:EW,concat2d:AW,concat3d:PW,concat4d:OW,conv1d:RW,conv2d:qx,conv2dTranspose:jW,conv3d:MW,conv3dTranspose:FW,copyRegisteredKernels:dae,cos:LW,cosh:BW,cosineWindow:n2,cumprod:zW,cumsum:UW,customGrad:ui,denseBincount:VW,deprecationWarn:Wae,depthToSpace:WW,depthwiseConv2d:KS,device_util:Fae,diag:GW,dilation2d:HW,disableDeprecationWarnings:Vae,dispose:Jt,disposeVariables:Gae,div:$t,divNoNan:qW,dot:KW,dropout:g5,einsum:Hu,elu:JE,enableDebugMode:Uae,enableProdMode:zae,enclosingPowerOfTwo:jA,engine:ia,ensureShape:XW,env:ee,equal:QE,erf:YW,euclideanNorm:ZW,exp:li,expandDims:Ga,expm1:e6,eye:eA,fft:ZS,fill:Tp,findBackend:Yae,findBackendFactory:Qae,floor:tA,floorDiv:VE,fused:v5,gather:nA,gatherND:m5,gather_util:pfe,getBackend:Vf,getGradient:Lk,getKernel:Qg,getKernelsForBackend:Ow,grad:Nie,grads:Iie,greater:Xx,greaterEqual:rA,ifft:sy,imag:Yx,image:Hl,inTopKAsync:y5,io:qA,irfft:TA,isFinite:t6,isInf:n6,isNaN:r6,keep:Co,kernel_impls:Pfe,leakyRelu:aA,less:Mw,lessEqual:XS,linalg:C5,linspace:a6,localResponseNormalization:s6,log:Gf,log1p:sA,logSigmoid:i6,logSoftmax:l6,logSumExp:iA,logicalAnd:ry,logicalNot:lA,logicalOr:uA,logicalXor:u6,losses:_5,lowerBound:c6,matMul:Zt,math:sfe,max:pc,maxPool:cA,maxPool3d:d6,maxPoolWithArgmax:f6,maximum:dA,mean:ay,memory:Hae,meshgrid:h6,min:jw,minimum:Hf,mirrorPad:fA,mod:p6,moments:m6,movingAverage:f5,mul:_e,multiRNNCell:g6,multinomial:y6,neg:No,nextFrame:YA,norm:Kx,notEqual:hA,oneHot:Fw,ones:El,onesLike:v6,op:X,outerProduct:x6,pad:qi,pad1d:b6,pad2d:w6,pad3d:S6,pad4d:C6,pool:_6,pow:Wf,prelu:mA,print:UE,prod:$6,profile:qae,raggedGather:k6,raggedRange:N6,raggedTensorToTensor:I6,rand:T6,randomGamma:O6,randomNormal:kA,randomStandardNormal:R6,randomUniform:JS,randomUniformInt:D6,range:qf,ready:JV,real:Kf,reciprocal:j6,registerBackend:qS,registerGradient:lae,registerKernel:zx,relu:Qx,relu6:NA,removeBackend:Xae,reshape:xe,reverse:eu,reverse1d:M6,reverse2d:F6,reverse3d:L6,reverse4d:B6,rfft:e2,round:IA,rsqrt:z6,scalar:bt,scatterND:h5,scatter_util:Tue,searchSorted:QS,selu:U6,separableConv2d:V6,serialization:Mde,setBackend:QV,setPlatform:Jae,setdiff1dAsync:W6,sigmoid:ei,sign:G6,signal:S5,sin:H6,sinh:q6,slice:gt,slice1d:K6,slice2d:X6,slice3d:Y6,slice4d:Q6,slice_util:W5,softmax:J6,softplus:oA,spaceToBatchND:pA,sparse:$5,sparseToDense:p5,spectral:w5,split:Xf,sqrt:ii,square:ys,squaredDifference:EA,squeeze:tn,stack:di,step:AA,stridedSlice:Z6,string:k5,sub:ft,sum:xn,sumOutType:Wx,tan:e5,tanh:Dw,tensor:Qs,tensor1d:jr,tensor2d:vs,tensor3d:PA,tensor4d:t5,tensor5d:n5,tensor6d:r5,tensorScatterUpdate:a5,tensor_util:Oae,test_util:Ule,tidy:at,tile:kf,time:Kae,topk:s5,train:bfe,transpose:oy,truncatedNormal:o5,unique:i5,unregisterGradient:cae,unregisterKernel:uae,unsortedSegmentSum:l5,unstack:du,upcastType:pa,upperBound:u5,util:bae,valueAndGrad:Tie,valueAndGrads:Eie,variable:c5,variableGrads:o6,version_core:xfe,where:ji,whereAsync:DA,zeros:ci,zerosLike:Za},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rfe=ee();Rfe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ba;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ba||(Ba={}));var w3;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(w3||(w3={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dfe={};function J5(t){return Dfe[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T(t,e,n,r,a){const s=e.inputParams[t];if(s&&s.inputIndexStart!==void 0){const i=s.inputIndexStart,l=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?i+1:s.inputIndexEnd,u=i<0?e.inputNames.length+i:i;if(s.type==="tensor")return Rr(e.inputNames[u],n,r,a);if(s.type==="tensors"){const f=e.inputs.slice(i,l);return e.inputNames.slice(i,l).filter((p,g)=>{var y;return((y=f[g])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(p=>Rr(p,n,r,a))}const c=Rr(e.inputNames[u],n,r,a),d=c.dataSync();return s.type==="number"?d[0]:hc(c.shape,d)}const o=e.attrParams[t];return o&&o.value}function Rr(t,e,n,r){const[a,s]=za(t,n);if(r!=null){const i=r.getHashTableHandleByName(a);if(i!=null)return i}const o=n.currentContextIds.find(i=>!!e[Lw(a,i)]);return o!==void 0?e[Lw(a,o)][s]:void 0}function S3(t,e,n){return e[Lw(t,n.currentContextId)]}function ki(t,e){const[n,r,a]=za(t,e);return[Lw(n,e&&e.currentContextId),r,a]}function Lw(t,e){return e?`${t}-${e}`:t}function za(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const s=e.parseNodeNameCache.get(t);if(s!=null)return s}const r=t.split(":");let a;if(r.length===1)a=[t,0,void 0];else{const s=r[0],o=r.length===3?r[1]:void 0,i=Number(r[r.length-1]);a=[s,i,o]}return n&&e.parseNodeNameCache.set(t,a),a}function H0(t,e,n){let r=T("pad",t,e,n);if(r==="explicit"){r=T("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)a[s][0]=r[s*2],a[s][1]=r[s*2+1];return a}return r}function Ni(t){return t.kept?t:Di(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jfe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Mfe=Object.freeze(Object.defineProperty({__proto__:null,json:jfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Lfe=Object.freeze(Object.defineProperty({__proto__:null,json:Ffe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],zfe=Object.freeze(Object.defineProperty({__proto__:null,json:Bfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ufe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Vfe=Object.freeze(Object.defineProperty({__proto__:null,json:Ufe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wfe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Gfe=Object.freeze(Object.defineProperty({__proto__:null,json:Wfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],qfe=Object.freeze(Object.defineProperty({__proto__:null,json:Hfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kfe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Xfe=Object.freeze(Object.defineProperty({__proto__:null,json:Kfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Qfe=Object.freeze(Object.defineProperty({__proto__:null,json:Yfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jfe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Zfe=Object.freeze(Object.defineProperty({__proto__:null,json:Jfe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ehe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],the=Object.freeze(Object.defineProperty({__proto__:null,json:ehe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],rhe=Object.freeze(Object.defineProperty({__proto__:null,json:nhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ahe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],she=Object.freeze(Object.defineProperty({__proto__:null,json:ahe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ohe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],ihe=Object.freeze(Object.defineProperty({__proto__:null,json:ohe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],uhe=Object.freeze(Object.defineProperty({__proto__:null,json:lhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const che=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],dhe=Object.freeze(Object.defineProperty({__proto__:null,json:che},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fhe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],hhe=Object.freeze(Object.defineProperty({__proto__:null,json:fhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const phe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],mhe=Object.freeze(Object.defineProperty({__proto__:null,json:phe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ghe=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],yhe=Object.freeze(Object.defineProperty({__proto__:null,json:ghe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vhe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],xhe=Object.freeze(Object.defineProperty({__proto__:null,json:vhe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C3{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Mfe,Lfe,zfe,Vfe,Gfe,qfe,Xfe,Qfe,Zfe,the,rhe,she,ihe,uhe,dhe,hhe,mhe,yhe,xhe],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,a)=>(r[a.tfOpName]=a,r),{})}transformGraph(e,n={}){const r=e.node,a=[],s=[],o=[],i=r.reduce((g,y)=>(g[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?a.push(g[y.name]):y.op==="Const"?s.push(g[y.name]):(y.input==null||y.input.length===0)&&o.push(g[y.name]),g),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const f=Object.keys(i);f.forEach(g=>{const y=i[g];y.inputNames.forEach((v,x)=>{const[b,,w]=ki(v),C=i[b];if(C.outputs!=null){const _=C.outputs.indexOf(w);if(_!==-1){const $=`${b}:${_}`;y.inputNames[x]=$}}y.inputs.push(C),C.children.push(y)})}),Object.keys(d).length===0?f.forEach(g=>{const y=i[g];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(g=>{const[y]=ki(g),v=i[y];v!=null&&(v.signatureKey=d[g],u.push(v))}),Object.keys(c).length>0?Object.keys(c).forEach(g=>{const[y]=ki(g),v=i[y];v&&(v.signatureKey=c[g],l.push(v))}):l=a;let h={};e.library!=null&&e.library.function!=null&&(h=e.library.function.reduce((g,y)=>(g[y.signature.name]=this.mapFunction(y),g),{}));const p={nodes:i,inputs:l,outputs:u,weights:s,placeholders:a,signature:n,functions:h};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=J5(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((a,s)=>(a[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},a),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((a,s)=>{const o=s.type;let i;switch(s.type){case"string":i=rN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=rN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":i=cN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=cN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":i=sN(e.attr,s.tfName,s.defaultValue||0),i===void 0&&s.tfDeprecatedName&&(i=sN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":i=uN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=uN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":i=aN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=aN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":i=fN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=fN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":i=lN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=lN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":i=dN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=dN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":i=oN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=oN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":i=iN(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=iN(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":i=_3(e.attr,s.tfName,s.defaultValue),i===void 0&&s.tfDeprecatedName&&(i=_3(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${e.op}`)}return a[s.name]={value:i,type:o},a},{})),r}mapFunction(e){const n=e.nodeDef,r=[],a=[];let s={};n!=null&&(s=n.reduce((d,f)=>(d[f.name]=this.mapNode(f),f.op==="Const"&&a.push(d[f.name]),d),{}));const o=[],i=[];e.signature.inputArg.forEach(d=>{const[f]=ki(d.name),h={name:f,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:_P(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,o.push(h),s[f]=h}),Object.keys(s).forEach(d=>{const f=s[d];f.inputNames.forEach((h,p)=>{const[g,,y]=ki(h),v=s[g];if(v.outputs!=null){const x=v.outputs.indexOf(y);if(x!==-1){const b=`${g}:${x}`;f.inputNames[p]=b}}f.inputs.push(v),v.children.push(f)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[f,h]=ki(u[d.name]),p=s[f];p!=null&&(p.defaultOutput=h,i.push(p))});const c=this.mapArgsToSignature(e);return{nodes:s,inputs:o,outputs:i,weights:a,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function bhe(t){const e=ee().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Z5(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):bhe(t);return e?n:n.toLowerCase()}function rN(t,e,n,r=!1){const a=t[e];return a!=null?Z5(a.s,r):n}function aN(t,e,n){const r=t[e];return r?r.b:n}function sN(t,e,n){const r=t[e]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function _P(t){switch(typeof t=="string"&&(t=Ba[t]),t){case Ba.DT_FLOAT:case Ba.DT_HALF:return"float32";case Ba.DT_INT32:case Ba.DT_INT64:case Ba.DT_INT8:case Ba.DT_UINT8:return"int32";case Ba.DT_BOOL:return"bool";case Ba.DT_DOUBLE:return"float32";case Ba.DT_STRING:return"string";case Ba.DT_COMPLEX64:case Ba.DT_COMPLEX128:return"complex64";default:return null}}function _3(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function oN(t,e,n){const r=t[e];return r&&r.type?_P(r.type):n}function iN(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(a=>_P(a)):n}function eG(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function lN(t,e,n){const r=t[e];return r&&r.shape?eG(r.shape):n}function uN(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function cN(t,e,n,r=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(s=>Z5(s,r)):n}function dN(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(a=>eG(a)):n}function fN(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class whe{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,s)=>(a[s]=this.getAttr(s),a),{}))}getInput(e){return Rr(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Rr(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return sN(this.node.rawAttrs,e,n);if(r.s!=null)return rN(this.node.rawAttrs,e,n);if(r.b!=null)return aN(this.node.rawAttrs,e,n);if(r.shape!=null)return lN(this.node.rawAttrs,e,n);if(r.type!=null)return oN(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return uN(this.node.rawAttrs,e,n);if(r.list.s!=null)return cN(this.node.rawAttrs,e,n);if(r.list.shape!=null)return dN(this.node.rawAttrs,e,n);if(r.list.b!=null)return fN(this.node.rawAttrs,e,n);if(r.list.type!=null)return iN(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fr=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:LE,abs:Ua,acos:dW,acosh:fW,add:Ke,addN:hW,all:pW,any:mW,argMax:WE,argMin:gW,asin:yW,asinh:vW,atan:xW,atan2:bW,atanh:wW,avgPool:HE,avgPool3d:SW,basicLSTMCell:CW,batchNorm:Hx,batchNorm2d:_W,batchNorm3d:$W,batchNorm4d:kW,batchToSpaceND:qE,bincount:KE,bitwiseAnd:NW,booleanMaskAsync:d5,broadcastArgs:IW,broadcastTo:$f,buffer:en,cast:zt,ceil:TW,clipByValue:XE,clone:Di,complex:Hi,concat:fr,concat1d:EW,concat2d:AW,concat3d:PW,concat4d:OW,conv1d:RW,conv2d:qx,conv2dTranspose:jW,conv3d:MW,conv3dTranspose:FW,cos:LW,cosh:BW,cosineWindow:n2,cumprod:zW,cumsum:UW,denseBincount:VW,depthToSpace:WW,depthwiseConv2d:KS,diag:GW,dilation2d:HW,div:$t,divNoNan:qW,dot:KW,dropout:g5,einsum:Hu,elu:JE,enclosingPowerOfTwo:jA,ensureShape:XW,equal:QE,erf:YW,euclideanNorm:ZW,exp:li,expandDims:Ga,expm1:e6,eye:eA,fft:ZS,fill:Tp,floor:tA,floorDiv:VE,fused:v5,gather:nA,gatherND:m5,greater:Xx,greaterEqual:rA,ifft:sy,imag:Yx,image:Hl,inTopKAsync:y5,irfft:TA,isFinite:t6,isInf:n6,isNaN:r6,leakyRelu:aA,less:Mw,lessEqual:XS,linalg:C5,linspace:a6,localResponseNormalization:s6,log:Gf,log1p:sA,logSigmoid:i6,logSoftmax:l6,logSumExp:iA,logicalAnd:ry,logicalNot:lA,logicalOr:uA,logicalXor:u6,losses:_5,lowerBound:c6,matMul:Zt,max:pc,maxPool:cA,maxPool3d:d6,maxPoolWithArgmax:f6,maximum:dA,mean:ay,meshgrid:h6,min:jw,minimum:Hf,mirrorPad:fA,mod:p6,moments:m6,movingAverage:f5,mul:_e,multiRNNCell:g6,multinomial:y6,neg:No,norm:Kx,notEqual:hA,oneHot:Fw,ones:El,onesLike:v6,op:X,outerProduct:x6,pad:qi,pad1d:b6,pad2d:w6,pad3d:S6,pad4d:C6,pool:_6,pow:Wf,prelu:mA,print:UE,prod:$6,raggedGather:k6,raggedRange:N6,raggedTensorToTensor:I6,rand:T6,randomGamma:O6,randomNormal:kA,randomStandardNormal:R6,randomUniform:JS,randomUniformInt:D6,range:qf,real:Kf,reciprocal:j6,relu:Qx,relu6:NA,reshape:xe,reverse:eu,reverse1d:M6,reverse2d:F6,reverse3d:L6,reverse4d:B6,rfft:e2,round:IA,rsqrt:z6,scalar:bt,scatterND:h5,searchSorted:QS,selu:U6,separableConv2d:V6,setdiff1dAsync:W6,sigmoid:ei,sign:G6,signal:S5,sin:H6,sinh:q6,slice:gt,slice1d:K6,slice2d:X6,slice3d:Y6,slice4d:Q6,softmax:J6,softplus:oA,spaceToBatchND:pA,sparse:$5,sparseToDense:p5,spectral:w5,split:Xf,sqrt:ii,square:ys,squaredDifference:EA,squeeze:tn,stack:di,step:AA,stridedSlice:Z6,string:k5,sub:ft,sum:xn,tan:e5,tanh:Dw,tensor:Qs,tensor1d:jr,tensor2d:vs,tensor3d:PA,tensor4d:t5,tensor5d:n5,tensor6d:r5,tensorScatterUpdate:a5,tile:kf,topk:s5,transpose:oy,truncatedNormal:o5,unique:i5,unsortedSegmentSum:l5,unstack:du,upperBound:u5,variable:c5,where:ji,whereAsync:DA,zeros:ci,zerosLike:Za},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const She=(t,e,n,r=Fr)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(T("a",t,e,n),T("b",t,e,n))];case"AddN":return[r.addN(T("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(T("a",t,e,n),T("b",t,e,n))];case"Mul":return[r.mul(T("a",t,e,n),T("b",t,e,n))];case"RealDiv":case"Div":return[r.div(T("a",t,e,n),T("b",t,e,n))];case"DivNoNan":return[r.divNoNan(T("a",t,e,n),T("b",t,e,n))];case"FloorDiv":return[r.floorDiv(T("a",t,e,n),T("b",t,e,n))];case"Sub":return[r.sub(T("a",t,e,n),T("b",t,e,n))];case"Minimum":return[r.minimum(T("a",t,e,n),T("b",t,e,n))];case"Maximum":return[r.maximum(T("a",t,e,n),T("b",t,e,n))];case"Pow":return[r.pow(T("a",t,e,n),T("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(T("a",t,e,n),T("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=(t,e,n,r=Fr)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(T("x",t,e,n))];case"Acos":return[r.acos(T("x",t,e,n))];case"Acosh":return[r.acosh(T("x",t,e,n))];case"Asin":return[r.asin(T("x",t,e,n))];case"Asinh":return[r.asinh(T("x",t,e,n))];case"Atan":return[r.atan(T("x",t,e,n))];case"Atan2":return[r.atan2(T("x",t,e,n),T("y",t,e,n))];case"Atanh":return[r.atanh(T("x",t,e,n))];case"Ceil":return[r.ceil(T("x",t,e,n))];case"Complex":return[r.complex(T("real",t,e,n),T("imag",t,e,n))];case"Cos":return[r.cos(T("x",t,e,n))];case"Cosh":return[r.cosh(T("x",t,e,n))];case"Elu":return[r.elu(T("x",t,e,n))];case"Erf":return[r.erf(T("x",t,e,n))];case"Exp":return[r.exp(T("x",t,e,n))];case"Expm1":return[r.expm1(T("x",t,e,n))];case"Floor":return[r.floor(T("x",t,e,n))];case"Log":return[r.log(T("x",t,e,n))];case"Log1p":return[r.log1p(T("x",t,e,n))];case"Imag":return[r.imag(T("x",t,e,n))];case"Neg":return[r.neg(T("x",t,e,n))];case"Reciprocal":return[r.reciprocal(T("x",t,e,n))];case"Real":return[r.real(T("x",t,e,n))];case"Relu":return[r.relu(T("x",t,e,n))];case"Round":return[r.round(T("x",t,e,n))];case"Selu":return[r.selu(T("x",t,e,n))];case"Sigmoid":return[r.sigmoid(T("x",t,e,n))];case"Sin":return[r.sin(T("x",t,e,n))];case"Sign":return[r.sign(T("x",t,e,n))];case"Sinh":return[r.sinh(T("x",t,e,n))];case"Softplus":return[r.softplus(T("x",t,e,n))];case"Sqrt":return[r.sqrt(T("x",t,e,n))];case"Square":return[r.square(T("x",t,e,n))];case"Tanh":return[r.tanh(T("x",t,e,n))];case"Tan":return[r.tan(T("x",t,e,n))];case"ClipByValue":return[r.clipByValue(T("x",t,e,n),T("clipValueMin",t,e,n),T("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(T("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Rr(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(T("x",t,e,n),T("alpha",t,e,n))];case"Prelu":return[r.prelu(T("x",t,e,n),T("alpha",t,e,n))];case"IsNan":return[r.isNaN(Rr(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Rr(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Rr(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){j(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const a=t[r],s=e[r];j(a<0||s<0||a===s,()=>n+` Shapes ${t} and ${e} must match`)}}}function $3(t){return!(typeof t=="number"||t.some(e=>e<0))}function Am(t,e,n){let r=hN(t,n);const a=!$3(r);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&e.forEach(s=>{r=hN(s.shape,r)}),!$3(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function hN(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const a=t[r],s=e[r];if(a>=0&&s>=0&&a!==s)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=a>=0?a:s}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _he{constructor(e,n,r,a,s,o,i){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=s,this.dynamicSize=o,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=bt(0),Co(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Ls(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Co(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,a)=>this.write(r,n[a]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return Qs([],[0].concat(this.elementShape));const r=this.readMany(e);return Ls(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),di(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Qs([],[0].concat(this.elementShape));const n=[];for(let a=0;a<this.size();a++)n.push(a);const r=this.readMany(n);return Ls(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),fr(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,du(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const a=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const s=r===0?0:n.size/r,o=[];at(()=>{n=xe(n,[1,r,s]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:a[l-1],0],d=[1,e[l],s];o[l]=xe(gt(n,c,d),this.elementShape)}return o});const i=[];for(let l=0;l<e.length;l++)i[l]=l;this.writeMany(i,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lc{get id(){return this.idTensor.id}constructor(e,n,r,a=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);Ls(n,s.shape,"TensorList shape mismatch: "),Co(s)}),this.idTensor=bt(0),this.maxNumElements=a,Co(this.idTensor)}copy(){return new Lc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Ls(e,this.elementShape,"TensorList shape mismatch: ");const a=Am(this.elementShape,this.tensors,e);return at(()=>{const s=this.tensors.map(o=>xe(o,a));return di(s,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Am(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,Ls(a.shape,e,"TensorList shape mismatch: "),xe(a,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Ls(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Co(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Lc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Ls(this.tensors[e].shape,n,"TensorList shape mismatch: ");const a=Am(this.elementShape,this.tensors,n);return xe(this.tensors[e],a)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Ls(this.elementShape,n.shape,"TensorList shape mismatch: "),Co(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Ls(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=Am(this.elementShape,this.tensors,r);return e.length===0?Qs([],[0].concat(a)):at(()=>{const s=e.map(o=>xe(this.tensors[o],a));return di(s,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Ls(this.elementShape,n,"TensorList shape mismatch: ");const r=Am(this.elementShape,this.tensors,n);return this.size()===0?Qs([],[0].concat(r)):at(()=>{const a=this.tensors.map(s=>xe(s,r));return fr(a,0)})}}function $he(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const a=t.shape.slice(1);Ls(a,e,"TensorList shape mismatch: ");const s=du(t);return new Lc(s,e,r)}function khe(t,e,n,r){return new Lc([],t,e,r)}function Nhe(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const a=Math.max(...e);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);const s=new Lc([],n,t.dtype,r),o=du(t,0);return e.forEach((i,l)=>{s.setItem(i,o[l])}),s}function Ihe(t,e,n){let r=0;const a=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const s=t.shape.slice(1),o=hN(s,n),i=r===0?0:t.size/r,l=at(()=>{const c=[];t=xe(t,[1,r,i]);for(let d=0;d<e.length;++d){const h=[0,d===0?0:a[d-1],0],p=[1,e[d],i];c[d]=xe(gt(t,h,p),o)}return t.dispose(),c}),u=new Lc([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=T("thenBranch",t,e,n),a=T("elseBranch",t,e,n),s=T("cond",t,e,n),o=T("args",t,e,n);return(await s.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=T("body",t,e,n),a=T("cond",t,e,n),s=T("args",t,e,n),o=await n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),i=s.map(c=>c.id);let l=await o[0].data();o.forEach(c=>{!c.kept&&i.indexOf(c.id)===-1&&c.dispose()});let u=s;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(h=>h.id);c.forEach(h=>{!h.kept&&i.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});const f=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await f[0].data(),f.forEach(h=>{!h.kept&&i.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return u}case"LoopCond":{const r=T("pred",t,e,n);return[Ni(r)]}case"Switch":{const r=T("pred",t,e,n);let a=T("data",t,e,n);return a.kept||(a=Ni(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=t.inputNames.find(a=>Rr(a,e,n)!==void 0);if(r){const a=Rr(r,e,n);return[Ni(a)]}return}case"Enter":{const r=T("frameName",t,e,n),a=T("tensor",t,e,n);return n.enterFrame(r),[Ni(a)]}case"Exit":{const r=T("tensor",t,e,n);return n.exitFrame(),[Ni(r)]}case"NextIteration":{const r=T("tensor",t,e,n);return n.nextIteration(),[Ni(r)]}case"TensorArrayV3":{const r=T("size",t,e,n),a=T("dtype",t,e,n),s=T("elementShape",t,e,n),o=T("dynamicSize",t,e,n),i=T("clearAfterRead",t,e,n),l=T("identicalElementShapes",t,e,n),u=T("name",t,e,n),c=new _he(u,a,r,s,l,o,i);return n.addTensorArray(c),[c.idTensor,bt(1)]}case"TensorArrayWriteV3":{const r=T("tensorArrayId",t,e,n),a=T("index",t,e,n),s=T("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(a,s),[o.idTensor]}case"TensorArrayReadV3":{const r=T("tensorArrayId",t,e,n),a=T("index",t,e,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=T("tensorArrayId",t,e,n),a=T("indices",t,e,n),s=T("dtype",t,e,n);return[n.getTensorArray(r.id).gather(a,s)]}case"TensorArrayScatterV3":{const r=T("tensorArrayId",t,e,n),a=T("indices",t,e,n),s=T("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(a,s),[o.idTensor]}case"TensorArrayConcatV3":{const r=T("tensorArrayId",t,e,n),a=n.getTensorArray(r.id),s=T("dtype",t,e,n);return[a.concat(s)]}case"TensorArraySplitV3":{const r=T("tensorArrayId",t,e,n),a=T("tensor",t,e,n),s=T("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(s,a),[o.idTensor]}case"TensorArraySizeV3":{const r=T("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return[bt(a.size(),"int32")]}case"TensorArrayCloseV3":{const r=T("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=T("tensorListId",t,e,n),a=T("index",t,e,n),s=T("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(a,s),[o.idTensor]}case"TensorListGetItem":{const r=T("tensorListId",t,e,n),a=T("index",t,e,n),s=T("elementShape",t,e,n),o=T("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(a,s,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=T("indices",t,e,n),a=T("tensor",t,e,n),s=T("elementShape",t,e,n),o=T("numElements",t,e,n),i=Nhe(a,r,s,o);return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=T("elementShape",t,e,n),a=T("elementDType",t,e,n);let s;t.op==="TensorListReserve"?s="numElements":s="maxNumElements";const o=T(s,t,e,n),i=t.op==="TensorListReserve"?-1:o,l=khe(r,a,o,i);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=T("tensorListId",t,e,n),a=T("indices",t,e,n),s=T("elementShape",t,e,n),o=T("elementDType",t,e,n);return[n.getTensorList(r.id).gather(a,o,s)]}case"TensorListStack":{const r=T("tensorListId",t,e,n),a=T("elementShape",t,e,n),s=T("elementDType",t,e,n),o=T("numElements",t,e,n);return[n.getTensorList(r.id).stack(a,s,o)]}case"TensorListFromTensor":{const r=T("tensor",t,e,n),a=T("elementShape",t,e,n),s=T("elementDType",t,e,n),o=$he(r,a,s);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=T("tensorListId",t,e,n),a=n.getTensorList(r.id),s=T("dtype",t,e,n),o=T("elementShape",t,e,n);return[a.concat(s,o)]}case"TensorListPushBack":{const r=T("tensorListId",t,e,n),a=T("tensor",t,e,n),s=n.getTensorList(r.id);return s.pushBack(a),[s.idTensor]}case"TensorListPopBack":{const r=T("tensorListId",t,e,n),a=T("elementShape",t,e,n),s=T("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(a,s)]}case"TensorListSplit":{const r=T("tensor",t,e,n),a=T("elementShape",t,e,n),s=T("lengths",t,e,n),o=Ihe(r,s,a);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=T("tensorListId",t,e,n),a=n.getTensorList(r.id);return[bt(a.size(),"int32")]}case"TensorListResize":{const r=T("tensorListId",t,e,n),a=T("size",t,e,n),o=n.getTensorList(r.id).resize(a);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k3(t,e,n){const[r,a]=T("fusedOps",t,e,n),s=r==="biasadd",o=!s,i=a==="prelu",l=r==="fusedbatchnorm",u=T("numArgs",t,e,n);if(s){if(i&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&s&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=T("strides",t,e,n),d=H0(t,e,n),f=T("dataFormat",t,e,n).toUpperCase(),h=T("dilations",t,e,n);let[p,g]=T("args",t,e,n);o&&(g=p,p=void 0);const y=T("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:f,dilations:h,biasArg:p,preluArg:g,activationFunc:a,leakyreluAlpha:y}}const Ehe=(t,e,n,r=Fr)=>{switch(t.op){case"Conv1D":{const a=T("stride",t,e,n),s=T("pad",t,e,n),o=T("dataFormat",t,e,n).toUpperCase(),i=T("dilation",t,e,n);return[r.conv1d(T("x",t,e,n),T("filter",t,e,n),a,s,o,i)]}case"Conv2D":{const a=T("strides",t,e,n),s=H0(t,e,n),o=T("dataFormat",t,e,n).toUpperCase(),i=T("dilations",t,e,n);return[r.conv2d(T("x",t,e,n),T("filter",t,e,n),[a[1],a[2]],s,o,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:a,pad:s,dataFormat:o,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=k3(t,e,n);return[r.fused.conv2d({x:T("x",t,e,n),filter:T("filter",t,e,n),strides:[a[1],a[2]],pad:s,dataFormat:o,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:s,dataFormat:o,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=k3(t,e,n);return[r.fused.depthwiseConv2d({x:T("x",t,e,n),filter:T("filter",t,e,n),strides:[a[1],a[2]],pad:s,dataFormat:o,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=T("outputShape",t,e,n),s=T("strides",t,e,n),o=H0(t,e,n);return[r.conv2dTranspose(T("x",t,e,n),T("filter",t,e,n),a,[s[1],s[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=T("strides",t,e,n),s=H0(t,e,n),o=T("dilations",t,e,n),i=T("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(T("input",t,e,n),T("filter",t,e,n),[a[1],a[2]],s,i,[o[1],o[2]])]}case"Conv3D":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("dataFormat",t,e,n).toUpperCase(),i=T("dilations",t,e,n);return[r.conv3d(T("x",t,e,n),T("filter",t,e,n),[a[1],a[2],a[3]],s,o,[i[1],i[2],i[3]])]}case"AvgPool":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("kernelSize",t,e,n);return[r.avgPool(T("x",t,e,n),[o[1],o[2]],[a[1],a[2]],s)]}case"MaxPool":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("kernelSize",t,e,n);return[r.maxPool(T("x",t,e,n),[o[1],o[2]],[a[1],a[2]],s)]}case"MaxPoolWithArgmax":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("kernelSize",t,e,n),i=T("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(T("x",t,e,n),[o[1],o[2]],[a[1],a[2]],s,i);return[l,u]}case"AvgPool3D":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("kernelSize",t,e,n);return[r.avgPool3d(T("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],s)]}case"MaxPool3D":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("kernelSize",t,e,n);return[r.maxPool3d(T("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],s)]}case"Dilation2D":{const a=T("strides",t,e,n),s=T("pad",t,e,n),o=T("dilations",t,e,n),i=a[1],l=a[2],u=o[1],c=o[2];return[r.dilation2d(T("x",t,e,n),T("filter",t,e,n),[i,l],s,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ahe=(t,e,n,r=Fr)=>{switch(t.op){case"Fill":{const a=T("shape",t,e,n),s=T("dtype",t,e,n),o=T("value",t,e,n);return[r.fill(a,o,s)]}case"LinSpace":{const a=T("start",t,e,n),s=T("stop",t,e,n),o=T("num",t,e,n);return[r.linspace(a,s,o)]}case"Multinomial":{const a=T("logits",t,e,n),s=T("numSamples",t,e,n),o=T("seed",t,e,n);return[r.multinomial(a,s,o)]}case"OneHot":{const a=T("indices",t,e,n),s=T("depth",t,e,n),o=T("onValue",t,e,n),i=T("offValue",t,e,n),l=T("dtype",t,e,n);return[r.oneHot(a,s,o,i,l)]}case"Ones":return[r.ones(T("shape",t,e,n),T("dtype",t,e,n))];case"OnesLike":return[r.onesLike(T("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(T("shape",t,e,n),T("dtype",t,e,n),T("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(T("shape",t,e,n),T("minval",t,e,n),T("maxval",t,e,n),T("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(T("shape",t,e,n),T("minval",t,e,n),T("maxval",t,e,n),T("seed",t,e,n))];case"Range":{const a=T("start",t,e,n),s=T("stop",t,e,n),o=T("step",t,e,n);return[r.range(a,s,o,T("dtype",t,e,n))]}case"TruncatedNormal":{const a=T("shape",t,e,n),s=T("mean",t,e,n),o=T("stdDev",t,e,n),i=T("seed",t,e,n);return[r.truncatedNormal(a,s,o,T("dtype",t,e,n),i)]}case"Zeros":return[r.zeros(T("shape",t,e,n),T("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(T("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_(t,e,n){const r=T("boxes",t,e,n),a=T("scores",t,e,n),s=T("maxOutputSize",t,e,n),o=T("iouThreshold",t,e,n),i=T("scoreThreshold",t,e,n),l=T("softNmsSigma",t,e,n);return{boxes:r,scores:a,maxOutputSize:s,iouThreshold:o,scoreThreshold:i,softNmsSigma:l}}const Phe=async(t,e,n,r,a=Fr)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:s,scores:o,maxOutputSize:i,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=E_(t,e,n),d=await a.image.nonMaxSuppressionWithScoreAsync(s,o,i,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:s,scores:o,maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=E_(t,e,n),c=T("padToMaxOutputSize",t,e,n),d=await a.image.nonMaxSuppressionPaddedAsync(s,o,i,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:s,scores:o,maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=E_(t,e,n);return[await a.image.nonMaxSuppressionAsync(s,o,i,l,u)]}case"Where":{const s=a.cast(T("condition",t,e,n),"bool"),o=[await a.whereAsync(s)];return s.dispose(),o}case"ListDiff":return a.setdiff1dAsync(T("x",t,e,n),T("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=(t,e,n,r=Fr)=>{switch(t.op){case"LowerBound":{const a=T("sortedSequence",t,e,n),s=T("values",t,e,n);return[r.lowerBound(a,s)]}case"TopKV2":{const a=T("x",t,e,n),s=T("k",t,e,n),o=T("sorted",t,e,n),i=r.topk(a,s,o);return[i.values,i.indices]}case"UpperBound":{const a=T("sortedSequence",t,e,n),s=T("values",t,e,n);return[r.upperBound(a,s)]}case"Unique":{const a=T("x",t,e,n),s=r.unique(a);return[s.values,s.indices]}case"UniqueV2":{const a=T("x",t,e,n),s=T("axis",t,e,n),o=r.unique(a,s);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rhe=(t,e,n,r=Fr)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=T("default",t,e,n);return[Rr(t.name,e,n)||a];case"Placeholder":return[Rr(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=T("x",t,e,n);return[Ni(c)]}case"IdentityN":return T("x",t,e,n).map(c=>Ni(c));case"Snapshot":const s=T("x",t,e,n);return[Ni(s)];case"Shape":return[r.tensor1d(T("x",t,e,n).shape,"int32")];case"ShapeN":return T("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(T("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(T("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=T("x",t,e,n),i=T("data",t,e,n),l=T("message",t,e,n),u=T("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<i.length;c++)console.log(Array.prototype.slice.call(i[c].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dhe{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=bt(0),this.tensorMap=new Map,Co(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return bt(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),at(()=>{const a=du(n),s=r.length,o=a.length;j(s===o,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${o} elements.`);for(let i=0;i<s;i++){const l=r[i],u=a[i];Co(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return at(()=>{const a=[];for(let s=0;s<r.length;s++){const o=r[s],i=this.findWithDefault(o,n);a.push(i)}return di(a)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jhe=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=r.getHashTableHandleByName(t.name);if(a!=null)return[a];{const s=T("keyDType",t,e,n),o=T("valueDType",t,e,n),i=new Dhe(s,o);return r.addHashTable(t.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=T("tableHandle",t,e,n,r),s=T("keys",t,e,n),o=T("values",t,e,n);return[await r.getHashTableById(a.id).import(s,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=T("tableHandle",t,e,n,r),s=T("keys",t,e,n),o=T("defaultValue",t,e,n);return[await r.getHashTableById(a.id).find(s,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=T("tableHandle",t,e,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe=(t,e,n,r=Fr)=>{switch(t.op){case"ResizeBilinear":{const a=T("images",t,e,n),s=T("size",t,e,n),o=T("alignCorners",t,e,n),i=T("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(a,[s[0],s[1]],o,i)]}case"ResizeNearestNeighbor":{const a=T("images",t,e,n),s=T("size",t,e,n),o=T("alignCorners",t,e,n),i=T("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(a,[s[0],s[1]],o,i)]}case"CropAndResize":{const a=T("image",t,e,n),s=T("boxes",t,e,n),o=T("boxInd",t,e,n),i=T("cropSize",t,e,n),l=T("method",t,e,n),u=T("extrapolationValue",t,e,n);return[r.image.cropAndResize(a,s,o,i,l,u)]}case"ImageProjectiveTransformV3":{const a=T("images",t,e,n),s=T("transforms",t,e,n),o=T("outputShape",t,e,n),i=T("fillValue",t,e,n),l=T("interpolation",t,e,n),u=T("fillMode",t,e,n);return[r.image.transform(a,s,l.toLowerCase(),u.toLowerCase(),i,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe=(t,e,n,r=Fr)=>{switch(t.op){case"Equal":return[r.equal(T("a",t,e,n),T("b",t,e,n))];case"NotEqual":return[r.notEqual(T("a",t,e,n),T("b",t,e,n))];case"Greater":return[r.greater(T("a",t,e,n),T("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(T("a",t,e,n),T("b",t,e,n))];case"Less":return[r.less(T("a",t,e,n),T("b",t,e,n))];case"LessEqual":return[r.lessEqual(T("a",t,e,n),T("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(T("a",t,e,n),T("b",t,e,n))];case"LogicalNot":return[r.logicalNot(T("a",t,e,n))];case"LogicalOr":return[r.logicalOr(T("a",t,e,n),T("b",t,e,n))];case"Select":case"SelectV2":return[r.where(T("condition",t,e,n),T("a",t,e,n),T("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(T("a",t,e,n),T("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lhe=(t,e,n,r=Fr)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(T("a",t,e,n),T("b",t,e,n),T("transposeA",t,e,n),T("transposeB",t,e,n))];case"Einsum":return[r.einsum(T("equation",t,e,n),...T("tensors",t,e,n))];case"Transpose":return[r.transpose(T("x",t,e,n),T("perm",t,e,n))];case"_FusedMatMul":const[a,s]=T("fusedOps",t,e,n),o=a==="biasadd",i=s==="prelu",l=T("numArgs",t,e,n),u=T("leakyreluAlpha",t,e,n);if(o){if(i&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=T("args",t,e,n);return[r.fused.matMul({a:T("a",t,e,n),b:T("b",t,e,n),transposeA:T("transposeA",t,e,n),transposeB:T("transposeB",t,e,n),bias:c,activation:s,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(T("a",t,e,n),T("numLower",t,e,n),T("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe=(t,e,n,r=Fr)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(T("x",t,e,n),T("axis",t,e,n),T("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(T("x",t,e,n),T("mean",t,e,n),T("variance",t,e,n),T("offset",t,e,n),T("scale",t,e,n),T("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(T("x",t,e,n),T("mean",t,e,n),T("variance",t,e,n),T("offset",t,e,n),T("scale",t,e,n),T("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(T("x",t,e,n),T("radius",t,e,n),T("bias",t,e,n),T("alpha",t,e,n),T("beta",t,e,n))];case"Softmax":return[r.softmax(T("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(T("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zhe=(t,e,n,r=Fr)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:s}=r.raggedGather(T("paramsNestedSplits",t,e,n),T("paramsDenseValues",t,e,n),T("indices",t,e,n),T("outputRaggedRank",t,e,n));return a.concat(s)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:s}=r.raggedRange(T("starts",t,e,n),T("limits",t,e,n),T("splits",t,e,n));return[a,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(T("shape",t,e,n),T("values",t,e,n),T("defaultValue",t,e,n),T("rowPartitionTensors",t,e,n),T("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uhe=(t,e,n,r=Fr)=>{switch(t.op){case"Max":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.max(T("x",t,e,n),i,l)]}case"Mean":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.mean(T("x",t,e,n),i,l)]}case"Min":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.min(T("x",t,e,n),i,l)]}case"Sum":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.sum(T("x",t,e,n),i,l)]}case"All":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.all(T("x",t,e,n),i,l)]}case"Any":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.any(T("x",t,e,n),i,l)]}case"ArgMax":{const i=T("axis",t,e,n);return[r.argMax(T("x",t,e,n),i)]}case"ArgMin":{const i=T("axis",t,e,n);return[r.argMin(T("x",t,e,n),i)]}case"Prod":{const i=T("axis",t,e,n),l=T("keepDims",t,e,n);return[r.prod(T("x",t,e,n),i,l)]}case"Cumprod":{const i=T("axis",t,e,n),l=T("exclusive",t,e,n),u=T("reverse",t,e,n);return[r.cumprod(T("x",t,e,n),i,l,u)]}case"Cumsum":{const i=T("axis",t,e,n),l=T("exclusive",t,e,n),u=T("reverse",t,e,n);return[r.cumsum(T("x",t,e,n),i,l,u)]}case"Bincount":const a=T("x",t,e,n),s=T("weights",t,e,n),o=T("size",t,e,n);return[r.bincount(a,s,o)];case"DenseBincount":{const i=T("x",t,e,n),l=T("weights",t,e,n),u=T("size",t,e,n),c=T("binaryOutput",t,e,n);return[r.denseBincount(i,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe=(t,e,n,r=Fr)=>{switch(t.op){case"ConcatV2":case"Concat":{const a=T("n",t,e,n),s=T("axis",t,e,n);let o=T("tensors",t,e,n);return o=o.slice(0,a),[r.concat(o,s)]}case"Gather":{const a=T("x",t,e,n),s=T("indices",t,e,n);return[r.gather(a,r.cast(s,"int32"),0)]}case"GatherV2":{const a=T("axis",t,e,n),s=T("batchDims",t,e,n),o=T("x",t,e,n),i=T("indices",t,e,n);return[r.gather(o,r.cast(i,"int32"),a,s)]}case"Reverse":{const a=T("dims",t,e,n),s=[];for(let i=0;i<a.length;i++)a[i]&&s.push(i);const o=T("x",t,e,n);return[r.reverse(o,s)]}case"ReverseV2":{const a=T("axis",t,e,n),s=T("x",t,e,n);return[r.reverse(s,a)]}case"Slice":{const a=T("begin",t,e,n),s=T("size",t,e,n);return[r.slice(T("x",t,e,n),a,s)]}case"StridedSlice":{const a=T("begin",t,e,n),s=T("end",t,e,n),o=T("strides",t,e,n),i=T("beginMask",t,e,n),l=T("endMask",t,e,n),u=T("ellipsisMask",t,e,n),c=T("newAxisMask",t,e,n),d=T("shrinkAxisMask",t,e,n),f=T("x",t,e,n);return[r.stridedSlice(f,a,s,o,i,l,u,c,d)]}case"Pack":return at(()=>{const a=T("axis",t,e,n),s=T("tensors",t,e,n),o=s[0].shape,i=r.squeeze(s[0]).shape,l=s.map(u=>{const c=Kt(u.shape,o);if(!c&&!Kt(r.squeeze(u).shape,i))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,o)});return[r.stack(l,a)]});case"Unpack":{const a=T("axis",t,e,n),s=T("tensor",t,e,n);return r.unstack(s,a)}case"Tile":{const a=T("reps",t,e,n);return[r.tile(T("x",t,e,n),a)]}case"Split":case"SplitV":{const a=T("axis",t,e,n),s=T("numOrSizeSplits",t,e,n),o=T("x",t,e,n);return r.split(o,s,a)}case"ScatterNd":{const a=T("indices",t,e,n),s=T("values",t,e,n),o=T("shape",t,e,n);return[r.scatterND(a,s,o)]}case"GatherNd":{const a=T("x",t,e,n),s=T("indices",t,e,n);return[r.gatherND(a,s)]}case"SparseToDense":{const a=T("sparseIndices",t,e,n),s=T("outputShape",t,e,n),o=T("sparseValues",t,e,n),i=T("defaultValue",t,e,n);return[r.sparseToDense(a,o,s,o.dtype===i.dtype?i:r.cast(i,o.dtype))]}case"TensorScatterUpdate":{const a=T("indices",t,e,n),s=T("values",t,e,n),o=T("tensor",t,e,n);return[r.tensorScatterUpdate(o,a,s)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe=(t,e,n,r=Fr)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:s,emptyRowIndicator:o,reverseIndexMap:i}=r.sparse.sparseFillEmptyRows(T("indices",t,e,n),T("values",t,e,n),T("denseShape",t,e,n),T("defaultValue",t,e,n));return[a,s,o,i]}case"SparseReshape":{const{outputIndices:a,outputShape:s}=r.sparse.sparseReshape(T("inputIndices",t,e,n),T("inputShape",t,e,n),T("newShape",t,e,n));return[a,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(T("data",t,e,n),T("indices",t,e,n),T("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(T("data",t,e,n),T("indices",t,e,n),T("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ghe=(t,e,n,r=Fr)=>{switch(t.op){case"FFT":return[r.fft(T("x",t,e,n))];case"IFFT":return[r.ifft(T("x",t,e,n))];case"RFFT":return[r.rfft(T("x",t,e,n))];case"IRFFT":return[r.irfft(T("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe=(t,e,n,r=Fr)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(T("input",t,e,n),T("pattern",t,e,n),T("rewrite",t,e,n),T("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:a,nGramsSplits:s}=r.string.stringNGrams(T("data",t,e,n),T("dataSplits",t,e,n),T("separator",t,e,n),T("nGramWidths",t,e,n),T("leftPad",t,e,n),T("rightPad",t,e,n),T("padWidth",t,e,n),T("preserveShortSequences",t,e,n));return[a,s]}case"StringSplit":{const{indices:a,values:s,shape:o}=r.string.stringSplit(T("input",t,e,n),T("delimiter",t,e,n),T("skipEmpty",t,e,n));return[a,s,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(T("input",t,e,n),T("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qhe=(t,e,n,r=Fr)=>{switch(t.op){case"Cast":return[r.cast(T("x",t,e,n),T("dtype",t,e,n))];case"ExpandDims":{const a=T("axis",t,e,n);return[r.expandDims(T("x",t,e,n),a)]}case"Squeeze":{const a=T("axis",t,e,n);return[r.squeeze(T("x",t,e,n),a)]}case"Reshape":return[r.reshape(T("x",t,e,n),T("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(T("x",t,e,n),T("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(T("x",t,e,n),T("padding",t,e,n),T("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(T("x",t,e,n),T("padding",t,e,n),T("constantValue",t,e,n))];case"SpaceToBatchND":{const a=T("blockShape",t,e,n),s=T("paddings",t,e,n);return[r.spaceToBatchND(T("x",t,e,n),a,s)]}case"BatchToSpaceND":{const a=T("blockShape",t,e,n),s=T("crops",t,e,n);return[r.batchToSpaceND(T("x",t,e,n),a,s)]}case"DepthToSpace":{const a=T("blockSize",t,e,n),s=T("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(T("x",t,e,n),a,s)]}case"BroadcastTo":return[r.broadcastTo(T("x",t,e,n),T("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(T("s0",t,e,n),T("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3(t,e,n,r,a=at){const s=((o,i,l)=>{switch(o.category){case"arithmetic":return a(()=>She(o,i,l));case"basic_math":return a(()=>Che(o,i,l));case"control":return The(o,i,l);case"convolution":return a(()=>Ehe(o,i,l));case"creation":return a(()=>Ahe(o,i,l));case"dynamic":return Phe(o,i,l);case"evaluation":return a(()=>Ohe(o,i,l));case"image":return a(()=>Mhe(o,i,l));case"graph":return a(()=>Rhe(o,i,l));case"logical":return a(()=>Fhe(o,i,l));case"matrices":return a(()=>Lhe(o,i,l));case"normalization":return a(()=>Bhe(o,i,l));case"ragged":return a(()=>zhe(o,i,l));case"reduction":return a(()=>Uhe(o,i,l));case"slice_join":return a(()=>Vhe(o,i,l));case"sparse":return a(()=>Whe(o,i,l));case"spectral":return a(()=>Ghe(o,i,l));case"string":return a(()=>Hhe(o,i,l));case"transformation":return a(()=>qhe(o,i,l));case"hash_table":return jhe(o,i,l,r);case"custom":const u=J5(o.op);if(u&&u.customExecutor)return u.customExecutor(new whe(o,i,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Jl(s)?s.then(o=>[].concat(o)):[].concat(s)}class I3{constructor(e={},n={},r={},a={},s){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3(t,e,n,r){const a=new Set,s=[];let o=null,i=null;const l=new Set,u=new Set(Object.keys(t).map(f=>za(f)[0]));r=r||[];const c=new Set(r.map(f=>za(f.name)[0])),d=[...e];for(;d.length>0;){const f=d.pop();if((qu(f)||tpe(f)||npe(f))&&o==null&&(o=f,i=o.children.map(h=>h.name).filter(h=>a.has(h))),a.add(f.name),n[f.name]==null&&!u.has(f.name)&&!c.has(f.name)){if(f.inputs.length===0){s.push(f.name);continue}f.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:t,outputs:e,usedNodes:a,missingInputs:s,dynamicNode:o,syncInputs:i}}function Khe(t,e){const{usedNodes:n,inputs:r}=e,a=Object.keys(r).map(y=>za(y)[0]).map(y=>t.nodes[y]),s=t.initNodes||[],o=y=>n.has(typeof y=="string"?y:y.name);function i(y){return[...new Map(y.map(v=>[v.name,v])).values()]}const l=i([...a,...t.weights,...s]).filter(o),u=i([...l,...Object.values(t.nodes)]).filter(o),c=new Map(u.map(y=>[y.name,y])),d={};for(const y of u){d[y.name]=d[y.name]||0;for(const v of y.children)o(v)||(d[v.name]=Number.POSITIVE_INFINITY),d[v.name]=(d[v.name]||0)+1}const f=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),h=[...f];for(;f.length>0;){const y=f.pop(),v=c.get(y);for(const x of v.children.filter(o))--d[x.name]===0&&(h.push(x.name),f.push(x.name))}const p=h.map(y=>c.get(y)),g=Xhe(p,l);return Yhe(g,l),g}function Xhe(t,e){const n=new Map(t.map(o=>[o.name,o])),r=e.map(o=>o.name),a=new Set(r);for(;r.length>0;){const o=r.pop(),i=n.get(o);for(const l of i.children)!n.has(l.name)||a.has(l.name)||(a.add(l.name),r.push(l.name))}return t.filter(o=>a.has(o.name))}class Jb extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Yhe(t,e){const n=new Map(t.map((i,l)=>[i.name,l])),r=new Set(e.map(i=>i.name)),a=i=>r.has(typeof i=="string"?i:i.name),s=new Set(t.map(i=>i.name)),o=i=>s.has(typeof i=="string"?i:i.name);for(const i of t){for(const l of i.children.filter(o)){if(!n.has(l.name))throw new Jb(`Child ${l.name} of node ${i.name} is unreachable.`);if(n.get(i.name)>n.get(l.name))throw new Jb(`Node ${i.name} is scheduled to run after its child ${l.name}.`)}if(!a(i))for(const l of i.inputs){if(!n.has(l.name))throw new Jb(`Input ${l.name} of node ${i.name} is unreachable.`);if(n.get(l.name)>n.get(i.name))throw new Jb(`Node ${i.name} is scheduled to run before its input ${l.name}.`)}}}function Qhe(t){const e=new Map(t.map((i,l)=>[i.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((i,l)=>qu(i)?n:l),a=i=>{const l=r[e.get(i.name)];return l??-1},s=t.map((i,l)=>i.children.map(a).reduce((u,c)=>Math.max(u,c),r[l])),o=new Map;for(let i=0;i<t.length;++i){const l=s[i];if(l===n)continue;const u=t[i],c=t[l];o.has(c.name)||o.set(c.name,[]),o.get(c.name).push(u)}return o}const Jhe=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Zhe=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),epe=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function qu(t){return Jhe.has(t.op)}function tpe(t){return Zhe.has(t.op)}function npe(t){return epe.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bw{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Bw(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(s=>s.name).sort(),a=n.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,n){const r=T3(e,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:s,syncInputs:o}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(a.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${a}]`)}const i=Khe(this.graph,r),l=Qhe(i);return{orderedNodes:i,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Co(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const a=r.map(f=>this.graph.nodes[za(f)[0]]),s=n.map(f=>za(f)[0]),o=new Set(s);let i=s.map(f=>this.graph.nodes[f]);i.length===0&&(i=this._outputs);const l=this.getCompilationKey(a,i);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,i),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=ee().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const c={},d={};return at(()=>{const f=new I3(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(v=>{const[x,b]=za(v,f),w=[];w[b]=e[v],h[x]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(w))});const p=this.getFrozenTensorIds(h),{orderedNodes:g,nodeLiveUntilMap:y}=u;for(const v of g){if(h[v.name])continue;const x=N3(v,h,f,this._resourceManager);if(Jl(x))throw new Error(`The execution of the op '${v.op}' returned a promise. Please use model.executeAsync() instead.`);h[v.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[v.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(v,h,f,p,o,y.get(v.name))}return this.parent==null&&f.dispose(p),n.map(v=>Rr(v,h,f))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(e,n,r,a,s,o,i){if(!(qu(n)||o.has(e))){for(const l of r[e])l!=null&&(i[l.id]=(i[l.id]||0)+n.children.length);for(const l of n.inputs){if(qu(l))continue;const u=S3(l.name,r,a);if(u!=null)for(const c of u){if(!c||c.kept||s.has(c.id))continue;const d=i[c.id];d===1?(c.dispose(),delete i[c.id]):d!=null&&i[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,a,s,o){function i(l){return qu(l)||s.has(l.name)}if(!(qu(e)||o==null))for(const l of o){if(i(l))continue;const u=S3(l.name,n,r);for(const c of u)!c||c.kept||a.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,a={},s={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=ee().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const o=new I3(this.weightMap,a,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(e,o,n,r),l=n.map(f=>Rr(f,i,o)),u=l.map(f=>f.id),c=Object.keys(e).map(f=>e[f].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(i).forEach(f=>{f.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&o.dispose(d),l}async executeFunctionAsync(e,n,r){const a=e.reduce((s,o,i)=>(s[this.inputs[i].name]=o,s),{});return this._executeAsync(a,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,a){const s=Object.keys(e),o=s.map(w=>this.graph.nodes[za(w)[0]]),i=r.map(w=>za(w)[0]),l=new Set(i);let u=i.map(w=>this.graph.nodes[w]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:f,syncInputs:h}=T3(e,u,this.weightMap,this._initNodes),p=[...o,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[C,_]=za(w),$=[];$[_]=e[w],g[C]=$});const y={},v=this.getFrozenTensorIds(g),x={};for(;p.length>0;){const w=this.processStack(o,p,n,g,x,v,l,y,c);await Promise.all(w)}f==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter(w=>!qu(w)&&!Rr(w.name,g,n)).map(w=>w.name);if(b.length>0){let w="";throw f!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${s}]. Consider providing the following inputs: [${d}]. ${w}`)}return g}processStack(e,n,r,a,s,o,i,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let f="";if(d.node.op==="Enter"&&T("isConstant",d.node,a,r)&&([f]=ki(d.node.name,r)),a[d.node.name]==null){const h=N3(d.node,a,r,this._resourceManager);f||([f]=ki(d.node.name,r));const p=r.currentContext;Jl(h)?c.push(h.then(g=>(a[f]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(g)),r.currentContext=p,this.checkTensorForDisposal(f,d.node,a,r,o,i,l),this.processChildNodes(d.node,n,r,a,s,u),g))):(a[f]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(h)),this.checkTensorForDisposal(f,d.node,a,r,o,i,l),this.processChildNodes(d.node,n,r,a,s,u))}else this.processChildNodes(d.node,n,r,a,s,u)}return c}processChildNodes(e,n,r,a,s,o){e.children.forEach(i=>{const[l]=ki(i.name,r);s[l]||!o.has(i.name)||(i.op==="Merge"?i.inputNames.some(u=>!!Rr(u,a,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:i})):i.inputNames.every(u=>!!Rr(u,a,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[a]=za(n),s=this.graph.nodes[a];if(s.attrParams.shape&&s.attrParams.shape.value){const o=s.attrParams.shape.value,i=o.length===r.shape.length&&r.shape.every((l,u)=>o[u]===-1||o[u]===l);j(i,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&j(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const a={};for(const s in e){const o=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[s];o!=null?a[o.name]=e[s]:a[s]=e[s]}return a}checkInputs(e){const n=Object.keys(e).filter(r=>{const[a]=za(r);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,a;const s=(a=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||a===void 0?void 0:a[n];return s!=null?s.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=za(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class rpe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape="?tfjs-format=file",spe="model.json";class ope{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=qA){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new rpe}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Jl(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await tW(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const s=this.artifacts.userDefinedMetadata;s.signature!=null&&(a=s.signature),s.structuredOutputKeys!=null&&(this.structuredOutputKeys=s.structuredOutputKeys)}if(this.signature=a,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Bw(C3.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const s=C3.Instance.transformGraph(e.modelInitializer);this.initializer=new Bw(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof cn?[e]:e,r={};return n.forEach((a,s)=>r[this.structuredOutputKeys[s]]=a),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof cn)&&!Array.isArray(e)){const s=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(s!=null)for(const o in s){const i=s[o];i.resourceId!=null&&(e[o]=this.resourceIdToCapturedInput[i.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let a=0;return this.inputNodes.reduce((s,o)=>{var i,l,u;const c=(u=(l=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||l===void 0?void 0:l[o])===null||u===void 0?void 0:u.resourceId;return c!=null?s[o]=this.resourceIdToCapturedInput[c]:s[o]=e[a++],s},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let a=0;a<r.length;a++){const s=r[a],o=n[s];this.resourceIdToCapturedInput[o.resourceId]=e[a]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Jt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Yf(t,e={},n=qA){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=ipe(t));const r=new ope(t,e,n);return await r.load(),r}function ipe(t){return t.endsWith("/")||(t=t+"/"),`${t}${spe}${ape}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ns=ee();Ns.registerFlag("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE",()=>15);Ns.registerFlag("WEBGPU_CPU_FORWARD",()=>!0);Ns.registerFlag("WEBGPU_MATMUL_PROGRAM_TYPE",()=>-1);Ns.registerFlag("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE",()=>!0);Ns.registerFlag("WEBGPU_USE_LOW_POWER_GPU",()=>!1);Ns.registerFlag("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e3);Ns.registerFlag("WEBGPU_USE_PROFILE_TOOL",()=>!1);Ns.registerFlag("WEBGPU_IMPORT_EXTERNAL_TEXTURE",()=>!0);Ns.registerFlag("WEBGPU_USE_NAIVE_CONV2D_DEBUG",()=>!1);Ns.registerFlag("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL",()=>-1);Ns.registerFlag("WEBGPU_CONV_SEPARATE_IM2COL_SHADER",()=>!1);Ns.registerFlag("WEBGPU_PRINT_SHADER",()=>"");Ns.registerFlag("WEBGPU_ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpe{constructor(e){e&&(this.vendor=e.vendor,this.architecture=e.architecture,this.intelGPUGeneration=this.getIntelGPUGeneration())}getIntelGPUGeneration(){if(this.isIntel()){if(this.architecture.startsWith("gen"))return Number(this.architecture.match(/\d+/));if(this.architecture.startsWith("xe"))return 12}return 0}isIntel(){return this.vendor==="intel"}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class upe{constructor(e){this.device=e,this.numUsedBuffers=0,this.numFreeBuffers=0,this.freeBuffers=new Map,this.usedBuffers=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireBuffer(e,n,r=!1,a=!0){let s;const o=E3(e,n);return a?(this.freeBuffers.has(o)||this.freeBuffers.set(o,[]),this.freeBuffers.get(o).length>0?(s=this.freeBuffers.get(o).pop(),this.numFreeBuffers--):(s=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e)):(s=this.device.createBuffer({size:e,usage:n,mappedAtCreation:r}),this.numBytesAllocated+=e),this.usedBuffers.has(o)||this.usedBuffers.set(o,[]),this.usedBuffers.get(o).push(s),this.numUsedBuffers++,this.numBytesUsed+=e,s}releaseBuffer(e,n=!0){if(this.freeBuffers.size===0)return;const r=e.size,a=e.usage,s=E3(r,a),o=this.usedBuffers.get(s),i=o.indexOf(e);if(i<0)throw new Error("Cannot find the buffer in buffer manager");o[i]=o[o.length-1],o.pop(),this.numUsedBuffers--,this.numBytesUsed-=r,n?(this.freeBuffers.get(s).push(e),this.numFreeBuffers++):(e.destroy(),this.numBytesAllocated-=r)}getNumUsedBuffers(){return this.numUsedBuffers}getNumFreeBuffers(){return this.numFreeBuffers}dispose(){this.freeBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedBuffers.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeBuffers=new Map,this.usedBuffers=new Map,this.numUsedBuffers=0,this.numFreeBuffers=0,this.numBytesUsed=0,this.numBytesAllocated=0}}function E3(t,e){return`${t}_${e}`}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cpe=class{constructor(e){this.device=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures=new Map,this.usedTextures=new Map,this.numBytesUsed=0,this.numBytesAllocated=0}acquireTexture(e,n,r,a){const s=P3(r),o=e*n*s,i=A3(e,n,r,a);if(this.freeTextures.has(i)||this.freeTextures.set(i,[]),this.usedTextures.has(i)||this.usedTextures.set(i,[]),this.numBytesUsed+=o,this.numUsedTextures++,this.freeTextures.get(i).length>0){this.numFreeTextures--;const u=this.freeTextures.get(i).shift();return this.usedTextures.get(i).push(u),u}this.numBytesAllocated+=o;const l=this.device.createTexture({size:[e,n],format:r,usage:a});return this.usedTextures.get(i).push(l),l}releaseTexture(e){if(this.freeTextures.size===0)return;const n=e.width,r=e.height,a=e.format,s=e.usage,o=A3(n,r,a,s);this.freeTextures.has(o)||this.freeTextures.set(o,[]),this.freeTextures.get(o).push(e),this.numFreeTextures++,this.numUsedTextures--;const i=this.usedTextures.get(o),l=i.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(l,1);const u=P3(a),c=n*r*u;this.numBytesUsed-=c}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){this.freeTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.usedTextures.forEach((e,n)=>{e.forEach(r=>{r.destroy()})}),this.freeTextures=new Map,this.usedTextures=new Map,this.numUsedTextures=0,this.numFreeTextures=0,this.numBytesUsed=0,this.numBytesAllocated=0}};function A3(t,e,n,r){return`${t}_${e}_${n}_${r}`}function P3(t){if(t==="rgba8unorm")return 16;throw new Error(`${t} is not supported!`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t,e){if(Math.max(...t)>5)throw new Error("Cannot symbolically compute strides for rank > 6 tensor.");const n=t.length,r="xyzwuv",a=t.map(o=>`${e}.${r[o]}`),s=new Array(n-1);s[n-2]=a[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${a[o+1]})`;return s}const hu=(t,e,n)=>n==="int32"?`atomicAdd(${t}, bitcast<i32>(${e}));`:`
          {
            var oldValue = 0;
            loop {
              let newValueF32 = bitcast<f32>(oldValue) + (${e});
              let newValue = bitcast<i32>(newValueF32);
              let res = atomicCompareExchangeWeak(${t}, oldValue, newValue);
              if res.exchanged {
                break;
              }
              oldValue = res.old_value;
            }
          }`;/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qf;(function(t){t[t.FROM_PIXELS=0]="FROM_PIXELS",t[t.DRAW=1]="DRAW"})(Qf||(Qf={}));const fpe=(t,e,n,r,a)=>{const s={dtype:r.dtype,shape:r.shape},o=ppe(n,s,e),i=t.createShaderModule({code:o,label:e.constructor.name});let l=ee().get("WEBGPU_PRINT_SHADER");if(l!==""){l=l.toLowerCase();const u=l.split(",");(l==="all"||u.some(c=>e.shaderKey.toLowerCase().includes(c)))&&(console.group(e.shaderKey),console.debug(o),console.groupEnd())}return a?t.createComputePipelineAsync({compute:{module:i,entryPoint:"_start"},label:e.constructor.name,layout:"auto"}):t.createComputePipeline({compute:{module:i,entryPoint:"_start"},label:e.constructor.name,layout:"auto"})},yt=(t,e="f32")=>{switch(t){case 1:return`${e}`;case 2:return`vec2<${e}>`;case 3:return`vec3<${e}>`;case 4:return`vec4<${e}>`;default:throw new Error(`${t}-component ${e} is not supported.`)}};function nr(t){if(t<=1)return"i32";if(t===2)return"vec2<i32>";if(t===3)return"vec3<i32>";if(t===4)return"vec4<i32>";if(t===5)return"vec5";if(t===6)return"vec6";throw Error(`GPU for rank ${t} is not yet supported`)}function Mi(t){if(t===0)return"x";if(t===1)return"y";if(t===2)return"z";if(t===3)return"w";if(t===4)return"u";if(t===5)return"v";throw Error(`Index ${t} is not yet supported`)}function Ae(...t){let e;switch(t.length){case 0:e=`
        fn main()
      `;break;case 1:e=`
        fn main(${t[0]} : i32)
      `;break;default:throw Error("Unreachable")}return e}function O3(t,e){let n;return n=`
     ${hpe(e)}
      fn _start(@builtin(local_invocation_id) LocalId : vec3<u32>,
                @builtin(global_invocation_id) GlobalId : vec3<u32>,
                @builtin(local_invocation_index) LocalIndex: u32,
                @builtin(workgroup_id) WorkgroupId : vec3<u32>,
                @builtin(num_workgroups) NumWorkgroups : vec3<u32>) {
        localId = LocalId;
        localIndex = LocalIndex;
        globalId = GlobalId;
        numWorkgroups = NumWorkgroups;
        workgroupId = WorkgroupId;
        ${t?"main(getGlobalIndex());":"main();"};
      }
    `,n}function hpe(t){return`
  @compute @workgroup_size(${t.workgroupSize[0]}, ${t.workgroupSize[1]}, ${t.workgroupSize[2]})
`}function ppe(t,e,n){const r=[],a=n.workgroupSize[0]*n.workgroupSize[1]*n.workgroupSize[2];if(n.outputComponent=n.outputComponent?n.outputComponent:1,r.push(`

      var<private> localId: vec3<u32>;
      var<private> localIndex: u32;
      var<private> globalId: vec3<u32>;
      var<private> numWorkgroups: vec3<u32>;
      var<private> workgroupId: vec3<u32>;

      // Only used when the y/z dimension of workgroup size is 1.
      fn getGlobalIndex() -> i32 {
        ${tG(n)?"  return i32(globalId.x);":`  return i32((workgroupId.z * numWorkgroups.x * numWorkgroups.y +
                workgroupId.y * numWorkgroups.x + workgroupId.x) * ${a}u +
                localIndex);
        `}
      }
    `),n.pixelsOpType!=null){const p=n.pixelsOpType===Qf.FROM_PIXELS?`@group(0) @binding(0) var<storage, read_write> result: array<${Ku(e.dtype,n.outputComponent)}>;`:`@group(0) @binding(1) var<storage, read> inBuf : array<${Ku(t[0].dtype,n.outputComponent)}>;`,g=e.shape.length===3?"vec2<i32>":"i32";r.push(`
        struct Uniform {
          outShapeStrides : ${g},
          size            : i32,
          numChannels     : i32,
          alpha           : f32,
        };

        ${p}
        @group(0) @binding(2) var<uniform> uniforms: Uniform;
      `);const y=D3(n);return[R3,r.join(`
`),q0(e.shape),n.getUserCode(),O3(y,n)].join(`
`)}let s,o,i="struct Uniforms { NAN : f32, INFINITY : f32, ";n.variableNames.forEach((p,g)=>{const y=nr(t[g].shape.length);i+=`${p.charAt(0).toLowerCase()+p.slice(1)}Shape : ${y}, `,s=t[g].shape.length-1,o=nr(s),i+=`${p.charAt(0).toLowerCase()+p.slice(1)}ShapeStrides: ${o}, `});const l=nr(e.shape.length);i+=`outShape : ${l}, `,s=e.shape.length-1,o=nr(s),i+=`
         outShapeStrides: ${o}, `,n.size&&(i+="size : i32, "),n.uniforms&&(i+=n.uniforms),i+="};",i=Cpe(i),r.push(i),n.atomic?r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<atomic<i32>>;
    `):r.push(`
      @group(0) @binding(0) var<storage, read_write> result: array<${Ku(e.dtype,n.outputComponent)}>;
    `),n.variableNames.forEach((p,g)=>{r.push(`
      @group(0) @binding(${1+g}) var<storage, read> ${p}: array<${n.variableComponents?Ku(t[g].dtype,n.variableComponents[g]):Ku(t[g].dtype,n.outputComponent)}>;
        `)}),i!==""&&r.push(`
      @group(0) @binding(${1+n.variableNames.length}) var<uniform> uniforms: Uniforms;
      `);const u=bpe(e.shape,n.dispatchLayout),c=[R3,r.join(`
`)+gpe,q0(e.shape),u,wpe(e.shape.length)];n.atomic||c.push(Spe(e.shape,e.dtype,n.outputComponent)),n.variableNames.forEach((p,g)=>{c.push(`${q0(t[g].shape,p)}`)});const d=t.map((p,g)=>xpe(p,e.shape,n.variableComponents?n.variableComponents[g]:n.outputComponent,n.dispatchLayout.x.length===e.shape.length)).join(`
`);c.push(d),c.push(n.getUserCode());const f=D3(n);return c.push(O3(f,n)),c.join(`
`)}function mpe(t,e,n){let r=t.shaderKey;if(t.pixelsOpType!=null)return r;const a=[],s=[];e.forEach(c=>{a.push(c.shape),s.push(c.dtype)}),a.push(n.shape),s.push(n.dtype);const o=e.map(c=>Mc(c.shape,n.shape)),i=e.map(c=>Kt(c.shape,n.shape)).join("_"),l=o.map(c=>c.join("_")).join(";"),u=tG(t)?"flatDispatch":"";return r+="_"+(t.workgroupSize?t.workgroupSize.join(","):"")+a.map(c=>c.length).join(",")+s.join(",")+t.variableNames.join(",")+l+i+u,r}const R3=`
  struct vec5 {x: i32, y: i32, z: i32, w: i32, u: i32};
  struct vec6 {x: i32, y: i32, z: i32, w: i32, u: i32, v: i32};

  // Checks whether coordinates lie within the bounds of the shape.
  fn coordsInBounds2D(coord : vec2<i32>, shape : vec2<i32>) -> bool {
    return all(coord >= vec2<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds3D(coord : vec3<i32>, shape : vec3<i32>) -> bool {
    return all(coord >= vec3<i32>(0)) && all(coord < shape);
  }
  fn coordsInBounds4D(coord : vec4<i32>, shape : vec4<i32>) -> bool {
    return all(coord >= vec4<i32>(0)) && all(coord < shape);
  }

  fn getIndexFromCoords1D(coord : i32, shape : i32) -> i32 {
    return coord;
  }
  fn getIndexFromCoords2D(coords : vec2<i32>, shape : vec2<i32>) -> i32 {
    return dot(coords, vec2<i32>(shape.y, 1));
  }
  fn getIndexFromCoords3D(coords : vec3<i32>, shape : vec3<i32>) -> i32 {
    return dot(coords, vec3<i32>(shape.y * shape.z, shape.z, 1));
  }
  fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
    return dot(coords, vec4<i32>(
        shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
  }
  fn getIndexFromCoords5D(coords : vec5, shape : vec5) -> i32 {
    let shapeStrides: vec5 = vec5(shape.y * shape.z * shape.w * shape.u, shape.z * shape.w * shape.u, shape.w * shape.u, shape.u, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u;
  }
  fn getIndexFromCoords6D(coords : vec6, shape : vec6) -> i32 {
    let shapeStrides: vec6 = vec6(shape.y * shape.z * shape.w * shape.u * shape.v, shape.z * shape.w * shape.u * shape.v, shape.w * shape.u * shape.v, shape.u * shape.v, shape.v, 1);
    return coords.x*shapeStrides.x + coords.y*shapeStrides.y + coords.z*shapeStrides.z + coords.w*shapeStrides.w + coords.u*shapeStrides.u + coords.v*shapeStrides.v;
  }

  // NaN defination in IEEE 754-1985 is :
  //   - sign = either 0 or 1.
  //   - biased exponent = all 1 bits.
  //   - fraction = anything except all 0 bits (since all 0 bits represents infinity).
  // https://en.wikipedia.org/wiki/IEEE_754-1985#Representation_of_non-numbers
  fn isnan(val: f32) -> bool {
    let floatToUint: u32 = bitcast<u32>(val);
    return (floatToUint & 0x7fffffffu) > 0x7f800000u;
  }
  fn isnanVec4(val : vec4<f32>) -> vec4<bool> {
    let floatToUint: vec4<u32> = bitcast<vec4<u32>>(val);
    return (floatToUint & vec4<u32>(0x7fffffffu)) > vec4<u32>(0x7f800000u);
  }
`,gpe=`
  fn isinf(val: f32) -> bool {
    return abs(val) == uniforms.INFINITY;
  }
`;function q0(t,e=""){const n=t.length,r=e!==""?`get${e.charAt(0).toUpperCase()+e.slice(1)}CoordsFromIndex`:"getCoordsFromIndex",a=e!==""?`${e.charAt(0).toLowerCase()+e.slice(1)}ShapeStrides`:"outShapeStrides";if(n<=1)return`fn ${r}(index : i32) -> i32 { return index; }`;const s=Dt(t),o=nr(n),i=[];for(let u=0;u<n;u++)i.push(`d${u}`);if(s.length===1)return`    fn ${r}(index : i32) -> vec2<i32> {
      let d0 = index / uniforms.${a}; let d1 = index - d0 * uniforms.${a};
      return vec2<i32>(d0, d1);
    }`;let l;return l="var index2 = index;"+s.map((u,c)=>{const d=`let ${i[c]} = index2 / uniforms.${a}.${Mi(c)}`,f=c===s.length-1?`let ${i[c+1]} = index2 - ${i[c]} * uniforms.${a}.${Mi(c)}`:`index2 = index2 - ${i[c]} * uniforms.${a}.${Mi(c)}`;return`${d}; ${f};`}).join(""),`
    fn ${r}(index : i32) -> ${o} {
      ${l}
      return ${o}(${i.join(",")});
    }
  `}function ype(t,e){const n=t.name,r=t.shape.length,a=nr(r),s="get"+n.charAt(0).toUpperCase()+n.slice(1),o=["d0","d1","d2","d3","d4","d5"].slice(0,r),i=o.map(c=>`${c} : i32`).join(", ");if(r<1)return`
      fn ${s}() -> ${yt(e)} {
        return ${yt(e)}(${n}[0]);
      }
    `;const l=`uniforms.${n.charAt(0).toLowerCase()+n.slice(1)}Shape`;let u=`${r}D`;return r===0&&(u="1D"),`
    fn ${s}(${i}) -> ${yt(e)} {
      return ${yt(e)}(${n}[getIndexFromCoords${u}(${a}(${o.join(",")}),
        ${l})${e===1?"":` / ${e}`}]);
    }
   `}function vpe(t,e,n,r){const a=t.name,s=a.charAt(0).toUpperCase()+a.slice(1),o="get"+s+"ByOutput",i=t.shape.length,l=e.length,u=nr(l);if(Kt(t.shape,e)&&r)return`
    fn ${o}Index(globalIndex : i32) -> ${yt(n)} {
      return ${yt(n)}(${a}[globalIndex]);
    }

    fn ${o}Coords(coords : ${u}) -> ${yt(n)} {
      return ${yt(n)}(${a}[${l>1?"getOutputIndexFromCoords(coords)":"coords"}${n===1?"":` / ${n}`}]);
    }
    `;const c=Mc(t.shape,e),d=l-i;let f="";if(i===0)return`
    fn ${o}Index(globalIndex : i32) -> ${yt(n)}{
      return get${s}();
    }

    fn ${o}Coords(coords : ${u}) -> ${yt(n)}{
      return get${s}();
    }
  `;l<2&&c.length>=1?f="coords = 0;":f=c.map(y=>`coords.${Mi(y+d)} = 0;`).join(`
`);let h="";if(l<2&&i>0)h="coords";else if(l>1){const y=nr(i),v=t.shape.map((x,b)=>`coords.${Mi(b+d)}`).join(", ");h=`${y}(${v})`}else h="coords";const p=`uniforms.${a.charAt(0).toLowerCase()+a.slice(1)}Shape`,g=`${i}D`;return`
  fn ${o}Index(globalIndex : i32) -> ${yt(n)} {
    var coords = getCoordsFromIndex(globalIndex);
    ${f}
    return ${yt(n)}(${a}[getIndexFromCoords${g}(${h}, ${p})${n===1?"":` / ${n}`}]);
  }

  fn ${o}Coords(coordsIn : ${u}) -> ${yt(n)} {
    var coords = coordsIn;
    ${f}
    return ${yt(n)}(${a}[getIndexFromCoords${g}(${h}, ${p})${n===1?"":` / ${n}`}]);
  }
`}function xpe(t,e,n,r){let a=ype(t,n);return t.shape.length<=e.length&&(a+=vpe(t,e,n,r)),a}function bpe(t,e){const{x:n,y:r=[],z:a=[]}=e,s=t.length,o=n.length+r.length+a.length;if(o!==s)return"";if(n.length===s)return`fn getOutputCoords() -> ${nr(s)}{
    let globalIndex = getGlobalIndex();
    return getCoordsFromIndex(globalIndex);
  }
  `;let i="";const l=[n,r,a];for(let f=0;f<l.length;f++){const h=l[f];if(h.length!==0)if(h.length===1)i+=`let d${h[0]} = i32(globalId[${f}]);`;else{const p=dpe(h,"uniforms.outShape");i+=`var index${f} = i32(globalId[${f}]);`;for(let g=0;g<p.length;g++)i+=`let d${h[g]} = index${f} / ${p[g]};`,g===p.length-1?i+=`let d${h[g+1]} = index${f} - d${h[g]} * ${p[g]};`:i+=`index${f} = index${f} - d${h[g]} * ${p[g]};`}}const u=[];for(let f=0;f<o;f++)u.push(`d${f}`);const c=nr(o);let d=`fn getOutputCoords() -> ${c} {
  ${i}
`;return u.length===0?d+=`return ${c}(0); }`:d+=`return ${c}(${u.join(",")}); }`,d}function wpe(t){let e="";switch(t){case 0:case 1:e+=`
        fn getOutputIndexFromCoords(coords : i32) -> i32 {
          return coords;
        }
        `;break;case 2:e+=`
        fn getOutputIndexFromCoords(coords : vec2<i32>) -> i32 {
          return dot(coords, vec2<i32>(uniforms.outShapeStrides, 1));
        }
        `;break;case 3:e+=`
        fn getOutputIndexFromCoords(coords : vec3<i32>) -> i32 {
          return dot(coords, vec3<i32>(uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, 1));
        }
        `;break;case 4:e+=`
        fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
          return dot(coords, vec4<i32>(
            uniforms.outShapeStrides.x, uniforms.outShapeStrides.y, uniforms.outShapeStrides.z, 1));
        }
        `;break;case 5:e+=`
        fn getOutputIndexFromCoords(coords : vec5) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u;
        }
        `;break;case 6:e+=`
        fn getOutputIndexFromCoords(coords : vec6) -> i32 {
          return coords.x * uniforms.outShapeStrides.x +
              coords.y * uniforms.outShapeStrides.y +
              coords.z * uniforms.outShapeStrides.z +
              coords.w * uniforms.outShapeStrides.w +
              coords.u * uniforms.outShapeStrides.u +
              coords.v;
        }
        `;break;default:j(!1,()=>`Unsupported ${t}D shape`);break}return e}function tG(t){return t.dispatch[1]===1&&t.dispatch[2]===1}function Ku(t,e=1){if(t==="float32")return yt(e,"f32");if(t==="int32"||t==="bool")return yt(e,"i32");throw new Error(`type ${t} is not supported.`)}function Spe(t,e,n){const r=t.length,a=Ku(e,n);let s=`fn setOutputAtIndex(flatIndex : i32, value : ${yt(n)}) {
      result[flatIndex] = ${a}(value);
    }

    fn setOutputAtIndexI32(flatIndex : i32, value : ${yt(n,"i32")}) {
      result[flatIndex] = ${a}(value);
    }
    `;if(r>=2){const o=["d0","d1","d2","d3","d4","d5"].slice(0,r),i=nr(r);s+=`
      fn setOutputAtCoords(${o.map(l=>`${l} : i32`).join(", ")}, value : ${yt(n)}) {
        let flatIndex = getOutputIndexFromCoords(${i}(${o.join(", ")}));
        setOutputAtIndex(flatIndex${n===1?"":` / ${n}`}, value);
      }
      fn setOutputAtCoordsI32(${o.map(l=>`${l} : i32`).join(", ")}, value : ${yt(n,"i32")}) {
        let flatIndex = getOutputIndexFromCoords(${i}(${o.join(", ")}));
        setOutputAtIndexI32(flatIndex${n===1?"":` / ${n}`}, value);
      }
    `}return s}function Cpe(t){const e=/(\w+)\s*:\s*vec(5|6)/g;t=t.replace(e,r=>"@align(16) "+r);const n=/vec(5|6)\s*,\s*(\w+)/g;return t=t.replace(n,(r,a,s)=>`vec${a}, @align(16) ${s}`),t}function D3(t){return!(t.dispatchLayout.hasOwnProperty("y")&&t.dispatchLayout.y.length!==0||t.dispatchLayout.hasOwnProperty("z")&&t.dispatchLayout.z.length!==0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mc=t=>{let e=1;for(let n=0;n<t.length;n++)e*=t[n];return e};function Pe(t,e,n=[1,1,1],r=[1,1,1]){const[a,s,o]=[Math.ceil(mc(t.x.map(i=>e[i]))/(n[0]*r[0])),t.y?Math.ceil(mc(t.y.map(i=>e[i]))/(n[1]*r[1])):1,t.z?Math.ceil(mc(t.z.map(i=>e[i]))/(n[2]*r[2])):1];return[a,s,o]}function _pe(t,e,n,r=!1){const a=[8,8,1],s=[4,4,1];return r||(t<=8&&(s[1]=1),e<=16&&n<=16&&(a[0]=4)),{workgroupSize:a,elementsPerThread:s}}function nG(t,e,n=!1){if(n)return[8,8,1];const r=mc(t.x.map(s=>e[s])),a=mc(t.y.map(s=>e[s]));return r<=4?[4,16,1]:a<=4?[16,4,1]:[16,16,1]}function rG(t,e,n=!1){if(n)return[4,4,1];const r=mc(t.x.map(s=>e[s])),a=mc(t.y.map(s=>e[s]));return r<=4?[1,2,1]:a<=4?[2,1,1]:[2,2,1]}function Be(t){return{x:t.map((e,n)=>n)}}function j3(t){if(t==="float32"||t==="int32"||t==="bool"||t==="string")return 4;if(t==="complex64")return 8;throw new Error(`Unknown dtype ${t}`)}function aG(){return!!(typeof globalThis<"u"&&globalThis.navigator&&globalThis.navigator.gpu)}function sG(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGPU backend.`)})}var Wo;(function(t){t[t.MatMulReduceProgram=0]="MatMulReduceProgram",t[t.MatMulSplitKProgram=1]="MatMulSplitKProgram",t[t.MatMulSmallOutputSizeProgram=2]="MatMulSmallOutputSizeProgram",t[t.MatMulPackedProgram=3]="MatMulPackedProgram",t[t.MatMulMax=4]="MatMulMax"})(Wo||(Wo={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $pe=ee().getNumber("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD"),kpe=(t,e)=>{const n=t.limits.maxComputeWorkgroupsPerDimension,r=e.dispatchLayout,a=e.dispatch;if(a.every(o=>o<=n))return a;j(a[0]>n&&r.y===void 0&&r.z===void 0,()=>"Dispatch size exceeds WebGPU limits in Y or Z dimension.");let s=Math.ceil(Math.sqrt(a[0]));return s>n?(s=Math.ceil(Math.cbrt(a[0])),j(s<=n,()=>"Total dispatch size exceeds WebGPU maximum."),[s,s,s]):[s,s,1]};class Ap extends iv{nextDataId(){return Ap.nextDataId++}constructor(e,n){if(super(),this.commandQueueOwnedIds=new WeakSet,this.dispatchCountInPass=0,this.disposed=!1,this.downloadWaitMs=0,this.tensorDataPendingDisposal=[],this.queryResolveBuffer=null,this.querySet=null,this.querySetCount=2,this.stagingPendingDisposal=[],this.uniformPendingDisposal=[],this.uploadWaitMs=0,this.hasReadSyncWarned=!1,this.hasTimestampQueryWarned=!1,!aG())throw new Error("WebGPU is not supported on this device");this.pipelineCache={},this.device=e,this.queue=e.queue,this.commandEncoder=null,this.computePassEncoder=null,this.adapterInfo=new lpe(n),this.supportTimestampQuery=this.device.features.has("timestamp-query"),this.thresholdToIncreaseWorkgroups=this.adapterInfo.intelGPUGeneration>=12?16:8,this.bufferManager=new upe(this.device),this.textureManager=new cpe(this.device),this.tensorMap=new xS(this,ia()),ee().getBool("WEBGPU_USE_PROFILE_TOOL")&&(this.dummyCanvas=document.createElement("canvas"),this.dummyCanvas.width=1,this.dummyCanvas.height=1,this.dummyContext=this.dummyCanvas.getContext("webgpu"),this.dummyContext.configure({device:e,format:"bgra8unorm"}),document.body.appendChild(this.dummyCanvas))}floatPrecision(){return 32}disposeData(e,n=!1){if(!this.tensorMap.has(e))return!0;const r=this.tensorMap.get(e);return n?r.refCount=0:r.refCount--,r.refCount>0?!1:(r.complexTensorInfos!=null&&(this.disposeData(r.complexTensorInfos.real.dataId),this.disposeData(r.complexTensorInfos.imag.dataId)),this.commandQueueOwnedIds.has(e)?(this.tensorDataPendingDisposal.push(e),!0):(this.releaseResource(e),this.tensorMap.delete(e),!0))}memory(){return{numBytesInGPU:this.bufferManager.numBytesUsed,numBytesAllocatedInGPU:this.bufferManager.numBytesAllocated,unreliable:!1}}releaseResource(e){const n=this.tensorMap.get(e);if(!(!n||!n.resource)){if(n.external){n.resource=null;return}n.resource instanceof GPUBuffer?this.bufferManager.releaseBuffer(n.resource):n.resource instanceof GPUTexture&&this.textureManager.releaseTexture(n.resource),n.resource=null}}refCount(e){return this.tensorMap.has(e)?this.tensorMap.get(e).refCount:0}incRef(e){const n=this.tensorMap.get(e);n.refCount++}decRef(e){if(this.tensorMap.has(e)){const n=this.tensorMap.get(e);n.refCount--}}write(e,n,r){if(r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.tensorMap.set(a,{dtype:r,shape:n,values:e,refCount:1}),a}move(e,n,r,a,s){if(a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.tensorMap.set(e,{dtype:a,shape:r,values:n,refCount:s})}submitQueue(){this.queue.submit([this.commandEncoder.finish()]),this.commandEncoder=null,this.dispatchCountInPass=0,this.commandQueueOwnedIds=new WeakSet,this.tensorDataPendingDisposal.forEach(e=>{this.releaseResource(e),this.tensorMap.delete(e)}),this.uniformPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e)),this.stagingPendingDisposal.forEach(e=>this.bufferManager.releaseBuffer(e,!1)),this.tensorDataPendingDisposal=[],this.uniformPendingDisposal=[],this.stagingPendingDisposal=[]}ensureCommandEncoderReady(){this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder())}endComputePassEncoder(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}async checkCompileCompletionAsync(){let e;try{e=await Promise.all(Object.values(this.pipelineCache))}catch(n){throw new Error(n.message)}Object.keys(this.pipelineCache).map((n,r)=>{this.pipelineCache[n]=e[r]})}async getBufferData(e){if(ee().getBool("WEBGPU_ENGINE_COMPILE_ONLY"))return console.warn("The data may be invalid since WEBGPU_ENGINE_COMPILE_ONLY is true, this can only be called when WEBGPU_ENGINE_COMPILE_ONLY is false"),null;const n=e.size,r=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,r,0,n),this.submitQueue(),await r.mapAsync(GPUMapMode.READ);const a=r.getMappedRange().slice(0);return r.unmap(),r!=null&&this.bufferManager.releaseBuffer(r),ee().getBool("WEBGPU_USE_PROFILE_TOOL")&&(j(this.dummyContext!==void 0,()=>"Fail to get context for profiling tool"),this.dummyContext.getCurrentTexture()),a}convertAndCacheOnCPU(e,n){const r=this.tensorMap.get(e);return r.values=n,r.values}readSync(e){const n=this.tensorMap.get(e),{values:r,complexTensorInfos:a}=n;if(r!=null||n.dtype==="string")return r;if(n.dtype==="complex64"){const g=this.readSync(a.real.dataId),y=this.readSync(a.imag.dataId),v=V0(iy(g,y).buffer,"float32");return this.convertAndCacheOnCPU(e,v),v}this.hasReadSyncWarned||(this.hasReadSyncWarned=!0,console.warn("The performance of synchronously reading data from GPU to CPU is poor on the webgpu backend, please use asynchronous APIs instead."));const s=["opaque","premultiplied"],o=n.resource,i=o.size;j(i%4===0,()=>"Because there is 4 bytes for one pixel, buffer size must be multiple of 4.");const l=i/4,u=new ArrayBuffer(i),c=256,d=256,f=s.map(g=>new OffscreenCanvas(c,d)),h=new OffscreenCanvas(c,d);this.endComputePassEncoder(),f.map((g,y)=>{const v=g.getContext("webgpu");return v.configure({device:this.device,format:"bgra8unorm",usage:GPUTextureUsage.COPY_DST,alphaMode:s[y]}),v.getCurrentTexture()}).map((g,y)=>{const v=c*4,x=(k,A,P)=>{this.ensureCommandEncoderReady(),this.commandEncoder.copyBufferToTexture({buffer:o,bytesPerRow:v,offset:P},{texture:g},{width:k,height:A}),this.submitQueue();const O=h.getContext("2d",{willReadFrequently:!0});O.clearRect(0,0,k,A),O.drawImage(f[y],0,0);const R=O.getImageData(0,0,k,A).data,B=s[y],F=new Uint8ClampedArray(u,P,k*A*4);for(let L=0;L<F.length;L+=4)if(B==="premultiplied")F[L+3]=R[L+3];else{const H=R[L];F[L]=R[L+2],F[L+1]=R[L+1],F[L+2]=H}},b=Math.floor(l/(c*d));let w=c,C=d,_=0;for(let k=0;k<b;k++)x(w,C,_),_+=c*d*4;const $=l%(c*d);C=Math.floor($/c),C>0&&(x(w,C,_),_+=C*(c*4)),w=$%c,w>0&&x(w,1,_)});const p=V0(u,n.dtype);return this.convertAndCacheOnCPU(e,p),p}async read(e){if(!this.tensorMap.has(e))throw new Error(`Tensor ${e} was not registered!`);const n=this.tensorMap.get(e),{values:r}=n;if(r!=null)return r;let a;if(n.dtype==="complex64"){const s=await Promise.all([this.read(n.complexTensorInfos.real.dataId),this.read(n.complexTensorInfos.imag.dataId)]),o=s[0],i=s[1];a=iy(o,i)}else{const s=await this.getBufferData(n.resource);a=V0(s,n.dtype)}return this.convertAndCacheOnCPU(e,a),a}copyBuffer(e){const n=e.size,r=e.usage,a=this.bufferManager.acquireBuffer(n,r);return this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(e,0,a,0,n),this.submitQueue(),a}createTensorFromGPUData(e,n,r){let a=e.buffer;if(r==="complex64")throw new Error("Cannot write to a complex64 dtype. ");const s={id:this.nextDataId()};this.tensorMap.set(s,{dtype:r,shape:n,values:null,refCount:1,external:e.zeroCopy});const o=this.tensorMap.get(s),i=j3(o.dtype)*ne(o.shape);if(e.buffer.size<i)throw new Error(`GPUBuffer size(${e.buffer.size}) is smaller than tensor size(${i})!`);if((e.buffer.usage&(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))!==(GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC))throw new Error("GPUBuffer.usage should include GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC!");return e.zeroCopy!==!0&&(a=this.copyBuffer(a)),o.resource=a,ia().makeTensorFromDataId(s,n,r,this)}readToGPU(e){const n=this.tensorMap.get(e),{values:r,dtype:a,shape:s,resource:o}=n;if(a==="complex64")throw new Error("Does not support reading buffer for complex64 dtype.");if(o==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const i=o,l=i.size,u=i.usage,c=this.bufferManager.acquireBuffer(l,u);this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,c,0,l),this.submitQueue();const d=this.makeTensorInfo(s,a),f=ia().makeTensorFromTensorInfo(d),h=this.tensorMap.get(d.dataId);return h.resource=c,{tensorRef:f,buffer:c}}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>si(a));return en(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return en(e.shape,e.dtype,n)}async time(e){!this.supportTimestampQuery&&!this.hasTimestampQueryWarned&&(console.warn("This device doesn't support timestamp-query extension. Start Chrome browser with flag --enable-dawn-features=allow_unsafe_apis to try it again. Otherwise, zero will be shown for the kernel time when profiling mode is enabled."),this.hasTimestampQueryWarned=!0);const n=this.activeTimers,r=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();const s=eo(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),o=eo(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},l=await Promise.all(s);return i.kernelMs=$E(l),i.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", "),this.uploadWaitMs=0,this.downloadWaitMs=0,i}makeTensorInfo(e,n,r){return n==="string"&&r!=null&&r.length>0&&Ko(r[0])&&(r=r.map(s=>Zo(s))),{dataId:this.write(r,e,n),shape:e,dtype:n}}tensorToBinding(e){if(!e)return null;const r=this.tensorMap.get(e.dataId).resource;return r instanceof GPUBuffer?{buffer:r}:r instanceof GPUTexture?r.createView():r}uploadToGPU(e){const n=this.tensorMap.get(e);if(n.resource!=null)return;const r=j3(n.dtype)*ne(n.shape);let a;const s=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;if(n.values){if(a=this.bufferManager.acquireBuffer(r,s,!0),a.mapState==="unmapped"){const o=this.bufferManager.acquireBuffer(r,GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC,!0,!1),i=o.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(i).set(n.values):new Float32Array(i).set(n.values),o.unmap(),this.ensureCommandEncoderReady(),this.endComputePassEncoder(),this.commandEncoder.copyBufferToBuffer(o,0,a,0,r),this.stagingPendingDisposal.push(o)}else{const o=a.getMappedRange();n.dtype==="int32"||n.dtype==="bool"?new Int32Array(o).set(n.values):new Float32Array(o).set(n.values),a.unmap()}n.values=null}else a=this.bufferManager.acquireBuffer(r,s);n.resource=a}makeUniforms(e){let n=0,r=0;const a=[];let s=1;e.forEach(l=>{l.data.length===0&&(l.data=[1]);let u;switch(l.data.length){case 1:u=4;break;case 2:u=8;break;case 3:u=16;break;case 4:u=16;break;case 5:u=16;break;case 6:u=16;break;default:j(!1,()=>`Unsupported ${l.data.length}D shape`)}(r===5||r===6)&&(u=16),u>s&&(s=u),n=Math.ceil(n/u)*u,r=l.data.length,a.push(n),n+=l.data.length*4}),n=Math.ceil(n/s)*s;const o=new ArrayBuffer(n);e.forEach((l,u)=>{const c=a[u];l.type==="int32"?new Int32Array(o,c,l.data.length).set(l.data):l.type==="uint32"?new Uint32Array(o,c,l.data.length).set(l.data):new Float32Array(o,c,l.data.length).set(l.data)});const i=this.bufferManager.acquireBuffer(n,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);return this.queue.writeBuffer(i,0,o,0,n),this.uniformPendingDisposal.push(i),{offset:0,size:n,buffer:i}}runWebGPUProgram(e,n,r,a,s){if(s||(s=this.makeTensorInfo(e.outputShape,r)),ne(s.shape)===0)return this.tensorMap.get(s.dataId).values=Eo(s.dtype,0),s;this.uploadToGPU(s.dataId),e.dispatch=kpe(this.device,e);const o=n.map((l,u)=>{if(l.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");return this.uploadToGPU(l.dataId),{dtype:this.tensorMap.get(l.dataId).dtype,shape:l.shape,name:e.variableNames[u]}});e.shaderKey=mpe(e,o,s);const i=ee().getBool("WEBGPU_ENGINE_COMPILE_ONLY");return e.shaderKey in this.pipelineCache||(this.pipelineCache[e.shaderKey]=fpe(this.device,e,o,s,i)),e.pipeline=this.pipelineCache[e.shaderKey],i||this.recordAndSubmit(e,s,n,a),s}recordAndSubmit(e,n,r,a){if(e.pipeline instanceof Promise)throw new Error("Please call checkCompileCompletionAsync to ensure parallel compilation is done!");let s=[],o=[];const i="int32";if(e.pixelsOpType==null){s.push({type:"float32",data:[NaN]},{type:"float32",data:[1/0]}),o=r.concat(n).map(h=>h.shape);const f="int32";o.map(h=>{s.push({type:f,data:h});const p=Dt(h);s.push({type:f,data:p})})}else{const f=Dt(n.shape);s.push({type:i,data:f})}if(e.size){const f=ne(e.outputShape);s.push({type:i,data:[e.outputComponent?f/e.outputComponent:f]})}a&&(s=[...s,...a]);const l=[this.tensorToBinding(n),...r.map(f=>this.tensorToBinding(f)),this.makeUniforms(s)];r.forEach(f=>{this.commandQueueOwnedIds.add(f.dataId)}),this.commandQueueOwnedIds.add(n.dataId);const u=this.device.createBindGroup({layout:e.pipeline.getBindGroupLayout(0),entries:l.map((f,h)=>({binding:h,resource:f}))}),c=this.activeTimers!=null;this.ensureCommandEncoderReady();const d={};c&&this.supportTimestampQuery?(this.endComputePassEncoder(),this.querySet==null&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.querySetCount})),d.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1},this.computePassEncoder=this.commandEncoder.beginComputePass(d)):this.computePassEncoder||(this.computePassEncoder=this.commandEncoder.beginComputePass(d)),this.computePassEncoder.setPipeline(e.pipeline),this.computePassEncoder.setBindGroup(0,u),this.computePassEncoder.dispatchWorkgroups(e.dispatch[0],e.dispatch[1],e.dispatch[2]),this.dispatchCountInPass++,(c||ee().get("WEBGPU_DEFERRED_SUBMIT_BATCH_SIZE")<=this.dispatchCountInPass||e.pixelsOpType===Qf.DRAW)&&(this.endComputePassEncoder(),c?this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime()}):this.submitQueue())}async getQueryTime(){if(!this.supportTimestampQuery)return 0;this.queryResolveBuffer==null&&(this.queryResolveBuffer=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST|GPUBufferUsage.QUERY_RESOLVE)),this.commandEncoder.resolveQuerySet(this.querySet,0,this.querySetCount,this.queryResolveBuffer,0);const e=this.bufferManager.acquireBuffer(this.querySetCount*8,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.querySetCount*8),this.submitQueue(),await e.mapAsync(GPUMapMode.READ);const n=new BigUint64Array(e.getMappedRange()),r=Number(n[1]-n[0])/1e6;return e.unmap(),this.bufferManager.releaseBuffer(e),r}shouldExecuteOnCPU(e,n=$pe){return ee().getBool("WEBGPU_CPU_FORWARD")&&e.every(r=>this.tensorMap.get(r.dataId).resource==null&&ne(r.shape)<n)}numDataIds(){return this.tensorMap.numDataIds()-this.tensorDataPendingDisposal.length}dispose(){this.disposed||(this.querySet!=null&&this.querySet.destroy(),this.bufferManager.dispose(),this.textureManager.dispose(),this.disposed=!0)}}Ap.nextDataId=0;/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */aG()&&qS("webgpu",async()=>{const t={powerPreference:ee().get("WEBGPU_USE_LOW_POWER_GPU")?"low-power":"high-performance"},e=await navigator.gpu.requestAdapter(t),n={},r=[];e.features.has("timestamp-query")&&r.push("timestamp-query"),e.features.has("bgra8unorm-storage")&&r.push(["bgra8unorm-storage"]),n.requiredFeatures=r;const a=e.limits;n.requiredLimits={maxComputeWorkgroupStorageSize:a.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:a.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:a.maxStorageBufferBindingSize,maxBufferSize:a.maxBufferSize,maxComputeWorkgroupSizeX:a.maxComputeWorkgroupSizeX,maxComputeInvocationsPerWorkgroup:a.maxComputeInvocationsPerWorkgroup};const s=await e.requestDevice(n),o="info"in e?e.info:"requestAdapterInfo"in e?await e.requestAdapterInfo():void 0;return new Ap(s,o)},3);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var rt;(function(t){t[t.ADD=0]="ADD",t[t.ATAN2=1]="ATAN2",t[t.COMPLEX_MULTIPLY_IMAG=2]="COMPLEX_MULTIPLY_IMAG",t[t.COMPLEX_MULTIPLY_REAL=3]="COMPLEX_MULTIPLY_REAL",t[t.DIV=4]="DIV",t[t.ELU_DER=5]="ELU_DER",t[t.EQUAL=6]="EQUAL",t[t.FLOOR_DIV=7]="FLOOR_DIV",t[t.GREATER=8]="GREATER",t[t.GREATER_EQUAL=9]="GREATER_EQUAL",t[t.LESS=10]="LESS",t[t.LESS_EQUAL=11]="LESS_EQUAL",t[t.LOGICAL_AND=12]="LOGICAL_AND",t[t.LOGICAL_OR=13]="LOGICAL_OR",t[t.MAX=14]="MAX",t[t.MIN=15]="MIN",t[t.MOD=16]="MOD",t[t.MUL=17]="MUL",t[t.NOT_EQUAL=18]="NOT_EQUAL",t[t.POW=19]="POW",t[t.PRELU=20]="PRELU",t[t.SQUARED_DIFFERENCE=21]="SQUARED_DIFFERENCE",t[t.SUB=22]="SUB"})(rt||(rt={}));const Npe="let resultTemp = a + b;",Ipe="let resultTemp = atan2(a, b);",Tpe="let resultTemp = areal * breal - aimag * bimag;",Epe="let resultTemp = areal * bimag + aimag * breal;",Ape="let resultTemp = a / b;",Ppe="let resultTemp = select(a * (b + 1.0), a, b >= b - b);",Ope=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a == b);
`,Rpe=`
  let remainder =
      select(a % b, round(a % b), (round(a) == a) & (round(b) == b));
  let quotient = (a - remainder) / b;
  let resultTemp =
      round(select(quotient, quotient - 1, sign(remainder) == -sign(b)));
`,Dpe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a > b);
`,jpe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a >= b);
`,Mpe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a < b);
`,Fpe=`
  let zero = sign(a) * 0 + 0;
  let one = sign(b) * 0 + 1;
  let resultTemp = select(zero, one, a <= b);
`,Lpe="return f32(a >= 1.0 && b >= 1.0);",Bpe=`return (vec4<f32>(a >= vec4<f32>(1.0)) *
  vec4<f32>(b >= vec4<f32>(1.0)));`,zpe="return f32(a >= 1.0 || b >= 1.0);",Upe=`return min(vec4<f32>(a >= vec4<f32>(1.0)) +
  vec4<f32>(b >= vec4<f32>(1.0)), vec4<f32>(1.0));`,Vpe="let resultTemp = max(a, b);",Wpe="let resultTemp = min(a, b);",Gpe=`
  let isNaN = b == 0.;
  var resultTemp = a % b;
  resultTemp = select((resultTemp + b) % b, resultTemp,
      (a < 0. && b < 0.) || (a >= 0. && b > 0.));
`,Hpe=`
  let isNaN = !vec4<bool>(b);
  var resultTemp = vec4<f32>(a % b);
  if (!((a[0] < 0. && b[0] < 0.) || (a[0] >= 0. && b[0] > 0.))) {
    resultTemp[0] = (resultTemp[0] + b[0]) % b[0];
  }
  if (!((a[1] < 0. && b[1] < 0.) || (a[1] >= 0. && b[1] > 0.))) {
    resultTemp[1] = (resultTemp[1] + b[1]) % b[1];
  }
  if (!((a[2] < 0. && b[2] < 0.) || (a[2] >= 0. && b[2] > 0.))) {
    resultTemp[2] = (resultTemp[2] + b[2]) % b[2];
  }
  if (!((a[3] < 0. && b[3] < 0.) || (a[3] >= 0. && b[3] > 0.))) {
    resultTemp[3] = (resultTemp[3] + b[3]) % b[3];
  }
`,qpe="let resultTemp = a * b;",Kpe=`
  var resultTemp = f32(a != b);
  let valueForNaN = 1.0;
`,Xpe=`
  var resultTemp = vec4<f32>(a != b);
  let valueForNaN = 1.0;
`,Ype=`
  let isNaN = a < 0.0 && floor(b) < b;
  if (b == 0.0) {
    return 1.0;
  }
  var resultTemp = select(sign(a) * pow(abs(a), b), pow(abs(a), b),
      round(abs(b) % 2.0) != 1.0);
`,Qpe=`
  let isModRound1Bool = vec4<i32>(round(abs(b) % vec4<f32>(2.0))) == vec4<i32>(1);
  let isModRound1 = vec4<f32>(isModRound1Bool);
  let multiplier = sign(a) * isModRound1 + (vec4<f32>(1.0) - isModRound1);
  var resultTemp = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  let isExpZero = b == vec4<f32>(0.0);
  if (isExpZero.r) {
    resultTemp.r = 1.0;
  }
  if (isExpZero.g) {
    resultTemp.g = 1.0;
  }
  if (isExpZero.b) {
    resultTemp.b = 1.0;
  }
  if (isExpZero.a) {
    resultTemp.a = 1.0;
  }
  let isNaN = (a < vec4<f32>(0.0)) & (floor(b) < b);
`,Jpe="if (a < 0.0) { return b * a; }  return a;",Zpe=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (b * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,eme="let resultTemp = (a - b) * (a - b);",tme="let resultTemp = a - b;";function $P(t,e){let n;do{switch(t){case rt.ATAN2:n=Ipe;break;case rt.MAX:n=Vpe;break;case rt.MIN:n=Wpe;break;case rt.MOD:n=e?Hpe:Gpe;break;case rt.NOT_EQUAL:n=e?Xpe:Kpe;break;case rt.POW:n=e?Qpe:Ype;break;default:continue}let r,a,s;return e?(r="isnanVec4",a="vec4<f32>",s="vec4<bool>"):(r="isnan",a="f32",s="bool"),`
      let aIsNaN = ${r}(a);
      let aPostLegalization = select(a, ${a}(42), aIsNaN);
      let bIsNaN = ${r}(b);
      let bPostLegalization = select(b, ${a}(42), bIsNaN);
      let isNaN = false;
      let valueForNaN = uniforms.NAN;
      {
        let a = aPostLegalization;
        let b = bPostLegalization;
        ${n}
        return select(
            resultTemp, ${a}(valueForNaN),
            ${s}(isNaN) | aIsNaN | bIsNaN);
      }
    `}while(!1);switch(t){case rt.ADD:n=Npe;break;case rt.COMPLEX_MULTIPLY_IMAG:n=Epe;break;case rt.COMPLEX_MULTIPLY_REAL:n=Tpe;break;case rt.DIV:n=Ape;break;case rt.ELU_DER:n=Ppe;break;case rt.EQUAL:n=Ope;break;case rt.FLOOR_DIV:n=Rpe;break;case rt.GREATER:n=Dpe;break;case rt.GREATER_EQUAL:n=jpe;break;case rt.LESS:n=Mpe;break;case rt.LESS_EQUAL:n=Fpe;break;case rt.LOGICAL_AND:return e?Bpe:Lpe;case rt.LOGICAL_OR:return e?Upe:zpe;case rt.MUL:n=qpe;break;case rt.PRELU:return e?Zpe:Jpe;case rt.SQUARED_DIFFERENCE:n=eme;break;case rt.SUB:n=tme;break}return`
    ${n}
    return resultTemp;
  `}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ee;(function(t){t[t.ABS=0]="ABS",t[t.ACOS=1]="ACOS",t[t.ACOSH=2]="ACOSH",t[t.ASIN=3]="ASIN",t[t.ASINH=4]="ASINH",t[t.ATAN=5]="ATAN",t[t.ATANH=6]="ATANH",t[t.CEIL=7]="CEIL",t[t.COS=8]="COS",t[t.COSH=9]="COSH",t[t.ELU=10]="ELU",t[t.ERF=11]="ERF",t[t.EXP=12]="EXP",t[t.EXPM1=13]="EXPM1",t[t.FLOOR=14]="FLOOR",t[t.IS_FINITE=15]="IS_FINITE",t[t.IS_INF=16]="IS_INF",t[t.IS_NAN=17]="IS_NAN",t[t.LINEAR=18]="LINEAR",t[t.LOG=19]="LOG",t[t.LOG1P=20]="LOG1P",t[t.LOGICAL_NOT=21]="LOGICAL_NOT",t[t.NEG=22]="NEG",t[t.RELU=23]="RELU",t[t.RELU6=24]="RELU6",t[t.LEAKYRELU=25]="LEAKYRELU",t[t.RECIPROCAL=26]="RECIPROCAL",t[t.ROUND=27]="ROUND",t[t.RSQRT=28]="RSQRT",t[t.SELU=29]="SELU",t[t.SIGMOID=30]="SIGMOID",t[t.SIGN=31]="SIGN",t[t.SIN=32]="SIN",t[t.SINH=33]="SINH",t[t.SOFTPLUS=34]="SOFTPLUS",t[t.SQRT=35]="SQRT",t[t.SQUARE=36]="SQUARE",t[t.STEP=37]="STEP",t[t.TAN=38]="TAN",t[t.TANH=39]="TANH",t[t.TO_INT=40]="TO_INT"})(Ee||(Ee={}));const nme="return abs(a);",rme=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return acos(a);
`,ame=`
  if (a < 1.) {
    return uniforms.NAN;
  }
  return acosh(a);
`,sme=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  return asin(a);
`,ome="return asinh(a);",ime=`
  if (isnan(a)) {
    return uniforms.NAN;
  }
  return atan(a);
`,lme=`
  if (abs(a) > 1.) {
    return uniforms.NAN;
  }
  if (a == 1.) {
    return uniforms.INFINITY;
  }
  if (a == -1.) {
    return -uniforms.INFINITY;
  }
  return atanh(a);
`,ume="return ceil(a);",cme="return cos(a);",dme=`
  let e2x = exp(-a);
  return (e2x + 1.0 / e2x) / 2.0;
`,fme="return exp(a) - 1.0;",hme="if (a >= 0.0) { return a; }  return (exp(a) - 1.0);",pme=`
  var resFloat = exp(a) - vec4<f32>(1.0);
  if (a.r >= 0.0) {
    resFloat.r = a.r;
  }
  if (a.g >= 0.0) {
    resFloat.g = a.g;
  }
  if (a.b >= 0.0) {
    resFloat.b = a.b;
  }
  if (a.a >= 0.0) {
    resFloat.a = a.a;
  }
  return resFloat;
`,mme=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  let p = ${eP};
  let a1 = ${tP};
  let a2 = ${nP};
  let a3 = ${rP};
  let a4 = ${aP};
  let a5 = ${sP};

  let sign = sign(a);
  let absA = abs(a);
  let t = 1.0 / (1.0 + p * absA);
  return sign * (1.0 - (((((a5 * t + a4) * t) + a3) * t + a2) * t + a1) * t * exp(-absA * absA));
`,gme="return exp(a);",yme="return floor(a);",vme="return f32(!isnan(a) && !isinf(a));",xme="return f32(isinf(a));",bme="return f32(isnan(a));",wme="return a;",Sme=`if (a < 0.0) { return uniforms.NAN; }
  return log(a);`,Cme=`
  if (isnan(a)) { return a; }
  return log(1.0 + a);
`,_me="return f32(!(a >= 1.0));",$me="return -a;",kme="if (a < 0.0) { return uniforms.alpha * a; } return a;",Nme=`
  let aLessThanZero = vec4<f32>(a < vec4<f32>(0.0));
  return (aLessThanZero * (uniforms.alpha * a)) + ((vec4<f32>(1.0) - aLessThanZero) * a);
`,Ime="return 1.0 / a;",Tme="return select(a, 0.0, a < 0.0);",Eme="return clamp(a, 0.0, 6.0);",Ame="return clamp(a, vec4<f32>(0.0, 0.0, 0.0, 0.0), vec4<f32>(6.0, 6.0, 6.0, 6.0));",Pme=`
  return select(a, vec4<f32>(0.0), a < vec4<f32>(0.0));
`,Ome="return round(a);",Rme="return inverseSqrt(a);",Dme=`
  if (a >= 0.0) {
    return ${ZA} * a;
  } else {
    return ${JA} * (exp(a) - 1.0);
  }
`,jme="return 1.0 / (1.0 + exp(-1.0 * a));",Mme="return sign(a);",Fme="return sin(a);",Lme=`
  let e2x = exp(a);
  return (e2x - 1.0 / e2x) / 2.0;
`,Bme=`
  let epsilon = 1.1920928955078125e-7;
  let threshold = log(epsilon) + 2.0;

  let too_large = a > -threshold;
  let too_small = a < threshold;
  let exp_a = exp(a);

  if (too_large) {
    return a;
  } else if (too_small) {
    return exp_a;
  } else {
    return log(exp_a + 1.0);
  }
`,zme="return sqrt(a);",Ume="return a * a;",Vme=`
  if (isnan(a)) {
    return a;
  }

  return select(uniforms.stepAlpha, 1.0, a > 0.0);
`,Wme="return tan(a);",Gme=`
  let e2x = exp(-2.0 * abs(a));
  return sign(a) * (1.0 - e2x) / (1.0 + e2x);
`,Hme="return f32(i32((a)));";function Bu(t,e){switch(t){case Ee.ABS:return nme;case Ee.ACOS:return rme;case Ee.ACOSH:return ame;case Ee.ASIN:return sme;case Ee.ASINH:return ome;case Ee.ATAN:return ime;case Ee.ATANH:return lme;case Ee.COS:return cme;case Ee.COSH:return dme;case Ee.CEIL:return ume;case Ee.ELU:return e?pme:hme;case Ee.ERF:return mme;case Ee.EXP:return gme;case Ee.EXPM1:return fme;case Ee.FLOOR:return yme;case Ee.IS_FINITE:return vme;case Ee.IS_INF:return xme;case Ee.IS_NAN:return bme;case Ee.LINEAR:return wme;case Ee.LOG:return Sme;case Ee.LOG1P:return Cme;case Ee.LOGICAL_NOT:return _me;case Ee.NEG:return $me;case Ee.LEAKYRELU:return e?Nme:kme;case Ee.RECIPROCAL:return Ime;case Ee.RELU:return e?Pme:Tme;case Ee.RELU6:return e?Ame:Eme;case Ee.ROUND:return Ome;case Ee.RSQRT:return Rme;case Ee.SELU:return Dme;case Ee.SIGMOID:return jme;case Ee.SIGN:return Mme;case Ee.SIN:return Fme;case Ee.SINH:return Lme;case Ee.SOFTPLUS:return Bme;case Ee.SQRT:return zme;case Ee.SQUARE:return Ume;case Ee.STEP:return Vme;case Ee.TAN:return Wme;case Ee.TANH:return Gme;case Ee.TO_INT:return Hme;default:throw new Error(`BinaryType ${t} is not implemented!`)}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function el(t,e=!1,n=!1,r=3){if(t===null)return"";let a="";if(t==="linear")a=Bu(Ee.LINEAR);else if(t==="relu")a=Bu(Ee.RELU,n);else if(t==="elu")a=Bu(Ee.ELU,n);else if(t==="relu6")a=Bu(Ee.RELU6,n);else if(t==="prelu")a=$P(rt.PRELU,n);else if(t==="sigmoid")a=Bu(Ee.SIGMOID,n);else if(t==="leakyrelu")a=Bu(Ee.LEAKYRELU,n);else throw new Error(`Activation ${t} has not been implemented for the WebGPU backend.`);const o=yt(n?4:1);let i="";return e?i=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        let b = getPreluActivationWeightsByOutputCoords(coords);
        ${a}
      }`:i=`
      fn activation(a : ${o}, coords : vec${r}<i32>) -> ${o} {
        ${a}
      }`,i}function id(t,e){return`
      ${t?"value = value + getBiasByOutputCoords(coords);":""}
      ${e?"value = activation(value, coords);":""}
      `}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(t,e,n=!1,r=!1,a=!1,s=1){j(t&&s===1||!t,()=>`transposeA ${t} is not compatible with component size ${s}`);const o=`
      ${t?"value = getA(batch, col, row);":"value = getA(batch, row, col);"}

    `,i=e?"value = getB(batch, col, row);":"value = getB(batch, row, col);";return`
  fn mm_readA(batch: i32, row: i32, col: i32) -> ${yt(s)} {
    var value = ${yt(s)}(0.0);
    ${n&&a?o:`
    ${t?"if(row < uniforms.dimAOuter && col < uniforms.dimInner)":"if(row < uniforms.aShape[1] && col < uniforms.aShape[2])"}
    {
      ${o}
    }
    `}
    return value;
  }

  fn mm_readB(batch: i32, row: i32, col: i32) -> ${yt(s)} {
    var value = ${yt(s)}(0.0);
    ${i}
    return value;
  }
  `}function kP(t,e,n,r,a=!1,s=!1,o=!1,i=1){return`
  ${oG(n,r,a,s,o,i)}
  fn mm_write(batch: i32, row: i32, col: i32, valueIn: ${yt(i)}) {
    ${a&&s?"":"if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)"}
    {
      var value = valueIn;
      let coords = vec3<i32>(batch, row, col);
      ${id(t,e)}
      setOutputAtCoords(coords[0], coords[1], coords[2], value);
    }
  }
  `}const qme=(t,e)=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol * ${e});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRow + innerRow,
          kStart + inputCol * ${e});
        `,Kme=(t,e,n,r)=>{if(t)return`
      for (var k = 0; k < ${r}; k++) {
        let BCached0 = mm_Bsub[k][tileCol];
        let ACached0 = mm_Asub[k][localRow];
        for (var i = 0; i < ${n}; i++) {
          acc[i] = fma(BCached0, vec4<f32>(ACached0[i]), acc[i]);
        }
      }`;{let a="",s="";for(let o=0;o<e;o++)a+=`let BCached${o} = mm_Bsub[k * ${e} + ${o}][tileCol];`,s+=`acc[i] = fma(BCached${o}, vec4<f32>(ACached[${o}]), acc[i]);`;return`
      for (var k = 0; k < ${r/e}; k++) {
        ${a}
        for (var i = 0; i < ${n}; i++) {
          let ACached = mm_Asub[tileRow + i][k];
          ${s}
        }
      }`}};function C2(t,e,n=!1,r=32,a=!1,s=32,o=!1){const i=e[1]*t[1],l=e[0]*t[0],u=n?i:r,c=n?r:i,d=u/e[0],f=r/e[1],h=t[1],p=t[0];return j((n&&d===4&&t[1]===4||!n&&(d===3||d===4))&&u%e[0]===0&&r%e[1]===0&&t[0]===4,()=>`If transposeA ${n} is true, innerElementSize ${d} and workPerThread[1] ${t[1]} must be 4.
          Otherwise, innerElementSize ${d} must be 3 or 4.
      tileAWidth ${u} must be divisible by workgroupSize[0]${e[0]}. tileInner ${r} must be divisible by workgroupSize[1] ${e[1]}. colPerThread ${t[0]} must be 4.`),`
  var<workgroup> mm_Asub : array<array<vec${d}<f32>, ${u/d}>, ${c}>;
  var<workgroup> mm_Bsub : array<array<vec4<f32>, ${l/t[0]}>, ${r}>;

  ${Ae()} {
    let localRow = i32(localId.y);
    let tileRow = localRow * ${h};
    let tileCol = i32(localId.x);

    let globalRow = i32(globalId.y) * ${h};
    let globalCol = i32(globalId.x) * ${p};
    let batch = ${a?"0":"i32(globalId.z)"};
    let batchA = ${a||!o?"batch":"batch % uniforms.aShape[0]"};
    let batchB = ${a||!o?"batch":"batch % uniforms.bShape[0]"};
    let globalRowStart = i32(workgroupId.y) * ${i};

    let numTiles = ${a?`${Math.ceil(s/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
    var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};

    var acc: array<vec4<f32>, ${h}>;

    // Loop over shared dimension.
    let tileRowB = localRow * ${f};
    for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var innerRow = 0; innerRow < ${h}; innerRow++) {
            let inputRow = tileRow + innerRow;
            let inputCol = tileCol;
            ${qme(n,d)}
        }

        // Load one tile of B into local memory.
        for (var innerRow = 0; innerRow < ${f}; innerRow++) {
            let inputRow = tileRowB + innerRow;
            let inputCol = tileCol;
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB, kStart + inputRow, globalCol);
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        ${Kme(n,d,h,r)}
        workgroupBarrier();
    }

    for (var innerRow = 0; innerRow < ${h}; innerRow++) {
        mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
    }
  }`}const M3=t=>t?`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          kStart + inputRow,
          globalRowStart + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batchA,
          globalRowStart + inputRow,
          kStart + inputCol);
        `,Xme=t=>t?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];";function _2(t,e,n=!1,r=32,a=!1,s=32,o=!1,i=!1){const l=t[1]*e[1],u=t[0]*e[0],c=n?l:r,d=n?r:l;j(d%e[1]===0&&c%e[0]===0&&r%e[1]===0,()=>`tileAHight ${d} must be divisible by workgroupSize[1]${e[1]}, tileAWidth ${c} must be divisible by workgroupSize[0]${e[0]}, tileInner ${r} must be divisible by workgroupSize[1]${e[1]}`);const f=d/e[1],h=c/e[0],p=r/e[1],g=t[1],y=t[0],v=o?`
      let localRow = i32(localId.y);
      let localCol = i32(localId.x);
      let globalRowStart = i32(workgroupId.y) * ${l};
      let globalColStart = i32(workgroupId.x) * ${u};

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        for (var inputRow = localRow; inputRow < ${d}; inputRow = inputRow + ${e[1]}) {
          for (var inputCol = localCol; inputCol < ${c}; inputCol = inputCol + ${e[0]}) {
            ${M3(n)}
          }
        }
        // Load one tile of B into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${e[1]}) {
              for (var inputCol = localCol; inputCol < ${u}; inputCol = inputCol + ${e[0]}) {
            mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
              kStart + inputRow,
              globalColStart + inputCol);
          }
        }
        kStart = kStart + ${r};
        workgroupBarrier();

        // Compute acc values for a single thread.
        var BCached : array<f32, ${y}>;
        for (var k = 0; k < ${r}; k++) {
          for (var inner = 0; inner < ${y}; inner++) {
            BCached[inner] = mm_Bsub[k][localCol + inner * ${e[0]}];
          }
          for (var innerRow = 0; innerRow < ${g}; innerRow++) {
            let ACached = ${n?`mm_Asub[k][localRow + innerRow * ${e[1]}];`:`mm_Asub[localRow + innerRow * ${e[1]}][k];`}
            for (var innerCol = 0; innerCol < ${y}; innerCol++) {
              acc[innerRow][innerCol] =
                  fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
            }
          }
        }
        workgroupBarrier();
      }
      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        let gRow = globalRowStart + localRow + innerRow * ${e[1]};
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          let gCol = globalColStart + localCol + innerCol * ${e[0]};
          mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
        }
      }
      `:`
  let tileRow = i32(localId.y) * ${g};
  let tileCol = i32(localId.x) * ${y};

  let globalRow = i32(globalId.y) * ${g};
  let globalCol = i32(globalId.x) * ${y};
  let globalRowStart = i32(workgroupId.y) * ${l};

  let tileRowA = i32(localId.y) * ${f};
  let tileColA = i32(localId.x) * ${h};
  let tileRowB = i32(localId.y) * ${p};
  // Loop over shared dimension.
  for (var t = 0; t < numTiles; t++) {
    // Load one tile of A into local memory.
    for (var innerRow = 0; innerRow < ${f}; innerRow++) {
      for (var innerCol = 0; innerCol < ${h}; innerCol++) {
        let inputRow = tileRowA + innerRow;
        let inputCol = tileColA + innerCol;
        ${M3(n)}
      }
    }

    // Load one tile of B into local memory.
    for (var innerRow = 0; innerRow < ${p}; innerRow++) {
      for (var innerCol = 0; innerCol < ${y}; innerCol++) {
        let inputRow = tileRowB + innerRow;
        let inputCol = tileCol + innerCol;
        mm_Bsub[inputRow][inputCol] = mm_readB(batchB,
          kStart + inputRow,
          globalCol + innerCol);
      }
    }
    kStart = kStart + ${r};
    workgroupBarrier();

    // Compute acc values for a single thread.
    var BCached : array<f32, ${y}>;
    for (var k = 0; k < ${r}; k++) {
      for (var inner = 0; inner < ${y}; inner++) {
        BCached[inner] = mm_Bsub[k][tileCol + inner];
      }

      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        ${Xme(n)}
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] =
              fma(ACached, BCached[innerCol], acc[innerRow][innerCol]);
        }
      }
    }

    workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < ${g}; innerRow++) {
    for (var innerCol = 0; innerCol < ${y}; innerCol++) {
      mm_write(batch, globalRow + innerRow, globalCol + innerCol,
          acc[innerRow][innerCol]);
    }
  }
  `;return`
    var<workgroup> mm_Asub : array<array<f32, ${c}>, ${d}>;
    var<workgroup> mm_Bsub : array<array<f32, ${u}>, ${r}>;

    ${Ae()} {
      let batch = ${a?"0":"i32(globalId.z)"};
      let batchA = ${a||!i?"batch":"batch % uniforms.aShape[0]"};
      let batchB = ${a||!i?"batch":"batch % uniforms.bShape[0]"};
      let numTiles = ${a?`${Math.ceil(s/r)}`:`(uniforms.dimInner - 1) / ${r} + 1`};
      var kStart = ${a?`i32(globalId.z) * ${s}`:"0"};

      var acc : array<array<f32, ${y}>, ${g}>;

      // Without this initialization strange values show up in acc.
      for (var innerRow = 0; innerRow < ${g}; innerRow++) {
        for (var innerCol = 0; innerCol < ${y}; innerCol++) {
          acc[innerRow][innerCol] = 0.0;
        }
      }
      ${v}
    }
  `}const Yme=t=>t?`
      mm_readA(batchA, colA, globalRow),
      mm_readA(batchA, colA + 1, globalRow),
      mm_readA(batchA, colA + 2, globalRow),
      mm_readA(batchA, colA + 3, globalRow)
  `:`
      mm_readA(batchA, globalRow, colA),
      mm_readA(batchA, globalRow, colA + 1),
      mm_readA(batchA, globalRow, colA + 2),
      mm_readA(batchA, globalRow, colA + 3)
  `;function Qme(t,e=!1){j(t[1]===1&&t[2]===1,()=>`A linear work group size is required. But got ${t}.`);const n=t[0]*4;return`
    var<workgroup> mm_Asub : array<vec4<f32>, ${t[0]}>;

    ${Ae()} {
      let tileCol = i32(localId.x);
      let globalCol = i32(globalId.x);
      let globalRow = i32(globalId.y);

      let numTiles = (uniforms.dimInner - 1) / ${n} + 1;
      let batch = i32(globalId.z);
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      // Without this initialization strange values show up in acc.
      var acc = 0.0;

      // Loop over shared dimension.
      for (var t = 0; t < numTiles; t++) {
        // Load one tile of A into local memory.
        let colA = t * ${n} + tileCol * 4;
        mm_Asub[tileCol] = vec4<f32>(${Yme(e)});
        workgroupBarrier();

        // Compute acc values for a single thread.
        for (var k = 0; k < ${n/4}; k++) {
          let rowB = t * ${n} + k * 4;
          let BCached = vec4<f32>(mm_readB(batchB, rowB, globalCol),
                              mm_readB(batchB, rowB + 1, globalCol),
                              mm_readB(batchB, rowB + 2, globalCol),
                              mm_readB(batchB, rowB + 3, globalCol));

          let ACached = mm_Asub[k];
          acc = acc + dot(ACached, BCached);
        }

        workgroupBarrier();
      }

      mm_write(batch, globalRow, globalCol, acc);
    }
  `}let Jme=class{constructor(e,n,r=!1,a=!1,s=null,o=null,i=null,l=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=n,this.dispatchLayout={x:[2],y:[1],z:[0]};const u=r?e[1]:e[2];if(this.isVec4=(u%4===0&&!r||n[1]%4===0&&r)&&n[2]%4===0&&!a,this.outputComponent=this.isVec4?4:1,this.isVectorA=n[1]===1&&!r,!this.isVec4&&this.isVectorA)this.elementsPerThread=[1,1,1],this.workgroupSize=[32,1,1];else{const f=_pe(n[1],u,n[2],r);this.workgroupSize=f.workgroupSize,this.elementsPerThread=f.elementsPerThread}this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread);const c=s!=null,d=i!=null;c&&this.variableNames.push("bias"),d&&this.variableNames.push("preluActivationWeights"),this.sequentialAccessByThreads=l,this.transposeA=r,this.transposeB=a,this.addBias=c,this.activation=o,this.hasPreluActivationWeights=d,[this.fitAOuter,this.fitBOuter,this.fitInner]=this.getShapeFit(n[1],n[2],u),this.shaderKey=`matMulPacked_${this.elementsPerThread}_${r}_${a}_${this.activation}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.isVectorA}_${this.sequentialAccessByThreads}`}getShapeFit(e,n,r){const a=this.workgroupSize[1]*this.elementsPerThread[1],s=this.workgroupSize[0]*this.elementsPerThread[0];!this.isVec4&&this.isVectorA?this.tileInner=this.workgroupSize[0]*4:this.tileInner=s;const o=e%a===0,i=n%s===0,l=r%this.tileInner===0;return[o,i,l]}getUserCode(){return`
      ${el(this.activation,this.hasPreluActivationWeights,this.isVec4)}
      ${kP(this.addBias,this.activation,!1,this.transposeB,this.fitAOuter,this.fitBOuter,this.fitInner,this.isVec4?4:1)}
      ${this.isVec4?C2(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,!0):this.isVectorA?Qme(this.workgroupSize,this.transposeA):_2(this.elementsPerThread,this.workgroupSize,this.transposeA,this.tileInner,!1,null,this.sequentialAccessByThreads,!0)}
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zme(t){return`
    var<workgroup> sumValues : array<f32, ${t}>;
    ${Ae()} {
      let coords = getOutputCoords();
      let batch = coords[0];
      let batchA = batch % uniforms.aShape[0];
      let batchB = batch % uniforms.bShape[0];
      let row = coords[1];
      let col = coords[2];
      var sum = 0.0;
      let Length = uniforms.dimInner;
      for (var k = i32(localId.x); k < Length; k = k + ${t}) {
        let dataA = mm_readA(batchA, row, k);
        let dataB = mm_readB(batchB, k, col);
        sum = sum + dataA * dataB;
      }
      sumValues[localId.x] = sum;
      workgroupBarrier();

      for(var currentSize = ${t/2}u; currentSize > 1u;
          currentSize = currentSize / 2u) {
        if (localId.x < currentSize)
        {
          sumValues[localId.x] = sumValues[localId.x] + sumValues[localId.x + currentSize];
        }
        workgroupBarrier();
      }

      if (localId.x == 0u) {
        sum = sumValues[0] + sumValues[1];
        mm_write(batch, row, col, sum);
      }
    }
  `}class ege{constructor(e,n=!1,r=!1,a=null,s=null,o=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout={x:[],y:[1,2],z:[0]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize);const i=a!=null,l=o!=null;i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),this.transposeA=n,this.transposeB=r,this.addBias=i,this.activation=s,this.hasPreluActivationWeights=l,this.shaderKey=`matMulReduce_${this.activation}_${n}_${r}`}getUserCode(){return`
      ${el(this.activation,this.hasPreluActivationWeights)}
      ${kP(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${Zme(this.workgroupSize[0])}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tge(t){const e=t[1],n=t[0],r=e>n?e:n;return`
  var<workgroup> mm_Asub : array<array<f32, ${r}>, ${e}>;
  var<workgroup> mm_Bsub : array<array<f32, ${n}>, ${r}>;

  // If the output size is small for matrix multiplication, avoid to use vec4
  // and handle some elements per thread to optimally utilize the ALU.
  // Read data from global memory to registers firstly, then store them into
  // shared memory, so it is instruction-Level parallelism for arithmetic
  // operations and others handle IO operations between barrier api, makes ALU
  // and load/store units work simultaneously, could improves the performance.
  ${Ae()} {
    let tileRow = i32(localId.y);
    let tileCol = i32(localId.x);
    let globalRow = i32(globalId.y);
    let globalCol = i32(globalId.x);
    let batch = i32(globalId.z);
    let batchA = batch % uniforms.aShape[0];
    let batchB = batch % uniforms.bShape[0];

    // uniforms.dimInner should be greater than 0.
    let numTiles = (uniforms.dimInner - 1) / ${r} + 1;
    var acc = 0.0;

    var globalColA = tileCol;
    var globalRowB = 0;
    var regA = mm_readA(batchA, globalRow, globalColA);
    var regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
    var regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
    globalColA = globalColA + ${r};
    globalRowB = globalRowB + ${r};

    for (var t = 0; t < numTiles; t = t + 1) {
      mm_Asub[tileRow][tileCol] = regA;
      mm_Bsub[2 * tileRow][tileCol] = regB0;
      mm_Bsub[2 * tileRow + 1][tileCol] = regB1;

      workgroupBarrier();

      regA = mm_readA(batchA, globalRow, globalColA);
      regB0 = mm_readB(batchB, globalRowB + 2 * tileRow, globalCol);
      regB1 = mm_readB(batchB, globalRowB + 2 * tileRow + 1, globalCol);
      globalColA = globalColA + ${r};
      globalRowB = globalRowB + ${r};

      for (var k = 0; k < ${r}; k = k + 1) {
        acc = acc + mm_Asub[tileRow][k] * mm_Bsub[k][tileCol];
      }
      workgroupBarrier();
    }

    mm_write(batch, globalRow, globalCol, acc);
  }
  `}class nge{constructor(e,n,r,a=!1,s=!1,o=null,i=null,l=null){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[16,8,1],this.outputShape=r,this.dispatchLayout={x:[2],y:[1],z:[0]},this.dispatch=[Math.ceil(r[2]/this.workgroupSize[0]),Math.ceil(r[1]/this.workgroupSize[1]),r[0]];const u=o!=null;u&&this.variableNames.push("bias");const c=l!=null;c&&this.variableNames.push("preluActivationWeights"),this.transposeA=a,this.transposeB=s,this.addBias=u,this.activation=i,this.hasPreluActivationWeights=c,this.shaderKey=`matMulSmallOutputSize_${this.activation}_${a}_${s}`}getUserCode(){return`
      ${el(this.activation,this.hasPreluActivationWeights)}
      ${kP(this.addBias,this.activation,this.transposeA,this.transposeB)}
      ${tge(this.workgroupSize)}
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rge{constructor(e,n,r=!1,a=!1){this.variableNames=["A","B"],this.uniforms="dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.workgroupSize=[8,8,1],this.atomic=!0,this.splitedDimInner=128,j(e[0]===1,()=>"MatMulSplitKProgram only supports batch = 1."),this.outputShape=e,this.dispatchLayout={x:[2],y:[1],z:[0,3]};const s=(r&&this.outputShape[1]%4===0||!r&&n%4===0)&&this.outputShape[2]%4===0;this.elementsPerThread=[4,4,this.splitedDimInner],this.outputComponent=s?4:1,s||(this.outputShape[1]<16&&(this.elementsPerThread[1]=1),this.outputShape[2]<16&&(this.elementsPerThread[0]=1)),this.dispatch=Pe(this.dispatchLayout,[this.outputShape[0],this.outputShape[1],this.outputShape[2],n],this.workgroupSize,this.elementsPerThread),this.transposeA=r,this.transposeB=a,this.shaderKey=`matMulSplitK_${r}_${a}_${this.elementsPerThread}_${this.outputComponent}`}getUserCode(){const e=this.outputComponent;return`
      ${oG(!1,this.transposeB,!1,!1,!1,e)}
      fn mm_write(batch: i32, row : i32, col : i32, value : ${yt(e)}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
          let coords = vec3<i32>(batch, row, col);
          let flatIndex = getOutputIndexFromCoords(coords);
          // The problem is that we should initialize output to zero before using.
          // Otherwise, the original value will be added to the result.
          for (var i = 0; i < ${e}; i = i + 1) {
            ${hu("&result[flatIndex + i]",`${e>1?"value[i]":"value"}`,"float32")}
          }
        }
      }
      ${e===4?C2(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner):_2(this.elementsPerThread,this.workgroupSize,this.transposeA,32,!0,this.splitedDimInner)}
    `}}class age{constructor(e,n=null,r=null,a=null){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n!=null,this.hasPreluActivationWeights=a!=null,this.activation=r,this.addBias&&this.variableNames.push("bias"),this.hasPreluActivationWeights&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`biasActivation_${r}`}getUserCode(){return`
    ${el(this.activation,this.hasPreluActivationWeights)}
    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        var value = getXByOutputIndex(index);
        ${id(this.addBias,this.activation)}
        setOutputAtIndex(index, value);
      }
    }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let sge=class{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="value : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="fill"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        setOutputAtIndex(index, uniforms.value);
      }
    }
  `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:s}=n;if(s=s||lu(a),s==="string"){const o=or(s,ne(r));return o.fill(a),e.makeTensorInfo(r,s,o)}else{const o=new sge(r),i=[{type:"float32",data:[a]}];return e.runWebGPUProgram(o,[],s,i)}}const oge={kernelName:jv,backendName:"webgpu",kernelFunc:Ia};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:a}=n,s=ne(r.shape),o=wS(a,s),i=ne(o);return j(s===i,()=>`The new shape (${o}) has ${i} elements and the old shape (${r.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const ige={kernelName:px,backendName:"webgpu",kernelFunc:He};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $2({a:t,b:e,transposeA:n,transposeB:r,backend:a,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=r?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),v=ne(g),x=ne(y),w=ct(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);j(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const C=n?[v,d,h]:[v,h,d],_=r?[x,p,f]:[x,f,p],$=He({inputs:{x:t},backend:a,attrs:{shape:C}}),k=He({inputs:{x:e},backend:a,attrs:{shape:_}}),A=[$,k],P=Math.max(v,x),O=[$,k],R=[{type:"int32",data:[h]},{type:"int32",data:[p]},{type:"int32",data:[d]}];let B,F;const L=[P,h,p];let H=ee().get("WEBGPU_MATMUL_PROGRAM_TYPE");if(H<0){const V=ee().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),Q=V>0?V:a.thresholdToIncreaseWorkgroups,se=P*Math.ceil(h/32)*Math.ceil(p/32);se<=Q||h<=8&&se<=Q*2?P*h*p<=128?H=Wo.MatMulReduceProgram:P===1&&f>=2e3?H=Wo.MatMulSplitKProgram:H=Wo.MatMulSmallOutputSizeProgram:H=Wo.MatMulPackedProgram}switch(H){case Wo.MatMulReduceProgram:B=new ege(L,n,r,s,l,o);break;case Wo.MatMulSplitKProgram:{if(F=Ia({backend:a,attrs:{shape:L,value:0,dtype:t.dtype}}),B=new rge(L,f,n,r),s||l){F=a.runWebGPUProgram(B,O,t.dtype,R,F);const Q=new age(F.shape,s,l,o);let se=null;const le=[F];s&&le.push(s),o&&le.push(o),l==="leakyrelu"&&(se=[{type:"float32",data:[i]}],Q.uniforms+=" alpha : f32,");const ue=a.runWebGPUProgram(Q,le,F.dtype,se);A.push(F);const ce=He({inputs:{x:ue},backend:a,attrs:{shape:w}});A.push(ue);for(const re of A)a.disposeData(re.dataId);return ce}break}case Wo.MatMulSmallOutputSizeProgram:B=new nge(C,_,L,n,r,s,l,o);break;case Wo.MatMulPackedProgram:const V=a.adapterInfo.isIntel();B=new Jme(C,L,n,r,s,l,o,V);break;default:throw new Error(`Unsupported MatMulProgramType ${H}.`)}s&&O.push(s),o&&O.push(o),l==="leakyrelu"&&(R.push({type:"float32",data:[i]}),B.uniforms+=" alpha : f32,"),F=a.runWebGPUProgram(B,O,t.dtype,R,F);const te=He({inputs:{x:F},backend:a,attrs:{shape:w}});A.push(F);for(const V of A)a.disposeData(V.dataId);return te}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lge(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s,bias:o,preluActivationWeights:i}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return $2({a,b:s,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:i,leakyreluAlpha:d,activation:c})}const uge={kernelName:Ic,backendName:"webgpu",kernelFunc:lge};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let F3=class{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.workgroupSize=[128,1,1],this.size=!0,this.outputShape=ct(n,r),this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`binaryOpComplex_${e}`,this.op=e}getUserCode(){return`
      fn binaryOpComplex(
          areal : f32, aimag : f32, breal : f32, bimag : f32) -> f32 {
        ${$P(this.op,!1)}
      }

      ${Ae("index")} {
        if(index < uniforms.size) {
          let areal = getARealByOutputIndex(index);
          let aimag = getAImagByOutputIndex(index);
          let breal = getBRealByOutputIndex(index);
          let bimag = getBImagByOutputIndex(index);
          setOutputAtIndex(index, binaryOpComplex(areal, aimag, breal, bimag));
        }
      }
    `}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zw=class{constructor(e,n,r){if(this.size=!0,this.variableNames=["A","B"],this.outputShape=ct(n,r),this.dispatchLayout=Be(this.outputShape),this.op=e,this.useSharedMemoryWithA=n.length<=1&&r.length>1&&n[0]<128,this.useSharedMemoryWithB=r.length<=1&&n.length>1&&r[0]<128,this.useSharedMemoryWithA||this.useSharedMemoryWithB)this.outputComponent=1,this.variableComponents=[1,1],this.lastDimensionSize=this.useSharedMemoryWithB?r[0]:n[0],this.shaderKey=`binary_${e}_${this.lastDimensionSize}`,this.type="shared",this.workgroupSize=[256,1,1];else{const a=n.length>0&&n[n.length-1]%4===0,s=r.length>0&&r[r.length-1]%4===0;a&&s?(this.outputComponent=4,this.variableComponents=[4,4]):a&&(Mk(r)||r[r.length-1]===1)||s&&(Mk(n)||n[n.length-1]===1)?(this.outputComponent=4,this.variableComponents=a?[4,1]:[1,4]):(this.outputComponent=1,this.variableComponents=[1,1]),this.type="nonshared",this.shaderKey=`binary_${e}_${this.variableComponents}`,this.workgroupSize=[128,1,1]}this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.outputComponent,1,1])}getUserCode(){let e;const n=this.outputComponent===4?"vec4<f32>":"f32",r=`
    fn binaryOperation(a : ${n}, b : ${n}) -> ${n} {
      ${$P(this.op,this.outputComponent===4)}
    };
    `;if(this.type==="shared"){const a=this.lastDimensionSize>1?`coords[${this.outputShape.length-1}]`:"0",s=this.useSharedMemoryWithB?`let a = getAByOutputIndex(index);
          let b = sharedBuf[${a}];`:`let a = sharedBuf[${a}];
          let b = getBByOutputIndex(index);`;e=`
        ${r}
        var<workgroup> sharedBuf : array<f32, ${this.lastDimensionSize}>;
        ${Ae("index")} {
          // Fill in the shared memory buffer.
          let localIndex = i32(localId.x);
          if(localIndex < ${this.lastDimensionSize}) {
            sharedBuf[localIndex] = f32(${this.useSharedMemoryWithB?"B":"A"}[localIndex]);
          }
          workgroupBarrier();

          if(index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            ${s}
            setOutputAtIndex(index, binaryOperation(a, b));
          }
        }
        `}else e=`
       ${r}
       ${Ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index * ${this.outputComponent});
           let a = ${n}(getAByOutputCoords(coords));
           let b = ${n}(getBByOutputCoords(coords));
           setOutputAtIndex(index, binaryOperation(a, b));
         }
       }
       `;return e}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(t){const{inputs:e}=t,{x:n}=e;return t.backend.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const cge={kernelName:Zh,backendName:"webgpu",kernelFunc:es};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,s=n.makeTensorInfo(r.shape,"complex64"),o=n.tensorMap.get(s.dataId),i=es({inputs:{x:r},backend:n}),l=es({inputs:{x:a},backend:n});return o.complexTensorInfos={real:i,imag:l},s}const dge={kernelName:kS,backendName:"webgpu",kernelFunc:ld};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Pp=class{constructor(e,n,r=""){this.variableNames=["A"],this.size=!0;const a=128;this.workgroupSize=[a,1,1],this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.op=n,r!==""&&(this.uniforms=r),this.shaderKey=`unary_${n}`}getUserCode(){return`
      fn unaryOperation(a : f32) -> f32 {
        ${Bu(this.op,!1)}
      }
      ${Ae("index")} {
        if (index < uniforms.size) {
          let a = getAByOutputIndex(index);
          setOutputAtIndex(index, unaryOperation(a));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt({opType:t,cpuKernelImpl:e,dtype:n}){return({inputs:r,backend:a})=>{const{x:s}=r,o=a,i=n||s.dtype;if(o.shouldExecuteOnCPU([s])&&e!=null){const u=o.tensorMap.get(s.dataId),c=e(u.values,i);return o.makeTensorInfo(s.shape,i,c)}const l=new Pp(s.shape,t);return o.runWebGPUProgram(l,[s],i)}}function $r({opType:t,cpuKernelImpl:e,supportsComplex:n=!1,dtype:r}){return({inputs:a,backend:s})=>{const{a:o,b:i}=a,l=s;if(n&&o.dtype==="complex64"){const d=l.tensorMap.get(o.dataId),f=l.tensorMap.get(i.dataId);let h,p;if(t!==rt.MUL)[h,p]=[[d.complexTensorInfos.real,f.complexTensorInfos.real],[d.complexTensorInfos.imag,f.complexTensorInfos.imag]].map(y=>{const[v,x]=y,b={dataId:v.dataId,dtype:v.dtype,shape:o.shape},w={dataId:x.dataId,dtype:x.dtype,shape:i.shape},C=new zw(t,o.shape,i.shape);return l.runWebGPUProgram(C,[b,w],pa(v.dtype,x.dtype))});else{const y=new F3(rt.COMPLEX_MULTIPLY_REAL,o.shape,i.shape),v=new F3(rt.COMPLEX_MULTIPLY_IMAG,o.shape,i.shape),x=[{dataId:d.complexTensorInfos.real.dataId,dtype:d.complexTensorInfos.real.dtype,shape:o.shape},{dataId:d.complexTensorInfos.imag.dataId,dtype:d.complexTensorInfos.imag.dtype,shape:o.shape},{dataId:f.complexTensorInfos.real.dataId,dtype:f.complexTensorInfos.real.dtype,shape:i.shape},{dataId:f.complexTensorInfos.imag.dataId,dtype:f.complexTensorInfos.imag.dtype,shape:i.shape}];h=l.runWebGPUProgram(y,x,"float32"),p=l.runWebGPUProgram(v,x,"float32")}const g=ld({inputs:{real:h,imag:p},backend:l});return l.disposeData(h.dataId),l.disposeData(p.dataId),g}const u=r||pa(o.dtype,i.dtype);if((o.dtype==="string"||i.dtype==="string"||l.shouldExecuteOnCPU([o,i]))&&e!=null){const d=l.tensorMap.get(o.dataId).values,f=l.tensorMap.get(i.dataId).values,h=o.dtype==="string"?tu(d):d,p=o.dtype==="string"?tu(f):f,[g,y]=e(o.shape,i.shape,h,p,u);return l.makeTensorInfo(y,u,g)}const c=new zw(t,o.shape,i.shape);return l.runWebGPUProgram(c,[o,i],u)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fge(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t){return(e,n,r,a,s)=>{const o=ct(e,n),i=o.length,l=Dt(o),u=ne(o),c=Eo(s,u),d=e.length,f=n.length,h=Dt(e),p=Dt(n),g=Mc(e,o),y=Mc(n,o);if(g.length+y.length===0)for(let v=0;v<c.length;++v)c[v]=t(r[v%r.length],a[v%a.length]);else for(let v=0;v<c.length;++v){const x=SS(v,i,l),b=x.slice(-d);g.forEach($=>b[$]=0);const w=Pw(b,d,h),C=x.slice(-f);y.forEach($=>C[$]=0);const _=Pw(C,f,p);c[v]=t(r[w],a[_])}return[c,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hge(t,e,n,r){if(r==="int32"){const a=Int32Array.from(t);return[e,"int32",a]}if(r==="bool"){const a=Vx([0],n),[s,o]=Da((i,l)=>i!==l?1:0)(e,[],t,a,"bool");return[o,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge=Da((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mge(t,e,n,r,a){const s=ne(r),o=ai(a,n);for(let i=0;i<t.length;i++){const l=t[i];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(s>0?o[l]+=e[i]:o[l]+=1)}return o}function gge(t,e,n,r=!1){const a=t.shape[0],s=t.shape[1],o=en([a,n],e.dtype);for(let i=0;i<a;i++)for(let l=0;l<s;l++){const u=t.get(i,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,i,u):e.size>0?o.set(o.get(i,u)+e.get(i,l),i,u):o.set(o.get(i,u)+1,i,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yge=Da((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tl(t){return(e,n,r)=>{const a=or(n,e.length);for(let s=0;s<e.length;++s)a[s]=t(e[s],r);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge=tl(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(t,e,n,r){const a=or(n,ne(e));if(r&&n!=="string"){let s=0;t.forEach(o=>{const i=ne(o.shape);a.set(o.vals,s),s+=i})}else{let s=0;t.forEach(o=>{const i=n==="string"?tu(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+s;for(let d=0;d<o.shape[1];++d)a[c+d]=i[l++]}s+=o.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xge=Da((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bge=tl(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wge=tl(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sge=tl(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cge=Da((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ge(t,e,n,r,a,s,o,i,l){const u=en([r,s],n);for(let c=0;c<r;c++){const d=[];let f=0;for(let h=0;h<a;h++){const p=t[c*a+h];f+=p*o[h],d.push(p)}if(f<0||f>=l/s)throw new Error(`Invalid indices: ${d} does not index into ${i}`);for(let h=0;h<s;h++)u.values[c*s+h]=e.get(...e.indexToLoc(f*s+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t,e,n){const r=en(n,t.dtype);for(let a=0;a<r.size;++a){const o=r.indexToLoc(a).slice(),i=o[0],l=o[2],u=e.locToIndex([i,l]);o[2]=e.values[u];const c=t.locToIndex(o);0<=c&&c<t.values.length&&(r.values[a]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kge=Da((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge=Da((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige=Da((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tge=Da((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ege(t,e,n){const r=(e-t)/(n-1),a=ai(n,"float32");a[0]=t;for(let s=1;s<a.length;s++)a[s]=a[s-1]+r;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Age=tl(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pge(t,e,n,r){const a=Eo(r,ne(n));for(let s=0;s<a.length;++s){const o=s*e;let i=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>i)&&(i=u)}a[s]=i}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=Da((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rge=Da((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lG=Da((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dge(t,e,n){const r=td(-1,n);return lG([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jge=Da((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mge(t,e,n,r,a){const s=e.length,o=ne(e),i=Dt(e),l=Dt(a),u=Eo(n,ne(a));for(let c=0;c<o;++c){const d=SS(c,s,i),f=new Array(d.length);for(let p=0;p<f.length;p++)f[p]=d[r[p]];const h=Pw(f,s,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fge(t,e,n,r){const[a,s]=mr(t,r),o=pa(e,"int32"),i=ai(ne(a),o),l=ne(s);for(let u=0;u<i.length;++u){const c=u*l;let d=1;for(let f=0;f<l;++f)d*=n[c+f];i[u]=d}return{outVals:i,outShape:a,outDtype:o}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lge(t,e,n){t.forEach((r,a)=>{if(r<0||r>=n){const s=SS(a,e.length,Dt(e)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function Bge(t,e){for(let n=0;n<t.length;++n){const r=t[n],a=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function zge(t,e,n,r){const a=[];let s=0;const o=e.length-1+n.length,i=new Array(o).fill(null).map(()=>[0]);Bge(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)i[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let f=0;f<n.length;++f){const h=n[f],p=f+e.length-1;if(p>=0){const g=i[p],y=g[g.length-1]-h[c];for(let v=c;v<d;++v)i[p].push(h[v+1]+y)}c=h[c],d=h[d]}d!==c&&(a.push([c,d]),s+=d-c)}return{outSplits:i,valueSlices:a,numValues:s}}function Uge(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,a=or("int32",r);e.push(a),t[n].forEach((s,o)=>a[o]=s)}return e}function L3(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Vge(t,e,n,r,a,s){const o=L3(e,2)[1],i=L3(s,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)a[l*i+d]=t[c*o+d];++l}}function Wge(t,e,n,r,a){const s=e.slice();s[0]=a;const o=or(n,ne(s)),i=t.length,l=i===0?0:i/e[0];return Vge(t,e,r,l,o,s),[o,s]}function Gge(t,e,n,r,a,s,o,i){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Lge(s,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:f}=zge(s,o,t,u),h=Uge(c),p=Wge(n,r,a,d,f);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B3=2147483647;function Hge(t,e,n,r,a,s,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const i=e.length===0,l=a.length===0,u=o.length===0,c=[];i||c.push(e[0]),l||c.push(a[0]),u||c.push(o[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=or("int32",d+1);f[0]=0;for(let y=0;y<d;++y){const v=i?t[0]:t[y],x=l?r[0]:r[y],b=u?s[0]:s[y];if(b===0)throw new Error("Requires delta != 0");let w;if(b>0&&x<v||b<0&&x>v)w=0;else if(w=Math.ceil(Math.abs((x-v)/b)),w>B3)throw new Error(`Requires ((limit - start) / delta) <= ${B3}`);f[y+1]=f[y]+w}const h=f[d],p=or(n,h);let g=0;for(let y=0;y<d;++y){const v=f[y+1]-f[y];let x=i?t[0]:t[y];const b=u?s[0]:s[y];for(let w=0;w<v;++w)p[g++]=x,x+=b}return[f,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ds=bo;class Uw{constructor(e,n,r,a,s,o,i,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=s,this.defaultValue=o,this.defaultValueShape=i,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=q5(c),this.raggedRank=K5(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ds.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ds.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ds.VALUE_ROWIDS:return Uw.getMaxWidthValueRowID(n);case Ds.ROW_SPLITS:return Uw.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ds[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let a=0;a<n-1;++a){const s=e[a+1]-e[a];s>r&&(r=s)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,a=e[0],s=0;for(let o=1;o<n;++o){const i=e[o];i!==a&&(a=i,s=Math.max(o-r,s),r=o)}return Math.max(n-r,s)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return U3(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;X5(r,n);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=H5(this.raggedRank,a,n);o[0]<0&&(o[0]=e);for(let i=1;i<=this.raggedRank;++i)o[i]<0&&(o[i]=this.getMaxWidth(i));return o}calculateFirstParentOutputIndex(e,n,r){const a=Math.min(e,r),s=[];let o=0;for(let i=0;i<a;++i,o+=n)s.push(o);for(let i=a;i<e;++i)s.push(-1);return j(s.length===e,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(e,n,r,a){const s=e.length,o=[];for(let i=0;i<s-1;++i){const l=e[i+1]-e[i];let u=Math.min(a,l),c=n[i];c===-1&&(u=0);for(let d=0;d<u;++d)o.push(c),c+=r;for(let d=0;d<l-u;++d)o.push(-1)}if(s>0&&o.length!==e[s-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,a){const s=e.length,o=[];if(s===0)return[];let i=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<s;++c){const d=e[c];if(d===l)u>=0&&(++i,i<a?u+=r:u=-1);else{if(i=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,a){const s=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Ds.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,a);case Ds.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,a);default:throw new Error(`Unsupported partition type: ${Ds[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ds.FIRST_DIM_SIZE:return e[0];case Ds.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ds.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ds[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let l=a.length-2;l>=0;--l)a[l]=a[l+1]*r[l+1];const s=U3(r,!1),o=or(this.valuesDType,ne(s));if(a[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,a[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,a[u],r[u]);this.setOutput(this.raggedRank,l,o,s)}return[s,o]}setOutput(e,n,r,a){if(r.length===0)return;const s=this.values,o=r;let i=a.slice();i=i.slice(e+1);const l=ne(i),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;at(()=>{const g=xe(c,p);c=$f(g,i).dataSync()})}let d=0,f=0,h=0;for(let p=0;p<=u;++p){let g=p<u?n[p]:-1;if(g===h){++h;continue}if(f<h){const y=s.subarray(d*l),v=o.subarray(f*l),x=(h-f)*l;z3(v,y,x)}if(p>=u){const y=r.length;g=Math.floor(y/l)}if(g>h)if(this.defaultValue.length===1)o.subarray(h*l,g*l).fill(this.defaultValue[0]),h=g;else for(;g>h;){const y=o.slice(h*l);z3(y,c,l),++h}g<0?(d=p+1,f=h):(d=p,f=h,h=f+1)}}}function z3(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function U3(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function qge(t,e,n,r,a,s,o,i,l,u){return new Uw(t,e,n,r,a,s,o,i,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t,e,n,r){const a=t===e,s=t<e&&n<0,o=e<t&&n>1;if(a||s||o)return ai(0,r);const i=Math.abs(Math.ceil((e-t)/n)),l=ai(i,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kge=tl(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xge(t,e,n,r,a,s,o,i,l,u){const c=[r/a,a],d=t.values,f=e.values;if(r===0)return en(n,e.dtype);const h=l instanceof Ac?l:en(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let p=0;p<s;p++){const g=[];let y=0;for(let v=0;v<o;v++){const x=d[p*o+v];g.push(x),y+=x*i[v]}if(y<0||y>=r/a)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let v=0;v<a;v++)u?h.values[y*a+v]+=f[p*a+v]:h.values[y*a+v]=e.rank===0?f[0]:f[p*a+v]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yge=tl(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pN(t,e,n,r,a){const s=f2(r,e,n),o=ne(n),i=Dt(r);if(s){const d=h2(e,i);return a==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=a==="string"?tu(t):t,u=en(r,a,l),c=en(n,a);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),h=f.map((p,g)=>p+e[g]);c.set(u.get(...h),...f)}return a==="string"?CP(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qge(t,e,n,r,a,s,o){const i=e[0],l=s[0],u=new Array(l),c=new Array(i),d=e[1];if(l===0){if(i!==0)throw new Error(dP(i));const y=or(n,0),v=or(a,0);return[y,[0,d],v,u,c]}let f=!0,h=0;const p=new Array(l).fill(0);for(let y=0;y<i;++y){const v=t[y*d];if(v<0)throw new Error(fP(y,v));if(v>=l)throw new Error(hP(y,v,l));++p[v],f=f&&v>=h,h=v}let g=!0;for(let y=0;y<l;++y){const v=p[y]===0;u[y]=v,g=g&&!v,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(g&&f){const y=t,v=r;for(let x=0;x<i;++x)c[x]=x;return[y,[i,d],v,u,c]}else{const y=p[l-1],v=or(n,y*d),x=or(a,y),b=new Array(l).fill(0);for(let w=0;w<i;++w){const C=t[w*d],_=b[C],$=(C===0?0:p[C-1])+_;b[C]++;for(let k=0;k<d;++k)v[$*d+k]=t[w*d+k];x[$]=r[w],c[w]=$}for(let w=0;w<l;++w)if(b[w]===0){const _=w===0?0:p[w-1];v[_*d+0]=w;for(let $=1;$<d;++$)v[_*d+$]=0;x[_]=o}return[v,[y,d],x,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jge(t,e,n,r,a){const s=ne(r),o=e[0],i=a.length,l=[];let u=1,c=-1;for(let y=0;y<i;++y){const v=a[y];if(v===-1){if(c!==-1)throw new Error(pP(c,y));c=y,l.push(1)}else{if(v<0)throw new Error(mP(y,v));u*=v,l.push(v)}}if(c!==-1){if(u<=0)throw new Error(gP());const y=Math.trunc(s/u);if(u*y!==s)throw new Error(yP(r,l));l[c]=y}if(ne(l)!==s)throw new Error(vP(r,l));const f=r.length,h=[];if(f>0){h[f-1]=1;for(let y=f-2;y>=0;--y)h[y]=h[y+1]*r[y+1]}const p=[];if(i>0){p[i-1]=1;for(let y=i-2;y>=0;--y)p[y]=p[y+1]*l[y+1]}const g=or(n,o*i);for(let y=0;y<o;++y){let v=0;for(let x=0;x<f;++x)v+=t[y*f+x]*h[x];for(let x=0;x<i;++x)g[y*i+x]=Math.trunc(v/p[x]),v%=p[x]}return[g,[o,i],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zge(t,e,n,r,a,s=!1,o=0){const i=r.length,l=[e[0],t.length/e[0]],u=l[1],d=i>0?a[i-1]+1:0;if(d<0)throw new Error(ly());const f=e.slice();f[0]=d;const h=f.reduce((b,w)=>b*w,1),p=or(n,h);if(i===0)return d>0&&p.fill(o),[p,f];if(d<=0)throw new Error(ly());let g=0,y=1,v=0,x=a[g];for(;;){let b=0;if(y<i){if(b=a[y],x===b){++y;continue}if(x>=b)throw new Error(xP())}if(x<0||x>=d)throw new Error(bP(x,d));x>v&&p.fill(o,v*u,x*u);for(let w=g;w<y;++w){const C=r[w];if(C<0||C>=l[0])throw new Error(wP(w,r[w],l[0]));for(let _=0;_<u;_++)p[x*u+_]+=t[C*u+_]}if(s)for(let w=0;w<u;w++)p[x*u+w]/=y-g;if(g=y,++y,v=x+1,x=b,y>i)break}return v<d&&p.fill(o,v*u,d*u),[p,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye=tl(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tye=Da((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nye=tl((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:a}=e;return t.replace(new RegExp(n,r?"g":""),a)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(t,e,n,r){const a=en(t,e.dtype);for(let s=0;s<a.size;s++){const o=a.indexToLoc(s),i=new Array(o.length);for(let l=0;l<i.length;l++)i[l]=o[l]*n[l]+r[l];a.set(e.get(...i),...o)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aye{constructor(e,n,r,a,s,o){this.separator=Zo(e),this.nGramWidths=n,this.leftPad=Zo(r),this.rightPad=Zo(a),this.padWidth=s,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,a,s,o){for(let i=0;i<s;++i){const l=this.getPadWidth(o),u=Math.max(0,l-i),c=Math.max(0,l-(s-(i+1))),d=o-(u+c),f=n+(u>0?0:i-l);let h=0;h+=u*this.leftPad.length;for(let x=0;x<d;++x)h+=e[f+x].length;h+=c*this.rightPad.length;const p=u+c+d-1;h+=p*this.separator.length,r[a+i]=new Uint8Array(h);const g=r[a+i];let y=0;const v=x=>x.forEach(b=>g[y++]=b);for(let x=0;x<u;++x)v(this.leftPad),v(this.separator);for(let x=0;x<d-1;++x)v(e[f+x]),v(this.separator);if(d>0){v(e[f+d-1]);for(let x=0;x<c;++x)v(this.separator),v(this.rightPad)}else{for(let x=0;x<c-1;++x)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(e,n){const r=e.length,a=n.length;if(a>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<a;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=a-1,o=or("int32",a);if(r===0||a===0){const l=new Array(r);for(let u=0;u<=s;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=s;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const i=new Array(o[s]);for(let l=0;l<s;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(d=>{const f=n[l+1]-n[l],h=this.getNumNGrams(f,d);this.createNGrams(e,u,i,c,h,d),c+=h}),this.preserveShort&&c===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const f=d+2*this.padWidth;this.createNGrams(e,u,i,c,1,f)}}return[i,o]}}function cG(t,e,n,r,a,s,o,i){return new aye(n,r,a,s,o,i).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sye(t,e,n,r){if(!t.length)return;if(e.length===0){for(let s=0;s<t.length;++s)r.push(t.subarray(s,s+1));return}if(e.length===1){const s=e[0];let o=t.indexOf(s);for(;o!==-1;){const i=t.subarray(0,o);(!n||i.length!==0)&&r.push(i),t=t.subarray(o+1),o=t.indexOf(s)}(!n||t.length!==0)&&r.push(t);return}let a=0;for(let s=0;s<t.length+1;s++)if(s===t.length||e.indexOf(t[s])!==-1){const o=t.subarray(a,s);(!n||o.length!==0)&&r.push(o),a=s+1}}function dG(t,e,n){const r=t.length,a=[];let s=0,o=0;const i=new Array(r);for(let f=0;f<r;++f){const h=a.length;sye(t[f],e,n,a);const p=a.length-h;i[f]=p,s+=p,o=Math.max(o,p)}const l=or("int32",s*2),u=new Array(s),c=[r,o];let d=0;for(let f=0;f<r;++f)for(let h=0;h<i[f];++h)l[d*2]=f,l[d*2+1]=h,u[d]=a[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t,e){const n=or("int32",t.length);for(let r=0;r<t.length;++r)n[r]=UV(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oye=Da((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const r=en(n,t.dtype);for(let a=0;a<r.values.length;++a){const s=r.indexToLoc(a),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=s[l]%t.shape[l];const i=t.locToIndex(o);r.values[a]=t.values[i]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qm=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function hG(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,l=e-n+1,u=Math.log(i),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(i-c)/i)*Math.sign(l-i/2),f=Math.max(n,Math.floor(e-l*c/i+d)),h=Math.min(r,Math.floor(e+(i-l)*c/i+d));hG(t,e,f,h)}const a=t[e];let s=n,o=r;for(Ii(t,n,e),Qm(t[r],a)>0&&Ii(t,n,r);s<o;){for(Ii(t,s,o),s++,o--;Qm(t[s],a)<0;)s=s+1;for(;Qm(t[o],a)>0;)o=o-1}Qm(t[n],a)===0?Ii(t,n,o):(o=o+1,Ii(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function lye(t,e,n,r,a){const s=e[e.length-1],[o,i]=[t.length/s,s],l=Eo(n,o*r),u=Eo("int32",o*r);for(let d=0;d<o;d++){const f=d*i,h=t.subarray(f,f+i);let p=new Array(h.length);h.forEach((x,b)=>p[b]={value:x,index:b}),r<p.length&&(hG(p,r),p=p.slice(0,r)),a&&p.sort(Qm);const g=d*r,y=l.subarray(g,g+r),v=u.subarray(g,g+r);for(let x=0;x<r;x++)y[x]=p[x].value,v[x]=p[x].index}const c=e.slice();return c[c.length-1]=r,[en(c,n,l),en(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(t,e,n,r){const a=Yt(e,n)[0],s=[1,n[0],1];for(let p=0;p<a;p++)s[0]*=n[p];s[1]=n[a];for(let p=a+1;p<n.length;p++)s[2]*=n[p];const o=new Map,i=new Int32Array(n[a]),l=new Ac(s,r,t),u=[],c=s[0]===1&&s[2]===1;for(let p=0;p<n[a];p++){let g;if(c)g=t[p].toString();else{const v=[];for(let x=0;x<s[0];x++)for(let b=0;b<s[2];b++)v.push(l.get(x,p,b));g=v.join(",")}const y=o.get(g);if(y!=null)i[p]=y;else{const v=o.size;o.set(g,v),i[p]=v,u.push(p)}}const d=s.slice();d[1]=o.size;const f=new Ac(d,r);u.forEach((p,g)=>{for(let y=0;y<s[0];y++)for(let v=0;v<s[2];v++)f.set(l.get(y,p,v),y,g,v)});const h=n.slice();return h[a]=d[1],{outputValues:f.values,outputShape:h,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG=Object.freeze(Object.defineProperty({__proto__:null,addImpl:pge,bincountImpl:mge,bincountReduceImpl:gge,bitwiseAndImpl:yge,castImpl:hge,ceilImpl:vge,concatImpl:iG,equalImpl:xge,expImpl:bge,expm1Impl:wge,floorDivImpl:Cge,floorImpl:Sge,gatherNdImpl:_ge,gatherV2Impl:$ge,greaterEqualImpl:Nge,greaterImpl:kge,lessEqualImpl:Tge,lessImpl:Ige,linSpaceImpl:Ege,logImpl:Age,maxImpl:Pge,maximumImpl:Oge,minimumImpl:Rge,multiplyImpl:lG,negImpl:Dge,notEqualImpl:jge,prodImpl:Fge,raggedGatherImpl:Gge,raggedRangeImpl:Hge,raggedTensorToTensorImpl:qge,rangeImpl:uG,rsqrtImpl:Kge,scatterImpl:Xge,sigmoidImpl:Yge,simpleAbsImpl:fge,sliceImpl:pN,sparseFillEmptyRowsImpl:Qge,sparseReshapeImpl:Jge,sparseSegmentReductionImpl:Zge,sqrtImpl:eye,squaredDifferenceImpl:tye,staticRegexReplaceImpl:nye,stridedSliceImpl:rye,stringNGramsImpl:cG,stringSplitImpl:dG,stringToHashBucketFastImpl:fG,subImpl:oye,tileImpl:iye,topKImpl:lye,transposeImpl:Mge,uniqueImpl:pG},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:uye,castImpl:cye,ceilImpl:dye,concatImpl:fye,equalImpl:hye,expImpl:pye,expm1Impl:mye,floorImpl:gye,floorDivImpl:yye,gatherNdImpl:vye,gatherV2Impl:xye,greaterEqualImpl:bye,greaterImpl:wye,lessEqualImpl:Sye,lessImpl:Cye,logImpl:_ye,maxImpl:$ye,maximumImpl:kye,minimumImpl:Nye,multiplyImpl:Iye,negImpl:Tye,notEqualImpl:Eye,prodImpl:Aye,rangeImpl:Pye,rsqrtImpl:Oye,scatterImpl:Rye,simpleAbsImpl:Dye,sliceImpl:jye,stridedSliceImpl:Mye,stringNGramsImpl:Fye,subImpl:Lye,tileImpl:Bye,topKImpl:zye,transposeImpl:Uye,uniqueImpl:Lht}=mG;/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vye=Mt({opType:Ee.ABS,cpuKernelImpl:Dye}),Wye={kernelName:lv,backendName:"webgpu",kernelFunc:Vye};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gye=Mt({opType:Ee.ACOS}),Hye={kernelName:uv,backendName:"webgpu",kernelFunc:Gye};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qye=Mt({opType:Ee.ACOSH}),Kye={kernelName:cv,backendName:"webgpu",kernelFunc:qye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xye=$r({opType:rt.ADD,cpuKernelImpl:uye,supportsComplex:!0}),Yye={kernelName:Ah,backendName:"webgpu",kernelFunc:Xye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Qye=class{constructor(e){this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e[0],this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="addN"}getUserCode(){const e=[];this.variableNames.forEach(a=>{e.push(`let v${a} = get${a}ByOutputCoords(coords);`)});const n=this.variableNames.map(a=>`v${a}`).join(" + ");return`
      ${Ae("index")} {
        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if (flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            ${e.join(`
        `)}
            setOutputAtIndex(flatIndex, ${n});
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jye(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return es({inputs:{x:r[0]},backend:n});const a=r.map(i=>i.dtype).reduce((i,l)=>pa(i,l)),s=r.map(i=>i.shape),o=new Qye(s);return n.runWebGPUProgram(o,r,a)}const Zye={kernelName:Ph,backendName:"webgpu",kernelFunc:Jye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eve{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[16,16,1];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[n[a]];this.outputShape=r,this.dispatchLayout={x:[0],y:[1]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[1,1,1]),this.shaderKey="transposeShared"}getUserCode(){j(this.workgroupSize[0]===this.workgroupSize[1],()=>`Must be a square tile, current tile shape is ${this.workgroupSize[0]} x ${this.workgroupSize[1]}`);const e=this.workgroupSize[0];return`
      var<workgroup> tile : array<array<f32, ${this.workgroupSize[0]+1}>, ${this.workgroupSize[0]}>;
      ${Ae()} {
        var x = i32(workgroupId.x) * ${e} + i32(localId.x);
        var y = i32(workgroupId.y) * ${e} + i32(localId.y);
        let width = uniforms.outShape[0];
        let height = uniforms.outShape[1];
        if (x < width && y < height) {
          tile[localId.y][localId.x] = f32(A[y * width + x]);
        }
        workgroupBarrier();

        x = i32(workgroupId.y) * ${e} + i32(localId.x);
        y = i32(workgroupId.x) * ${e} + i32(localId.y);
        if (x < height && y < width) {
          setOutputAtIndex((y * height + x), tile[localId.x]
            [localId.y]);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tve=class{constructor(e,n){this.variableNames=["A"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[n[a]];this.outputShape=r,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.newDim=n,this.shaderKey=`transpose_${n}`}getUserCode(){const e=nr(this.outputShape.length),n=gG(this.newDim);return`
      ${Ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            setOutputAtIndex(flatIndex, A[getIndexFromCoords${this.outputShape.length}D(
              ${e}(${n}), uniforms.aShape)]);
          }
        }
      }
    `}};function gG(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=new Array(e);for(let r=0;r<t.length;r++)n[t[r]]=`coords.${Mi(r)}`;return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fi(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:s}=r,o=n,i=a.shape.length,l=new Array(i);for(let c=0;c<l.length;c++)l[c]=a.shape[s[c]];if(n.shouldExecuteOnCPU([a])){const d=o.tensorMap.get(a.dataId).values,f=Uye(d,a.shape,a.dtype,s,l);return n.makeTensorInfo(l,a.dtype,f)}if(a.shape.length===2&&Kt(s,[1,0])){const c=new eve(a.shape,s);return o.runWebGPUProgram(c,[a],a.dtype)}const u=new tve(a.shape,s);return o.runWebGPUProgram(u,[a],a.dtype)}const nve={kernelName:Wl,backendName:"webgpu",kernelFunc:fi};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rve=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="reduceSize : i32,",this.size=!0,this.inputShape=[e.batchSize,e.inSize];const[a]=mr(this.inputShape,[1]);this.outputShape=a.length===0?[1]:a,e.inSize>=32768&&r>=512?this.workgroupSize=[512,1,1]:e.inSize>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,[1,1,1]),this.reduceType=n,this.shaderKey=`reduce_${n}`}getUserCode(){let e="",n="0.0";const r=this.workgroupSize[0];this.reduceType==="min"||this.reduceType==="max"?(e=`
         if (isnan(candidate)) {
          bestValue = uniforms.NAN;
         } else if (!isnan(bestValue) && candidate ${this.reduceType==="min"?"<":">"} bestValue)
           {  bestValue = candidate; }`,n="f32(x[offset])"):this.reduceType==="sum"||this.reduceType==="mean"?e=" bestValue = bestValue + candidate; ":this.reduceType==="prod"?(e=" bestValue = bestValue * candidate; ",n="1.0"):this.reduceType==="all"?(e=" bestValue = f32(bestValue >= 1.0 && candidate >= 1.0); ",n="1.0"):this.reduceType==="any"&&(e=" bestValue = f32(bestValue >= 1.0 || candidate >= 1.0); ",n="0.0");const a=this.reduceType==="mean"?"setOutputAtIndex(outputIndex, bestValue / f32(uniforms.reduceSize));":"setOutputAtIndex(outputIndex, bestValue);";return`
       fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
       }

       ${`
         var<workgroup> xBestValues : array<f32, ${r}>;
       `}
       fn getOffset(outputIndex : i32) -> i32 {
         let outputCoords = getCoordsFromIndex(outputIndex);
         let offset = ${this.outputShape.length===1?"outputCoords":"outputCoords[0]"} * uniforms.reduceSize;
          return offset;
       }
       ${Ae("index")} {
         let outputIndex = index / ${r};
         let offset = getOffset(outputIndex);
         var bestValue = ${n};
         let Length = uniforms.reduceSize;
         let WorkPerThread = DIV_CEIL(u32(Length), ${r}u);
         for (var k = i32(localId.x); k < Length && outputIndex < uniforms.size;
             k = k + ${r}) {
           let candidate = f32(x[offset + k]);
           ${e}
         }
         xBestValues[localId.x] = bestValue;
         workgroupBarrier();

         var reduceSize = min(u32(Length), ${r}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            ${e}
            xBestValues[localId.x] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (localId.x == 0u && outputIndex < uniforms.size) {
          ${a}
        }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ave={mean:"float32",all:"bool",any:"bool"};function ud(t,e,n,r,a){const s=t.shape.length,o=[],i=Yt(e,t.shape);let l=i;const u=gr(l,s);let c=t;u!=null&&(c=fi({inputs:{x:t},attrs:{perm:u},backend:a}),l=Qn(l.length,s),o.push(c)),Yn(r,l,s);const[d,f]=mr(c.shape,l);let h=d;n&&(h=ir(d,i));let p;if((r==="max"||r==="prod")&&a.shouldExecuteOnCPU([c])){const g=a.tensorMap.get(c.dataId).values;switch(r){case"max":const y=$ye(g,ne(f),h,t.dtype);p=a.makeTensorInfo(h,t.dtype,y);break;case"prod":const{outVals:v,outShape:x,outDtype:b}=Aye(c.shape,c.dtype,g,l);p=a.makeTensorInfo(x,b,v);break;default:throw new Error(`${r} CPU implementation is not yet supported.`)}}else{const g=ne(f),v=ne(c.shape)/g,x={windowSize:g,inSize:g,batchSize:v,outSize:1},b=ave[r]||Wx(t.dtype),w=[{type:"int32",data:[g]}],C=new rve(x,r,a.device.limits.maxComputeWorkgroupSizeX),_=a.runWebGPUProgram(C,[c],b,w);o.push(_),p=He({inputs:{x:_},attrs:{shape:h},backend:a})}return o.forEach(g=>a.disposeData(g.dataId)),p}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sve(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{keepDims:s,axis:o}=r;return ud(a,o,s,"all",n)}const ove={kernelName:Oh,backendName:"webgpu",kernelFunc:sve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{keepDims:s,axis:o}=r;return ud(a,o,s,"any",n)}const lve={kernelName:Rh,backendName:"webgpu",kernelFunc:ive};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yG=class{constructor(e,n,r){this.workgroupSize=[64,1,1],this.variableNames=["x"],this.uniforms="infinityValue : f32,",this.size=!0;const a=[n];this.op=r==="min"?"<":">";const[s,o]=mr(e,a);this.outputShape=s.length===0?[1]:s,this.dispatchLayout=Be(this.outputShape),ne(o)<32?(this.type="plain",this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize)):(this.type="shared",this.dispatch=Pe(this.dispatchLayout,this.outputShape,[1,1,1])),this.inputShape=e,this.shaderKey=`argMinMax_${this.op}_${this.type}`}getUserCode(){const e=this.workgroupSize[0],n=()=>this.inputShape.length===1?"uniforms.xShape":`uniforms.xShape.${Mi(this.inputShape.length-1)}`,r=()=>{let a="";if(this.outputShape.length===1)this.inputShape.length!==1&&(a+="outputCoords,");else for(let s=0;s<this.outputShape.length;s++)a+=`outputCoords.${Mi(s)},`;return a};return this.type==="shared"?`
      fn DIV_CEIL(a : u32, b : u32) -> u32 {
        return ((a - 1u) / b + 1u);
      }

      ${`
      var<workgroup> xBestIndices : array<i32, ${e}>;
      var<workgroup> xBestValues : array<f32, ${e}>;
    `}

      ${Ae("index")} {
        let outputIndex = index / ${e};
        let reduceLength = ${n()};

        var bestIndex = i32(localId.x);
        var bestValue = uniforms.infinityValue;
        let outputCoords = getCoordsFromIndex(outputIndex);
        for (var k = i32(localId.x); k < reduceLength && outputIndex < uniforms.size;
            k = k + ${e}) {
          let candidate = getX(${r()} k);
          if (!isnan(candidate) && candidate ${this.op} bestValue) {
            bestValue = candidate;
            bestIndex = k;
          }
        }
        xBestValues[localId.x] = bestValue;
        xBestIndices[localId.x] = bestIndex;
        workgroupBarrier();

        var reduceSize = min(u32(reduceLength), ${e}u);
        for (var currentSize = reduceSize / 2u; reduceSize > 1u;
            currentSize = reduceSize / 2u) {
          let interval = DIV_CEIL(reduceSize, 2u);
          if (localId.x < currentSize) {
            let candidate = xBestValues[localId.x + interval];
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              xBestValues[localId.x] = bestValue;
              xBestIndices[localId.x] = xBestIndices[localId.x + interval];
            }
          }
          reduceSize = interval;
          workgroupBarrier();
        }

        if (localId.x == 0u && outputIndex < uniforms.size) {
          setOutputAtIndexI32(outputIndex, xBestIndices[localId.x]);
        }
      }
    `:`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let outputCoords = getCoordsFromIndex(index);
          var bestIndex = 0;
          var bestValue = getX(${r()} 0);
          let reduceLength = ${n()};
          for (var i = 1; i < reduceLength; i++) {
            let candidate = getX(${r()} i);
            if (candidate ${this.op} bestValue) {
              bestValue = candidate;
              bestIndex = i;
            }
          }
          setOutputAtIndexI32(index, bestIndex);
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uve(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s}=r;let o=Yt(s,a.shape);const i=gr(o,a.shape.length);let l=a;const u=[];i!=null&&(l=fi({inputs:{x:a},backend:n,attrs:{perm:i}}),u.push(l),o=Qn(o.length,l.shape.length)),Yn("argMax",[o[0]],l.shape.length);const c=new yG(l.shape,o[0],"max"),d=[{type:"float32",data:[Number.NEGATIVE_INFINITY]}],f=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(h=>n.disposeData(h.dataId)),f}const cve={kernelName:dv,backendName:"webgpu",kernelFunc:uve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dve(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s}=r;let o=Yt(s,a.shape);const i=gr(o,a.shape.length);let l=a;const u=[];i!=null&&(l=fi({inputs:{x:a},backend:n,attrs:{perm:i}}),u.push(l),o=Qn(o.length,l.shape.length)),Yn("argMin",[o[0]],l.shape.length);const c=new yG(l.shape,o[0],"min"),d=[{type:"float32",data:[Number.POSITIVE_INFINITY]}],f=n.runWebGPUProgram(c,[l],"int32",d);return u.forEach(h=>n.disposeData(h.dataId)),f}const fve={kernelName:fv,backendName:"webgpu",kernelFunc:dve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hve=Mt({opType:Ee.ASIN}),pve={kernelName:hv,backendName:"webgpu",kernelFunc:hve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mve=Mt({opType:Ee.ASINH}),gve={kernelName:pv,backendName:"webgpu",kernelFunc:mve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve=Mt({opType:Ee.ATAN}),vve={kernelName:mv,backendName:"webgpu",kernelFunc:yve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xve=$r({opType:rt.ATAN2}),bve={kernelName:yv,backendName:"webgpu",kernelFunc:xve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wve=Mt({opType:Ee.ATANH}),Sve={kernelName:gv,backendName:"webgpu",kernelFunc:wve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cve{constructor(e){this.variableNames=["x"],this.uniforms="strides : vec2<i32>,",this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="poolWithFilterSizeEqualsOne"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];

          let xRCCorner = coords.yz * uniforms.strides;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          let value = getX(batch, xRCorner, xCCorner, d);
          setOutputAtIndex(index, value);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let uy=class{constructor(e,n,r=!1,a=!1,s=!1){if(this.variableNames=["x"],this.uniforms="strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, convDims : vec2<i32>, filterDims : vec2<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=a,this.includeBatchIndex=s,this.shaderKey=`pool2D_${n}_${r}_${a}_${s}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue = resultValue + value; count = count + 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"((batch * uniforms.xShape[1] + xR) * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"(xR * uniforms.xShape[2] + xC) * uniforms.xShape[3] + d":"wR * uniforms.filterDims.y + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let batch = coords[0];
          let d = coords[3];
          let xRCCorner = vec2<i32>(coords.yz) * uniforms.strides - uniforms.pads;
          let xRCorner = xRCCorner.x;
          let xCCorner = xRCCorner.y;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + uniforms.dilations.x) {
            let xR = xRCorner + wR;

            if (xR < 0 || xR >= uniforms.convDims.x) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + uniforms.dilations.y) {
              let xC = xCCorner + wC;
              if (xC < 0 || xC >= uniforms.convDims.y) {
                continue;
              }

              let value = getX(batch, xR, xC, d);
              ${e}
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}},NP=class{constructor(e,n,r=!1,a=!1,s=!1){if(this.variableNames=["x"],this.uniforms="strides : vec3<i32>, pads : vec3<i32>, convDims : vec3<i32>, filterDims : vec3<i32>,",this.workgroupSize=[128,1,1],this.size=!0,n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.poolType=n,this.computePositions=r,this.flattenPositions=a,this.includeBatchIndex=s,this.shaderKey=`pool3D_${n}_${r}_${a}_${s}`}getUserCode(){let e;this.poolType==="avg"?e="resultValue += value; count += 1.0;":this.computePositions?e=`let currMaxValue = mix(value, maxValue, maxValueFound);
      if (value >= currMaxValue) {
        maxValue = value;
        maxValueFound = 1.0;
        maxPosition = ${this.flattenPositions?this.includeBatchIndex?"(((batch * uniforms.xShape.y + xD) * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"((xD * uniforms.xShape.z + xR) * uniforms.xShape.w + xC) * uniforms.xShape.u + ch":"wD * uniforms.filterDims.y * uniforms.filterDims.y + wR * uniforms.filterDims.z + wC"};
      }`:e="resultValue = max(value, resultValue);";let n="resultValue";return this.poolType==="avg"&&(n="resultValue / max(count, 1.0)"),`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let batch = coords.x;
          let ch = coords.u;

          let xCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
          let xDCorner = xCorner.x;
          let xRCorner = xCorner.y;
          let xCCorner = xCorner.z;

          ${this.computePositions?`var maxValue = 0.0;
            var maxValueFound = 0.0;
            var maxPosition = 0;`:`var resultValue = ${this.poolType==="avg"?"0.0":"-1.0 / pow(10.0, -20.0)"};`}

          var count = 0.0;
          for (var wD = 0; wD < uniforms.filterDims.x; wD++) {
            let xD = xDCorner + wD;
            if (xD < 0 || xD >= uniforms.convDims.x) {
              continue;
            }

            for (var wR = 0; wR < uniforms.filterDims.y; wR++) {
              let xR = xRCorner + wR;
              if (xR < 0 || xR >= uniforms.convDims.y) {
                continue;
              }

              for (var wC = 0; wC < uniforms.filterDims.z; wC++) {
                let xC = xCCorner + wC;
                if (xC < 0 || xC >= uniforms.convDims.z) {
                  continue;
                }

                let value = getX(batch, xD, xR, xC, ch);
                ${e}
              }
            }
          }

          ${this.computePositions?"setOutputAtIndexI32(index, maxPosition);":`setOutputAtIndex(index, ${n});`}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:s,keepDims:o}=r;return ud(a,s,o,"max",n)}const _ve={kernelName:rp,backendName:"webgpu",kernelFunc:vG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{keepDims:s,axis:o}=r;return ud(a,o,s,"mean",n)}const $ve={kernelName:sp,backendName:"webgpu",kernelFunc:xG};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e,n,r){if(e.filterWidth===1&&e.filterHeight===1&&Kt(e.inShape,e.outShape))return es({inputs:{x:t},backend:r});if(e.filterWidth===e.inWidth&&e.filterHeight===e.inHeight&&e.batchSize===1&&e.padInfo.type==="VALID"){const o=t.shape.length,i=He({inputs:{x:t},backend:r,attrs:{shape:[t.shape[o-3]*t.shape[o-2],t.shape[o-1]]}});let l;n==="avg"?l=xG({inputs:{x:i},backend:r,attrs:{axis:0,keepDims:!1}}):(j(n==="max",()=>`Invalid pool type ${n}`),l=vG({inputs:{x:i},backend:r,attrs:{reductionIndices:0,keepDims:!1}}));const u=He({inputs:{x:l},backend:r,attrs:{shape:e.outShape}});return r.disposeData(i.dataId),r.disposeData(l.dataId),u}let a;const s=[{type:"int32",data:[e.strideHeight,e.strideWidth]}];return e.filterHeight===1&&e.filterWidth===1?a=new Cve(e):(n==="avg"?a=new uy(e,"avg"):(j(n==="max",()=>`Invalid pool type ${n}`),a=new uy(e,"max")),s.push({type:"int32",data:[e.padInfo.top,e.padInfo.left]},{type:"int32",data:[e.dilationHeight,e.dilationWidth]},{type:"int32",data:[e.inHeight,e.inWidth]},{type:"int32",data:[e.effectiveFilterHeight,e.effectiveFilterWidth]})),r.runWebGPUProgram(a,[t],t.dtype,s)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kve(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:l}=r,c=Yr(a.shape,s,o,1,i,l);return bG(a,c,"avg",n)}const Nve={kernelName:Dh,backendName:"webgpu",kernelFunc:kve};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=$s(a.shape,s,o,c,i,u,l),f=new NP(d,"avg"),h=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(f,[a],a.dtype,h)}const Tve={kernelName:vv,backendName:"webgpu",kernelFunc:Ive};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Eve=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool2DBackprop"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR = wR + uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC = wC + uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);

            dotProd = dotProd + dyValue * uniforms.avgMultiplier;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},Ave=class{constructor(e){this.variableNames=["dy"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
       outDepth : i32, outHeight : i32, outWidth : i32, avgMultiplier : f32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="avgPool3DBackprop"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              dotProd += dyValue * uniforms.avgMultiplier;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pve(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=$s(o.shape,i,l,1,u,c),f=new Ave(d),h=1/(d.filterDepth*d.filterHeight*d.filterWidth),p=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.effectiveFilterDepth-1-d.padInfo.front,d.effectiveFilterHeight-1-d.padInfo.top,d.effectiveFilterWidth-1-d.padInfo.left]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]},{type:"int32",data:[d.outDepth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"float32",data:[h]}];return n.runWebGPUProgram(f,[a],o.dtype,p)}const Ove={kernelName:_S,backendName:"webgpu",kernelFunc:Pve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s;sG([a,s],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=r,c=Yr(o.shape,i,l,1,u),d=new Eve(c),f=1/(c.filterHeight*c.filterWidth),h=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.effectiveFilterHeight-1-c.padInfo.top,c.effectiveFilterWidth-1-c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]},{type:"int32",data:[c.outHeight]},{type:"int32",data:[c.outWidth]},{type:"float32",data:[f]}];return n.runWebGPUProgram(d,[a],o.dtype,h)}const Dve={kernelName:CS,backendName:"webgpu",kernelFunc:Rve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s}=e,{transposeA:o,transposeB:i}=r;return $2({a,b:s,transposeA:o,transposeB:i,backend:n})}const Mve={kernelName:jh,backendName:"webgpu",kernelFunc:jve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Fve=class{constructor(e,n){this.variableNames=["source"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.rank=n.length,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.start=e,this.uniforms=`start : ${nr(e.length)}, `,this.shaderKey="slice"}getUserCode(){const e=nr(this.rank),n=Lve(this.rank);let r;return this.start.length===1?r=this.outputShape.map((s,o)=>"sourceLoc = uniforms.start + coords;"):r=this.outputShape.map((s,o)=>`sourceLoc.${mN[o]} = uniforms.start.${Mi(o)} + coords.${mN[o]};`),`
      ${Ae("index")} {
        if (index < uniforms.size) {
          var sourceLoc : ${e};
          let coords = getCoordsFromIndex(index);
          ${r.join(`
`)}
          setOutputAtIndex(index, getSource(${n}));
        }
      }
    `}};const mN=["x","y","z","w","u","v"];function Lve(t){if(t===1)return"sourceLoc";if(t<=6)return mN.slice(0,t).map(e=>`sourceLoc.${e}`).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:s,size:o}=r,[i,l]=p2(a,s,o);if(XA(a,i,l),n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.tensorMap.get(a.dataId),f=jye(d.values,i,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,f)}if(ne(l)===0)return n.makeTensorInfo(l,a.dtype,[]);const u=new Fve(i,l),c=[{type:"int32",data:i}];return n.runWebGPUProgram(u,[a],a.dtype,c)}const Bve={kernelName:Sx,backendName:"webgpu",kernelFunc:Op};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zve=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,crops:o}=r;j(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGPU backend not implemented yet");const i=s.reduce((x,b)=>x*b),l=ad(a.shape,s,i),u=sd(l.length,s.length),c=od(a.shape,s,i),d=x2(o,s.length),f=b2(c,o,s.length),h=[],p=He({inputs:{x:a},backend:n,attrs:{shape:l}}),g=fi({inputs:{x:p},backend:n,attrs:{perm:u}}),y=He({inputs:{x:g},backend:n,attrs:{shape:c}}),v=Op({inputs:{x:y},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(g),h.push(y),h.forEach(x=>n.disposeData(x.dataId)),v},Uve={kernelName:xv,backendName:"webgpu",kernelFunc:zve};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vve=`
  fn bincount_write(index: i32, value: f32) {
    ${hu("&result[index]","value","float32")}
  }
`,Wve=`
  fn bincount_write(index: i32, value: f32) {
    atomicStore(&result[index], bitcast<i32>(value));
  }
`;class wG{constructor(e,n,r=!1){this.outputShape=[],this.variableNames=["x"],this.uniforms="binCountSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.hasWeights=!0,this.binaryOutput=!1,this.outputShape=e,this.rank=e.length,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.binaryOutput=r,r&&(this.atomic=!1),this.hasWeights=n,this.hasWeights&&this.variableNames.push("w"),this.shaderKey=`bincount_${this.hasWeights}_${this.binaryOutput}_${this.rank}`}getUserCode(){return`
    ${this.binaryOutput?Wve:Vve}
  ${Ae("index")} {
    ${this.rank===1?`if (index < uniforms.xShape) {
      let indexVal = i32(getX(index));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(index)":"1."};
        bincount_write(indexVal, value);
      }
    }`:`let coord = getCoordsFromIndex(index);
    if (coordsInBounds2D(coord, uniforms.xShape)) {
      let indexVal = i32(getX(coord[0], coord[1]));
      if (indexVal < uniforms.binCountSize) {
        let value = ${this.binaryOutput?1:this.hasWeights?"getW(coord[0], coord[1])":"1."};
        bincount_write(coord.x * uniforms.binCountSize + indexVal, value);
      }
    }`}
  }
  `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gve(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:s}=e,{size:o}=r,i=ne(a.shape),u=ne(s.shape)>0,c=[o],d=s.dtype,f=Ia({backend:n,attrs:{shape:c,value:0,dtype:d}}),h=new wG([i],u),p=[{type:"int32",data:[o]}],g=u?[a,s]:[a];return n.runWebGPUProgram(h,g,d,p,f)}const Hve={kernelName:Mh,backendName:"webgpu",kernelFunc:Gve};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qve{constructor(e){this.outputShape=[],this.variableNames=["s0","s1"],this.uniforms="s0Size : i32, s1Size : i32, ",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="broadcastArgs"}getUserCode(){return`
  ${Ae("index")} {
    if (index < uniforms.size) {
      var s0 = 1.0;
      var s1 = 1.0;
      let indexS0 = index - uniforms.size + uniforms.s0Size;
      let indexS1 = index - uniforms.size + uniforms.s1Size;
      if (indexS0 >= 0) {
        s0 = getS0(indexS0);
      }
      if (indexS1 >= 0) {
        s1 = getS1(indexS1);
      }

      if (s0 == 1.0) {
        setOutputAtIndex(index, s1);
      } else if (s1 == 1.0) {
        setOutputAtIndex(index, s0);
      } else if (s0 != s1) {
        setOutputAtIndex(index, uniforms.NAN);
      } else {
        setOutputAtIndex(index, s0);
      }
    }
  }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kve(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e;if(n.shouldExecuteOnCPU([r,a])){const c=n.tensorMap.get(r.dataId),d=n.tensorMap.get(a.dataId),f=c.values,h=d.values,p=ct(Array.from(f),Array.from(h));return n.makeTensorInfo([p.length],"int32",Int32Array.from(p))}const s=ne(r.shape),o=ne(a.shape),i=Math.max(s,o),l=new qve(i),u=[{type:"int32",data:[s]},{type:"int32",data:[o]}];return n.runWebGPUProgram(l,[r,a],"int32",u)}const Xve={kernelName:bv,backendName:"webgpu",kernelFunc:Kve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG=$r({opType:rt.NOT_EQUAL,dtype:"bool",cpuKernelImpl:Eye}),Yve={kernelName:ox,backendName:"webgpu",kernelFunc:SG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.tensorMap.get(r.dataId);return es({inputs:{x:a.complexTensorInfos.real},backend:n})}const Qve={kernelName:BS,backendName:"webgpu",kernelFunc:Zx};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(t,e){const n=new Pp(t.shape,Ee.TO_INT),r=e.runWebGPUProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gN(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:s}=r;if(s==="complex64"){if(a.dtype==="complex64")return es({inputs:{x:a},backend:n});const o=ci(a.shape),i=gN({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=ld({inputs:{real:i,imag:o},backend:n});return o.dispose(),n.disposeData(i.dataId),l}if(a.dtype==="complex64"){const o=Zx({inputs:{input:a},backend:n}),i=gN({inputs:{x:o},backend:n,attrs:{dtype:s}});return n.disposeData(o.dataId),i}if(!kE(a.dtype,s)){const o=es({inputs:{x:a},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(n.shouldExecuteOnCPU([a])){const o=n.tensorMap.get(a.dataId).values,[i,l,u]=cye(o,a.shape,a.dtype,s);return n.makeTensorInfo(i,l,u)}if(s==="int32")return Jve(a,n);if(s==="bool"){const o=n.makeTensorInfo([],"bool",Eo("bool",1)),l=SG({inputs:{a,b:o},backend:n});return n.disposeData(o.dataId),l}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}const Zve={kernelName:Fh,backendName:"webgpu",kernelFunc:gN};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const exe=Mt({opType:Ee.CEIL,cpuKernelImpl:dye}),txe={kernelName:wv,backendName:"webgpu",kernelFunc:exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nxe{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workPerThread=4,this.workgroupSize=[64,1,1],this.outputComponent=4,this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.shaderKey="clipVec4"}getUserCode(){return`
      ${Ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          var clampedValue = clamp(
              value, vec4<f32>(uniforms.minVal), vec4<f32>(uniforms.maxVal));
          clampedValue = select(clampedValue, value, isnanVec4(value));
          setOutputAtIndex(index, clampedValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rxe=class{constructor(e){this.variableNames=["A"],this.uniforms="minVal : f32, maxVal : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="clip"}getUserCode(){return`
      ${Ae("index")} {
        if(index < uniforms.size) {
          let value = getAByOutputIndex(index);
          if (isnan(value)) {
            setOutputAtIndex(index, value);
            return;
          }
          setOutputAtIndex(index, clamp(value, uniforms.minVal, uniforms.maxVal));
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function axe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:s,clipValueMax:o}=r;let i;const l=[{type:"float32",data:[s]},{type:"float32",data:[o]}];return ne(a.shape)%4===0?i=new nxe(a.shape):i=new rxe(a.shape),n.runWebGPUProgram(i,[a],a.dtype,l)}const sxe={kernelName:Lh,backendName:"webgpu",kernelFunc:axe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oxe=class{constructor(e){this.outputShape=[],this.variableNames=["real","imag"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="complexAbs"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let re = abs(getRealByOutputIndex(index));
        let im = abs(getImagByOutputIndex(index));
        let mx = max(re, im);

        // The length function in wgsl may be not underflow-safe on some GPUs.
        // So the safe solution is to ensure underflow-safety in all cases.
        setOutputAtIndex(index, select(mx * length(vec2<f32>(1, min(re, im)/mx)), 0.0, mx == 0.0));
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V3(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function ixe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.tensorMap.get(r.dataId),s=new oxe(r.shape),o=[V3(r,a.complexTensorInfos.real),V3(r,a.complexTensorInfos.imag)];return n.runWebGPUProgram(s,o,o[0].dtype)}const lxe={kernelName:NS,backendName:"webgpu",kernelFunc:ixe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let uxe=class{constructor(e){this.uniforms="",this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=Na(e,1),this.variableNames=e.map((n,r)=>`T${r}`),this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]),this.offsetLength=e.length-1;for(let n=0;n<this.offsetLength;n++)this.uniforms+=`offset${n} : i32,`;this.shaderKey="concat"}getUserCode(){const e=[];if(this.offsetLength>0){e.push("if (yC < uniforms.offset0){ setOutputAtCoords(coords.x, coords.y, getT0(yR, yC)); }");for(let s=1;s<this.offsetLength;s++)e.push(`else if (yC < uniforms.offset${[s]}){ setOutputAtCoords(coords.x, coords.y, getT${s}(yR, yC - uniforms.offset${s-1})); }`);const r=this.offsetLength,a=this.offsetLength-1;e.push(`else { setOutputAtCoords(coords.x, coords.y, getT${r}(yR, yC - uniforms.offset${a})); }`)}else e.push("setOutputAtCoords(coords.x, coords.y, getT0(yR, yC));");return`
      ${Ae("index")} {
        for(var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let flatIndex = index * ${this.workPerThread} + i;
          if(flatIndex < uniforms.size) {
            let coords = getCoordsFromIndex(flatIndex);
            let yR = coords.x;
            let yC = coords.y;

            ${e.join(`
        `)}
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.tensorMap.get(r.dataId);return es({inputs:{x:a.complexTensorInfos.imag},backend:n})}const cxe={kernelName:MS,backendName:"webgpu",kernelFunc:k2};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jm(t,e,n){const r=t[0].dtype;if(r==="complex64"){const p=t.map(b=>Zx({inputs:{input:b},backend:n})),g=t.map(b=>k2({inputs:{input:b},backend:n})),y=Jm(p,e,n),v=Jm(g,e,n),x=ld({inputs:{real:y,imag:v},backend:n});return p.forEach(b=>n.disposeData(b.dataId)),g.forEach(b=>n.disposeData(b.dataId)),n.disposeData(y.dataId),n.disposeData(v.dataId),x}let a=n.shouldExecuteOnCPU(t);if(r==="string"&&(a=!0),a){const p=t.map(C=>{const $=[-1,ne(C.shape.slice(e))];return He({inputs:{x:C},backend:n,attrs:{shape:$}})}),g=p.map(C=>({vals:n.readSync(C.dataId),shape:C.shape})),y=Na(p.map(C=>C.shape),1),v=p[0].shape[0]===1,x=fye(g,y,r,v),b=Na(t.map(C=>C.shape),e),w=n.makeTensorInfo(b,r,x);return p.forEach(C=>n.disposeData(C.dataId)),w}const s=n.device.limits.maxStorageBuffersPerShaderStage-1;if(t.length>s){const p=[];for(let y=0;y<t.length;y+=s){const v=t.slice(y,y+s);p.push(Jm(v,e,n))}const g=Jm(p,e,n);for(const y of p)n.disposeData(y.dataId);return g}const{tensors2D:o,outShape:i}=dxe(t,e,n),l=o.map(p=>p.shape),u=new uxe(l),c=[],d=new Array(l.length-1);if(d.length>0){d[0]=l[0][1],c.push({type:"int32",data:[d[0]]});for(let p=1;p<d.length;p++)d[p]=d[p-1]+l[p][1],c.push({type:"int32",data:[d[p]]})}const f=n.runWebGPUProgram(u,o,o[0].dtype,c);o.forEach(p=>n.disposeData(p.dataId));const h=He({inputs:{x:f},backend:n,attrs:{shape:i}});return n.disposeData(f.dataId),h}function dxe(t,e,n){const r=Na(t.map(s=>s.shape),e);return{tensors2D:t.map(s=>He({inputs:{x:s},backend:n,attrs:{shape:[ne(s.shape.slice(0,e)),ne(s.shape.slice(e))]}})),outShape:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,s=Yt(a,e[0].shape)[0],o=e.map(u=>u.shape);g2(o,s);const i=Na(e.map(u=>u.shape),s);if(ne(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const l=e.filter(u=>ne(u.shape)>0);return l.length===1?es({inputs:{x:l[0]},backend:n}):Jm(l,s,n)}const fxe={kernelName:Sv,backendName:"webgpu",kernelFunc:CG};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(t,e,n,r,a=!1,s=null,o=!1,i=4,l=4,u=4){const c=A=>{switch(A){case 1:return"resData = f32(x[xIndex]);";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = vec4<f32>(x[xIndex / 4]);";default:throw new Error(`innerElementSize ${A} is not supported.`)}},d=A=>{switch(A){case 1:return"return f32(W[row * uniforms.wShape[3] + col]);";case 4:return"return vec4<f32>(W[(row * uniforms.wShape[3] + col) / 4]);";default:throw new Error(`innerElementSize ${A} is not supported.`)}},f=t?`
      let coord = vec4<i32>(batch, xRow, xCol, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, xRow, xCol);
      `,h=t?`
      let coords = vec4<i32>(
        batch,
        row / outWidth,
        row % outWidth,
        col);
      `:`
      let coords = vec4<i32>(
        batch,
        row,
        col / outWidth,
        col % outWidth);
      `,p=t?"uniforms.xShape[1]":"uniforms.xShape[2]",g=t?"uniforms.xShape[2]":"uniforms.xShape[3]",y=t?"row":"col",v=t?"col":"row",x=`
      let inChannels = uniforms.wShape[2];
      let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
      let outRow = ${y} / outWidth;
      let outCol = ${y} % outWidth;

      let WRow = ${v} / (uniforms.filterDims[1] * inChannels);
      let WCol = ${v} / inChannels % uniforms.filterDims[1];
      let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * WRow - uniforms.pads[0];
      let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * WCol - uniforms.pads[1];
      let xCh = ${v} % inChannels;
      var resData = ${yt(i)}(0.0);
      // The bounds checking is always needed since we use it to pad zero for
      // the 'same' padding type.
      if (xRow >= 0 && xRow < ${p} && xCol >= 0 && xCol < ${g}) {
        ${f}
        let xIndex = getIndexFromCoords4D(coord, uniforms.xShape);
        ${c(i)}
      }
      return resData;`,b=t?e&&r?`
      ${x}`:`
      if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${x}
      }
      return ${yt(i)}(0.0);`:r&&n?`
      ${x}`:`
      if (row < uniforms.dimInner && col < uniforms.dimBOuter) {
        ${x}
      }
      return ${yt(i)}(0.0);`,w=`${d(l)}`,C=yt(u),_=yt(t?i:l),$=yt(t?l:i);return`
      ${el(s,o,u===4,4)}
      fn mm_readA(batch: i32, row : i32, col : i32) -> ${_} {
        ${t?b:w}
      }

      fn mm_readB(batch: i32, row : i32, col : i32) -> ${$} {
        ${t?w:b}
      }

      fn mm_write(batch: i32, row : i32, col : i32, valueIn : ${C}) {
        if (row < uniforms.dimAOuter && col < uniforms.dimBOuter)
        {
        var value = valueIn;
        let outWidth = ${t?"uniforms.outShape[2]":"uniforms.outShape[3]"};
        ${h}
        ${id(a,s)}
        setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }`}class pxe{constructor(e,n,r,a,s=!1,o=null,i=!1,l=!1){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=((e.inChannels%4===0||e.inChannels%3===0)&&this.isChannelsLast||e.outWidth%4===0&&!this.isChannelsLast)&&e.outChannels%4===0,this.dispatchLayout=this.isChannelsLast?{x:[3],y:[1,2],z:[0]}:{x:[2,3],y:[1],z:[0]},this.workgroupSize=nG(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=rG(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4?(this.outputComponent=4,this.isChannelsLast&&e.inChannels%4!==0?(this.innerElementSize=3,this.variableComponents=[1,4]):(this.innerElementSize=4,this.variableComponents=[4,4]),s&&(this.variableNames.push("bias"),this.variableComponents.push(4)),i&&(this.variableNames.push("preluActivationWeights"),this.variableComponents.push(4))):(this.innerElementSize=this.elementsPerThread[0],s&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights")),this.sequentialAccessByThreads=l,this.addBias=s,this.activation=o,this.hasPreluActivationWeights=i,this.tileAOuter=this.workgroupSize[1]*this.elementsPerThread[1],this.tileBOuter=this.workgroupSize[0]*this.elementsPerThread[0],this.tileInner=Math.max(this.workgroupSize[0]*this.innerElementSize,this.workgroupSize[1]),this.fitAOuter=n%this.tileAOuter===0,this.fitBOuter=r%this.tileBOuter===0,this.fitInner=a%this.tileInner===0,this.shaderKey=`conv2DMM_${this.elementsPerThread}_${this.activation}}_${this.fitAOuter}_${this.fitBOuter}_${this.fitInner}_${this.isVec4}_${this.innerElementSize}_${this.isChannelsLast}_${this.sequentialAccessByThreads}`}getUserCode(){const e=this.isVec4?C2(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner):_2(this.elementsPerThread,this.workgroupSize,!this.isChannelsLast,this.tileInner,!1,null,this.sequentialAccessByThreads),n=this.isVec4?[this.innerElementSize,4,4]:[1,1,1];return`
    ${hxe(this.isChannelsLast,this.fitAOuter,this.fitBOuter,this.fitInner,this.addBias,this.activation,this.hasPreluActivationWeights,n[0],n[1],n[2])}
    ${e}
  `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mxe{constructor(e,n=!1,r=null,a=!1){this.variableNames=["x","W"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>,",this.workgroupSize=[4,4,8],this.outputShape=e.outShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.dispatchLayout=this.isChannelsLast?{x:[2],y:[1],z:[0,3]}:{x:[3],y:[2],z:[0,1]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.addBias=n,this.activation=r,this.hasPreluActivationWeights=a,n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.shaderKey=`conv2dnaive_${this.activation}_${this.isChannelsLast}`}getUserCode(){return`
       ${el(this.activation,this.hasPreluActivationWeights,!1,4)}
       fn readInp(batch : i32, row : i32, col : i32, chan : i32) -> f32{
         let coords = vec4<i32>(batch, row, col, chan);
         if (coordsInBounds4D(coords, uniforms.xShape)) {
           return  getX(batch, row, col, chan);
         } else {
          return 0.0;
         }
       }
       fn readFilt(row : i32, col : i32, xChannel : i32, outChannel : i32) -> f32{
         let coords = vec4<i32>(row, col, xChannel, outChannel);
         if(coordsInBounds4D(coords, uniforms.wShape)) {
           return getW(row, col, xChannel, outChannel);
          } else {
            return 0.0;
          }
       }
       fn writeResult(batch : i32, row : i32, col : i32, chan : i32, valueIn : f32) {
         let coords = ${this.isChannelsLast?"vec4<i32>(batch, row, col, chan);":"vec4<i32>(batch, chan, row, col);"}
         if (coordsInBounds4D(coords, uniforms.outShape)) {
           var value = valueIn;
           ${id(this.addBias,this.activation)}
           setOutputAtCoords(coords.x, coords.y, coords.z, coords.w, value);
         }
       }
       ${Ae("index")} {
         let coords = getOutputCoords();
         let batch = coords[0];
         let outChannel = ${this.isChannelsLast?"coords[3];":"coords[1];"}
         let outRow = ${this.isChannelsLast?"coords[1];":"coords[2];"}
         let outCol = ${this.isChannelsLast?"coords[2];":"coords[3];"}
         var acc : f32 = 0.0;
         for (var row = 0; row < uniforms.filterDims[0]; row = row + 1) {
           for (var col = 0; col < uniforms.filterDims[1]; col = col + 1) {
             let xRow = outRow * uniforms.strides[0] + uniforms.dilations[0] * row - uniforms.pads[0];
             let xCol = outCol * uniforms.strides[1] + uniforms.dilations[1] * col - uniforms.pads[1];
             for (var xChannel = 0; xChannel < ${this.isChannelsLast?"uniforms.xShape[3];":"uniforms.xShape[1];"} xChannel = xChannel + 1) {
               ${this.isChannelsLast?"let v = readInp(batch, xRow, xCol, xChannel);":"let v = readInp(batch, xChannel, xRow, xCol);"}
               let f = readFilt(row, col, xChannel, outChannel);
               acc = acc + v * f;
             }
           }
         }
         writeResult(batch, outRow, outCol, outChannel, acc);
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gxe{constructor(e,n){this.variableNames=["x"],this.uniforms=`pads : vec2<i32>, strides : vec2<i32>, dilations : vec2<i32>, outWidth : i32, itemsPerBlockRow : i32,
       inChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=n,this.shaderKey=`im2col_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?"coords[1]":"coords[2]",a=this.isChannelsLast?"coords[2]":"coords[1]",s=this.isChannelsLast?"getX(batch, xRow, xCol, ch)":"getX(batch, ch, xRow, xCol)";return`
    ${Ae("index")} {
      let coords = getCoordsFromIndex(index);
      if(index < uniforms.size) {
        let batch = coords[0];
        let row = ${r};
        let col = ${a};
        let offsetY = (row / uniforms.outWidth) * uniforms.strides[0] - uniforms.pads[0];
        let xRow = offsetY + uniforms.dilations[0] * (col / uniforms.itemsPerBlockRow);
        var value = 0.0;
        if(xRow < uniforms.xShape[${e}] && xRow >= 0) {
          let offsetX = (row % uniforms.outWidth) * uniforms.strides[1] -
              uniforms.pads[1];
          let xCol = offsetX + uniforms.dilations[1] * ((col %
              uniforms.itemsPerBlockRow) / uniforms.inChannels);
          let ch = col % uniforms.inChannels;
          if(xCol < uniforms.xShape[${n}] && xCol >= 0) {
            value = ${s};
          }
        }
        setOutputAtIndex(index, value);
      }
    }
   `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vw(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function yxe({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:i=null}){const l=n.dataFormat==="channelsLast",u=!l,c=!1,d=l&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",f=[];let h,p;if(d){const v=n.inHeight*n.inWidth*n.inChannels;h=He({inputs:{x:t},backend:r,attrs:{shape:[1,n.batchSize,v]}}),p=He({inputs:{x:e},backend:r,attrs:{shape:[1,v,n.outChannels]}})}else h=He({inputs:{x:t},backend:r,attrs:{shape:l?[n.batchSize,n.inHeight*n.inWidth,n.inChannels]:[n.batchSize,n.inChannels,n.inHeight*n.inWidth]}}),p=He({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});if(f.push(h),f.push(p),s!=null){const v=Vw(s.shape,l);v!=null&&(s=He({inputs:{x:s},backend:r,attrs:{shape:v}}),f.push(s))}if(a!=null){const v=Vw(a.shape,l);v!=null&&(a=He({inputs:{x:a},backend:r,attrs:{shape:v}}),f.push(a))}const g=$2({a:l?h:p,b:l?p:h,transposeA:u,transposeB:c,backend:r,bias:a,activation:i,preluActivationWeights:s,leakyreluAlpha:o}),y=He({inputs:{x:g},backend:r,attrs:{shape:n.outShape}});f.push(g);for(const v of f)r.disposeData(v.dataId);return y}function vxe({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:i=null}){const{filterWidth:l,filterHeight:u,inChannels:c,strideWidth:d,strideHeight:f,padInfo:h,outWidth:p,outHeight:g,dilationWidth:y,dilationHeight:v,dataFormat:x}=n,b=x==="channelsLast",w=l*u*c,C=g*p,_=b?[n.batchSize,C,w]:[n.batchSize,w,C],$=new gxe(_,b),k=[{type:"int32",data:[h.top,h.left]},{type:"int32",data:[f,d]},{type:"int32",data:[v,y]},{type:"int32",data:[p]},{type:"int32",data:[c*l]},{type:"int32",data:[c]}],A=r.runWebGPUProgram($,[t],t.dtype,k),P=[];P.push(A);const O=He({inputs:{x:e},backend:r,attrs:{shape:[1,w,-1]}});if(P.push(O),s!=null){const H=Vw(s.shape,b);H!=null&&(s=He({inputs:{x:s},backend:r,attrs:{shape:H}}),P.push(s))}if(a!=null){const H=Vw(a.shape,b);H!=null&&(a=He({inputs:{x:a},backend:r,attrs:{shape:H}}),P.push(a))}const F=$2({a:b?A:O,b:b?O:A,transposeA:!b,transposeB:!1,backend:r,bias:a,activation:i,preluActivationWeights:s,leakyreluAlpha:o}),L=He({inputs:{x:F},backend:r,attrs:{shape:n.outShape}});P.push(F);for(const H of P)r.disposeData(H.dataId);return L}function _G({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:i=null}){const l=a!=null,u=s!=null,c=n.dataFormat==="channelsLast",d=c&&n.filterHeight===n.inHeight&&n.filterWidth===n.inWidth&&n.padInfo.type==="VALID",f=ee().getBool("WEBGPU_USE_NAIVE_CONV2D_DEBUG");if(!f&&(d||n.filterHeight===1&&n.filterWidth===1&&n.dilationHeight===1&&n.dilationWidth===1&&n.strideHeight===1&&n.strideWidth===1&&(n.padInfo.type==="SAME"||n.padInfo.type==="VALID")))return yxe({x:t,filter:e,convInfo:n,backend:r,bias:a,activation:i,preluActivationWeights:s,leakyreluAlpha:o});const h=ee().getNumber("WEBGPU_THRESHOLD_TO_INCREASE_WORKGROUPS_FOR_MATMUL"),p=h>-1?h:r.thresholdToIncreaseWorkgroups,g=n.batchSize*Math.ceil(n.outHeight*n.outWidth/32)*Math.ceil(n.outChannels/32);if(ee().getBool("WEBGPU_CONV_SEPARATE_IM2COL_SHADER")||g<=p)return vxe({x:t,filter:e,convInfo:n,backend:r,bias:a,preluActivationWeights:s,leakyreluAlpha:o,activation:i});let y;const v=[n.padInfo.top,n.padInfo.left],x=[{type:"int32",data:[n.filterHeight,n.filterWidth]},{type:"int32",data:[...v]},{type:"int32",data:[n.strideHeight,n.strideWidth]},{type:"int32",data:[n.dilationHeight,n.dilationWidth]}];if(f)y=new mxe(n,l,i,u);else{const _=c?n.outHeight*n.outWidth:n.outChannels,$=c?n.outChannels:n.outHeight*n.outWidth,k=n.filterHeight*n.filterWidth*n.inChannels;x.push({type:"int32",data:[_]},{type:"int32",data:[$]},{type:"int32",data:[k]});const A=r.adapterInfo.isIntel();y=new pxe(n,_,$,k,l,i,u,A)}const b=[],w=[t,e];l&&(!c&&a.shape.length===1&&(a=He({inputs:{x:a},backend:r,attrs:{shape:[a.shape[0],1,1]}}),b.push(a)),w.push(a)),u&&(!c&&s.shape.length===1&&(s=He({inputs:{x:s},backend:r,attrs:{shape:[s.shape[0],1,1]}}),b.push(s)),w.push(s)),i==="leakyrelu"&&(x.push({type:"float32",data:[o]}),y.uniforms+=" alpha : f32,");const C=r.runWebGPUProgram(y,w,t.dtype,x);for(const _ of b)r.disposeData(_.dataId);return C}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(t){const{inputs:e,attrs:n,backend:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dataFormat:l,dilations:u,dimRoundingMode:c}=n,d=ks(l),f=Rn(a.shape,s.shape,o,u,i,c,!1,d);return _G({x:a,filter:s,convInfo:f,backend:r})}const bxe={kernelName:Bh,backendName:"webgpu",kernelFunc:xxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wxe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>,",this.workgroupSize=[64,1,1],this.size=!1,this.isVec4=!1,this.workPerThread=1,this.outputShape=e.inShape,this.isChannelsLast=e.dataFormat==="channelsLast",this.isVec4=this.isChannelsLast&&e.outChannels%4===0&&e.inChannels%4===0,this.isVec4?(this.workPerThread=2,this.outputComponent=4,this.workgroupSize=[4,4,4],this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[4,this.workPerThread,1])):(this.size=!0,this.workPerThread=1,this.workgroupSize=[64,1,1],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize)),this.shaderKey=`conv2DDerInput_${this.isChannelsLast}_${this.isVec4}_${this.workPerThread}`}getUserCode(){const e=this.isChannelsLast?1:2,n=this.isChannelsLast?2:3,r=this.isChannelsLast?3:1,a=`
    ${Ae()} {
      let batch = i32(globalId.z) / uniforms.outShape[1];
      let r = i32(globalId.z) % uniforms.outShape[1];
      let c = i32(globalId.y) * ${this.workPerThread};
      let d1 = i32(globalId.x) * 4;

      let dyCorner = vec2<i32>(r, c) - uniforms.pads;

      // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
      // ? = to be determined. : = across all values in that axis.
      var dotProd: array<vec4<f32>, ${this.workPerThread}>;
      for (var i = 0; i < ${this.workPerThread}; i++) {
        dotProd[i] = vec4<f32>(0.0);
      }
      for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
        let dyR = f32(dyCorner.x + wR) / f32(uniforms.strides.x);
        let wRPerm = uniforms.filterDims.x - 1 - wR;
        if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) ||
            fract(dyR) > 0.0) {
          continue;
        }
        let idyR = i32(dyR);

        for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
          let dyC = f32(dyCorner.y + wC) / f32(uniforms.strides.y);
          let dyC2 = f32(dyCorner.y + 1 + wC) / f32(uniforms.strides.y);
          let wCPerm = uniforms.filterDims.y - 1 - wC;
          var bDyCVal = true;
          var bDyCVal2 = true;
          if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
              fract(dyC) > 0.0) {
            bDyCVal = false;
          }
          if (dyC2 < 0.0 || dyC2 >= f32(uniforms.outBackprop[2]) ||
              fract(dyC2) > 0.0) {
            bDyCVal2 = false;
          }

          let idyC = i32(dyC);
          let idyC2 = i32(dyC2);
          if (bDyCVal && bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
              xValue = getDy(batch, idyR, idyC2, d2);
              dotProd[1] = dotProd[1] + vec4<f32>(dot(xValue, wValue0),
                                                  dot(xValue, wValue1),
                                                  dot(xValue, wValue2),
                                                  dot(xValue, wValue3));
            }
          } else if (bDyCVal) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[0] = dotProd[0] + tmpval;
            }
          } else if (bDyCVal2) {
            let d2Length = uniforms.outBackprop[3];
            for (var d2 = 0; d2 < d2Length; d2 = d2 + 4) {
              let wValue0 = getW(wRPerm, wCPerm, d1, d2);
              let wValue1 = getW(wRPerm, wCPerm, d1 + 1, d2);
              let wValue2 = getW(wRPerm, wCPerm, d1 + 2, d2);
              let wValue3 = getW(wRPerm, wCPerm, d1 + 3, d2);
              var xValue =  getDy(batch, idyR, idyC2, d2);
              let tmpval = vec4<f32>(dot(xValue, wValue0),
                                     dot(xValue, wValue1),
                                     dot(xValue, wValue2),
                                     dot(xValue, wValue3));
              dotProd[1] = dotProd[1] + tmpval;
            }
          }
        }
      }

      for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
        let coords = vec4<i32>(batch, r, c + i, d1);
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], dotProd[i]);
        }
      }
    }
    `;return this.isVec4?`
    ${a}
    `:`
    ${Ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[${r}];

        let dyCorner = vec2<i32>(coords[${e}], coords[${n}]) - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims.x; wR = wR + 1) {
          let dyR = (f32(dyRCorner) + f32(wR)) / f32(uniforms.strides.x);
          let wRPerm = uniforms.filterDims.x - 1 - wR;
          if (dyR < 0.0 || dyR >= f32(uniforms.outBackprop[1]) || fract(dyR) > 0.0 ||
              wRPerm < 0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims.y; wC = wC + 1) {
            let dyC = (f32(dyCCorner) + f32(wC)) / f32(uniforms.strides.y);
            let wCPerm = uniforms.filterDims.y - 1 - wC;
            if (dyC < 0.0 || dyC >= f32(uniforms.outBackprop[2]) ||
                fract(dyC) > 0.0 || wCPerm < 0) {
              continue;
            }
            let idyC = i32(dyC);

            for (var d2 = 0; d2 < uniforms.outBackprop[3]; d2 = d2 + 1) {
              let xValue = ${this.isChannelsLast?"getDy(batch, idyR, idyC, d2)":"getDy(batch, d2, idyR, idyC)"};
              let wValue = getW(wRPerm, wCPerm, d1, d2);
              dotProd = dotProd + xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},Sxe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms="pads : vec2<i32>, strides : vec2<i32>, batchSize : i32, outHeight : i32, outWidth : i32, inHeight : i32, inWidth : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",this.shaderKey=`conv2DDerFilter_${this.isChannelsLast}`}getUserCode(){return`
    ${Ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let d2 = coords[3];

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b = b + 1) {
          for (var yR = 0; yR < uniforms.outHeight; yR = yR + 1) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];
            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC = yC + 1) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              if (${this.isChannelsLast}) {
                let dyValue = getDy(b, yR, yC, d2);
                let xValue = getX(b, xR, xC, d1);
                dotProd = dotProd + xValue * dyValue;
              } else {
                let dyValue = getDy(b, d2, yR, yC);
                let xValue = getX(b, d1, xR, xC);
                dotProd = dotProd + xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},Cxe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`pads : vec3<i32>, strides : vec3<i32>, batchSize : i32, outDepth : i32,
       outHeight : i32, outWidth : i32, inDepth : i32, inHeight : i32, inWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerFilter"}getUserCode(){return`
    ${Ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wF = coords.x;
        let wR = coords.y;
        let wC = coords.z;
        let d1 = coords.w;
        let d2 = coords.u;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yF = 0; yF < uniforms.outDepth; yF++) {
            let xF = wF + yF * uniforms.strides[0] - uniforms.pads[0];
            if (xF < 0 || xF >= uniforms.inDepth) {
              continue;
            }

            for (var yR = 0; yR < uniforms.outHeight; yR++) {
              let xR = wR + yR * uniforms.strides[1] - uniforms.pads[1];
              if (xR < 0 || xR >= uniforms.inHeight) {
                continue;
              }

              for (var yC = 0; yC < uniforms.outWidth; yC++) {
                let xC = wC + yC * uniforms.strides[2] - uniforms.pads[2];
                if (xC < 0 || xC >= uniforms.inWidth) {
                  continue;
                }

                let dyValue = getDy(b, yF, yR, yC, d2);
                let xValue = getX(b, xF, xR, xC, d1);
                dotProd += xValue * dyValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}},_xe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`filterDims : vec3<i32>, pads : vec3<i32>, strides : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32, outChannels : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3DDerInput"}getUserCode(){return`
    ${Ae("index")} {
      if(index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let d1 = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyFCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let dyF = f32(dyFCorner + wF) / f32(uniforms.strides[0]);
          if (dyF < 0.0 || dyF >= f32(uniforms.outDepth) || fract(dyF) > 0.0) {
            continue;
          }
          let idyF = i32(dyF);

          let wFPerm = uniforms.filterDims[0] - 1 - wF;

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            let wRPerm = uniforms.filterDims[1] - 1 - wR;

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let wCPerm = uniforms.filterDims[2] - 1 - wC;

              for (var d2 = 0; d2 < uniforms.outChannels; d2++) {
                let xValue = getDy(batch, idyF, idyR, idyC, d2);
                let wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=ks(l),f=Rn(a.shape,c,o,1,i,u,!1,d),h=new Sxe(f),p=[{type:"int32",data:[f.padInfo.top,f.padInfo.left]},{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.batchSize]},{type:"int32",data:[f.outHeight]},{type:"int32",data:[f.outWidth]},{type:"int32",data:[f.inHeight]},{type:"int32",data:[f.inWidth]}];return n.runWebGPUProgram(h,[a,s],a.dtype,p)}const kxe={kernelName:IS,backendName:"webgpu",kernelFunc:$xe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(t=4){const e=s=>{switch(s){case 1:return"return W[getIndexFromCoords4D(coord, uniforms.wShape)];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = W[getIndexFromCoords4D(coord, uniforms.wShape)];
            let v1 = W[getIndexFromCoords4D(coord1, uniforms.wShape)];
            let v2 = W[getIndexFromCoords4D(coord2, uniforms.wShape)];
            let v3 = W[getIndexFromCoords4D(coord3, uniforms.wShape)];
            return vec4<f32>(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${s} is not supported.`)}},r=`if (row < uniforms.dimAOuter && col < uniforms.dimInner) {
        ${`
      let outRow = row / uniforms.outShape[2];
      let outCol = row % uniforms.outShape[2];

      let WRow = col / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
      let WCol = col / uniforms.outBackprop[3] % uniforms.filterDims[1];
      let xR = f32(outRow - uniforms.pads[0] + WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(uniforms.outBackprop[1]) || fract(xR) > 0.0) {
        return ${yt(t)}(0.0);
      }
      if (xC < 0.0 || xC >= f32(uniforms.outBackprop[2]) || fract(xC) > 0.0) {
        return ${yt(t)}(0.0);
      }
      let coord = vec4<i32>(
          batch,
          i32(xR),
          i32(xC),
          col % uniforms.outBackprop[3]);
      return x[getIndexFromCoords4D(coord, uniforms.xShape)/${t}];`}
      }
      return ${yt(t)}(0.0);`;return`
  fn mm_readA(batch: i32, row : i32, col : i32) -> ${yt(t)} {
    ${r}
  }

  fn mm_readB(batch: i32, row : i32, col : i32) -> ${yt(t)} {
    let coordX = uniforms.filterDims.x - 1 -
        row / (uniforms.filterDims[1] * uniforms.outBackprop[3]);
    let coordY = uniforms.filterDims.y - 1 -
        (row / uniforms.outBackprop[3]) % uniforms.filterDims[1];
    if (row < uniforms.dimInner && col < uniforms.dimBOuter &&
        coordX >= 0 && coordY >= 0) {
      let rowInner = row % uniforms.outBackprop[3];
      let coord = vec4<i32>(coordX, coordY, col, rowInner);
      ${e(t)}
    }
    return ${yt(t)}(0.0);
  }

  fn mm_write(batch: i32, row : i32, col : i32, valueInput : ${yt(t)}) {
    if (row < uniforms.dimAOuter && col < uniforms.dimBOuter) {
      var value = valueInput;
      let outCoord = vec4<i32>(
          batch,
          row / uniforms.outShape[2],
          row % uniforms.outShape[2],
          col);
      result[getIndexFromCoords4D(outCoord, uniforms.outShape)/${t}] = value;
    }
  }`}class Ixe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims : vec2<i32>, pads : vec2<i32>, strides : vec2<i32>, outBackprop : vec4<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32,",this.outputShape=e.inShape,j(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),this.isVec4=e.inChannels%4===0&&e.outChannels%4===0,this.dispatchLayout={x:[3],y:[1,2],z:[0]},this.workgroupSize=nG(this.dispatchLayout,this.outputShape,this.isVec4),this.elementsPerThread=rG(this.dispatchLayout,this.outputShape,this.isVec4),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,this.elementsPerThread),this.isVec4&&(this.outputComponent=4,this.variableComponents=[4,1]),this.shaderKey=`conv2DDerInputMM_${this.isVec4}_${this.elementsPerThread}`}getUserCode(){const e=this.isVec4?C2(this.elementsPerThread,this.workgroupSize):_2(this.elementsPerThread,this.workgroupSize);return`
    ${Nxe(this.isVec4?4:1)}
    ${e}
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Txe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{inputShape:o,strides:i,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=ks(u),f=Rn(o,s.shape,i,1,l,c,!1,d),h=[{type:"int32",data:[f.filterHeight,f.filterWidth]},{type:"int32",data:[f.filterHeight-1-f.padInfo.top,f.filterWidth-1-f.padInfo.left]},{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.batchSize,f.outHeight,f.outWidth,f.outChannels]}];let p;if(ee().getBool("WEBGPU_USE_NAIVE_CONV2D_TRANSPOSE")||f.dataFormat!=="channelsLast")p=new wxe(f);else{p=new Ixe(f);const g=f.inHeight*f.inWidth,y=f.inChannels,v=f.filterHeight*f.filterWidth*f.outChannels;h.push({type:"uint32",data:[g]},{type:"uint32",data:[y]},{type:"uint32",data:[v]})}return n.runWebGPUProgram(p,[a,s],"float32",h)}const Exe={kernelName:zh,backendName:"webgpu",kernelFunc:Txe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Axe{constructor(e){this.variableNames=["x","W"],this.uniforms="filterDims: vec3<i32>, pads: vec3<i32>, strides: vec3<i32>, dilations: vec3<i32>,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="conv3dnaive"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords.x;
        let d2 = coords.u;

        let xFRCCorner = vec3<i32>(coords.y, coords.z, coords.w) * uniforms.strides - uniforms.pads;
        let xFCorner = xFRCCorner.x;
        let xRCorner = xFRCCorner.y;
        let xCCorner = xFRCCorner.z;

        let inputDepthNearestVec4 = (uniforms.xShape.u / 4) * 4;
        let inputDepthVec4Remainder = uniforms.xShape.u % 4;

        var dotProd = 0.0;
        for (var wF = 0; wF < uniforms.filterDims[0]; wF++) {
          let xF = xFCorner + wF * uniforms.dilations[0];
          if (xF < 0 || xF >= uniforms.xShape.y) {
            continue;
          }

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let xR = xRCorner + wR * uniforms.dilations[1];
            if (xR < 0 || xR >= uniforms.xShape.z) {
              continue;
            }

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let xC = xCCorner + wC * uniforms.dilations[2];
              if (xC < 0 || xC >= uniforms.xShape.w) {
                continue;
              }

              for (var d1 = 0; d1 < inputDepthNearestVec4; d1 += 4) {
                let xValues = vec4<f32>(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                let wValues = vec4<f32>(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (inputDepthVec4Remainder == 1) {
                dotProd += getX(batch, xF, xR, xC, inputDepthNearestVec4) *
                  getW(wF, wR, wC, inputDepthNearestVec4, d2);
              } else if (inputDepthVec4Remainder == 2) {
                let xValues = vec2<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1)
                );
                let wValues = vec2<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (inputDepthVec4Remainder == 3) {
                let xValues = vec3<f32>(
                  getX(batch, xF, xR, xC, inputDepthNearestVec4),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),
                  getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2)
                );
                let wValues = vec3<f32>(
                  getW(wF, wR, wC, inputDepthNearestVec4, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 1, d2),
                  getW(wF, wR, wC, inputDepthNearestVec4 + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }`}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r,u=Do(a.shape,s.shape,o,l,i),c=[u.padInfo.front,u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationDepth,u.dilationHeight,u.dilationWidth]}],f=new Axe(u),h=pa(a.dtype,s.dtype);return n.runWebGPUProgram(f,[a,s],h,d)}const Oxe={kernelName:Uh,backendName:"webgpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,pad:i,filterShape:l}=r,u=Do(a.shape,l,o,1,i),c=new Cxe(u),d=[{type:"int32",data:[u.padInfo.front,u.padInfo.top,u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.batchSize]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.inDepth]},{type:"int32",data:[u.inHeight]},{type:"int32",data:[u.inWidth]}];return n.runWebGPUProgram(c,[a,s],s.dtype,d)}const Dxe={kernelName:Cv,backendName:"webgpu",kernelFunc:Rxe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{strides:o,pad:i,inputShape:l}=r,u=Do(l,s.shape,o,1,i),c=new _xe(u),d=[{type:"int32",data:[u.filterDepth,u.filterHeight,u.filterWidth]},{type:"int32",data:[u.filterDepth-1-u.padInfo.front,u.filterHeight-1-u.padInfo.top,u.filterWidth-1-u.padInfo.left]},{type:"int32",data:[u.strideDepth,u.strideHeight,u.strideWidth]},{type:"int32",data:[u.outDepth]},{type:"int32",data:[u.outHeight]},{type:"int32",data:[u.outWidth]},{type:"int32",data:[u.outChannels]}];return n.runWebGPUProgram(c,[a,s],a.dtype,d)}const Mxe={kernelName:Vh,backendName:"webgpu",kernelFunc:jxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fxe=Mt({opType:Ee.COS}),Lxe={kernelName:_v,backendName:"webgpu",kernelFunc:Fxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bxe=Mt({opType:Ee.COSH}),zxe={kernelName:$v,backendName:"webgpu",kernelFunc:Bxe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Uxe=class{constructor(e,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.uniforms="extrapolationValue : f32,",this.workgroupSize=[64,1,1],this.size=!0;const[s]=n;this.outputShape=[s,r[0],r[1],e],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.methodId=a==="bilinear"?1:0,this.cropHeightBiggerThan1=this.outputShape[1]>1,this.cropWidthBiggerThan1=this.outputShape[2]>1,this.shaderKey=`cropAndResize_${this.methodId}_${this.cropHeightBiggerThan1}_${this.cropWidthBiggerThan1}`}getUserCode(){const[e,n]=["f32(uniforms.imageShape[1] - 1)","f32(uniforms.imageShape[2] - 1)"],[r,a,s]=this.cropHeightBiggerThan1?[`(${e} / f32(uniforms.outShape[1] - 1))`,"(y2-y1) * height_ratio",`y1*${e} + f32(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${e}`],[o,i,l]=this.cropWidthBiggerThan1?[`(${n} / f32(uniforms.outShape[2] - 1))`,"(x2-x1) * width_ratio",`x1*${n} + f32(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${n}`];return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let height_ratio = f32(${r});
        let width_ratio = f32(${o});
        let b = coords[0];
        let y = coords[1];
        let x = coords[2];
        let d = coords[3];
        // get box vals
        let y1 = getBoxes(b, 0);
        let x1 = getBoxes(b, 1);
        let y2 = getBoxes(b, 2);
        let x2 = getBoxes(b, 3);
        // get image in batch index
        let bInd = i32(round(getBoxInd(b)));
        if(bInd < 0 || bInd >= uniforms.outShape[0]) {
          return;
        }
        let height_scale = ${a};
        let width_scale = ${i};
        let in_y = ${s};
        if( in_y < 0.0 || in_y > ${e} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let in_x = ${l};
        if( in_x < 0.0 || in_x > ${n} ) {
          setOutputAtIndex(index, uniforms.extrapolationValue);
          return;
        }
        let sourceFracIndexCR = vec2<f32>(in_x,in_y);
        if(${this.methodId} == 1) {
          // Compute the four integer indices.
          let sourceFloorCR = vec2<i32>(sourceFracIndexCR);
          let sourceCeilCR = vec2<i32>(ceil(sourceFracIndexCR));
          let topLeft = getImage(bInd, sourceFloorCR.y, sourceFloorCR.x, d);
          let bottomLeft = getImage(bInd, sourceCeilCR.y, sourceFloorCR.x, d);
          let topRight = getImage(bInd, sourceFloorCR.y, sourceCeilCR.x, d);
          let bottomRight = getImage(bInd, sourceCeilCR.y, sourceCeilCR.x, d);
          let fracCR = sourceFracIndexCR - vec2<f32>(sourceFloorCR);
          let top = topLeft + (topRight - topLeft) * fracCR.x;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          let newValue = top + (bottom - top) * fracCR.y;
          setOutputAtIndex(index, newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          let sourceNearestCR = vec2<i32>(floor(
            sourceFracIndexCR + vec2<f32>(0.5,0.5)));
          let newValue = getImage(
            bInd, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutputAtIndex(index, newValue);
        }
      }
    }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vxe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:s,boxInd:o}=e,{cropSize:i,method:l,extrapolationValue:u}=r,c=new Uxe(a.shape[3],s.shape,i,l),d=[{type:"float32",data:[u]}];return n.runWebGPUProgram(c,[a,s,o],"float32",d)},Wxe={kernelName:Hh,backendName:"webgpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var cy;(function(t){t.Prod="*",t.Sum="+"})(cy||(cy={}));let W3=class{constructor(e,n,r,a){this.variableNames=["x"],this.uniforms="index : f32,",this.size=!0,this.workgroupSize=[128,1,1],this.outputShape=n,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.exclusive=r,this.reverse=a,this.op=e,this.shaderKey=`cum_${this.op}_${this.exclusive}_${this.reverse}`}getUserCode(){const e=this.outputShape.length,n=this.op===cy.Prod?"1.0":"0.0",r=this.exclusive?n:`getX(${G3(e,"coords",this.op)})`,a=this.outputShape[this.outputShape.length-1];let s="",o="";return this.exclusive?(s=this.reverse?`end != ${a-1}`:"end != 0",o=this.reverse?"end + 1":"end - 1"):(s=this.reverse?`end + pow2 < ${a}`:"end >= pow2",o=this.reverse?"end + pow2":"end - pow2"),`
      ${Ae("index")} {
       if (index < uniforms.size) {
         var coords = getCoordsFromIndex(index);

         let end = ${H3(e,"coords",this.op)};
         var val = ${r};
         let pow2 = i32(pow(2.0, uniforms.index));
         if (${s}) {
           let idx = ${o};
           ${H3(e,"coords",this.op)} = idx;
           val ${this.op}= getX(${G3(e,"coords",this.op)});
         }
         setOutputAtIndex(index, val);
       }
      }
    `}};function G3(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function H3(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t,e,n,r,a,s){const o=e.shape.length,i=gr([r],o);let l=e;i!=null&&(l=fi({inputs:{x:e},backend:n,attrs:{perm:i}}));const u=Qn(1,o)[0];if(u!==o-1)throw new Error(`WebGPU cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=es({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new W3(t,l.shape,!1,s),p=d,g=[{type:"float32",data:[f]}];d=n.runWebGPUProgram(h,[d],d.dtype,g),n.disposeData(p.dataId)}if(a){const f=new W3(t,l.shape,a,s),h=d,p=[{type:"float32",data:[0]}];d=n.runWebGPUProgram(f,[d],d.dtype,p),n.disposeData(h.dataId)}if(i!=null){const f=nd(i),h=fi({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeData(d.dataId),n.disposeData(l.dataId),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r;return $G(cy.Prod,a,n,s,o,i)}const Hxe={kernelName:Wh,backendName:"webgpu",kernelFunc:Gxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r;return $G(cy.Sum,a,n,s,o,i)}const Kxe={kernelName:Gh,backendName:"webgpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:s}=e,{size:o,binaryOutput:i}=r,l=a.shape.length===1,c=ne(s.shape)>0,d=s.dtype,f=l?[a.shape[0]]:[a.shape[0],a.shape[1]],h=l?[o]:[a.shape[0],o],p=Ia({backend:n,attrs:{shape:h,value:0,dtype:d}}),g=new wG(f,c,i),y=[{type:"int32",data:[o]}],v=c?[a,s]:[a];return n.runWebGPUProgram(g,v,d,y,p)}const Yxe={kernelName:kv,backendName:"webgpu",kernelFunc:Xxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Qxe=class{constructor(e,n){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.uniforms="blockSize : i32,",this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`depthToSpace_${n}`,this.dataFormat=n}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let h = ${this.getHeightCoordString()};
          let w = ${this.getWidthCoordString()};
          let d = ${this.getDepthCoordString()};

          let in_h = h / uniforms.blockSize;
          let offset_h = h % uniforms.blockSize;
          let in_w = w / uniforms.blockSize;
          let offset_w = w % uniforms.blockSize;
          let offset_d = (offset_h * uniforms.blockSize + offset_w) *
            ${this.getOutputDepthSize()};
          let in_d = d + offset_d;

          let rlt = ${this.getInputSamplingString()};
          setOutputAtIndex(index, rlt);
        }
      }`}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?"uniforms.outShape[3]":"uniforms.outShape[1]"}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:s,dataFormat:o}=r,i=a.shape[0],l=o==="NHWC"?a.shape[1]:a.shape[2],u=o==="NHWC"?a.shape[2]:a.shape[3],c=o==="NHWC"?a.shape[3]:a.shape[1],d=l*s,f=u*s,h=c/(s*s),p=o==="NHWC"?[i,d,f,h]:[i,h,d,f],g=[{type:"int32",data:[s]}],y=new Qxe(p,o);return n.runWebGPUProgram(y,[a],a.dtype,g)}const Zxe={kernelName:qh,backendName:"webgpu",kernelFunc:Jxe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ebe{constructor(e,n,r,a=!1,s=null,o=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>,",this.workgroupSize=[16,16,1],this.outputShape=e,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.addBias=a,this.activation=s,this.hasPreluActivation=o,this.filterHeight=n,this.filterWidth=r,this.shaderKey=`depthwiseNCHW_${this.activation}_${this.filterHeight}_${this.filterWidth}`}getUserCode(){const e=this.filterWidth*this.filterHeight,n=this.workgroupSize[0]*this.workgroupSize[1]*this.workgroupSize[2],r=this.workgroupSize[1]+this.filterHeight-1,a=this.workgroupSize[0]+this.filterWidth-1;return`
      ${el(this.activation,this.hasPreluActivation,!1,4)}

      var<workgroup> mm_Asub : array<array<f32, ${a}>, ${r}>;
      var<workgroup> mm_Bsub : array<array<f32, ${this.filterWidth}>, ${this.filterHeight}>;
      fn readX(batch : i32, channel : i32, row : i32, col : i32) -> f32 {
        var value = 0.0;
        if (row >=0 && row < uniforms.inDims[0] && col >=0 && col < uniforms.inDims[1])
        {
          value = getX(batch, channel, row, col);
        }
        return value;
      }

      ${Ae()} {
        let coords = getOutputCoords();
        let batch = coords[0];
        let xRCCorner = vec2<i32>(coords.zw) - uniforms.pads;
        let channelMul = uniforms.wShape[3];
        let d1 = coords[1] / channelMul;
        let q = coords[1] % channelMul;

        let inputRowStart = xRCCorner.x;
        let inputColStart = xRCCorner.y;

        let localRow = i32(localId.y);
        let localCol = i32(localId.x);

        // Load one tile of X into local memory.
        for (var inputRow = localRow; inputRow < ${r}; inputRow = inputRow + ${this.workgroupSize[1]}) {
          for (var inputCol = localCol; inputCol < ${a}; inputCol = inputCol + ${this.workgroupSize[0]}) {
            let rowOffset = inputRow - localRow;
            let colOffset = inputCol - localCol;
            mm_Asub[inputRow][inputCol] = readX(batch, d1, inputRowStart + rowOffset, inputColStart + colOffset);
          }
        }

        // Load one tile of W into local memory.
        var wIndex = i32(localIndex);
        ${e<n?`if (wIndex < ${e})`:`for(; wIndex < ${e}; wIndex = wIndex + ${n})`}

        {
          let wRow = wIndex / ${this.filterWidth};
          let wCol = wIndex % ${this.filterWidth};
          mm_Bsub[wRow][wCol] = getW(wRow, wCol, d1, q);
        }

        workgroupBarrier();

        var value = 0.0;
        for (var wR = 0; wR < ${this.filterHeight}; wR = wR + 1) {
          for (var wC = 0; wC < ${this.filterWidth}; wC = wC + 1) {
            let xVal = mm_Asub[localRow + wR][localCol + wC];
            let wVal = mm_Bsub[wR][wC];
            value = fma(xVal, wVal, value);
          }
        }
        ${id(this.addBias,this.activation)}
        if (coordsInBounds4D(coords, uniforms.outShape)) {
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kG{constructor(e,n=!1,r=null,a=!1){this.variableNames=["x","W"],this.uniforms="pads : vec2<i32>, inDims : vec2<i32>, virtualWidth : i32,",this.workgroupSize=[64,1,1],this.workPerThread=4,this.outputComponent=4,this.outputShape=e.outShape,this.virtualWidth=Math.ceil(this.outputShape[2]/this.workPerThread)*this.workPerThread;const s=[this.outputShape[0],this.outputShape[1],this.virtualWidth,this.outputShape[3]];this.dispatchLayout=Be(s),this.dispatch=Pe(this.dispatchLayout,s,this.workgroupSize,[this.outputComponent*this.workPerThread,1,1]),j(e.dataFormat==="channelsLast",()=>"TODO: NCHW is unimplemented"),n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=a,this.shaderKey=`depthwiseVec4_${r}_${this.convInfo.filterHeight}_${this.convInfo.filterWidth}_${this.convInfo.strideHeight}_${this.convInfo.strideWidth}_${this.workPerThread}`}getUserCode(){const e=(this.workPerThread-1)*this.convInfo.strideWidth+this.convInfo.filterWidth,n=this.convInfo.strideHeight,r=this.convInfo.strideWidth;return`
      ${el(this.activation,this.hasPreluActivation,!0,4)}
      fn readX(batch : i32, row : i32, col : i32, channel : i32) -> vec4<f32> {
        var value = vec4<f32>(0.0);
        if (col >=0 && col < uniforms.inDims[1]) {
          value = getX(batch, row, col, channel);
        }
        return value;
      }

      ${Ae("index")} {
        let width0 = uniforms.outShape[3] / ${this.outputComponent};
        let d1 = (index % width0) * ${this.outputComponent};
        var index1 = index / width0;
        let width1 = uniforms.virtualWidth / ${this.workPerThread};
        let c = (index1 % width1) * ${this.workPerThread};
        index1 = index1 / width1;
        let r = index1 % uniforms.outShape[1];
        let batch = index1 / uniforms.outShape[1];

        let xRCCorner = vec2<i32>(r, c) * vec2<i32>(${n}, ${r}) - uniforms.pads;

        let xRCorner = xRCCorner.x;
        let xCCorner = xRCCorner.y;
        var xVals : array<vec4<f32>, ${e}>;
        var dotProd : array<vec4<f32>, ${this.workPerThread}>;
        for (var i = 0; i < ${this.workPerThread}; i++) {
          dotProd[i] = vec4<f32>(0.0);
        }

        // Use constant instead of uniform can give better performance.
        for (var wR = 0; wR < ${this.convInfo.filterHeight}; wR = wR + 1) {
          let xR = xRCorner + wR;
          if (xR >=0 && xR < uniforms.inDims[0]) {
            for (var i = 0; i < ${e}; i++) {
              xVals[i] = readX(batch, xR, xCCorner + i, d1);
            }
            for (var wC = 0; wC < ${this.convInfo.filterWidth}; wC = wC + 1) {
              let wValue = getW(wR, wC, d1, 0);
              for (var i = 0; i < ${this.workPerThread}; i++) {
                dotProd[i] = fma(xVals[i * ${r} + wC], wValue, dotProd[i]);
              }
            }
          }
        }

        for (var i = 0; i < ${this.workPerThread}; i = i + 1) {
          let coords = vec4<i32>(batch, r, c + i, d1);
          if (coordsInBounds4D(coords, uniforms.outShape)) {
            var value = dotProd[i];
            ${id(this.addBias,this.activation)}
            setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
          }
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let NG=class{constructor(e,n=!1,r=null,a=!1){this.variableNames=["x","W"],this.uniforms=`pads : vec2<i32>, inDims : vec2<i32>, filterHeight : i32,
      filterWidth : i32, strides : vec2<i32>, dilations : vec2<i32>,`,this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.isChannelsLast=e.dataFormat==="channelsLast",n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.convInfo=e,this.addBias=n,this.activation=r,this.hasPreluActivation=a,this.shaderKey=`depthwise_${this.activation}_${this.isChannelsLast}`}getUserCode(){const e=this.isChannelsLast?"getX(batch, xR, xC, d1);":"getX(batch, d1, xR, xC);";return`
      ${el(this.activation,this.hasPreluActivation,!1,4)}

      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let batch = coords[0];
          let xRCCorner = vec2<i32>(coords.${this.isChannelsLast?"yz":"zw"}) * uniforms.strides - uniforms.pads;
          let d2 = coords[${this.isChannelsLast?3:1}];
          let channelMul = uniforms.wShape[3];
          let d1 = d2 / channelMul;
          let q = d2 % channelMul;

          let inputRowStart = xRCCorner.x;
          let inputColStart = xRCCorner.y;
          let inputRowEnd = inputRowStart + uniforms.filterHeight *
              uniforms.dilations[0];
          let inputColEnd = inputColStart + uniforms.filterWidth *
              uniforms.dilations[1];

          // Convolve x(?, ?, d1)|x(d1, ?, ?) with w(:, :, d1, q) to get
          // y(yR, yC, d2)|y(d2, yR, yC). ? = to be determined. : = across all
          // values in that axis. x(?, ?, d1) and y(yR, yC, d2) is for NHWC.
          // x(d1, ?, ?) and y(d2, yR, yC) is for NCHW.
          var value = 0.0;

          // Extract if checking out of for loop for performance.
          if (inputRowStart >= 0 && inputColStart >= 0 &&
            inputRowEnd < uniforms.inDims[0] &&
                inputColEnd < uniforms.inDims[1]) {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            } else {
              for (var wR = 0; wR < uniforms.filterHeight; wR = wR + 1) {
                let xR = inputRowStart + wR * uniforms.dilations[0];

                if (xR < 0 || xR >= uniforms.inDims[0]) {
                  continue;
                }

                for (var wC = 0; wC < uniforms.filterWidth; wC = wC + 1) {
                  let xC = inputColStart + wC * uniforms.dilations[1];

                  if (xC < 0 || xC >= uniforms.inDims[1]) {
                    continue;
                  }

                  let xVal = ${e};
                  let wVal = getW(wR, wC, d1, q);
                  value = value + xVal * wVal;
                }
              }
            }
            ${id(this.addBias,this.activation)}
          setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=ks(l);let f=u;f==null&&(f=[1,1]);const h=Rn(a.shape,s.shape,o,f,i,c,!0,d),p=[{type:"int32",data:[h.padInfo.top,h.padInfo.left]},{type:"int32",data:[h.inHeight,h.inWidth]}],g=h.dataFormat==="channelsLast";let y;return!g&&h.inHeight>16&&h.inWidth>16&&h.strideHeight===1&&h.strideWidth===1&&h.dilationWidth===1&&h.dilationHeight===1&&h.inChannels===h.outChannels?y=new ebe(h.outShape,h.filterHeight,h.filterWidth):g&&h.outHeight>4&&h.outWidth>4&&h.strideWidth<=2&&h.inChannels===h.outChannels&&h.dilationHeight===1&&h.dilationWidth===1&&h.inChannels%4===0?(y=new kG(h),p.push({type:"int32",data:[y.virtualWidth]})):(y=new NG(h),p.push({type:"int32",data:[h.filterHeight]},{type:"int32",data:[h.filterWidth]},{type:"int32",data:[h.strideHeight,h.strideWidth]},{type:"int32",data:[h.dilationHeight,h.dilationWidth]})),n.runWebGPUProgram(y,[a,s],a.dtype,p)}const nbe={kernelName:Kh,backendName:"webgpu",kernelFunc:tbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rbe=class{constructor(e){this.variableNames=["x","dy"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>, outHeight : i32,
      outWidth : i32, inHeight : i32, inWidth : i32, batchSize : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.filterShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_filter"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let wR = coords[0];
        let wC = coords[1];
        let d1 = coords[2];
        let dm = coords[3];
        let d2 = d1 * uniforms.channelMul + dm;

        var dotProd = 0.0;
        for (var b = 0; b < uniforms.batchSize; b++) {
          for (var yR = 0; yR < uniforms.outHeight; yR++) {
            let xR = wR + yR * uniforms.strides[0] - uniforms.pads[0];

            if (xR < 0 || xR >= uniforms.inHeight) {
              continue;
            }

            for (var yC = 0; yC < uniforms.outWidth; yC++) {
              let xC = wC + yC * uniforms.strides[1] - uniforms.pads[1];

              if (xC < 0 || xC >= uniforms.inWidth) {
                continue;
              }

              let dyValue = getDy(b, yR, yC, d2);
              let xValue = getX(b, xR, xC, d1);
              dotProd += xValue * dyValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},abe=class{constructor(e){this.variableNames=["dy","W"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32, channelMul : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="depthwise_conv2d_backprop_input"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d1 = coords[3];
        let dyCorner = coords.yz - uniforms.pads;
        let dyRCorner = dyCorner.x;
        let dyCCorner = dyCorner.y;

        var dotProd = 0.0;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }

          let idyR = i32(dyR);
          let wRPerm = uniforms.filterDims[0] - 1 - wR;

          for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }

            let idyC = i32(dyC);
            let wCPerm = uniforms.filterDims[1] - 1 - wC;

            for (var dm = 0; dm < uniforms.channelMul; dm++) {
              let d2 = d1 * uniforms.channelMul + dm;
              let xValue = getDy(batch, idyR, idyC, d2);
              let wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,dilations:i,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Rn(a.shape,c,o,i,l,u,!0),f=new rbe(d),h=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.inHeight]},{type:"int32",data:[d.inWidth]},{type:"int32",data:[d.batchSize]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(f,[a,s],"float32",h)}const obe={kernelName:TS,backendName:"webgpu",kernelFunc:sbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{strides:o,dilations:i,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Rn(c,s.shape,o,i,l,u,!0),f=new abe(d),h=[{type:"int32",data:[d.strideHeight,d.strideWidth]},{type:"int32",data:[d.filterHeight-1-d.padInfo.top,d.filterWidth-1-d.padInfo.left]},{type:"int32",data:[d.filterHeight,d.filterWidth]},{type:"int32",data:[d.outHeight]},{type:"int32",data:[d.outWidth]},{type:"int32",data:[d.outChannels/d.inChannels]}];return n.runWebGPUProgram(f,[a,s],a.dtype,h)}const lbe={kernelName:ES,backendName:"webgpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ube=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,e],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="diag"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let value = select(0.0, getX(coords[0]), coords[0] == coords[1]);
          setOutputAtIndex(index, value);
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],s=ne(r.shape),o=He({inputs:{x:r},backend:n,attrs:{shape:[s]}}),i=new ube(s),l=n.runWebGPUProgram(i,[o],o.dtype),u=He({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeData(o.dataId),n.disposeData(l.dataId),u}const dbe={kernelName:Nv,backendName:"webgpu",kernelFunc:cbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fbe=class{constructor(e){this.variableNames=["x","w"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.outShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="dilation2d"}getUserCode(){return`
       ${Ae("index")} {
         if (index < uniforms.size) {
           let neg_infinity = -3.4e38;
           let coords = getOutputCoords();
           let batch = coords.x;
           let d1 = coords.w;
           let outTopLeftCorner = coords.yz * uniforms.strides - uniforms.pads;
           let hBeg = outTopLeftCorner.x;
           let wBeg = outTopLeftCorner.y;

           var curVal = neg_infinity;
           for (var h = 0; h < uniforms.filterDims[0]; h = h + 1) {
             let hIn = hBeg + h * uniforms.dilations[0];

             if (hIn >= 0 && hIn < uniforms.xShape[1]) {
               for (var w = 0; w < uniforms.filterDims[1]; w = w + 1) {
                 let wIn = wBeg + w * uniforms.dilations[1];

                 if (wIn >= 0 && wIn < uniforms.xShape[2]) {
                   let val = getX(batch, hIn, wIn, d1) + getW(h, w, d1);
                   if (val > curVal) {
                     curVal = val;
                   }
                 }
               }
             }
           }

           setOutputAtIndex(index, curVal);
         }
       }
     `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r,u=cu(a.shape,s.shape,o,i,"NHWC",l),c=[u.padInfo.top,u.padInfo.left],d=[{type:"int32",data:[u.filterHeight,u.filterWidth]},{type:"int32",data:[...c]},{type:"int32",data:[u.strideHeight,u.strideWidth]},{type:"int32",data:[u.dilationHeight,u.dilationWidth]}],f=new fbe(u);return n.runWebGPUProgram(f,[a,s],a.dtype,d)}const pbe={kernelName:Xh,backendName:"webgpu",kernelFunc:hbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mbe{constructor(e,n){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(e.outShape),this.dispatch=Pe(this.dispatchLayout,e.outShape,this.workgroupSize),n!=="float32"&&n!=="int32")throw new Error(`Dilation2DBackpropInput only supports float32 and int32
          types, does not support ${n} type.`);this.type=n,this.shaderKey="dilation2DBackpropInput"}getUserCode(){return`
       ${Ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var xRMax = 0;
           var xCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     xRMax = xR;
                     xCMax = xC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.xShape[3] *
               (xCMax + uniforms.xShape[2] * (xRMax + uniforms.xShape[1] * b));
           let value = getDy(b, r, c, d);
           ${hu("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}class gbe{constructor(e,n,r){if(this.variableNames=["x","w","dy"],this.uniforms="filterDims: vec2<i32>, pads: vec2<i32>, strides: vec2<i32>, dilations: vec2<i32>, dySize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e.filterShape,this.dispatchLayout=Be(e.outShape),this.dispatch=Pe(this.dispatchLayout,e.outShape,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`Dilation2DBackpropFilter only supports float32 and int32
          types, does not support ${r} type.`);this.type=r,this.shaderKey="dilation2DBackpropFilter"}getUserCode(){return`
       ${Ae("index")} {
         if (index < uniforms.dySize) {
           let coords = getDyCoordsFromIndex(index);
           let b = coords[0];
           let r = coords[1];
           let c = coords[2];
           let d = coords[3];

           let dyCorner = vec2<i32>(r, c) * uniforms.strides - uniforms.pads;
           var curVal = -3.4e38;  // neg_infinity
           var wRMax = 0;
           var wCMax = 0;

           // In the case of multiple argmax branches, we only back-propagate
           // along the last branch, i.e., the one with largest value of
           // 'wR * uniforms.filterDims[1] + wC', similarly to the max-pooling
           // backward routines.
           for (var wR = 0; wR < uniforms.filterDims[0]; wR++) {
             let xR = dyCorner.x + wR * uniforms.dilations[0];

             if (xR >= 0 && xR < uniforms.xShape[1]) {
               for (var wC = 0; wC < uniforms.filterDims[1]; wC++) {
                 let xC = dyCorner.y + wC * uniforms.dilations[1];

                 if (xC >= 0 && xC < uniforms.xShape[2]) {
                   let val = getX(b, xR, xC, d) + getW(wR, wC, d);
                   if (val > curVal) {
                     curVal = val;
                     wRMax = wR;
                     wCMax = wC;
                   }
                 }
               }
             }
           }

           let flatIndexIn = d + uniforms.wShape[2] * (wCMax + wRMax * uniforms.wShape[1]);
           let value = getDy(b, r, c, d);
           ${hu("&result[flatIndexIn]","value",this.type)}
         }
       }
     `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,dy:o}=e,{strides:i,pad:l,dilations:u}=r,c=cu(a.shape,s.shape,i,l,"NHWC",u),d=s.dtype,f=new gbe(c,s.shape,d),h=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[ne(c.outShape)]}],p=Ia({backend:n,attrs:{shape:s.shape,value:0,dtype:d}});return n.runWebGPUProgram(f,[a,s,o],d,h,p)}const vbe={kernelName:PS,backendName:"webgpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,dy:o}=e,{strides:i,pad:l,dilations:u}=r,c=cu(a.shape,s.shape,i,l,"NHWC",u),d=a.dtype,f=new mbe(c,d),h=[{type:"int32",data:[c.filterHeight,c.filterWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[ne(c.outShape)]}],p=Ia({backend:n,attrs:{shape:c.inShape,value:0,dtype:d}});return n.runWebGPUProgram(f,[a,s,o],d,h,p)}const bbe={kernelName:AS,backendName:"webgpu",kernelFunc:xbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wbe{constructor(e,n,r){this.variableNames=["Image"],this.uniforms="alpha: f32,",this.workgroupSize=[64,1,1],this.pixelsOpType=Qf.DRAW,this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.type=n,this.textureFormat=r,this.shaderKey=`draw_${n}_${r}`}getUserCode(){let e;const n=this.type==="float32"?"value":"value / 255.0";return e=`
      if (uniforms.numChannels == 1) {
        rgba[0] = ${n};
        rgba[1] = ${n};
        rgba[2] = ${n};
      } else {
        rgba[d] = ${n};
      }`,`
       @group(0) @binding(0) var outImage : texture_storage_2d<${this.textureFormat}, write>;
       ${Ae("index")} {
         if (index < uniforms.size) {
           var rgba = vec4<f32>(0.0, 0.0, 0.0, uniforms.alpha);
           for (var d = 0; d < uniforms.numChannels; d = d + 1) {
             let value = f32(inBuf[index * uniforms.numChannels + d]);
             ${e}
           }
           rgba.x = rgba.x * rgba.w;
           rgba.y = rgba.y * rgba.w;
           rgba.z = rgba.z * rgba.w;
           let coords = getCoordsFromIndex(index);
           textureStore(outImage, vec2<i32>(coords.yx), rgba);
         }
       }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sbe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a}=e,{canvas:s,options:o}=r,[i,l]=a.shape.slice(0,2),{imageOptions:u}=o||{},c=(u==null?void 0:u.alpha)||1,d=n.device.features.has("bgra8unorm-storage")?"bgra8unorm":"rgba8unorm",f=[i,l],h=new wbe(f,a.dtype,d);s.width=l,s.height=i;const p="webgpu";let g=s.getContext(p),y;g||(y=new OffscreenCanvas(l,i),g=y.getContext(p));const v=a.shape.length===3?a.shape[2]:1;g.configure({device:n.device,format:d,usage:GPUTextureUsage.STORAGE_BINDING,alphaMode:"premultiplied"});const x="int32",b=n.makeTensorInfo(f,x),w=n.tensorMap.get(b.dataId);w.resource=g.getCurrentTexture(),w.external=!0;const C=[{type:"uint32",data:[v]},{type:"float32",data:[c]}];if(n.runWebGPUProgram(h,[a],x,C,b),y){const _=s.getContext("2d");if(!_)throw new Error("Please make sure this canvas has only been used for 2d or webgpu context!");_.drawImage(y,0,0)}return n.disposeData(b.dataId),a}const Cbe={kernelName:OS,backendName:"webgpu",kernelFunc:Sbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IG=$r({opType:rt.MUL,cpuKernelImpl:Iye,supportsComplex:!0}),_be={kernelName:ax,backendName:"webgpu",kernelFunc:IG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r;return ud(a,s,o,"sum",n)}const $be={kernelName:wp,backendName:"webgpu",kernelFunc:TG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,s=e,{allDims:o,summedDims:i,idDims:l}=oP(a,s.length);lP(o.length,l,s);const{path:u,steps:c}=uP(i,l),d=c.length;let f=null,h=o.length;const p=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:v,expandDims:x}=iP(h,l[y]);let b;cP(v)?b=s[y]:(b=fi({inputs:{x:s[y]},backend:n,attrs:{perm:v}}),p.push(b));const w=b.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);Kt(b.shape,w)||(b=He({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),f===null?f=b:(f=IG({inputs:{a:b,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=TG({inputs:{x:f},backend:n,attrs:{axis:u[g]-(o.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeData(g.dataId);return f}const Nbe={kernelName:RS,backendName:"webgpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ibe=Mt({opType:Ee.ELU}),Tbe={kernelName:Tv,backendName:"webgpu",kernelFunc:Ibe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ebe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,s=new zw(rt.ELU_DER,r.shape,a.shape);return n.runWebGPUProgram(s,[r,a],r.dtype)},Abe={kernelName:Ev,backendName:"webgpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pbe=$r({opType:rt.EQUAL,dtype:"bool",cpuKernelImpl:hye}),Obe={kernelName:Pv,backendName:"webgpu",kernelFunc:Pbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rbe=Mt({opType:Ee.ERF}),Dbe={kernelName:Av,backendName:"webgpu",kernelFunc:Rbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jbe=Mt({opType:Ee.EXP,cpuKernelImpl:pye,dtype:"float32"}),Mbe={kernelName:Ov,backendName:"webgpu",kernelFunc:jbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yN(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:s}=e,o=s.shape.length,i=s.shape.slice();let l=a;return a<0&&(j(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+a+1),i.splice(l,0,1),He({inputs:{x:s},backend:r,attrs:{shape:i}})}const Fbe={kernelName:Rv,backendName:"webgpu",kernelFunc:yN};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lbe=Mt({opType:Ee.EXPM1,cpuKernelImpl:mye}),Bbe={kernelName:Dv,backendName:"webgpu",kernelFunc:Lbe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let q3=class{constructor(e,n){this.variableNames=["real","imag"],this.outputShape=[],this.uniforms="exponentMultiplier : f32, denominator: f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.component=e,this.shaderKey=`fft_${e}`}getUserCode(){return`
    fn unaryOpComplex(real: f32, expR: f32, imag: f32, expI: f32) -> f32 {
      ${this.component==="real"?"return real * expR - imag * expI;":"return real * expI + imag * expR;"}
    }

    fn mulMatDFT(batch: i32, index: i32) -> f32 {
      let indexRatio = f32(index) / f32(uniforms.realShape[1]);
      let exponentMultiplierTimesIndexRatio =
          uniforms.exponentMultiplier * indexRatio;

      var result = 0.0;

      for (var i = 0; i < uniforms.realShape[1]; i = i + 1) {
        // x = (-2|2 * PI / N) * index * i;
        let x = exponentMultiplierTimesIndexRatio * f32(i);
        let expR = cos(x);
        let expI = sin(x);
        let real = getReal(batch, i);
        let imag = getImag(batch, i);

        result = result +
            unaryOpComplex(real, expR, imag, expI) / uniforms.denominator;
      }

      return result;
    }

    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        setOutputAtIndex(index, mulMatDFT(coords[0], coords[1]));
      }
    }
  `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(t,e,n){const r=n.tensorMap.get(t.dataId),a=ne(t.shape),s=t.shape[t.shape.length-1],o=a/s,i=[],l=He({inputs:{x:t},backend:n,attrs:{shape:[o,s]}});i.push(l);const u=l.shape,c=new q3("real",u),d=new q3("imag",u),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],h=e?2*Math.PI:-2*Math.PI,p=e?u[1]:1,g=[{type:"float32",data:[h]},{type:"float32",data:[p]}],y=n.runWebGPUProgram(c,f,"float32",g);i.push(y);const v=n.runWebGPUProgram(d,f,"float32",g);i.push(v);const x=ld({inputs:{real:y,imag:v},backend:n});i.push(x);const b=He({inputs:{x},backend:n,attrs:{shape:t.shape}});return i.forEach(w=>n.disposeData(w.dataId)),b}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zbe(t){const{inputs:e,backend:n}=t,{input:r}=e;return EG(r,!1,n)}const Ube={kernelName:DS,backendName:"webgpu",kernelFunc:zbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Vbe=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="flipLeftRight"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let coordX = uniforms.xShape[2] - coords[2] - 1;
          let outputValue = getX(coords[0], coords[1], coordX, coords[3]);
          setOutputAtIndex(index, outputValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wbe={kernelName:Yh,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,a=new Vbe(n.shape);return r.runWebGPUProgram(a,[n],n.dtype)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gbe=Mt({opType:Ee.FLOOR,cpuKernelImpl:gye}),Hbe={kernelName:Mv,backendName:"webgpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qbe=$r({opType:rt.FLOOR_DIV,cpuKernelImpl:yye,dtype:"int32"}),Kbe={kernelName:Fv,backendName:"webgpu",kernelFunc:qbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Xbe=class{constructor(e,n,r=!1){this.pixelsOpType=Qf.FROM_PIXELS,this.outputShape=[0],this.variableNames=[],this.workgroupSize=[256,1,1],this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[n,1,1]),this.importVideo=r,this.shaderKey=`fromPixels_${this.importVideo}`}getUserCode(){const e=this.importVideo?"textureLoad(src, vec2<i32>(coords.yx));":"textureLoad(src, vec2<i32>(coords.yx), 0)";return`
      @binding(1) @group(0) var src: ${this.importVideo?"texture_external":"texture_2d<f32>"};
      ${Ae("index")} {
        let flatIndex = index * uniforms.numChannels;
        if (flatIndex < uniforms.size) {
          let coords = getCoordsFromIndex(flatIndex);
          let values = ${e};
          for (var i = 0; i < uniforms.numChannels; i = i + 1) {
            result[flatIndex + i] = i32(floor(255.0 * values[i]));
          }
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use backend file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ybe={kernelName:Xg,backendName:"webgpu",kernelFunc:Qbe};let Pd,A_=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Qbe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:s}=r;if(a==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");const o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,i=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,l=typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas,u=typeof ImageBitmap<"u"&&a instanceof ImageBitmap,[c,d]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],f=[d,c,s],h=ee().getBool("WEBGPU_IMPORT_EXTERNAL_TEXTURE")&&o,p=o||i;if(u||l||p){let x;if(h)x=n.device.importExternalTexture({source:a});else{if(p){const B=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Pd==null||B!==A_)&&(A_=B,Pd=document.createElement("canvas").getContext("2d",{willReadFrequently:A_})),Pd.canvas.width=c,Pd.canvas.height=d,Pd.drawImage(a,0,0,c,d),a=Pd.canvas}const P=GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING,R=n.textureManager.acquireTexture(f[1],f[0],"rgba8unorm",P);n.queue.copyExternalImageToTexture({source:a},{texture:R},[f[1],f[0]]),x=R}const b=ne(f),w=Dt(f),C=new Xbe(f,s,h),_=[{type:"uint32",data:[b]},{type:"uint32",data:[s]},{type:"uint32",data:[...w]}],$=n.makeTensorInfo([d,c],"int32"),k=n.tensorMap.get($.dataId);k.resource=x;const A=n.runWebGPUProgram(C,[$],"int32",_);return n.disposeData($.dataId),A}const g=a.data;let y=g;if(s!=null&&s!==4){y=new Uint8Array(a.width*a.height*s);const x=g.length;let b=0;for(let w=0;w<x;w++)w%4<s&&(y[b++]=g[w])}const v=n.makeTensorInfo(f,"int32",new Int32Array(y));return n.uploadToGPU(v.dataId),v}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jbe=class{constructor(e,n,r,a,s){this.uniforms="varianceEpsilon : f32,",this.workgroupSize=[128,1,1],this.size=!0,this.variableNames=["x","mean","variance"],ct(e,n),ct(e,r),this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),a!=null&&(ct(e,a),this.variableNames.push("offset")),s!=null&&(ct(e,s),this.variableNames.push("scale")),this.offsetShape=a,this.scaleShape=s,this.shaderKey="batchNorm"}getUserCode(){let e="0.0";this.offsetShape!=null&&(e="getOffsetByOutputIndex(index)");let n="1.0";return this.scaleShape!=null&&(n="getScaleByOutputIndex(index)"),`
      ${Ae("index")} {
        if (index < uniforms.size)
        {
          let xValue = getXByOutputIndex(index);
          let meanValue = getMeanByOutputIndex(index);
          let varianValue = getVarianceByOutputIndex(index);
          let offsetValue = ${e};
          let scaleValue = ${n};
          let inv = scaleValue * inverseSqrt(varianValue + f32(uniforms.varianceEpsilon));
          setOutputAtIndex(index,dot(vec3<f32>(xValue, -meanValue, offsetValue), vec3<f32>(inv, inv, 1.0)));
        }
      }
  `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zbe={kernelName:Qh,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r,scale:a,offset:s,mean:o,variance:i}=t,{varianceEpsilon:l}=e,u=n,c=[r,o,i];let d=null;s!=null&&(d=s.shape,c.push(s));let f=null;a!=null&&(f=a.shape,c.push(a));const h=new Jbe(r.shape,o.shape,i.shape,d,f),p=[{type:"float32",data:[l]}];return u.runWebGPUProgram(h,c,r.dtype,p)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,g=ks(c),y=Rn(a.shape,s.shape,l,d,u,f,!1,g);return _G({x:a,filter:s,convInfo:y,backend:n,bias:o,preluActivationWeights:i,leakyreluAlpha:p,activation:h})}const t0e={kernelName:Tc,backendName:"webgpu",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r;let p=c;p==null&&(p=[1,1]),j(Qr(l,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${p}'`);const g=Rn(a.shape,s.shape,l,p,u,d,!0),y=[a,s],v=o!=null,x=i!=null;v&&y.push(o),x&&y.push(i);const b=[{type:"int32",data:[g.padInfo.top,g.padInfo.left]},{type:"int32",data:[g.inHeight,g.inWidth]}];let w;return g.outHeight>4&&g.outWidth>4&&g.strideWidth<=2&&g.inChannels===g.outChannels&&g.dilationHeight===1&&g.dilationWidth===1&&g.inChannels%4===0?(w=new kG(g,v,f,x),b.push({type:"int32",data:[w.virtualWidth]})):(w=new NG(g,v,f,x),b.push({type:"int32",data:[g.filterHeight]},{type:"int32",data:[g.filterWidth]},{type:"int32",data:[g.strideHeight,g.strideWidth]},{type:"int32",data:[g.dilationHeight,g.dilationWidth]})),f==="leakyrelu"&&(b.push({type:"float32",data:[h]}),w.uniforms+=" alpha : f32,"),n.runWebGPUProgram(w,y,"float32",b)}const r0e={kernelName:Ec,backendName:"webgpu",kernelFunc:n0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let a0e=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey=`gathernd_${e}`,this.sliceDim=e,this.uniforms=`sliceDim : i32, strides : ${nr(e)},`}getUserCode(){let e;return this.sliceDim>1?e="uniforms.strides[j]":e="uniforms.strides",`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          var flattenIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexTemp = i32(round(getIndices(coords[0], j)));
            let strideNum = ${e};
            flattenIndex = flattenIndex + indexTemp * strideNum;
          }

          setOutputAtIndex(index, getA(flattenIndex, coords[1]));
        }
      }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s0e(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,s=a.shape,o=s[s.length-1],i=ne(r.shape),[l,u,c,d]=Jx(r,a),f=He({inputs:{x:a},backend:n,attrs:{shape:[u,o]}}),h=He({inputs:{x:r},backend:n,attrs:{shape:[ne(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const x=n.readSync(a.dataId),b=n.bufferSync(r),w=vye(x,b,r.dtype,u,o,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,w.values)}const p=new a0e(o,[u,c]),g=[{type:"int32",data:[o]},{type:"int32",data:d}],y=n.runWebGPUProgram(p,[h,f],h.dtype,g),v=He({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeData(f.dataId),n.disposeData(h.dataId),n.disposeData(y.dataId),v}const o0e={kernelName:Jh,backendName:"webgpu",kernelFunc:s0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let i0e=class{constructor(e,n){this.variableNames=["A","indices"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.slice(),this.aShape=e,this.outputShape=n,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="gather"}getUserCode(){const e=l0e(this.aShape);return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let indexZ = i32(getIndices(resRC.x, resRC.z));
          let inBounds = select(0.0, 1.0, indexZ >= 0 && indexZ < uniforms.aShape[2]);
          setOutputAtIndex(index, inBounds * getA(${e}));
        }
      }
    `}};function l0e(t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)r===2?n.push("indexZ"):n.push(`${e[r]}`);return n.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:s}=e,{axis:o,batchDims:i}=r,l=Yt(o,a.shape)[0],u=S2(a,s,l,i),c=ne(s.shape),d=[],f=He({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=He({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(h);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,s])){const b=n.tensorMap.get(h.dataId).values,w=en(h.shape,h.dtype,b),_=n.tensorMap.get(f.dataId).values,$=en(f.shape,f.dtype,_),k=xye($,w,p);return d.forEach(A=>n.disposeData(A.dataId)),n.makeTensorInfo(u.outputShape,k.dtype,k.values)}const g=new i0e(f.shape,p),y=n.runWebGPUProgram(g,[f,h],f.dtype);d.push(y);const v=He({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeData(x.dataId)),v}const u0e={kernelName:Lv,backendName:"webgpu",kernelFunc:AG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c0e=$r({opType:rt.GREATER,cpuKernelImpl:wye,dtype:"bool"}),d0e={kernelName:Bv,backendName:"webgpu",kernelFunc:c0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f0e=$r({opType:rt.GREATER_EQUAL,dtype:"bool",cpuKernelImpl:bye}),h0e={kernelName:zv,backendName:"webgpu",kernelFunc:f0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n}=t,{input:r}=e;return EG(r,!0,n)}const m0e={kernelName:jS,backendName:"webgpu",kernelFunc:p0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g0e=Mt({opType:Ee.IS_FINITE,dtype:"bool"}),y0e={kernelName:Uv,backendName:"webgpu",kernelFunc:g0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v0e=Mt({opType:Ee.IS_INF,dtype:"bool"}),x0e={kernelName:Vv,backendName:"webgpu",kernelFunc:v0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b0e=Mt({opType:Ee.IS_NAN,dtype:"bool"}),w0e={kernelName:Wv,backendName:"webgpu",kernelFunc:b0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:s}=r,o=[{type:"float32",data:[s]}],i=new Pp(a.shape,Ee.LEAKYRELU,"alpha : f32,");return n.runWebGPUProgram(i,[a],"float32",o)}const C0e={kernelName:ep,backendName:"webgpu",kernelFunc:S0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _0e=$r({opType:rt.LESS,dtype:"bool",cpuKernelImpl:Cye}),$0e={kernelName:Gv,backendName:"webgpu",kernelFunc:_0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k0e=$r({opType:rt.LESS_EQUAL,dtype:"bool",cpuKernelImpl:Sye}),N0e={kernelName:Hv,backendName:"webgpu",kernelFunc:k0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I0e{constructor(e){this.variableNames=[],this.outputShape=[],this.uniforms="start : f32, step : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="linSpace"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          setOutputAtIndex(index, uniforms.start + f32(index) * uniforms.step);
        }
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T0e(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:s}=n,o=(a-r)/(s-1),i=new I0e(s),l=[{type:"float32",data:[r]},{type:"float32",data:[o]}];return e.runWebGPUProgram(i,[],"float32",l)}const E0e={kernelName:tp,backendName:"webgpu",kernelFunc:T0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A0e=Mt({opType:Ee.LOG,cpuKernelImpl:_ye}),P0e={kernelName:qv,backendName:"webgpu",kernelFunc:A0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O0e=Mt({opType:Ee.LOG1P}),R0e={kernelName:Kv,backendName:"webgpu",kernelFunc:O0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D0e=$r({opType:rt.LOGICAL_AND,dtype:"bool"}),j0e={kernelName:Xv,backendName:"webgpu",kernelFunc:D0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M0e=Mt({opType:Ee.LOGICAL_NOT}),F0e={kernelName:Yv,backendName:"webgpu",kernelFunc:M0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L0e=$r({opType:rt.LOGICAL_OR}),B0e={kernelName:Qv,backendName:"webgpu",kernelFunc:L0e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PG=`
  var powValue = 0.0;
  let basis = uniforms.bias + uniforms.alpha * sum;
  if (uniforms.beta == 0.5) {
    powValue = inverseSqrt(basis);
  } else if (uniforms.beta == 1.0) {
    powValue = 1.0 / basis;
  } else {
    powValue = exp(log(basis) * (-uniforms.beta));
  }
`;let z0e=class{constructor(e){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];
        let d = coords[3];

        let x = getX(b, r, c, d);
        var sum = 0.0;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let idx = d + i;
          if (idx >= 0 && idx < uniforms.xShape[3]) {
            let z = getX(b, r, c, idx);
            sum = sum + z * z;
          }
        }
        ${PG}

        setOutputAtIndex(index, x * powValue);
      }
    }
  `}};class U0e{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.uniforms="radius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[256,1,1],this.maxAllowRadius=16,j(n<=this.maxAllowRadius,()=>`Radius must be less than or equal to ${this.maxAllowRadius}, current radius is ${n}`),this.outputShape=e,this.elementsPerWorkgroup=this.workgroupSize[0]-2*this.maxAllowRadius,this.dispatchLayout={x:[3],y:[2],z:[0,1]},this.dispatch=Pe(this.dispatchLayout,this.outputShape,[this.elementsPerWorkgroup,this.workgroupSize[1],this.workgroupSize[2]]),this.shaderKey="lrn_shared"}getUserCode(){return`
    var <workgroup>lrnSub: array<f32, ${this.workgroupSize[0]}>;
    const elementsPerWorkgroup = ${this.elementsPerWorkgroup};
    const maxAllowRadius = ${this.maxAllowRadius};

    ${Ae()} {
      let localDepth = i32(localId.x);
      let workgroupDepth = i32(workgroupId.x) * elementsPerWorkgroup;
      let xDepth = workgroupDepth + localDepth - maxAllowRadius;
      let b = i32(globalId.z) / uniforms.xShape[1];
      let r = i32(globalId.z) - b * uniforms.xShape[1];
      let c = i32(globalId.y);
      let d = workgroupDepth + localDepth;

      var x = 0.0;
      if (xDepth >= 0 && xDepth < uniforms.xShape[3]) {
        x = getX(b, r, c, xDepth);
      }
      lrnSub[localDepth] = x;
      workgroupBarrier();

      if (localDepth < elementsPerWorkgroup && d < uniforms.outShape[3]) {
        var sum = 0.0;
        let index = localDepth + maxAllowRadius;
        for (var i = -uniforms.radius; i <= uniforms.radius; i = i + 1) {
          let z = lrnSub[index + i];
          sum = sum + z * z;
        }
        ${PG}

        setOutputAtCoords(b, r, c, d, lrnSub[index] * powValue);
      }
    } `}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:s,bias:o,alpha:i,beta:l}=r;let u;s>16?u=new z0e(a.shape):u=new U0e(a.shape,s);const c=[{type:"int32",data:[s]},{type:"float32",data:[o]},{type:"float32",data:[i]},{type:"float32",data:[l]}];return n.runWebGPUProgram(u,[a],a.dtype,c)}const W0e={kernelName:np,backendName:"webgpu",kernelFunc:V0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let G0e=class{constructor(e){this.outputShape=[],this.variableNames=["inputImage","outputImage","dy"],this.uniforms="depthRadius : i32, bias : f32, alpha : f32, beta : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="lrn_grad"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let b = coords[0];
        let r = coords[1];
        let c = coords[2];

        let MIN_DEPTH_BEGIN = 0;
        let MAX_DEPTH_END = uniforms.outShape[3];
        var result = 0.0;
        for (var d = MIN_DEPTH_BEGIN; d < MAX_DEPTH_END; d++) {
          let depthBegin = max(MIN_DEPTH_BEGIN, d - uniforms.depthRadius);
          let depthEnd = min(MAX_DEPTH_END, d + uniforms.depthRadius + 1);

          var norm = 0.0;
          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            } else {
              break;
            }
          }

          norm = uniforms.alpha * norm + uniforms.bias;

          for (var k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; k++) {
            if (k < depthBegin) {
              continue;
            } else if (k >= depthBegin && k < depthEnd) {
              var dyi = -2.0 * uniforms.alpha * uniforms.beta
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d) / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * uniforms.beta);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            } else {
              break;
            }
          }
        }

        setOutputAtIndex(index, result);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,y:s,dy:o}=e,{depthRadius:i,bias:l,alpha:u,beta:c}=r,d=new G0e(a.shape),f=[{type:"int32",data:[i]},{type:"float32",data:[l]},{type:"float32",data:[u]},{type:"float32",data:[c]}];return n.runWebGPUProgram(d,[a,s,o],a.dtype,f)}const q0e={kernelName:Jv,backendName:"webgpu",kernelFunc:H0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K0e=$r({opType:rt.MAX,cpuKernelImpl:kye}),X0e={kernelName:Zv,backendName:"webgpu",kernelFunc:K0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:l}=r,c=Yr(a.shape,s,o,1,i,l);return bG(a,c,"max",n)}const Q0e={kernelName:ap,backendName:"webgpu",kernelFunc:Y0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=$s(a.shape,s,o,c,i,u,l),f=new NP(d,"max"),h=[{type:"int32",data:[d.strideDepth,d.strideHeight,d.strideWidth]},{type:"int32",data:[d.padInfo.front,d.padInfo.top,d.padInfo.left]},{type:"int32",data:[d.inDepth,d.inHeight,d.inWidth]},{type:"int32",data:[d.effectiveFilterDepth,d.effectiveFilterHeight,d.effectiveFilterWidth]}];return n.runWebGPUProgram(f,[a],a.dtype,h)}const Z0e={kernelName:ex,backendName:"webgpu",kernelFunc:J0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ewe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec2<i32>, pads : vec2<i32>, dilations : vec2<i32>, filterDims : vec2<i32>,
       outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool2DBackprop"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords[0];
        let d = coords[3];

        let dyRCCorner = vec2<i32>(coords.yz) - uniforms.pads;
        let dyRCorner = dyRCCorner.x;
        let dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] - 1;
        for (var wR = 0; wR < uniforms.filterDims[0]; wR += uniforms.dilations[0]) {
          let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[0]);

          if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
            continue;
          }
          let idyR = i32(dyR);

          for (var wC = 0; wC < uniforms.filterDims[1]; wC += uniforms.dilations[1]) {
            let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[1]);

            if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
              continue;
            }
            let idyC = i32(dyC);

            let dyValue = getDy(batch, idyR, idyC, d);
            let maxPosValue = lastIndex - i32(getMaxPos(batch, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            let curPosValue = wR * uniforms.filterDims[1] + wC;
            let mask = select(0.0, 1.0, maxPosValue == curPosValue);
            dotProd += dyValue * mask;
          }
        }
        setOutputAtIndex(index, dotProd);
      }
    }
    `}},twe=class{constructor(e){this.variableNames=["dy","maxPos"],this.uniforms=`strides : vec3<i32>, pads : vec3<i32>, filterDims : vec3<i32>,
      outDepth : i32, outHeight : i32, outWidth : i32`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e.inShape,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="maxPool3DBackprop"}getUserCode(){return`
      ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
        let batch = coords.x;
        let ch = coords.u;

        let dyCorner = vec3<i32>(coords.y, coords.z, coords.w) - uniforms.pads;
        let dyDCorner = dyCorner.x;
        let dyRCorner = dyCorner.y;
        let dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        var dotProd = 0.0;
        let lastIndex = uniforms.filterDims[0] * uniforms.filterDims[1] * uniforms.filterDims[2] - 1;

        for (var wD = 0; wD < uniforms.filterDims[0]; wD++) {
          let dyD = f32(dyDCorner + wD) / f32(uniforms.strides[0]);

          if (dyD < 0.0 || dyD >= f32(uniforms.outDepth) || fract(dyD) > 0.0) {
            continue;
          }
          let idyD = i32(dyD);

          for (var wR = 0; wR < uniforms.filterDims[1]; wR++) {
            let dyR = f32(dyRCorner + wR) / f32(uniforms.strides[1]);

            if (dyR < 0.0 || dyR >= f32(uniforms.outHeight) || fract(dyR) > 0.0) {
              continue;
            }
            let idyR = i32(dyR);

            for (var wC = 0; wC < uniforms.filterDims[2]; wC++) {
              let dyC = f32(dyCCorner + wC) / f32(uniforms.strides[2]);

              if (dyC < 0.0 || dyC >= f32(uniforms.outWidth) || fract(dyC) > 0.0) {
                continue;
              }
              let idyC = i32(dyC);

              let dyValue = getDy(batch, idyD, idyR, idyC, ch);
              let maxPosValue = lastIndex - i32(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              let curPosValue = wD * uniforms.filterDims[1] * uniforms.filterDims[2] + wR * uniforms.filterDims[2] + wC;
              let mask = select(0.0, 1.0, maxPosValue == curPosValue);
              dotProd += dyValue * mask;
            }
          }
        }

        setOutputAtIndex(index, dotProd);
      }
    }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=$s(o.shape,i,l,d,u,c),h=new NP(f,"max",!0);let p=[{type:"int32",data:[f.strideDepth,f.strideHeight,f.strideWidth]},{type:"int32",data:[f.padInfo.front,f.padInfo.top,f.padInfo.left]},{type:"int32",data:[f.inDepth,f.inHeight,f.inWidth]},{type:"int32",data:[f.effectiveFilterDepth,f.effectiveFilterHeight,f.effectiveFilterWidth]}];const g=n.runWebGPUProgram(h,[o],"int32",p),y=new twe(f);p=[{type:"int32",data:[f.strideDepth,f.strideHeight,f.strideWidth]},{type:"int32",data:[f.effectiveFilterDepth-1-f.padInfo.front,f.effectiveFilterHeight-1-f.padInfo.top,f.effectiveFilterWidth-1-f.padInfo.left]},{type:"int32",data:[f.effectiveFilterDepth,f.effectiveFilterHeight,f.effectiveFilterWidth]},{type:"int32",data:[f.outDepth]},{type:"int32",data:[f.outHeight]},{type:"int32",data:[f.outWidth]}];const v=n.runWebGPUProgram(y,[a,g],o.dtype,p);return n.disposeData(g.dataId),v}const rwe={kernelName:LS,backendName:"webgpu",kernelFunc:nwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function awe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s,output:o}=e,i=s;sG([s,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=Yr(i.shape,l,u,1,c,d),h=new uy(f,"max",!0);let p=[{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.padInfo.top,f.padInfo.left]},{type:"int32",data:[f.dilationHeight,f.dilationWidth]},{type:"int32",data:[f.inHeight,f.inWidth]},{type:"int32",data:[f.effectiveFilterHeight,f.effectiveFilterWidth]}];const g=n.runWebGPUProgram(h,[i],"int32",p),y=new ewe(f);p=[{type:"int32",data:[f.strideHeight,f.strideWidth]},{type:"int32",data:[f.effectiveFilterHeight-1-f.padInfo.top,f.effectiveFilterWidth-1-f.padInfo.left]},{type:"int32",data:[f.dilationHeight,f.dilationWidth]},{type:"int32",data:[f.effectiveFilterHeight,f.effectiveFilterWidth]},{type:"int32",data:[f.outHeight]},{type:"int32",data:[f.outWidth]}];const v=n.runWebGPUProgram(y,[a,g],i.dtype,p);return n.disposeData(g.dataId),v}const swe={kernelName:FS,backendName:"webgpu",kernelFunc:awe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function owe(t){const{inputs:e,backend:n,attrs:r}=t,{filterSize:a,strides:s,pad:o,includeBatchInIndex:i}=r,{x:l}=e;j(l.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.shape.length}.`);const u=[1,1];j(Qr(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Yr(l.shape,a,s,u,o),d=[{type:"int32",data:[c.strideHeight,c.strideWidth]},{type:"int32",data:[c.padInfo.top,c.padInfo.left]},{type:"int32",data:[c.dilationHeight,c.dilationWidth]},{type:"int32",data:[c.inHeight,c.inWidth]},{type:"int32",data:[c.effectiveFilterHeight,c.effectiveFilterWidth]}];let f=new uy(c,"max",!1);const h=n.runWebGPUProgram(f,[l],l.dtype,d);f=new uy(c,"max",!0,!0,i);const p=n.runWebGPUProgram(f,[l],"int32",d);return[h,p]}const iwe={kernelName:tx,backendName:"webgpu",kernelFunc:owe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r;return ud(a,s,o,"min",n)}const uwe={kernelName:op,backendName:"webgpu",kernelFunc:lwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cwe=$r({opType:rt.MIN,cpuKernelImpl:Nye}),dwe={kernelName:nx,backendName:"webgpu",kernelFunc:cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fwe=class{constructor(e,n,r){this.uniforms="",this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((a,s)=>a[0]+e[s]+a[1]),this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,n.map((a,s)=>{this.uniforms+=` pad${s} : vec2<i32>,`}),this.offset=r==="reflect"?0:1,this.shaderKey=`mirrorPad_${r}`}getUserCode(){const e=this.xShape.length,n=this.xShape.map((u,c)=>`uniforms.pad${c}[0]`).join(","),r=this.xShape.map((u,c)=>`uniforms.pad${c}[0] + uniforms.xShape${e>1?`[${c}]`:""}`).join(","),a=e===1?"start":"start[i]",s=e===1?"end":"end[i]",o=e===1?"outC":"outC[i]",i=nr(e),l=e>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,e):"coords";return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let start = ${i}(${n});
          let end = ${i}(${r});
          var outC = getCoordsFromIndex(index);
          for (var i = 0; i < ${e}; i = i + 1) {
            if (${o} < ${a}) {
              ${o} = ${a} * 2 - ${o} - ${this.offset};
            } else if(${o} >= ${s}) {
              ${o} = (${s} - 1) * 2 - ${o} + ${this.offset};
            }
          }
          let coords = outC - start;
          setOutputAtIndex(index, getX(${l}));
        }
      }
    `}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hwe={kernelName:ip,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{paddings:a,mode:s}=e,o=n,i=a.map(c=>({type:"int32",data:[c[0],c[1]]})),l=new fwe(r.shape,a,s);return o.runWebGPUProgram(l,[r],r.dtype,i)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pwe=$r({opType:rt.MOD}),mwe={kernelName:rx,backendName:"webgpu",kernelFunc:pwe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gwe=class{constructor(e,n){this.variableNames=["probs"],this.outputShape=[],this.uniforms="seed : f32, numOutcomes: i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="multinomial"}getUserCode(){return`
    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    fn random (seed : f32, resultUV : vec2<f32>) -> f32 {
      let HASHSCALE1 = 443.8975;
      let p = resultUV * seed;
      var p3  = fract(vec3<f32>(p.xyx) * HASHSCALE1);
      p3 = p3 + dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Ae("index")} {
      if (index < uniforms.size) {
        let coords = getOutputCoords();
        let batch = coords[0];

        let resUV = vec2<f32>(f32(coords[1]) / f32(uniforms.outShape[1]),
            f32(coords[0]) / f32(uniforms.outShape[0]));
        let r = random(uniforms.seed, resUV);
        var cdf = 0.0;
        for (var i = 0; i < uniforms.numOutcomes - 1; i = i + 1) {
          cdf = cdf + getProbs(batch, i);

          if (r < cdf) {
            setOutputAtIndexI32(index, i);
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutputAtIndexI32(index, uniforms.numOutcomes - 1);
      }
    }
  `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ywe{constructor(e){this.variableNames=["logits"],this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=[this.outputShape[0],1,1],this.outputShape[1]>=4096?this.workgroupSize=[256,1,1]:this.workgroupSize=[64,1,1],this.shaderKey="softmax"}getUserCode(){return`
    var<workgroup> buf : array<f32, ${this.workgroupSize[0]}>;
    var<workgroup> rowMaxShared : f32;
    var<workgroup> rowSumShared : f32;
    const blockSize = ${this.workgroupSize[0]};
    ${Ae("index")} {
      let row = index / blockSize;
      let tid = i32(localId.x);
      let cols = uniforms.outShape[1];

      var threadMax = -3.402823e+38f;
      for (var col = tid; col < cols; col += blockSize) {
        let value = getLogits(row, col);
        threadMax = max(threadMax, value);
      }
      if (tid < cols) {
        buf[tid] = threadMax;
      }
      workgroupBarrier();

      var reduceSize = min(cols, blockSize);
      for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
        reduceSize = currSize + (reduceSize & 1);
        if (tid < currSize) {
          buf[tid] = max(buf[tid], buf[tid + reduceSize]);
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowMaxShared = buf[0];
      }
      workgroupBarrier();

      var threadSum = 0.0;
      for (var col = tid; col < cols; col += blockSize) {
        let subExp = exp(getLogits(row, col) - rowMaxShared);
        threadSum += subExp;
      }
      buf[tid] = threadSum;
      workgroupBarrier();

      for (var currSize = blockSize >> 1;  currSize > 0; currSize = currSize >> 1) {
        if (tid < currSize) {
          buf[tid] = buf[tid] + buf[tid + currSize];
        }
        workgroupBarrier();
      }

      if (tid == 0) {
        rowSumShared = buf[0];
      }
      workgroupBarrier();

      for (var col = tid; col < cols; col += blockSize) {
        let value = exp(getLogits(row, col) - rowMaxShared) / rowSumShared;
        setOutputAtCoords(row, col, value);
      }
  }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:s}=r,o=He({inputs:{x:a},backend:n,attrs:{shape:[ne(a.shape)/a.shape[s],a.shape[s]]}}),i=new ywe(o.shape),l=n.runWebGPUProgram(i,[o],a.dtype),u=He({inputs:{x:l},backend:n,attrs:{shape:a.shape}});return n.disposeData(o.dataId),n.disposeData(l.dataId),u}const vwe={kernelName:Sp,backendName:"webgpu",kernelFunc:OG};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xwe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:s,seed:o,normalized:i}=r,l=i?a:OG({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new gwe(u,s),f=[{type:"float32",data:[o]},{type:"int32",data:[c]}],h=n.runWebGPUProgram(d,[l],"int32",f);return i||n.disposeData(l.dataId),h}const bwe={kernelName:lp,backendName:"webgpu",kernelFunc:xwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wwe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const s=n.tensorMap.get(r.dataId),[o,i]=Tye(s.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,o)}const a=new Pp(r.shape,Ee.NEG);return n.runWebGPUProgram(a,[r],r.dtype)}const Swe={kernelName:sx,backendName:"webgpu",kernelFunc:wwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:s}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:l}=r,u=n.readSync(a.dataId),c=n.readSync(s.dataId),{selectedIndices:d}=i2(u,c,o,i,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const _we={kernelName:up,backendName:"webgpu",kernelFunc:Cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){console.warn("tf.nonMaxSuppression() in webgpu locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:s}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(a.dataId),d=n.readSync(s.dataId),f=o,h=i,p=l,g=u,{selectedIndices:y,selectedScores:v}=l2(c,d,f,h,p,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const kwe={kernelName:cp,backendName:"webgpu",kernelFunc:$we};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Nwe=class{constructor(e,n){this.variableNames=["x"],this.uniforms="onValue : f32, offValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e,n],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="onehot"}getUserCode(){return`
      ${Ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          setOutputAtIndex(index, mix(uniforms.offValue, uniforms.onValue,
                                      f32(i32(round(getX(coords.x))) == coords.y)));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iwe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:s,depth:o,onValue:i,offValue:l}=r,u=ne(a.shape),c=new Nwe(u,o),d=He({inputs:{x:a},backend:n,attrs:{shape:[u]}}),f=[{type:"float32",data:[i]},{type:"float32",data:[l]}],h=n.runWebGPUProgram(c,[d],s,f);n.disposeData(d.dataId);const p=[...a.shape,o],g=He({inputs:{x:h},backend:n,attrs:{shape:p}});return n.disposeData(h.dataId),g}const Twe={kernelName:dp,backendName:"webgpu",kernelFunc:Iwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ww(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const a=Zx({inputs:{input:r},backend:n}),s=Ww({inputs:{x:a},backend:n}),o=k2({inputs:{input:r},backend:n}),i=Ww({inputs:{x:o},backend:n}),l=ld({inputs:{real:s,imag:i},backend:n});return n.disposeData(a.dataId),n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),l}else return Ia({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const Ewe={kernelName:Bx,backendName:"webgpu",kernelFunc:Ww};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const a=Zx({inputs:{input:r},backend:n}),s=RG({inputs:{x:a},backend:n}),o=k2({inputs:{input:r},backend:n}),i=Ww({inputs:{x:o},backend:n}),l=ld({inputs:{real:s,imag:i},backend:n});return n.disposeData(a.dataId),n.disposeData(s.dataId),n.disposeData(o.dataId),n.disposeData(i.dataId),l}else return Ia({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const Awe={kernelName:lx,backendName:"webgpu",kernelFunc:RG};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pwe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return yN({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const s=e[0].shape,o=e[0].dtype;e.forEach(c=>{_r(s,c.shape,"All tensors passed to stack must have matching shapes"),j(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(c=>{const d=yN({inputs:{input:c},backend:n,attrs:{dim:a}});return i.push(d),d}),u=CG({inputs:l,backend:n,attrs:{axis:a}});return i.forEach(c=>n.disposeData(c.dataId)),u}const Owe={kernelName:ux,backendName:"webgpu",kernelFunc:Pwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e=!1){const n=t.length,r=nr(n),a=t.map((d,f)=>`uniforms.pad${f}[0]`).join(","),s=t.map((d,f)=>`uniforms.pad${f}[0] + uniforms.xShape${n>1?`[${f}]`:""}`).join(","),o=n>1?`${r}(${a})`:`${a}`,i=n>1?`${r}(${s})`:`${s}`,l=n>1?"any(paddedCoords < start)":"paddedCoords < start",u=n>1?"any(paddedCoords >= end)":"paddedCoords >= end",c=n>1?["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n):"coords";return`
        let start = ${o};
        let end = ${i};
        if (${l} || ${u}) {
          setOutputAtIndex(index, ${e?0:"uniforms.constantValue"});
        } else {
          let coords = paddedCoords - start;
          setOutputAtIndex(index, getX(${c}));
        }
  `}let Rwe=class{constructor(e,n){this.variableNames=["x"],this.uniforms="constantValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n.map((r,a)=>r[0]+e[a]+r[1]),this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),n.map((r,a)=>{this.uniforms+=` pad${a} : vec2<i32>,`}),this.xShape=e,this.shaderKey="pad"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let paddedCoords = getCoordsFromIndex(index);
          ${DG(this.xShape)}
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dwe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:s,constantValue:o}=r;if(s.every(u=>Kt(u,[0,0])))return es({inputs:{x:a},backend:n});if(ne(a.shape)===0){const u=s.map((c,d)=>c[0]+a.shape[d]+c[1]);return Ia({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}const i=[{type:"float32",data:[o]}];s.map(u=>i.push({type:"int32",data:[u[0],u[1]]}));const l=new Rwe(a.shape,s);return n.runWebGPUProgram(l,[a],a.dtype,i)},jwe={kernelName:fp,backendName:"webgpu",kernelFunc:Dwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mwe=$r({opType:rt.POW}),Fwe={kernelName:cx,backendName:"webgpu",kernelFunc:Mwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lwe(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,s=new zw(rt.PRELU,r.shape,a.shape);return n.runWebGPUProgram(s,[r,a],"float32")}const Bwe={kernelName:hp,backendName:"webgpu",kernelFunc:Lwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r;return ud(a,s,o,"prod",n)}const Uwe={kernelName:pp,backendName:"webgpu",kernelFunc:zwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vwe=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:s,dtype:o}=n,i=Pye(r,a,s,o);return e.makeTensorInfo([i.length],o,i)},Wwe={kernelName:dx,backendName:"webgpu",kernelFunc:Vwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gwe=$r({opType:rt.DIV}),Hwe={kernelName:Iv,backendName:"webgpu",kernelFunc:Gwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qwe=Mt({opType:Ee.RECIPROCAL}),Kwe={kernelName:fx,backendName:"webgpu",kernelFunc:qwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xwe=Mt({opType:Ee.RELU}),Ywe={kernelName:hx,backendName:"webgpu",kernelFunc:Xwe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qwe=Mt({opType:Ee.RELU6}),Jwe={kernelName:yx,backendName:"webgpu",kernelFunc:Qwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Zwe=class{constructor(e,n,r){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, halfPixelCenters : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="resizeBilinear"}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
        let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC =
            (vec2<f32>(rc) + vec2<f32>(uniforms.halfPixelCenters)) *
            effectiveInputOverOutputRatioRC - vec2<f32>(uniforms.halfPixelCenters);

          // Compute the four integer indices.
          let sourceFloorRC = vec2<i32>(sourceFracIndexRC);
          let sourceCeilRC = vec2<i32>(
            min(vec2<f32>(uniforms.xShape.yz) - vec2<f32>(1.0), ceil(sourceFracIndexRC)));

          let topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
          let bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
          let topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
          let bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

          let fracRC = sourceFracIndexRC - vec2<f32>(sourceFloorRC);

          let top = topLeft + (topRight - topLeft) * fracRC.y;
          let bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
          let newValue = top + (bottom - top) * fracRC.x;

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:s,size:o,halfPixelCenters:i}=r,[l,u]=o,c=s&&l>1?1:0,d=s&&u>1?1:0,h=[{type:"float32",data:[c,d]},{type:"float32",data:[i?.5:0]}],p=new Zwe(a.shape,l,u);return n.runWebGPUProgram(p,[a],"float32",h)}const t1e={kernelName:gp,backendName:"webgpu",kernelFunc:e1e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let n1e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, heightScale : f32, widthScale : f32,
       invHeightScale : f32, invWidthScale : f32, winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeBilinearBackprop_${n}`}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(startRLerp - f32(uniforms.winHeight / 2));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(startCLerp - f32(uniforms.winWidth / 2));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let dxR = f32(dyR) * uniforms.heightScale;
              let topDxRIndex = i32(floor(dxR));
              let bottomDxRIndex = i32(min(ceil(dxR), f32(uniforms.outShape[1] - 1)));
              let dxRLerp = dxR - f32(topDxRIndex);
              let inverseDxRLerp = 1.0 - dxRLerp;

              let dxC = f32(dyC) * uniforms.widthScale;
              let leftDxCIndex = i32(floor(dxC));
              let rightDxCIndex = i32(min(ceil(dxC), f32(uniforms.outShape[2] - 1)));
              let dxCLerp = dxC - f32(leftDxCIndex);
              let inverseDxCLerp = 1.0 - dxCLerp;

              if (r == topDxRIndex && c == leftDxCIndex) {
                // topLeft
                accumulator +=
                  getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
              }

              if (r == topDxRIndex && c == rightDxCIndex) {
                // topRight
                accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
              }

              if (r == bottomDxRIndex && c == leftDxCIndex) {
                // bottomLeft
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
              }

              if (r == bottomDxRIndex && c == rightDxCIndex) {
                // bottomRight
                accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,[,i,l]=a.shape,[,u,c]=s.shape,d=[o&&u>1?i-1:i,o&&c>1?l-1:l],f=[o&&u>1?u-1:u,o&&c>1?c-1:c],h=d[0]/f[0],p=d[1]/f[1],g=1/h,y=1/p,v=Math.ceil(g)*2+2,x=Math.ceil(y)*2+2,b=new n1e(a.shape,o),w=[{type:"int32",data:d},{type:"int32",data:f},{type:"float32",data:[h]},{type:"float32",data:[p]},{type:"float32",data:[g]},{type:"float32",data:[y]},{type:"int32",data:[v]},{type:"int32",data:[x]}];return n.runWebGPUProgram(b,[s],s.dtype,w)}const a1e={kernelName:gx,backendName:"webgpu",kernelFunc:r1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s1e=class{constructor(e,n,r,a){this.variableNames=["x"],this.uniforms="adjustHeightWidth : vec2<f32>, roundBase : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=[e[0],n,r,e[3]],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.halfPixelCenters=a,this.shaderKey=`resizeNearest_${a}`}getUserCode(){let e;return this.halfPixelCenters?e="max((vec2<f32>(rc) + vec2<f32>(0.5)) * effectiveInputOverOutputRatioRC, vec2<f32>(0.0))":e="vec2<f32>(rc) * effectiveInputOverOutputRatioRC",`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let b = coords[0];
          let d = coords[3];
          let rc = coords.yz;

          let effectiveInSize = vec2<f32>(
            f32(uniforms.xShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.xShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveOutSize = vec2<f32>(
            f32(uniforms.outShape.y) - uniforms.adjustHeightWidth[0],
            f32(uniforms.outShape.z) - uniforms.adjustHeightWidth[1]);

          let effectiveInputOverOutputRatioRC =
              effectiveInSize / effectiveOutSize;

          // Fractional source index
          let sourceFracIndexRC = ${e};

          // Compute the coordinators of nearest neighbor point.
          let inputShapeRC = vec2<f32>(f32(uniforms.xShape.y), f32(uniforms.xShape.z));
          let sourceNearestRC = vec2<i32>(
            min(inputShapeRC - 1.0, floor(sourceFracIndexRC + uniforms.roundBase)));
          let newValue = getX(b, sourceNearestRC.x, sourceNearestRC.y, d);

          setOutputAtIndex(index, newValue);
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:s,halfPixelCenters:o,size:i}=r,[l,u]=i,c=s&&l>1?1:0,d=s&&u>1?1:0,h=[{type:"float32",data:[c,d]},{type:"float32",data:[s?.5:0]}],p=new s1e(a.shape,l,u,o);return n.runWebGPUProgram(p,[a],a.dtype,h)}const i1e={kernelName:mp,backendName:"webgpu",kernelFunc:o1e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let l1e=class{constructor(e,n){this.variableNames=["dy"],this.uniforms=`effectiveXSize : vec2<i32>, effectiveYSize : vec2<i32>, invHeightScale : f32, invWidthScale : f32,
       winHeight : i32, winWidth : i32,`,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.alignCorners=n,this.shaderKey=`resizeNearestNeigborBackprop_${n}`}getUserCode(){return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getOutputCoords();
          let b = coords[0];
          let d = coords[3];
          let r = coords[1];
          let c = coords[2];

          var accumulator = 0.0;

          // Compute bounds for where in dy we will look
          let startRLerp = floor(f32(r) * uniforms.invHeightScale);
          let startDyR = i32(floor(startRLerp - f32(uniforms.winHeight / 2)));

          let startCLerp = floor(f32(c) * uniforms.invWidthScale);
          let startDyC = i32(floor(startCLerp - f32(uniforms.winWidth / 2)));

          // Loop over dy
          for (var dyROffset = 0; dyROffset < uniforms.winHeight; dyROffset++) {
            let dyR = startDyR + dyROffset;

            // Guard against the window exceeding the bounds of dy
            if (dyR < 0 || dyR >= uniforms.dyShape[1]) {
              continue;
            }

            for (var dyCOffset = 0; dyCOffset < uniforms.winWidth; dyCOffset++) {
              let dyC = startDyC + dyCOffset;

              // Guard against the window exceeding the bounds of dy
              if (dyC < 0 || dyC >= uniforms.dyShape[2]) {
                continue;
              }

              let sourceFracRow = f32(uniforms.effectiveXSize[0]) *
                  (f32(dyR) / f32(uniforms.effectiveYSize[0]));

              let sourceFracCol = f32(uniforms.effectiveXSize[1]) *
                  (f32(dyC) / f32(uniforms.effectiveYSize[1]));

              let sourceNearestRow =
                  i32(min(f32(uniforms.outShape[1] - 1),
                  ${this.alignCorners?"floor(sourceFracRow + 0.5)":"floor(sourceFracRow)"}));

              let sourceNearestCol =
                  i32(min(f32(uniforms.outShape[2] - 1),
                  ${this.alignCorners?"floor(sourceFracCol + 0.5)":"floor(sourceFracCol)"}));

              if (r == sourceNearestRow && c == sourceNearestCol) {
                accumulator += getDy(b, dyR, dyC, d);
              }
            }
          }
          // End loop over dy

          setOutputAtIndex(index, accumulator);
        }
      }
    `}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,[,i,l]=a.shape,[,u,c]=s.shape,d=[o&&u>1?i-1:i,o&&c>1?l-1:l],f=[o&&u>1?u-1:u,o&&c>1?c-1:c],h=d[0]/f[0],p=d[1]/f[1],g=1/h,y=1/p,v=Math.ceil(g)*2+2,x=Math.ceil(y)*2+2,b=new l1e(a.shape,o),w=[{type:"int32",data:d},{type:"int32",data:f},{type:"float32",data:[g]},{type:"float32",data:[y]},{type:"int32",data:[v]},{type:"int32",data:[x]}];return n.runWebGPUProgram(b,[s],s.dtype,w)}const c1e={kernelName:mx,backendName:"webgpu",kernelFunc:u1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let d1e=class{constructor(e){this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=" axis : vec4<i32>,",this.shaderKey="reverse"}getUserCode(){return`
      
      // Using uniform variables as judging conditions, so the function has
      // coherent execution within all threads.
      fn getReverseCoords(coords : vec4<i32>) -> vec4<i32> {
        var reverseCoords = coords;
        if (uniforms.axis[0] == 1) {
          reverseCoords[0] = uniforms.xShape[0] - coords[0] - 1;
        }
        if (uniforms.axis[1] == 1) {
          reverseCoords[1] = uniforms.xShape[1] - coords[1] - 1;
        }
        if (uniforms.axis[2] == 1) {
          reverseCoords[2] = uniforms.xShape[2] - coords[2] - 1;
        }
        if (uniforms.axis[3] == 1) {
          reverseCoords[3] = uniforms.xShape[3] - coords[3] - 1;
        }

        return reverseCoords;
      }
    
      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let reverseCoords = getReverseCoords(coords);
          setOutputAtIndex(index, getX(reverseCoords[0],
              reverseCoords[1], reverseCoords[2], reverseCoords[3]));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:s}=r,o=a.shape.length;if(o===0)return es({inputs:{x:a},backend:n});const i=a.shape,l=[1,1,1,1];i.forEach((y,v)=>{const x=v+4-o;l[x]=y});const u=Yt(s,a.shape),c=[0,0,0,0];u.forEach(y=>{const v=y+4-o;c[v]=1});const d=[{type:"int32",data:c}],f=He({inputs:{x:a},backend:n,attrs:{shape:l}}),h=new d1e(l),p=n.runWebGPUProgram(h,[f],f.dtype,d);n.disposeData(f.dataId);const g=He({inputs:{x:p},backend:n,attrs:{shape:i}});return n.disposeData(p.dataId),g}const h1e={kernelName:yp,backendName:"webgpu",kernelFunc:f1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let p1e=class{constructor(e,n){this.outputShape=[],this.variableNames=["x"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`centerX : f32, centerY : f32, sinRadians : f32,
          cosRadians : f32,`,this.shaderKey="rotate",this.outputShape=e,typeof n=="number"?(this.uniforms+=" fillValue : f32,",this.fillSnippet="var outputValue = uniforms.fillValue;",this.shaderKey+="_float"):(this.uniforms+=" fillValue : vec3<f32>,",this.fillSnippet="var outputValue = uniforms.fillValue[coords[3]];",this.shaderKey+="_vec3")}getUserCode(){return`
        ${Ae("index")} {
          if (index < uniforms.size) {
            let coords = getCoordsFromIndex(index);
            let coordXFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.cosRadians - (f32(coords[1]) - uniforms.centerY) *
                uniforms.sinRadians;
            let coordYFloat = (f32(coords[2]) - uniforms.centerX) *
                uniforms.sinRadians + (f32(coords[1]) - uniforms.centerY) *
                uniforms.cosRadians;
            let coordX = i32(round(coordXFloat + uniforms.centerX));
            let coordY = i32(round(coordYFloat + uniforms.centerY));
            ${this.fillSnippet}
            if(coordX >= 0 && coordX < uniforms.xShape[2] && coordY >= 0 &&
                coordY < uniforms.xShape[1]) {
              outputValue = getX(coords[0], coordY, coordX, coords[3]);
            }
            setOutputAtIndex(index, outputValue);
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1e={kernelName:Ip,backendName:"webgpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:s,center:o}=e,i=n,l=new p1e(r.shape,s),[u,c]=v2(o,r.shape[1],r.shape[2]),d=[{type:"float32",data:[u]},{type:"float32",data:[c]},{type:"float32",data:[Math.sin(a)]},{type:"float32",data:[Math.cos(a)]}];return typeof s=="number"?d.push({type:"float32",data:[Number.parseFloat(s.toFixed(2))]}):d.push({type:"float32",data:s}),i.runWebGPUProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g1e=Mt({opType:Ee.ROUND}),y1e={kernelName:vx,backendName:"webgpu",kernelFunc:g1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v1e=Mt({opType:Ee.RSQRT,cpuKernelImpl:Oye}),x1e={kernelName:xx,backendName:"webgpu",kernelFunc:v1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let mg=class{constructor(e,n,r,a,s,o,i,l=!0){this.variableNames=["updates","indices"],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=o,this.type=i,this.sumDupeIndices=l,this.dispatchLayout=Be(e),this.dispatch=Pe(this.dispatchLayout,e,this.workgroupSize),this.sliceDimGreaterThanOne=n>1,this.shaderKey=`scatter_${r}_${a}_${this.sliceDimGreaterThanOne}_${i}_${l}_${s.length}`;const u=nr(s.length);this.uniforms=`sliceDim : i32, strides: ${u}, updatesSize: i32,`,this.updatesRank=a,this.indicesRank=r}getUserCode(){let e="";this.indicesRank===1?e="coords[0]":this.indicesRank===2&&(e="coords[0], j");const n=`getIndices(${e})`,r=this.sliceDimGreaterThanOne?"uniforms.strides[j]":"uniforms.strides";let a="",s="";this.dispatchLayout.x.length===1?(a="flattenedIndex",s=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> i32 {
        return index;
      }
      `):this.dispatchLayout.x.length===2&&(a="vec2<i32>(flattenedIndex, coords[1])",s=`
      fn getUpdatesCoordsFromFlatIndex(index : i32) -> vec2<i32> {
        // N.B. |updates| could be a scalar tensor, conceptually representing a
        // 2D tensor with all values equal to that. By design, its size must be
        // the same as |outShape[1]| in one dimension, and |indicesShape[0]|
        // gives the other.
        let sliceSize = uniforms.outShape[1];
        let d0 = index / sliceSize;
        let d1 = index - d0 * sliceSize;
        return vec2<i32>(d0, d1);
      }
      `);const i=`getUpdates(${Array.from({length:this.updatesRank},(u,c)=>`coords[${c}]`).join(", ")})`;return`
    ${s}
      ${Ae("index")} {
        if (index < uniforms.updatesSize) {
          let coords = getUpdatesCoordsFromFlatIndex(index);
          var flattenedIndex = 0;
          for (var j = 0; j < uniforms.sliceDim; j = j + 1) {
            let indexInside = i32(round(${n}));
            flattenedIndex = flattenedIndex + indexInside * ${r};
          }
          let updateValue =
              ${Ku(this.type)}(${i});
          let flatIndex = getOutputIndexFromCoords(${a});

          ${this.sumDupeIndices?hu("&result[flatIndex]","updateValue",this.type):"atomicStore(&result[flatIndex], bitcast<i32>(updateValue));"}
        }
      }`}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b1e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:s}=e,{shape:o}=r,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=jo(s,a,o),f=[d/u,u];if(d===0)return n.makeTensorInfo(o,a.dtype);const h=He({inputs:{x:a},backend:n,attrs:{shape:[l,i]}}),p=He({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=p.dtype,y=Ia({backend:n,attrs:{shape:f,value:0,dtype:g}}),v=ne(p.shape),x=[{type:"int32",data:[i]},{type:"int32",data:c},{type:"int32",data:[v]}],b=new mg(p.shape,i,h.shape.length,p.shape.length,c,f,g),w=n.runWebGPUProgram(b,[p,h],g,x,y),C=He({inputs:{x:w},backend:n,attrs:{shape:o}});return n.disposeData(h.dataId),n.disposeData(p.dataId),n.disposeData(w.dataId),C}const w1e={kernelName:vp,backendName:"webgpu",kernelFunc:b1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let S1e=class{constructor(e,n){this.outputShape=[],this.variableNames=["sortedSequence","values"],this.uniforms="numInputs : i32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.side=n,this.shaderKey=`search_sorted_${n}`}getUserCode(){return`
      fn findBound(batch: i32, value: f32) -> i32 {
        var left = i32(0);
        var right = uniforms.numInputs;
        while (left < right) {
          var mid = (left + right) / 2;
          if (getSortedSequence(batch, mid) ${this.side==="left"?"<":"<="} value) {
            left = mid + 1;
          } else {
            right = mid;
          }
        }
        return right;
      }

      ${Ae("index")} {
        if (index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let value = getValuesByOutputIndex(index);
          setOutputAtIndexI32(index, findBound(coords[0], value));
        }
      }
    `}};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1e(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:s}=e,{side:o}=r,i=new S1e([s.shape[0],s.shape[1]],o),l=[{type:"int32",data:[a.shape[1]]}];return n.runWebGPUProgram(i,[a,s],"int32",l)}const _1e={kernelName:bp,backendName:"webgpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let $1e=class{constructor(e,n,r){this.variableNames=["c","a","b"],this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=n,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.cRank=e,this.rank=r,this.shaderKey="select"}getUserCode(){let e,n;if(this.rank>4)throw Error(`Where for rank ${this.rank} is not yet supported`);if(this.rank===1)n="resRC",e="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let i=0;i<this.outputShape.length;i++)o.push(`${a[i]}`),i<this.cRank&&s.push(`${a[i]}`);e=s.join(),n=o.join()}return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          let cVal = getC(${e});
          if (cVal >= 1.0) {
            setOutputAtIndex(index, getA(${n}));
          } else {
            setOutputAtIndex(index, getB(${n}));
          }
        }
      }
    `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:s}=e,o=new $1e(r.shape.length,a.shape,a.shape.length);return n.runWebGPUProgram(o,[r,a,s],pa(a.dtype,s.dtype))}const N1e={kernelName:bx,backendName:"webgpu",kernelFunc:k1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1e=Mt({opType:Ee.SELU}),T1e={kernelName:wx,backendName:"webgpu",kernelFunc:I1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1e=Mt({opType:Ee.SIGMOID}),A1e={kernelName:kx,backendName:"webgpu",kernelFunc:E1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1e=Mt({opType:Ee.SIGN}),O1e={kernelName:$x,backendName:"webgpu",kernelFunc:P1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R1e=Mt({opType:Ee.SIN}),D1e={kernelName:Cx,backendName:"webgpu",kernelFunc:R1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1e=Mt({opType:Ee.SINH}),M1e={kernelName:_x,backendName:"webgpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F1e=Mt({opType:Ee.SOFTPLUS}),L1e={kernelName:Nx,backendName:"webgpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B1e{constructor(e,n,r,a,s,o){this.variableNames=["x"],this.outputShape=[],this.uniforms="",this.workgroupSize=[64,1,1],this.size=!0;const i=new Array(a.length);for(let l=0;l<i.length;l++)i[l]=a[s[l]];this.outputShape=i,this.newDim=s,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.xShape=e,this.paddedXShape=n,this.uniforms+=`reshapedPaddedXShape : ${nr(a.length)}, paddedXShapeStrides : ${nr(o)}, `,r.map((l,u)=>{this.uniforms+=` pad${u} : vec2<i32>,`}),this.shaderKey=`spaceToBatchND_${s}`}getUserCode(){const e=nr(this.outputShape.length),n=gG(this.newDim);return`
      ${q0(this.paddedXShape,"PaddedX")}
      ${Ae("index")} {
        if(index < uniforms.size) {
          let coords = getCoordsFromIndex(index);
          let switchedIndex = getIndexFromCoords${this.outputShape.length}D(${e}(${n}), uniforms.reshapedPaddedXShape);
          let paddedCoords = getPaddedXCoordsFromIndex(switchedIndex);
          ${DG(this.xShape,!0)}
        }
      }
    `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1e=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,paddings:o}=r;j(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGPU backend not implemented yet");const i=s.reduce((x,b)=>x*b),l=[[0,0]];l.push(...o);for(let x=1+s.length;x<a.shape.length;++x)l.push([0,0]);const u=l.map((x,b)=>x[0]+a.shape[b]+x[1]),c=ad(u,s,i,!1),d=sd(c.length,s.length,!1),f=od(u,s,i,!1),h=Dt(u),p=new B1e(a.shape,u,l,c,d,h.length),g=[{type:"int32",data:c},{type:"int32",data:h}];l.map(x=>g.push({type:"int32",data:[x[0],x[1]]}));const y=n.runWebGPUProgram(p,[a],a.dtype,g),v=He({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeData(y.dataId),v},U1e={kernelName:Tx,backendName:"webgpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V1e{constructor(e,n,r){this.variableNames=["input","indices","segmentIds"],this.outputShape=[],this.uniforms="segmentSize : i32, sparseSize : i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=e,this.type=r,this.dispatchLayout=Be([n]),this.dispatch=Pe(this.dispatchLayout,[n],this.workgroupSize),this.shaderKey="sparseSegmentSum"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.sparseSize) {
        let indexInSegmentIds = index / uniforms.segmentSize;
        let indexInSegment = index % uniforms.segmentSize;
        let indexInInput = indices[indexInSegmentIds];
        let segmentId = segmentIds[indexInSegmentIds];

        let value = input[indexInInput * uniforms.segmentSize + indexInSegment];
        let outIndex = segmentId * uniforms.segmentSize + indexInSegment;
        ${hu("&result[outIndex]","value",this.type)}
      }
    }
  `}}class W1e{constructor(e,n){this.variableNames=["segmentIds"],this.outputShape=[],this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=[e],this.dispatchLayout=Be(n),this.dispatch=Pe(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="sparseSegmentIdCountProgram"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.segmentIdsShape) {
        let segmentId = segmentIds[index];
        ${hu("&result[segmentId]","1","int32")}
      }
    }
  `}}class G1e{constructor(e,n){this.variableNames=["segmentSum","sameSegmentIdCount"],this.outputShape=[],this.uniforms="segmentSize : i32",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.type=n,this.dispatchLayout=Be(e),this.dispatch=Pe(this.dispatchLayout,e,this.workgroupSize),this.shaderKey="sparseSegmentMean"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.size) {
        let segmentId = index / uniforms.segmentSize;
        let count = sameSegmentIdCount[segmentId];
        if (count != 0) {
          ${this.type==="float32"?"setOutputAtIndex(index, segmentSum[index] / f32(count));":"setOutputAtIndexI32(index, segmentSum[index] / count);"}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t,e,n,r=!1,a){const o=ne(t.shape)/t.shape[0],i=t.dtype,l=ne(e.shape),u=a.readSync(n.dataId),d=l>0?u[l-1]+1:0;let f;const h=t.shape.slice();h[0]=d;const p=l*o,g=Ia({backend:a,attrs:{shape:h,value:0,dtype:i}});f=new V1e(h,p,i);let y=[{type:"int32",data:[o]},{type:"int32",data:[p]}];const v=a.runWebGPUProgram(f,[t,e,n],i,y,g);if(r)return v;const x=Ia({backend:a,attrs:{shape:[d],value:0,dtype:"int32"}});f=new W1e(d,n.shape);const b=a.runWebGPUProgram(f,[n],"int32",null,x),w=Ia({backend:a,attrs:{shape:h,value:0,dtype:i}});f=new G1e(h,i),y=[{type:"int32",data:[o]}];const C=a.runWebGPUProgram(f,[v,b],i,y,w);return a.disposeData(v.dataId),a.disposeData(b.dataId),C}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:s}=e;return jG(r,a,s,!1,n)}const q1e={kernelName:Px,backendName:"webgpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1e(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:s}=e;return jG(r,a,s,!0,n)}const X1e={kernelName:Ox,backendName:"webgpu",kernelFunc:K1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Y1e=class{constructor(e,n){this.variableNames=["A"],this.workgroupSize=[64,1,1],this.size=!0;const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[a]*n[a];this.outputShape=r,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.rank=this.outputShape.length,this.shaderKey="tile"}getUserCode(){const e=Q1e(this.rank,"uniforms.");return`
      ${Ae("index")} {
        if (index < uniforms.size) {
          let resRC = getCoordsFromIndex(index);
          setOutputAtIndex(index, getA(${e}));
        }
      }
    `}};function Q1e(t,e=""){if(t>=5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`(resRC % ${e}aShape)`;const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<t;a++)r.push(`(${n[a]} % ${e}aShape[${a}])`);return r.join()}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IP(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:s}=r;if(n.shouldExecuteOnCPU([a])||a.dtype==="string"||a.shape.length>=5){const l=n.readSync(a.dataId),u=a.dtype==="string"?l.map(f=>si(f)):l,c=en(a.shape,a.dtype,u),d=Bye(c,s);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new Y1e(a.shape,s);return n.runWebGPUProgram(o,[a],a.dtype)}const J1e={kernelName:Zc,backendName:"webgpu",kernelFunc:IP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1e(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:s,defaultValue:o}=e,{outputShape:i}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=jo(s,a,i),h=!1;if(s.dtype==="string"){const k=n.bufferSync(a),A=n.bufferSync(s),P=si(n.readSync(o.dataId)[0]),O=Rye(k,A,i,f,c,u,l,d,P,h);return n.makeTensorInfo(i,O.dtype,O.values)}const p=[f/c,c],g=He({inputs:{x:a},backend:n,attrs:{shape:[u,l]}}),y=s.shape.length?He({inputs:{x:s},backend:n,attrs:{shape:[u,c]}}):es({inputs:{x:s},backend:n}),v=y.dtype,x=n.makeTensorInfo([],v,ai(1,v)),b=He({inputs:{x:o},backend:n,attrs:{shape:Array(p.length).fill(1)}}),w=IP({inputs:{x:b},backend:n,attrs:{reps:p}}),C=ne([u,c]),_=[{type:"int32",data:[l]},{type:"int32",data:d},{type:"int32",data:[C]}];switch(u){case 0:break;case 1:{const k=new mg([u,c],l,g.shape.length,y.shape.length,d,p,v,h);n.runWebGPUProgram(k,[y,g],v,_,w)}break;default:{const k=new mg([u,c],l,g.shape.length,x.shape.length,d,p,v,h);n.runWebGPUProgram(k,[x,g],v,_,w)}{const k=new mg([u,c],l,g.shape.length,y.shape.length,d,p,v);n.runWebGPUProgram(k,[y,g],v,_,w)}}const $=He({inputs:{x:w},backend:n,attrs:{shape:i}});return n.disposeData(g.dataId),n.disposeData(y.dataId),n.disposeData(b.dataId),n.disposeData(x.dataId),n.disposeData(w.dataId),$}const eSe={kernelName:Cp,backendName:"webgpu",kernelFunc:Z1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:s,axis:o}=r,i=Yt(o,a.shape)[0],l=w2(a,s,i),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(f=>{const h=[...d];h[i]=f;const p=Op({inputs:{x:a},backend:n,attrs:{begin:c,size:h}});return c[i]+=f,p})}const nSe={kernelName:Ex,backendName:"webgpu",kernelFunc:tSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe=Mt({opType:Ee.SQRT}),aSe={kernelName:Ix,backendName:"webgpu",kernelFunc:rSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sSe={kernelName:US,backendName:"webgpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e,a=new Pp(n.shape,Ee.SQUARE);return r.runWebGPUProgram(a,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe=$r({opType:rt.SQUARED_DIFFERENCE}),iSe={kernelName:Rx,backendName:"webgpu",kernelFunc:oSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe({inputs:t,attrs:e,backend:n}){const{x:r}=t,a=new Pp(r.shape,Ee.STEP,"stepAlpha : f32,"),s=[{type:"float32",data:[e.alpha]}];return n.runWebGPUProgram(a,[r],r.dtype,s)}const uSe={kernelName:Np,backendName:"webgpu",kernelFunc:lSe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cSe=class{constructor(e){this.variableNames=["x"],this.workPerThread=1,this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize,[this.workPerThread,1,1]);const n=nr(this.outputShape.length);this.uniforms=`begin : ${n},  strides : ${n}, `,this.shaderKey="stridedSlice"}getUserCode(){const e=this.outputShape.length;let n="";if(e===1)n="coords * uniforms.strides + uniforms.begin";else{let a=0;n=this.outputShape.map((s,o)=>(a++,this.outputShape.length===1?`coords * uniforms.strides[${o}] + uniforms.begin[${o}]`:`coords[${a-1}] * uniforms.strides[${o}] + uniforms.begin[${o}]`)).join(",")}return`
       ${Ae("index")} {
         if (index < uniforms.size) {
           let coords = getCoordsFromIndex(index);
           setOutputAtIndex(index, getX(${n}));
         }
       }
     `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:s,end:o,strides:i,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:y,isSimpleSlice:v,begin:x,end:b,strides:w}=m2(a.shape,s,o,i,l,u,c,d,f);let C;if(g)C=He({inputs:{x:a},backend:n,attrs:{shape:p}});else if(y||v){j(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const _=d2(x,b,w),$=Op({inputs:{x:a},backend:n,attrs:{begin:x,size:_}});C=He({inputs:{x:$},backend:n,attrs:{shape:p}}),n.disposeData($.dataId)}else if(n.shouldExecuteOnCPU([a])){const $=n.readSync(a.dataId),k=en(a.shape,a.dtype,$),A=Mye(h,k,w,x);C=n.makeTensorInfo(p,a.dtype,A.values)}else{const $=new cSe(h),k=[{type:"int32",data:x},{type:"int32",data:w}],A=n.runWebGPUProgram($,[a],a.dtype,k);C=He({inputs:{x:A},backend:n,attrs:{shape:p}}),n.disposeData(A.dataId)}return C}const fSe={kernelName:_p,backendName:"webgpu",kernelFunc:dSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:s,leftPad:o,rightPad:i,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,g]=Fye(f,h,a,s,o,i,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const pSe={kernelName:Dx,backendName:"webgpu",kernelFunc:hSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mSe=$r({opType:rt.SUB,cpuKernelImpl:Lye,supportsComplex:!0}),gSe={kernelName:jx,backendName:"webgpu",kernelFunc:mSe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe=Mt({opType:Ee.TAN}),vSe={kernelName:Mx,backendName:"webgpu",kernelFunc:ySe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe=Mt({opType:Ee.TANH}),bSe={kernelName:Fx,backendName:"webgpu",kernelFunc:xSe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:a,indices:s,updates:o}=e,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=jo(o,s,a.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(a.shape,s.dtype);const h=[],p=He({inputs:{x:s},backend:n,attrs:{shape:[l,i]}});h.push(p);const g=He({inputs:{x:o},backend:n,attrs:{shape:[l,u]}});h.push(g);const y=He({inputs:{x:a},backend:n,attrs:{shape:f}});h.push(y);const v=IP({inputs:{x:y},backend:n,attrs:{reps:Array(f.length).fill(1)}}),x=new mg([l,u],i,p.shape.length,g.shape.length,c,f,a.dtype,!1),b=ne([l,u]),w=[{type:"int32",data:[i]},{type:"int32",data:c},{type:"int32",data:[b]}],C=n.runWebGPUProgram(x,[g,p],y.dtype,w,v);h.push(C);const _=He({inputs:{x:C},backend:n,attrs:{shape:a.shape}});return h.forEach($=>n.disposeData($.dataId)),_}const SSe={kernelName:xp,backendName:"webgpu",kernelFunc:wSe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let CSe=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms=`inputSize : i32, firstPass : i32, negativeInf : f32,
        dir : i32, inc : i32,`,this.shaderKey="swap"}getUserCode(){return`
        ${Ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // We compare elements pair-wise within a group of size 2 * inc.
            // The comparing rule for each group alternates between ascending
            // and descending. Within each group, we compare each pair at
            // positions i and i+inc. To decide whether an element at position i
            // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
            // inc, it is in the first half of the group, we denote it as x0,
            // otherwise we denote it as x1.
            // For example, as shown in the Bitonic top K paper referenced
            // above, Figure5(a) shows that element[1] is in the second half of
            // the group when group size is 2, but it is in the first half of
            // the group when group size is 4.
            let isFirstInPair = elemIdx % (2 * uniforms.inc) < uniforms.inc;
            var i = 0;
            if (isFirstInPair) {
              i = elemIdx;
            } else {
              i = elemIdx - uniforms.inc;
            }

            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }

            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.inc;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.inc));
            }

            var x0 = f32(0.0);
            var x1 = f32(0.0);
            if (i0 < uniforms.inputSize) {
              x0 = getX(batch, i0);
            } else {
              x0 = uniforms.negativeInf;
            }
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = uniforms.negativeInf;
            }

            let reverse = elemIdx % (2 * uniforms.dir) >= uniforms.dir;
            let isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
            if (reverse == isGreater) {
              // Elements in opposite order of direction
              let iTemp = i0;
              i0 = i1;
              i1 = iTemp;
            }
            if (isFirstInPair) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}},_Se=class{constructor(e){this.variableNames=["x","indices"],this.workgroupSize=[256,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.uniforms="inputSize : i32, firstPass : i32, k : i32,",this.shaderKey="merge"}getUserCode(){return`
        ${Ae("index")} {
          if (index < uniforms.size) {
            let outC = getCoordsFromIndex(index);
            let batch = outC[0];
            let elemIdx = outC[1];
            // The output size is half of the previous size.
            // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _
            // (k=4), we only need to output the indices at positions |, the
            // indices at positions _ can be thrown away, see Figure5(b) After
            // Phase 2 (Merge phase) in the Bitonic Top K paper referenced
            // above.
            // For example, the paper shows we only need to output the orange
            // bars. The output sequence should look like this | | | | | | | |.
            // Because the sequence is halved, to map the output index back to
            // the previous sequence to find the corresponding value, we need
            // to double the index. When we double the index, we basically
            // interpolate a position, so 2i looks like
            // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k
            // position of each 2k positions by - elemIdx % k. E.g. for output
            // at index 4,5,6,7, we want to get the corresponding element at
            // original index 8,9,10,11, for output at index 8,9,10,11,
            // we want to get the corresponding element at original index
            // 16,17,18,19, so on and so forth.

            var i = 0;
            if (elemIdx < uniforms.k) {
              i = elemIdx;
            } else {
              i = elemIdx * 2 - elemIdx % uniforms.k;
            }
            var i0 = 0;
            if (uniforms.firstPass == 1) {
              i0 = i;
            } else {
              i0 = i32(getIndices(batch, i));
            }
            var i1 = 0;
            if (uniforms.firstPass == 1) {
              i1 = i + uniforms.k;
            } else {
              i1 = i32(getIndices(batch, i + uniforms.k));
            }

            let x0 = getX(batch, i0);
            var x1 = f32(0.0);
            if (i1 < uniforms.inputSize) {
              x1 = getX(batch, i1);
            } else {
              x1 = x0;
            }

            if (x0 >= x1) {
              setOutputAtIndex(index, f32(i0));
            } else {
              setOutputAtIndex(index, f32(i1));
            }
          }
        }
      `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Od(t,e){e!==null&&t.disposeData(e.dataId)}function K3(t){let e=1;for(;e<t;)e*=2;return e}function $Se(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:s,sorted:o}=r,i=a.shape,l=i[i.length-1];if(n.shouldExecuteOnCPU([a])){const C=n.readSync(a.dataId),[_,$]=zye(C,i,a.dtype,s,o);return[n.makeTensorInfo(_.shape,_.dtype,_.values),n.makeTensorInfo($.shape,$.dtype,$.values)]}if(s===0)return i[i.length-1]=0,[n.makeTensorInfo(i,a.dtype,[]),n.makeTensorInfo(i,"int32",[])];if(l===1)return[a,Ia({attrs:{shape:i,dtype:"int32",value:0},backend:n})];const c=ne(i)/l,d=He({inputs:{x:a},attrs:{shape:[c,l]},backend:n}),f=K3(s),h=K3(l);let p=null;const g=()=>p===null?[d,d]:[d,p],y=(C,_,$)=>{const k=g(),A=new CSe($),O=[{type:"int32",data:[l]},{type:"int32",data:[p===null?1:0]},{type:"float32",data:[Number.NEGATIVE_INFINITY]},{type:"int32",data:[C]},{type:"int32",data:[_]}],R=p;p=n.runWebGPUProgram(A,k,"int32",O),Od(n,R)};for(let C=1;C<f;C*=2){const _=C*2;for(let $=C;$>=1;$/=2)y(_,$,[c,h])}for(let C=h;C>f;C/=2){const _=g(),$=new _Se([c,C/2]),A=[{type:"int32",data:[l]},{type:"int32",data:[p===null?1:0]},{type:"int32",data:[f]}],P=p;p=n.runWebGPUProgram($,_,"int32",A),Od(n,P);const O=f/2,R=O*2;for(let B=O;B>=1;B/=2)y(R,B,p.shape)}let v=p;p=Op({inputs:{x:p},backend:n,attrs:{begin:0,size:[c,s]}}),Od(n,v);let x=AG({inputs:{x:d,indices:p},backend:n,attrs:{axis:1,batchDims:1}});Od(n,d);const b=i.slice(0,-1);b.push(s),v=p,p=He({inputs:{x:p},attrs:{shape:b},backend:n}),Od(n,v);const w=x;return x=He({inputs:{x},attrs:{shape:b},backend:n}),Od(n,w),[x,p]}const kSe={kernelName:$p,backendName:"webgpu",kernelFunc:$Se};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let NSe=class{constructor(e){this.variableNames=["Image","Transforms"],this.uniforms="interpolationModeId : i32, fillModeId : i32, fillValue : f32,",this.workgroupSize=[64,1,1],this.size=!0,this.outputShape=e,this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="transform"}getUserCode(){return`
          fn mapCoord(outCoord : f32, len : f32) -> f32{
            var inCoord = outCoord;
            if(uniforms.fillModeId == 2) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  if (inCoord < sz2) {
                    inCoord = sz2 * f32(i32(f32(-inCoord / sz2))) +
                    inCoord;
                  }
                  if (inCoord < -len) {
                    inCoord = inCoord + sz2;
                  } else {
                    inCoord = -inCoord - 1.0;
                  }
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz2 = 2.0 * len;
                  inCoord = inCoord - sz2 * f32(i32(f32(inCoord / sz2)));
                  if (inCoord >= len) {
                    inCoord = sz2 - inCoord - 1.0;
                  }
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 3) {
              if (inCoord < 0.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord + len * (f32(i32(f32(-inCoord / sz))) + 1.0);
                }
              } else if (inCoord > len - 1.0) {
                if (len <= 1.0) {
                  inCoord = 0.0;
                } else {
                  let sz = len - 1.0;
                  inCoord = inCoord - len * f32(i32(f32(inCoord / sz)));
                }
              }
              return clamp(inCoord, 0.0, len - 1.0);
            } else if (uniforms.fillModeId == 4) {
              return clamp(outCoord, 0.0, len - 1.0);
            }
            return outCoord;
          }
          fn readWithFillValue(batch : i32, coordY : i32, coordX : i32,
            channel : i32) -> f32 {
            var outputValue : f32;
            if (0 <= coordY && coordY < uniforms.imageShape[1] && 0 <= coordX && coordX < uniforms.imageShape[2]) {
                outputValue = getImage(batch, coordY, coordX, channel);
            } else {
              outputValue = uniforms.fillValue;
            }
            return outputValue;
          }

          ${Ae("index")} {
            if (index < uniforms.size) {
              let coords = getCoordsFromIndex(index);
              var outputValue : f32;
              let batch = coords[0];
              let x = coords[2];
              let y = coords[1];
              let channel = coords[3];
              let xf = f32(x);
              let yf = f32(y);
              let a1 = getTransforms(batch, 0);
              let a2 = getTransforms(batch, 1);
              let a3 = getTransforms(batch, 2);
              let b1 = getTransforms(batch, 3);
              let b2 = getTransforms(batch, 4);
              let b3 = getTransforms(batch, 5);
              let c1 = getTransforms(batch, 6);
              let c2 = getTransforms(batch, 7);
              let projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = uniforms.fillValue;
              } else {
                let inX = (a1 * xf + a2 * yf + a3) / projection;
                let inY = (b1 * xf + b2 * yf + b3) / projection;
                let mapX = mapCoord(inX, f32(uniforms.imageShape[2]));
                let mapY = mapCoord(inY, f32(uniforms.imageShape[1]));

                if (uniforms.interpolationModeId == 1) {
                  let coordY = i32(round(mapY));
                  let coordX = i32(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  let yFloor = floor(mapY);
                  let xFloor = floor(mapX);
                  let yCeil = yFloor + 1.0;
                  let xCeil = xFloor + 1.0;
                  let valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yFloor), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yFloor), i32(xCeil), channel);
                  let valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, i32(yCeil), i32(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, i32(yCeil), i32(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutputAtIndex(index, outputValue);
            }
          }
        `}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:s}=e,{interpolation:o,fillMode:i,fillValue:l,outputShape:u}=r,[c,d,f,h]=a.shape,[p,g]=u??[d,f],y=[c,p,g,h],v=new NSe(y),x=o==="nearest"?1:2;let b;switch(i){case"constant":b=1;break;case"reflect":b=2;break;case"wrap":b=3;break;case"nearest":b=4;break;default:b=1;break}const w=[{type:"int32",data:[x]},{type:"int32",data:[b]},{type:"float32",data:[l]}];return n.runWebGPUProgram(v,[a,s],"float32",w)}const TSe={kernelName:kp,backendName:"webgpu",kernelFunc:ISe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:s}=r;s<0&&(s+=a.shape.length);const o=a,i=o.shape.length,l=a.shape[s],u=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==s&&(u[c++]=o.shape[g]);const d=[],f=new Array(i).fill(0),h=o.shape.slice();h[s]=1;const p=new Array(l);for(let g=0;g<p.length;g++){f[s]=g;const y=Op({inputs:{x:o},backend:n,attrs:{begin:f,size:h}}),v=He({inputs:{x:y},backend:n,attrs:{shape:u}});p[g]=v,d.push(y)}return d.forEach(g=>n.disposeData(g.dataId)),p}const ASe={kernelName:Lx,backendName:"webgpu",kernelFunc:ESe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PSe{constructor(e,n,r){if(this.outputShape=[],this.variableNames=["x","segmentIds"],this.uniforms="numSegments : i32, xSize: i32,",this.workgroupSize=[64,1,1],this.atomic=!0,this.outputShape=n,this.dispatchLayout=Be(e),this.dispatch=Pe(this.dispatchLayout,e,this.workgroupSize),r!=="float32"&&r!=="int32")throw new Error(`UnsortedSegmentSum only supports float32 and int32
              types, does not support ${r} type.`);this.type=r,this.shaderKey="unsortedSegmentSum"}getUserCode(){return`
    ${Ae("index")} {
      if (index < uniforms.xSize) {
        let coords = getXCoordsFromIndex(index);
        let b = coords[0];
        let inCol = coords[1];

        let segmentId = i32(getSegmentIds(inCol));
        if (segmentId >= 0) {
          let flatIndex = b * uniforms.numSegments + segmentId % uniforms.numSegments;
          let value = getX(b, inCol);

          ${hu("&result[flatIndex]","value",this.type)}
        }
      }
    }
  `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:s}=e,{numSegments:o}=r,i=a.shape.length,l=[];let u=0;const c=gr([u],i);let d=a;c!=null&&(d=fi({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=Qn(1,i)[0]);const f=SP(d.shape,u,o),h=ne([d.shape[u]]),p=He({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(p);const g=a.dtype,y=[p.shape[0],o],v=Ia({backend:n,attrs:{shape:y,value:0,dtype:g}}),x=new PSe(p.shape,y,g),b=[{type:"int32",data:[o]},{type:"int32",data:[ne(p.shape)]}],w=n.runWebGPUProgram(x,[p,s],g,b,v),C=He({inputs:{x:w},backend:n,attrs:{shape:f}});l.push(w);let _=C;if(c!=null){l.push(C);const $=nd(c);_=fi({inputs:{x:_},backend:n,attrs:{perm:$}})}return l.forEach($=>n.disposeData($.dataId)),_}const RSe={kernelName:HS,backendName:"webgpu",kernelFunc:OSe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe=[uge,Wye,Hye,Kye,Yye,Zye,ove,lve,cve,fve,pve,gve,vve,bve,Sve,Nve,Tve,Ove,Dve,Mve,Uve,Hve,Xve,Zve,txe,sxe,dge,lxe,fxe,bxe,kxe,Exe,Oxe,Dxe,Mxe,Lxe,zxe,Wxe,Hxe,Kxe,Yxe,Zxe,obe,lbe,nbe,dbe,pbe,vbe,bbe,Cbe,Nbe,Tbe,Abe,Obe,Dbe,Mbe,Fbe,Bbe,Ube,oge,Wbe,Ybe,Hbe,Kbe,Zbe,t0e,r0e,o0e,u0e,d0e,h0e,cge,m0e,cxe,y0e,x0e,w0e,C0e,$0e,N0e,E0e,R0e,P0e,j0e,F0e,B0e,W0e,q0e,_ve,X0e,Q0e,swe,Z0e,rwe,iwe,$ve,uwe,dwe,hwe,mwe,bwe,_be,Swe,_we,kwe,Yve,Twe,Awe,Owe,jwe,Fwe,Bwe,Uwe,Wwe,Qve,Hwe,Kwe,Ywe,Jwe,ige,t1e,a1e,i1e,c1e,h1e,m1e,y1e,x1e,w1e,_1e,N1e,T1e,A1e,O1e,D1e,M1e,Bve,uSe,fSe,pSe,vwe,L1e,U1e,q1e,X1e,eSe,nSe,aSe,sSe,iSe,gSe,$be,vSe,bSe,SSe,J1e,kSe,TSe,nve,ASe,RSe,Ewe];for(const t of DSe)zx(t);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var MG=function(t,e){return(MG=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])})(t,e)};function FG(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}MG(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var yn=function(){return(yn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function Ot(t,e,n,r){return new(n||(n=Promise))(function(a,s){function o(u){try{l(r.next(u))}catch(c){s(c)}}function i(u){try{l(r.throw(u))}catch(c){s(c)}}function l(u){var c;u.done?a(u.value):(c=u.value,c instanceof n?c:new n(function(d){d(c)})).then(o,i)}l((r=r.apply(t,[])).next())})}function Rt(t,e){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function i(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(a=o.trys,!((a=a.length>0&&a[a.length-1])||c[0]!==6&&c[0]!==2)){o=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(c[0]===6&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(d){c=[6,d],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function rc(t,e,n){if(n||arguments.length===2)for(var r,a=0,s=e.length;a<s;a++)!r&&a in e||(r||(r=Array.prototype.slice.call(e,0,a)),r[a]=e[a]);return t.concat(r||Array.prototype.slice.call(e))}var hi=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],dy=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function Gw(t){return t instanceof SVGAnimatedLength?t.baseVal.value:t}function LG(t){return Ot(this,void 0,void 0,function(){var e,n;return Rt(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),t instanceof cn?[4,c2(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=Gw(t.width),e.height=Gw(t.height),n=e.getContext("2d"),t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),r.label=3;case 3:return[2,e]}})})}function BG(t){return Ot(this,void 0,void 0,function(){var e,n,r,a,s,o;return Rt(this,function(i){switch(i.label){case 0:return t instanceof cn?(e=t.shape.slice(0,2),n=e[0],r=e[1],a=ImageData.bind,[4,c2(t)]):[3,2];case 1:return[2,new(a.apply(ImageData,[void 0,i.sent(),r,n]))];case 2:return s=document.createElement("canvas"),o=s.getContext("2d"),s.width=Gw(t.width),s.height=Gw(t.height),o.drawImage(t,0,0),[2,o.getImageData(0,0,s.width,s.height)]}})})}function jSe(t){return Ot(this,void 0,void 0,function(){var e,n;return Rt(this,function(r){switch(r.label){case 0:return t instanceof SVGImageElement||t instanceof OffscreenCanvas?[4,LG(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return e=n,[2,KA(e,4)]}})})}function zG(t){if(t<0||t>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(t));if(!Number.isInteger(t))throw new Error("Mask value must be an integer but got ".concat(t))}var Pm={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},MSe=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,this.mask]})})},t.prototype.toImageData=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,BG(this.mask)]})})},t.prototype.toTensor=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,jSe(this.mask)]})})},t.prototype.getUnderlyingType=function(){return"canvasimagesource"},t}();function FSe(t){return zG(t),"person"}var LSe=function(){function t(e){var n,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new zre.Pose({locateFile:function(a,s){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(a)}return"".concat(s,"/").concat(a)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(a){if(r.height=a.image.height,r.width=a.image.width,a.poseLandmarks==null)r.poses=[];else{var s=r.translateOutput(a.poseLandmarks,a.poseWorldLandmarks);a.segmentationMask&&(s.segmentation={maskValueToLabel:FSe,mask:new MSe(a.segmentationMask)}),r.poses=[s]}})}return t.prototype.translateOutput=function(e,n){var r=this,a={keypoints:e.map(function(s,o){return{x:s.x*r.width,y:s.y*r.height,z:s.z,score:s.visibility,name:dy[o]}})};return n!=null&&(a.keypoints3D=n.map(function(s,o){return{x:s.x,y:s.y,z:s.z,score:s.visibility,name:dy[o]}})),a},t.prototype.estimatePoses=function(e,n,r){return Ot(this,void 0,void 0,function(){var a,s;return Rt(this,function(o){switch(o.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof cn?(s=ImageData.bind,[4,c2(e)]):[3,2];case 1:return a=new(s.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:a=e,o.label=3;case 3:return e=a,[4,this.poseSolution.send({image:e},r)];case 4:return o.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function BSe(t){return Ot(this,void 0,void 0,function(){var e,n;return Rt(this,function(r){switch(r.label){case 0:return e=function(a){if(a==null)return yn({},Pm);var s=yn({},a);return s.runtime="mediapipe",s.enableSegmentation==null&&(s.enableSegmentation=Pm.enableSegmentation),s.enableSmoothing==null&&(s.enableSmoothing=Pm.enableSmoothing),s.smoothSegmentation==null&&(s.smoothSegmentation=Pm.smoothSegmentation),s.modelType==null&&(s.modelType=Pm.modelType),s}(t),[4,(n=new LSe(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function Jf(t){return t instanceof cn?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function UG(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function TP(t){return t instanceof cn?t:KA(t)}function VG(t,e,n){return vN(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}function vN(t,e){j(t.width!==0,function(){return"".concat(e," width cannot be 0.")}),j(t.height!==0,function(){return"".concat(e," height cannot be 0.")})}function P_(t,e,n){var r=n.rotationVectorStartKeypointIndex,a=n.rotationVectorEndKeypointIndex,s=t.locationData,o=s.relativeKeypoints[r].x*e.width,i=s.relativeKeypoints[r].y*e.height,l=s.relativeKeypoints[a].x*e.width,u=s.relativeKeypoints[a].y*e.height,c=2*Math.sqrt((l-o)*(l-o)+(u-i)*(u-i)),d=function(f,h,p){var g,y=f.locationData,v=p.rotationVectorStartKeypointIndex,x=p.rotationVectorEndKeypointIndex;g=p.rotationVectorTargetAngle?p.rotationVectorTargetAngle:Math.PI*p.rotationVectorTargetAngleDegree/180;var b=y.relativeKeypoints[v].x*h.width,w=y.relativeKeypoints[v].y*h.height,C=y.relativeKeypoints[x].x*h.width,_=y.relativeKeypoints[x].y*h.height;return UG(g-Math.atan2(-(_-w),C-b))}(t,e,n);return{xCenter:o/e.width,yCenter:i/e.height,width:c/e.width,height:c/e.height,rotation:d}}function WG(t){if(t.length!==16)throw new Error("Array length must be 16 but got ".concat(t.length));return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}function O_(t,e,n,r,a,s,o){return t[e][a]*(t[n][s]*t[r][o]-t[n][o]*t[r][s])}function aa(t,e,n){var r=(e+1)%4,a=(e+2)%4,s=(e+3)%4,o=(n+1)%4,i=(n+2)%4,l=(n+3)%4;return O_(t,r,a,s,o,i,l)+O_(t,a,s,r,o,i,l)+O_(t,s,r,a,o,i,l)}function X3(t,e,n){n===void 0&&(n={ignoreRotation:!1});for(var r=[],a=0,s=t;a<s.length;a++){var o=s[a],i=o.x-.5,l=o.y-.5,u=n.ignoreRotation?0:e.rotation,c=Math.cos(u)*i-Math.sin(u)*l,d=Math.sin(u)*i+Math.cos(u)*l;c=c*e.width+e.xCenter,d=d*e.height+e.yCenter;var f=o.z*e.width,h=yn({},o);h.x=c,h.y=d,h.z=f,r.push(h)}return r}function GG(t,e){var n=function(r,a,s,o){var i=a-r,l=o-s,u=l/i;return{scale:u,offset:s-r*u}}(0,255,e[0],e[1]);return at(function(){return Ke(_e(t,n.scale),n.offset)})}function xN(t,e,n){var r,a,s,o,i,l,u,c,d,f,h,p,g,y,v=e.outputTensorSize,x=e.keepAspectRatio,b=e.borderMode,w=e.outputTensorFloatRange,C=Jf(t),_=function(A,P){return P?{xCenter:P.xCenter*A.width,yCenter:P.yCenter*A.height,width:P.width*A.width,height:P.height*A.height,rotation:P.rotation}:{xCenter:.5*A.width,yCenter:.5*A.height,width:A.width,height:A.height,rotation:0}}(C,n),$=function(A,P,O){if(O===void 0&&(O=!1),!O)return{top:0,left:0,right:0,bottom:0};var R=P.height,B=P.width;vN(P,"targetSize"),vN(A,"roi");var F,L,H=R/B,te=A.height/A.width,V=0,Q=0;return H>te?(F=A.width,L=A.width*H,Q=(1-te/H)/2):(F=A.height/H,L=A.height,V=(1-H/te)/2),A.width=F,A.height=L,{top:Q,left:V,right:V,bottom:Q}}(_,v,x),k=(r=_,a=C.width,s=C.height,o=!1,i=r.width,l=r.height,u=o?-1:1,c=Math.cos(r.rotation),d=Math.sin(r.rotation),f=r.xCenter,h=r.yCenter,p=1/a,g=1/s,(y=new Array(16))[0]=i*c*u*p,y[1]=-l*d*p,y[2]=0,y[3]=(-.5*i*c*u+.5*l*d+f)*p,y[4]=i*d*u*g,y[5]=l*c*g,y[6]=0,y[7]=(-.5*l*c-.5*i*d*u+h)*g,y[8]=0,y[9]=0,y[10]=i*p,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,WG(y));return{imageTensor:at(function(){var A=TP(t),P=vs(VG(k,C,v),[1,8]),O=b==="zero"?"constant":"nearest",R=Hl.transform(Ga(zt(A,"float32")),P,"bilinear",O,0,[v.height,v.width]);return w!=null?GG(R,w):R}),padding:$,transformationMatrix:k}}function Y3(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function zSe(t){return at(function(){var e=function(a){return at(function(){return[gt(a,[0,0,0],[1,-1,1]),gt(a,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:tn(r),logits:tn(n)}})}function HG(t){return t!=null&&t.currentTime!=null}function Q3(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,o=0;o<t.length;++o){var i=t[o];n=Math.min(n,i.x),r=Math.max(r,i.x),a=Math.min(a,i.y),s=Math.max(s,i.y),e.locationData.relativeKeypoints.push({x:i.x,y:i.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:a,xMax:r,yMax:s,width:r-n,height:s-a},e}function USe(t,e,n,r){return Ot(this,void 0,void 0,function(){var a,s,o,i,l;return Rt(this,function(u){switch(u.label){case 0:return t.sort(function(c,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,c.score)}),a=vs(t.map(function(c){return[c.locationData.relativeBoundingBox.yMin,c.locationData.relativeBoundingBox.xMin,c.locationData.relativeBoundingBox.yMax,c.locationData.relativeBoundingBox.xMax]})),s=jr(t.map(function(c){return c.score[0]})),[4,Hl.nonMaxSuppressionAsync(a,s,e,n)];case 1:return[4,(o=u.sent()).array()];case 2:return i=u.sent(),l=t.filter(function(c,d){return i.indexOf(d)>-1}),Jt([a,s,o]),[2,l]}})})}function qG(t,e){return t.map(function(n){var r=yn(yn({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function VSe(t,e,n){return Ot(this,void 0,void 0,function(){var r,a,s,o,i,l,u,c,d,f,h,p,g,y,v,x,b,w,C,_,$,k,A,P;return Rt(this,function(O){switch(O.label){case 0:if(r=tn(e,[0]),a=r.shape,s=a[0],o=a[1],i=a[2],t.length!==i)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(t.length,", heatmap length: ").concat(i));return l=[],[4,r.buffer()];case 1:for(u=O.sent(),c=0;c<t.length;c++)if(d=t[c],f=yn({},d),l.push(f),h=Math.trunc(f.x*o),p=Math.trunc(f.y*s),!(h<0||h>=o||p<0||h>=s)){for(g=Math.trunc((n.kernelSize-1)/2),y=Math.max(0,h-g),v=Math.min(o,h+g+1),x=Math.max(0,p-g),b=Math.min(s,p+g+1),w=0,C=0,_=0,$=0,k=x;k<b;++k)for(A=y;A<v;++A)P=u.get(k,A,c),w+=P,$=Math.max($,P),C+=A*P,_+=k*P;$>=n.minConfidenceToRefine&&w>0&&(f.x=C/o/w,f.y=_/s/w)}return r.dispose(),[2,l]}})})}function J3(t,e){var n=e.left,r=e.top,a=e.left+e.right,s=e.top+e.bottom;return t.map(function(o){return yn(yn({},o),{x:(o.x-n)/(1-a),y:(o.y-r)/(1-s),z:o.z/(1-a)})})}function WSe(t,e,n){return Vf()==="webgl"?function(r,a,s){var o=s.combineWithPreviousRatio.toFixed(2),i={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(o,`);

      setOutput(outputValue);
    }
`)},l=Oc();return at(function(){var u=l.compileAndRun(i,[r,a]);return ia().makeTensorFromDataId(u.dataId,u.shape,u.dtype)})}(t,e,n):at(function(){var r=ft(e,.5),a=ys(r),s=ft(1,Hf(1,_e(a,Ke(5.68842,_e(a,Ke(-.748699,_e(a,Ke(-57.8051,_e(a,Ke(291.309,_e(a,-624.717)))))))))));return Ke(e,_e(ft(t,e),_e(s,n.combineWithPreviousRatio)))})}function GSe(t,e,n){return Ot(this,void 0,void 0,function(){var r,a,s,o,i;return Rt(this,function(l){switch(l.label){case 0:return r=t[0],a=t[1],s=function(u,c,d){return at(function(){var f,h,p,g;d.reverseOutputOrder?(h=tn(gt(u,[0,d.boxCoordOffset+0],[-1,1])),f=tn(gt(u,[0,d.boxCoordOffset+1],[-1,1])),g=tn(gt(u,[0,d.boxCoordOffset+2],[-1,1])),p=tn(gt(u,[0,d.boxCoordOffset+3],[-1,1]))):(f=tn(gt(u,[0,d.boxCoordOffset+0],[-1,1])),h=tn(gt(u,[0,d.boxCoordOffset+1],[-1,1])),p=tn(gt(u,[0,d.boxCoordOffset+2],[-1,1])),g=tn(gt(u,[0,d.boxCoordOffset+3],[-1,1]))),h=Ke(_e($t(h,d.xScale),c.w),c.x),f=Ke(_e($t(f,d.yScale),c.h),c.y),d.applyExponentialOnBoxSize?(p=_e(li($t(p,d.hScale)),c.h),g=_e(li($t(g,d.wScale)),c.w)):(p=_e($t(p,d.hScale),c.h),g=_e($t(g,d.wScale),c.h));var y=ft(f,$t(p,2)),v=ft(h,$t(g,2)),x=Ke(f,$t(p,2)),b=Ke(h,$t(g,2)),w=fr([xe(y,[d.numBoxes,1]),xe(v,[d.numBoxes,1]),xe(x,[d.numBoxes,1]),xe(b,[d.numBoxes,1])],1);if(d.numKeypoints)for(var C=0;C<d.numKeypoints;++C){var _=d.keypointCoordOffset+C*d.numValuesPerKeypoint,$=void 0,k=void 0;d.reverseOutputOrder?($=tn(gt(u,[0,_],[-1,1])),k=tn(gt(u,[0,_+1],[-1,1]))):(k=tn(gt(u,[0,_],[-1,1])),$=tn(gt(u,[0,_+1],[-1,1])));var A=Ke(_e($t($,d.xScale),c.w),c.x),P=Ke(_e($t(k,d.yScale),c.h),c.y);w=fr([w,xe(A,[d.numBoxes,1]),xe(P,[d.numBoxes,1])],1)}return w})}(a,e,n),o=at(function(){var u=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(u=XE(r,-n.scoreClippingThresh,n.scoreClippingThresh)),u=ei(u)):u}),[4,HSe(s,o,n)];case 1:return i=l.sent(),Jt([s,o]),[2,i]}})})}function HSe(t,e,n){return Ot(this,void 0,void 0,function(){var r,a,s,o,i,l,u,c,d,f,h,p;return Rt(this,function(g){switch(g.label){case 0:return r=[],[4,t.data()];case 1:return a=g.sent(),[4,e.data()];case 2:for(s=g.sent(),o=0;o<n.numBoxes;++o)if(!(n.minScoreThresh!=null&&s[o]<n.minScoreThresh||(i=o*n.numCoords,l=qSe(a[i+0],a[i+1],a[i+2],a[i+3],s[o],n.flipVertically,o),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(n.numKeypoints>0)for((c=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,f=0;f<d;f+=n.numValuesPerKeypoint)h=i+n.keypointCoordOffset+f,p={x:a[h+0],y:n.flipVertically?1-a[h+1]:a[h+1]},c.relativeKeypoints.push(p);r.push(l)}return[2,r]}})})}function qSe(t,e,n,r,a,s,o){return{score:[a],ind:o,locationData:{relativeBoundingBox:{xMin:e,yMin:s?1-n:t,xMax:r,yMax:s?1-t:n,width:r-e,height:n-t}}}}function KSe(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function Z3(t,e,n,r){return Ot(this,void 0,void 0,function(){var a,s,o,i,l,u,c,d;return Rt(this,function(f){switch(f.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,a=t.size,s=a/e.numLandmarks,[4,t.data()];case 1:for(o=f.sent(),i=[],l=0;l<e.numLandmarks;++l)u=l*s,(d={x:0,y:0}).x=n?e.inputImageWidth-o[u]:o[u],s>1&&(d.y=r?e.inputImageHeight-o[u+1]:o[u+1]),s>2&&(d.z=o[u+2]),s>3&&(d.score=KSe(e.visibilityActivation,o[u+3])),i.push(d);for(c=0;c<i.length;++c)(d=i[c]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,i]}})})}function ej(t,e,n){var r=t.width,a=t.height,s=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(s=function(u,c){return c.rotation!=null?u+=c.rotation:c.rotationDegree!=null&&(u+=Math.PI*c.rotationDegree/180),UG(u)}(s,n)),s===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+a*n.shiftY;else{var o=(e.width*r*n.shiftX*Math.cos(s)-e.height*a*n.shiftY*Math.sin(s))/e.width,i=(e.width*r*n.shiftX*Math.sin(s)+e.height*a*n.shiftY*Math.cos(s))/e.height;t.xCenter=t.xCenter+o,t.yCenter=t.yCenter+i}{var l=Math.max(r*e.width,a*e.height);r=l/e.width,a=l/e.height}return t.width=r*n.scaleX,t.height=a*n.scaleY,t}function XSe(t,e){return t.map(function(n){var r=yn(yn({},n),{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),r})}var Al=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var r;return this.initialized?r=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},t.prototype.applyWithAlpha=function(e,n,r){return this.alpha=n,this.apply(e,r)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),R_=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new Al(this.getAlpha(this.minCutOff)),this.dx=new Al(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,r){if(e==null)return e;var a=Math.trunc(n);if(this.lastTimestamp>=a)return e;this.lastTimestamp!==0&&a!==0&&(this.frequency=1/(1e-6*(a-this.lastTimestamp))),this.lastTimestamp=a;var s=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,o=this.dx.applyWithAlpha(s,this.getAlpha(this.derivateCutOff)),i=this.minCutOff+this.beta*Math.abs(o),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(o):null;return this.x.applyWithAlpha(e,this.getAlpha(i),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),bN=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var a=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return rc([],e,!0);s=1/r}return e.map(function(o,i){var l=yn(yn({},o),{x:a.xFilters[i].apply(o.x,n,s),y:a.yFilters[i].apply(o.y,n,s)});return o.z!=null&&(l.z=a.zFilters[i].apply(o.z,n,s)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new R_(n.config)}),this.yFilters=e.map(function(r){return new R_(n.config)}),this.zFilters=e.map(function(r){return new R_(n.config)}))},t}(),D_=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new Al(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,r){if(e==null)return e;var a,s=Math.trunc(n);if(this.lastTimestamp>=s)return e;if(this.lastTimestamp===-1)a=1;else{for(var o=e*r-this.lastValue*this.lastValueScale,i=s-this.lastTimestamp,l=o,u=i,c=(1+this.window.length)*(1e6/30),d=0,f=this.window;d<f.length;d++){var h=f[d];if(u+h.duration>c)break;l+=h.distance,u+=h.duration}var p=l/(1e-6*u);a=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:o,duration:i}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=s,this.lowPassFilter.applyWithAlpha(e,a)},t}(),YSe=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var a=this;if(e==null)return this.reset(),null;var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return rc([],e,!0);s=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(o,i){var l=yn(yn({},o),{x:a.xFilters[i].apply(o.x,n,s),y:a.yFilters[i].apply(o.y,n,s)});return o.z!=null&&(l.z=a.zFilters[i].apply(o.z,n,s)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new D_(n.config)}),this.yFilters=e.map(function(r){return new D_(n.config)}),this.zFilters=e.map(function(r){return new D_(n.config)}))},t}(),j_=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new YSe(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new bN(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,r,a,s){if(a===void 0&&(a=!1),e==null)return this.keypointsFilter.reset(),null;var o=s!=null?function(u,c){return(u.width*c.width+u.height*c.height)/2}(s,r):1,i=a?qG(e,r):e,l=this.keypointsFilter.apply(i,n,o);return a?XSe(l,r):l},t}(),tj=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(i){return new Al(n.alpha)}));for(var r=[],a=0;a<e.length;++a){var s=e[a],o=yn({},s);o.score=this.visibilityFilters[a].apply(s.score),r.push(o)}return r},t}(),QSe={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},Rd={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},JSe={maxPoses:1,flipHorizontal:!1},ZSe={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},e2e=.3,nj={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},t2e={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},n2e={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},r2e={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},a2e={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},s2e={kernelSize:7,minConfidenceToRefine:.5},rj={alpha:.1},o2e={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},i2e={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},l2e={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},u2e={activation:"none"},c2e={combineWithPreviousRatio:.7},d2e=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,LG(this.mask)]})})},t.prototype.toImageData=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,BG(this.mask)]})})},t.prototype.toTensor=function(){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,this.mask]})})},t.prototype.getUnderlyingType=function(){return"tensor"},t}();function f2e(t){return zG(t),"person"}var h2e=function(){function t(e,n,r,a,s,o){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=r,this.enableSegmentation=a,this.smoothSegmentation=s,this.modelType=o,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var f=[],h=0;h<d.numLayers;){for(var p=[],g=[],y=[],v=[],x=h;x<d.strides.length&&d.strides[x]===d.strides[h];){var b=Y3(d.minScale,d.maxScale,x,d.strides.length);if(x===0&&d.reduceBoxesInLowestLayer)y.push(1),y.push(2),y.push(.5),v.push(.1),v.push(b),v.push(b);else{for(var w=0;w<d.aspectRatios.length;++w)y.push(d.aspectRatios[w]),v.push(b);if(d.interpolatedScaleAspectRatio>0){var C=x===d.strides.length-1?1:Y3(d.minScale,d.maxScale,x+1,d.strides.length);v.push(Math.sqrt(b*C)),y.push(d.interpolatedScaleAspectRatio)}}x++}for(var _=0;_<y.length;++_){var $=Math.sqrt(y[_]);p.push(v[_]/$),g.push(v[_]*$)}var k=0,A=0;if(d.featureMapHeight.length>0)k=d.featureMapHeight[h],A=d.featureMapWidth[h];else{var P=d.strides[h];k=Math.ceil(d.inputSizeHeight/P),A=Math.ceil(d.inputSizeWidth/P)}for(var O=0;O<k;++O)for(var R=0;R<A;++R)for(var B=0;B<p.length;++B){var F={xCenter:(R+d.anchorOffsetX)/A,yCenter:(O+d.anchorOffsetY)/k,width:0,height:0};d.fixedAnchorSize?(F.width=1,F.height=1):(F.width=g[B],F.height=p[B]),f.push(F)}h=x}return f}(QSe);var i=jr(this.anchors.map(function(d){return d.width})),l=jr(this.anchors.map(function(d){return d.height})),u=jr(this.anchors.map(function(d){return d.xCenter})),c=jr(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:u,y:c,w:i,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?vs([],[0,0]):null}return t.prototype.estimatePoses=function(e,n,r){return Ot(this,void 0,void 0,function(){var a,s,o,i,l,u,c,d,f,h,p,g,y,v,x,b,w,C,_,$,k,A,P;return Rt(this,function(O){switch(O.label){case 0:return a=function(R){var B;if((B=R==null?JSe:yn({},R)).maxPoses==null&&(B.maxPoses=1),B.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(B.maxPoses,". Should be > 0."));if(B.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return B}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=a.maxPoses,this.timestamp=r!=null?1e3*r:HG(e)?1e6*e.currentTime:null,s=Jf(e),o=at(function(){return zt(TP(e),"float32")}),(i=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(o)]);case 1:if((l=O.sent()).length===0)return this.reset(),o.dispose(),[2,[]];u=l[0],i=this.poseDetectionToRoi(u,s),O.label=2;case 2:return[4,this.poseLandmarksByRoi(i,o)];case 3:return c=O.sent(),o.dispose(),c==null?(this.reset(),[2,[]]):(d=c.landmarks,f=c.auxiliaryLandmarks,h=c.poseScore,p=c.worldLandmarks,g=c.segmentationMask,y=this.poseLandmarkFiltering(d,f,p,s),v=y.actualLandmarksFiltered,x=y.auxiliaryLandmarksFiltered,b=y.actualWorldLandmarksFiltered,w=this.poseLandmarksToRoi(x,s),this.regionOfInterest=w,C=this.smoothSegmentation&&g!=null?this.poseSegmentationFiltering(g):g,(_=v!=null?qG(v,s):null)!=null&&_.forEach(function(R,B){R.name=dy[B]}),($=b)!=null&&$.forEach(function(R,B){R.name=dy[B]}),k={score:h,keypoints:_,keypoints3D:$},C!==null&&(A=at(function(){var R=Ga(C,2),B=qi(R,[[0,0],[0,0],[0,1]]);return fA(B,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||Jt(C),P={maskValueToLabel:f2e,mask:new d2e(A)},k.segmentation=P),[2,[k]])}})})},t.prototype.poseSegmentationFiltering=function(e){var n=this.prevFilteredSegmentationMask;return n.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=WSe(n,e,c2e),Jt(e)),Jt(n),this.prevFilteredSegmentationMask},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),Jt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},t.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(Jt(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=vs([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return Ot(this,void 0,void 0,function(){var n,r,a,s,o,i,l,u,c,d;return Rt(this,function(f){switch(f.label){case 0:return n=xN(e,t2e),r=n.imageTensor,a=n.padding,s=this.detectorModel.predict(r),o=zSe(s),i=o.boxes,[4,GSe([l=o.logits,i],this.anchorTensor,ZSe)];case 1:return(u=f.sent()).length===0?(Jt([r,s,l,i]),[2,u]):[4,USe(u,this.maxPoses,e2e)];case 2:return c=f.sent(),d=function(h,p){h===void 0&&(h=[]);for(var g=p.left,y=p.top,v=p.left+p.right,x=p.top+p.bottom,b=0;b<h.length;b++){var w=h[b],C=w.locationData.relativeBoundingBox,_=(C.xMin-g)/(1-v),$=(C.yMin-y)/(1-x),k=C.width/(1-v),A=C.height/(1-x);C.xMin=_,C.yMin=$,C.width=k,C.height=A,C.xMax=_+k,C.yMax=$+A;var P=w.locationData.relativeKeypoints;P&&P.forEach(function(O){var R=(O.x-g)/(1-v),B=(O.y-y)/(1-x);O.x=R,O.y=B})}return h}(c,a),Jt([r,s,l,i]),[2,d]}})})},t.prototype.poseDetectionToRoi=function(e,n){return ej(P_(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,nj)},t.prototype.poseLandmarksByRoi=function(e,n){return Ot(this,void 0,void 0,function(){var r,a,s,o,i,l,u,c,d,f,h,p,g,y;return Rt(this,function(v){switch(v.label){case 0:if(r=Jf(n),a=xN(n,n2e,e),s=a.imageTensor,o=a.padding,i=a.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),u=this.landmarkModel.execute(s,l),[4,this.tensorsToPoseLandmarksAndSegmentation(u)];case 1:return(c=v.sent())==null?(Jt(u),Jt(s),[2,null]):(d=c.landmarks,f=c.auxiliaryLandmarks,h=c.poseScore,p=c.worldLandmarks,g=c.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,o,i,d,f,p,g)]);case 2:return y=v.sent(),Jt(u),Jt(s),[2,yn({poseScore:h},y)]}})})},t.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,n,r,a,s,o,i,l){return Ot(this,void 0,void 0,function(){var u,c,d,f,h,p;return Rt(this,function(g){return u=J3(s,r),c=J3(o,r),d=X3(u,n),f=X3(c,n),h=function(y,v){for(var x=[],b=0,w=y;b<w.length;b++){var C=w[b],_=C.x,$=C.y,k=v.rotation,A=Math.cos(k)*_-Math.sin(k)*$,P=Math.sin(k)*_+Math.cos(k)*$,O=yn({},C);O.x=A,O.y=P,x.push(O)}return x}(i,n),p=null,this.enableSegmentation&&(p=at(function(){var y=l.shape,v=y[0],x=y[1],b=function(_){var $=WG(new Array(16).fill(0));$[0][0]=aa(_,0,0),$[1][0]=-aa(_,0,1),$[2][0]=aa(_,0,2),$[3][0]=-aa(_,0,3),$[0][2]=aa(_,2,0),$[1][2]=-aa(_,2,1),$[2][2]=aa(_,2,2),$[3][2]=-aa(_,2,3),$[0][1]=-aa(_,1,0),$[1][1]=aa(_,1,1),$[2][1]=-aa(_,1,2),$[3][1]=aa(_,1,3),$[0][3]=-aa(_,3,0),$[1][3]=aa(_,3,1),$[2][3]=-aa(_,3,2),$[3][3]=aa(_,3,3);for(var k=_[0][0]*$[0][0]+_[1][0]*$[0][1]+_[2][0]*$[0][2]+_[3][0]*$[0][3],A=0;A<$.length;A++)for(var P=0;P<$.length;P++)$[A][P]/=k;return $}(a),w=vs(VG(b,{width:x,height:v},e),[1,8]),C=[1,v,x,1];return tn(Hl.transform(xe(l,C),w,"bilinear","constant",0,[e.height,e.width]),[0,3])}),Jt(l)),[2,{landmarks:d,auxiliaryLandmarks:f,worldLandmarks:h,segmentationMask:p}]})})},t.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return Ot(this,void 0,void 0,function(){var n,r,a,s,o,i,l,u,c,d,f,h,p;return Rt(this,function(g){switch(g.label){case 0:return n=e[0],r=e[1],a=e[2],s=e[3],o=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(i=g.sent()[0])<.5?[2,null]:[4,Z3(n,r2e)];case 2:return[4,VSe(g.sent(),a,s2e)];case 3:return l=g.sent(),u=l.slice(0,33),c=l.slice(33,35),[4,Z3(s,a2e)];case 4:return d=g.sent(),f=d.slice(0,33),h=function(y,v,x){for(var b=[],w=0;w<y.length;w++){var C=yn({},v[w]);C.score=y[w].score,b.push(C)}return b}(u,f),p=this.enableSegmentation?function(y,v,x){return at(function(){var b=tn(y,[0]),w=b.shape[2];if(w===1){var C=b;switch(v.activation){case"none":break;case"sigmoid":C=ei(C);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(v.activation,")"))}var _=C;return tn(_,[2])}throw new Error("Unsupported number of tensor channels ".concat(w))})}(o,u2e):null,[2,{landmarks:u,auxiliaryLandmarks:c,poseScore:i,worldLandmarks:h,segmentationMask:p}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return ej(P_(Q3(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,nj)},t.prototype.poseLandmarkFiltering=function(e,n,r,a){var s,o,i;if(this.timestamp!=null&&this.enableSmoothing){var l=P_(Q3(n),a,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new tj(rj)),s=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new tj(rj)),o=this.visibilitySmoothingFilterAuxiliary.apply(n),i=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new j_(o2e)),s=this.landmarksSmoothingFilterActual.apply(s,this.timestamp,a,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new j_(i2e)),o=this.landmarksSmoothingFilterAuxiliary.apply(o,this.timestamp,a,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new j_(l2e)),i=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else s=e,o=n,i=r;return{actualLandmarksFiltered:s,auxiliaryLandmarksFiltered:o,actualWorldLandmarksFiltered:i}},t}();function p2e(t){return Ot(this,void 0,void 0,function(){var e,n,r,a,s,o;return Rt(this,function(i){switch(i.label){case 0:return e=function(l){var u=yn({},l??Rd);if(u.enableSmoothing==null&&(u.enableSmoothing=Rd.enableSmoothing),u.enableSegmentation==null&&(u.enableSegmentation=Rd.enableSegmentation),u.smoothSegmentation==null&&(u.smoothSegmentation=Rd.smoothSegmentation),u.modelType==null&&(u.modelType=Rd.modelType),u.detectorModelUrl==null&&(u.detectorModelUrl=Rd.detectorModelUrl),u.landmarkModelUrl==null)switch(u.modelType){case"lite":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:u.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return u}(t),n=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Yf(e.detectorModelUrl,{fromTFHub:n}),Yf(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return a=i.sent(),s=a[0],o=a[1],[2,new h2e(s,o,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var gc,Io,KG=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(n.maxTracks));if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(n.maxAge));if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(n.keypointTrackerParams.keypointConfidenceThreshold));if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(n.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,a=n.keypointTrackerParams.keypointFalloff;r<a.length;r++){var s=a[r];if(s<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(s))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var r=this.computeSimilarity(e);return this.assignTracks(e,r,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,r){for(var a=Array.from(Array(n[0].length).keys()),s=[],o=0,i=Array.from(Array(e.length).keys());o<i.length;o++){var l=i[o];if(a.length!==0){for(var u=-1,c=-1,d=0,f=a;d<f.length;d++){var h=f[d],p=n[l][h];p>=this.minSimilarity&&p>c&&(u=h,c=p)}if(u>=0){var g=this.tracks[u];g=Object.assign(g,this.createTrack(e[l],r,g.id)),e[l].id=g.id;var y=a.indexOf(u);a.splice(y,1)}else s.push(l)}else s.push(l)}for(var v=0,x=s;v<x.length;v++){l=x[v];var b=this.createTrack(e[l],r);this.tracks.push(b),e[l].id=b.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,r){return r.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,r){var a={id:r||this.nextTrackID(),lastTimestamp:n,keypoints:rc([],e.keypoints,!0).map(function(s){return yn({},s)})};return e.box!==void 0&&(a.box=yn({},e.box)),a},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),m2e=function(t){function e(n){return t.call(this,n)||this}return FG(e,t),e.prototype.computeSimilarity=function(n){var r=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(a){return r.tracks.map(function(s){return r.iou(a,s)})})},e.prototype.iou=function(n,r){var a=Math.max(n.box.xMin,r.box.xMin),s=Math.max(n.box.yMin,r.box.yMin),o=Math.min(n.box.xMax,r.box.xMax),i=Math.min(n.box.yMax,r.box.yMax);if(a>=o||s>=i)return 0;var l=(o-a)*(i-s);return l/(n.box.width*n.box.height+r.box.width*r.box.height-l)},e}(KG),g2e=function(t){function e(n){var r=t.call(this,n)||this;return r.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=n.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,r}return FG(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var r=[],a=0,s=n;a<s.length;a++){for(var o=s[a],i=[],l=0,u=this.tracks;l<u.length;l++){var c=u[l];i.push(this.oks(o,c))}r.push(i)}return r},e.prototype.oks=function(n,r){for(var a=this.area(r.keypoints)+1e-6,s=0,o=0,i=0;i<n.keypoints.length;++i){var l=n.keypoints[i],u=r.keypoints[i];if(!(l.score<this.keypointThreshold||u.score<this.keypointThreshold)){o+=1;var c=Math.pow(l.x-u.x,2)+Math.pow(l.y-u.y,2),d=2*this.keypointFalloff[i];s+=Math.exp(-1*c/(2*a*Math.pow(d,2)))}}return o<this.minNumKeyoints?0:s/o},e.prototype.area=function(n){var r=this,a=n.filter(function(l){return l.score>r.keypointThreshold}),s=Math.min.apply(Math,rc([1],a.map(function(l){return l.x}),!1)),o=Math.max.apply(Math,rc([0],a.map(function(l){return l.x}),!1)),i=Math.min.apply(Math,rc([1],a.map(function(l){return l.y}),!1));return(o-s)*(Math.max.apply(Math,rc([0],a.map(function(l){return l.y}),!1))-i)},e}(KG);function y2e(t){switch(t){case Io.BlazePose:return dy.reduce(function(e,n,r){return e[n]=r,e},{});case Io.PoseNet:case Io.MoveNet:return hi.reduce(function(e,n,r){return e[n]=r,e},{});default:throw new Error("Model ".concat(t," is not supported."))}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(gc||(gc={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}(Io||(Io={}));var aj=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],XG={modelType:"SinglePose.Lightning",enableSmoothing:!0},sj={},oj={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},M_={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},ij={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function v2e(t,e,n,r){for(var a={},s=0,o=hi;s<o.length;s++){var i=o[s];a[i]=[e[n[i]].y*r.height,e[n[i]].x*r.width]}if(function(x,b){return(x[b.left_hip].score>.2||x[b.right_hip].score>.2)&&(x[b.left_shoulder].score>.2||x[b.right_shoulder].score>.2)}(e,n)){var l=(a.left_hip[0]+a.right_hip[0])/2,u=(a.left_hip[1]+a.right_hip[1])/2,c=function(x,b,w,C,_){for(var $=["left_shoulder","right_shoulder","left_hip","right_hip"],k=0,A=0,P=0;P<$.length;P++)(L=Math.abs(C-w[$[P]][0]))>k&&(k=L),(H=Math.abs(_-w[$[P]][1]))>A&&(A=H);for(var O=0,R=0,B=0,F=Object.keys(w);B<F.length;B++){var L,H,te=F[B];x[b[te]].score<.2||((L=Math.abs(C-w[te][0]))>O&&(O=L),(H=Math.abs(_-w[te][1]))>R&&(R=H))}return[k,A,O,R]}(e,n,a,l,u),d=c[0],f=c[1],h=c[2],p=c[3],g=Math.max(1.9*f,1.9*d,1.2*h,1.2*p),y=[l-(g=Math.min(g,Math.max(u,r.width-u,l,r.height-l))),u-g];if(g>Math.max(r.width,r.height)/2)return wN(t==null,r);var v=2*g;return{yMin:y[0]/r.height,xMin:y[1]/r.width,yMax:(y[0]+v)/r.height,xMax:(y[1]+v)/r.width,height:(y[0]+v)/r.height-y[0]/r.height,width:(y[1]+v)/r.width-y[1]/r.width}}return wN(t==null,r)}function wN(t,e){var n,r,a,s;return t?e.width>e.height?(n=1,r=e.height/e.width,a=0,s=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,r=1,a=(e.height/2-e.width/2)/e.height,s=0):e.width>e.height?(n=e.width/e.height,r=1,a=(e.height/2-e.width/2)/e.height,s=0):(n=1,r=e.height/e.width,a=0,s=(e.width/2-e.height/2)/e.width),{yMin:a,xMin:s,yMax:a+n,xMax:s+r,height:n,width:r}}function x2e(t){var e,n=t==null?XG:yn({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(aj.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(aj));if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=gc.BoundingBox),n.trackerType===gc.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(r){var a=lj(M_,r);return a.keypointTrackerParams=yn({},M_.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(a.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(a.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(a.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),a}(n.trackerConfig):n.trackerConfig=M_;else{if(n.trackerType!==gc.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,lj(ij,e)):n.trackerConfig=ij}return n}function lj(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var b2e=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=y2e(Io.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new bN(oj),this.cropRegionFilterYMin=new Al(.9),this.cropRegionFilterXMin=new Al(.9),this.cropRegionFilterYMax=new Al(.9),this.cropRegionFilterXMax=new Al(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===gc.Keypoint?this.tracker=new g2e(n.trackerConfig):n.trackerType===gc.BoundingBox&&(this.tracker=new m2e(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return Ot(this,void 0,void 0,function(){var n,r,a,s,o;return Rt(this,function(i){switch(i.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return Vf()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=i.sent(),i.label=3;case 3:for(n.dispose(),a={keypoints:[],score:0},s=0,o=0;o<17;++o)a.keypoints[o]={y:r[3*o],x:r[3*o+1],score:r[3*o+2]},a.keypoints[o].score>.2&&(++s,a.score+=a.keypoints[o].score);return s>0&&(a.score/=s),[2,a]}})})},t.prototype.runMultiPersonPoseModel=function(e){return Ot(this,void 0,void 0,function(){var n,r,a,s,o,i,l,u;return Rt(this,function(c){switch(c.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return Vf()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=c.sent(),c.label=3;case 3:for(n.dispose(),a=[],s=r.length/56,o=0;o<s;++o)for(a[o]={keypoints:[]},i=56*o+51,a[o].box={yMin:r[i],xMin:r[i+1],yMax:r[i+2],xMax:r[i+3],width:r[i+3]-r[i+1],height:r[i+2]-r[i]},l=56*o+55,a[o].score=r[l],a[o].keypoints=[],u=0;u<17;++u)a[o].keypoints[u]={y:r[56*o+3*u],x:r[56*o+3*u+1],score:r[56*o+3*u+2]};return[2,a]}})})},t.prototype.estimatePoses=function(e,n,r){return n===void 0&&(n=sj),Ot(this,void 0,void 0,function(){var a,s,o,i,l,u;return Rt(this,function(c){switch(c.label){case 0:return n=function(d){return d==null?sj:yn({},d)}(n),e==null?(this.reset(),[2,[]]):(r==null?HG(e)&&(r=1e6*e.currentTime):r*=1e3,a=TP(e),s=Jf(a),o=Ga(a,0),e instanceof cn||a.dispose(),i=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(o,s,r)]);case 1:return i=c.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(o,s,r)];case 3:i=c.sent(),c.label=4;case 4:for(l=0;l<i.length;++l)for(u=0;u<i[l].keypoints.length;++u)i[l].keypoints[u].name=hi[u],i[l].keypoints[u].y*=s.height,i[l].keypoints[u].x*=s.width;return[2,i]}})})},t.prototype.estimateSinglePose=function(e,n,r){return Ot(this,void 0,void 0,function(){var a,s,o,i,l=this;return Rt(this,function(u){switch(u.label){case 0:return this.cropRegion||(this.cropRegion=wN(this.cropRegion==null,n)),a=at(function(){var c=vs([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=ci([1],"int32"),f=[l.modelInputResolution.height,l.modelInputResolution.width];return zt(Hl.cropAndResize(e,c,d,f,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(a)];case 1:if(s=u.sent(),a.dispose(),s.score<this.minPoseScore)return this.reset(),[2,[]];for(o=0;o<s.keypoints.length;++o)s.keypoints[o].y=this.cropRegion.yMin+s.keypoints[o].y*this.cropRegion.height,s.keypoints[o].x=this.cropRegion.xMin+s.keypoints[o].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(s.keypoints=this.keypointFilter.apply(s.keypoints,r,1)),i=v2e(this.cropRegion,s.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(i),[2,[s]]}})})},t.prototype.estimateMultiplePoses=function(e,n,r){return Ot(this,void 0,void 0,function(){var a,s,o,i,l,u,c,d,f,h,p,g=this;return Rt(this,function(y){switch(y.label){case 0:return n.width>n.height?(s=this.multiPoseMaxDimension,o=Math.round(this.multiPoseMaxDimension*n.height/n.width),a=Hl.resizeBilinear(e,[o,s]),l=s,u=32*Math.ceil(o/32),i=qi(a,[[0,0],[0,u-o],[0,0],[0,0]])):(s=Math.round(this.multiPoseMaxDimension*n.width/n.height),o=this.multiPoseMaxDimension,a=Hl.resizeBilinear(e,[o,s]),l=32*Math.ceil(s/32),u=o,i=qi(a,[[0,0],[0,0],[0,l-s],[0,0]])),a.dispose(),e.dispose(),c=zt(i,"int32"),i.dispose(),[4,this.runMultiPersonPoseModel(c)];case 1:for(d=y.sent(),c.dispose(),d=d.filter(function(v){return v.score>=g.minPoseScore}),h=0;h<d.length;++h)for(f=0;f<d[h].keypoints.length;++f)d[h].keypoints[f].y*=u/o,d[h].keypoints[f].x*=l/s;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(h=0;h<d.length;++h)this.keypointFilterMap.has(d[h].id)||this.keypointFilterMap.set(d[h].id,new bN(oj)),d[h].keypoints=this.keypointFilterMap.get(d[h].id).apply(d[h].keypoints,r,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(v,x){p.has(x)||g.keypointFilterMap.delete(x)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),a=this.cropRegionFilterYMax.apply(e.yMax),s=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:r,yMax:a,xMax:s,height:a-n,width:s-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function w2e(t){return t===void 0&&(t=XG),Ot(this,void 0,void 0,function(){var e,n,r,a;return Rt(this,function(s){switch(s.label){case 0:return e=x2e(t),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Yf(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=s.sent(),[3,4];case 2:return a=void 0,e.modelType==="SinglePose.Lightning"?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?a="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(a="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Yf(a,{fromTFHub:r})];case 3:n=s.sent(),s.label=4;case 4:return Vf()==="webgl"&&ee().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new b2e(n,e)]}})})}var uj={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},cj=["MobileNetV1","ResNet50"],dj={MobileNetV1:[8,16],ResNet50:[16]},S2e=[8,16,32],fj={MobileNetV1:[.5,.75,1],ResNet50:[1]},hj=[1,2,4],pj={maxPoses:1,flipHorizontal:!1},C2e={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},_2e=[-123.15,-115.9,-103.06];function F_(t){return Math.floor(t/2)}var $2e=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(F_(e),e);)this.exchange(e,F_(e)),e=F_(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=r},t}();function k2e(t,e,n,r,a,s){for(var o=s.shape,i=o[0],l=o[1],u=!0,c=Math.max(n-a,0),d=Math.min(n+a+1,i),f=c;f<d;++f){for(var h=Math.max(r-a,0),p=Math.min(r+a+1,l),g=h;g<p;++g)if(s.get(f,g,t)>e){u=!1;break}if(!u)break}return u}function N2e(t){return Ot(this,void 0,void 0,function(){return Rt(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function YG(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+17)}}function QG(t,e,n){var r=YG(t.heatmapY,t.heatmapX,t.id,n),a=r.y,s=r.x;return{x:t.heatmapX*e+s,y:t.heatmapY*e+a}}function JG(t,e,n,r){var a=n.x,s=n.y;return t.some(function(o){var i,l,u,c,d,f,h=o.keypoints;return i=s,l=a,u=h[r].y,c=h[r].x,(d=u-i)*d+(f=c-l)*f<=e})}var mj=hi.reduce(function(t,e,n){return t[e]=n,t},{}),ZG=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[mj[e],mj[n]]}),L_=ZG.map(function(t){return t[1]}),gj=ZG.map(function(t){return t[0]});function yj(t,e,n){return t<e?e:t>n?n:t}function B_(t,e,n,r){return{y:yj(Math.round(t.y/e),0,n-1),x:yj(Math.round(t.x/e),0,r-1)}}function vj(t,e){return{x:t.x+e.x,y:t.y+e.y}}function xj(t,e,n,r,a,s,o,i){i===void 0&&(i=2);for(var l=r.shape,u=l[0],c=l[1],d={y:e.y,x:e.x},f=vj(d,function(x,b,w){var C=w.shape[2]/2;return{y:w.get(b.y,b.x,x),x:w.get(b.y,b.x,C+x)}}(t,B_(d,s,u,c),o)),h=0;h<i;h++){var p=B_(f,s,u,c),g=YG(p.y,p.x,n,a);f=vj({x:p.x*s,y:p.y*s},{x:g.x,y:g.y})}var y=B_(f,s,u,c),v=r.get(y.y,y.x,n);return{y:f.y,x:f.x,name:hi[n],score:v}}function I2e(t,e,n,r,a,s){var o=e.shape[2],i=L_.length,l=new Array(o),u=t.part,c=t.score,d=QG(u,r,n);l[u.id]={score:c,name:hi[u.id],y:d.y,x:d.x};for(var f=i-1;f>=0;--f){var h=L_[f],p=gj[f];l[h]&&!l[p]&&(l[p]=xj(f,l[h],p,e,n,r,s))}for(f=0;f<i;++f)h=gj[f],p=L_[f],l[h]&&!l[p]&&(l[p]=xj(f,l[h],p,e,n,r,a));return l}function T2e(t,e,n){return n.reduce(function(r,a,s){var o=a.y,i=a.x,l=a.score;return JG(t,e,{y:o,x:i},s)||(r+=l),r},0)/n.length}function E2e(t,e,n,r,a,s,o,i){return o===void 0&&(o=.5),i===void 0&&(i=20),Ot(this,void 0,void 0,function(){var l,u,c,d,f,h,p,g,y,v,x,b;return Rt(this,function(w){switch(w.label){case 0:return[4,N2e([t,e,n,r])];case 1:for(l=w.sent(),u=l[0],c=l[1],d=l[2],f=l[3],h=[],p=function(C,_,$){for(var k=$.shape,A=k[0],P=k[1],O=k[2],R=new $2e(A*P*O,function(te){return te.score}),B=0;B<A;++B)for(var F=0;F<P;++F)for(var L=0;L<O;++L){var H=$.get(B,F,L);H<C||k2e(L,H,B,F,_,$)&&R.enqueue({score:H,part:{heatmapY:B,heatmapX:F,id:L}})}return R}(o,1,u),g=i*i;h.length<s&&!p.empty();)y=p.dequeue(),v=QG(y.part,a,c),JG(h,g,v,y.part.id)||(x=I2e(y,u,c,a,d,f),b=T2e(h,g,x),h.push({keypoints:x,score:b}));return[2,h]}})})}function eH(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(e.length){case 0:t="fn main() ";break;case 1:t="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return t}var A2e=function(){function t(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=Be(this.outputShape),this.dispatch=Pe(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return t.prototype.getUserCode=function(){return`
        `.concat(eH("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},t}();function P2e(t,e){if(Oc()instanceof Ap)return function(n,r){var a=Oc(),s=new A2e(r.shape),o=a.runWebGPUProgram(s,[n,r],"float32");return ia().makeTensorFromTensorInfo(o)}(t,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var O2e=function(){function t(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var n=[e[0],1];this.dispatchLayout=Be(n),this.dispatch=Pe(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return t.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(eH("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},t}();function R2e(t,e){if(Oc()instanceof Ap)return function(n,r){var a=Oc(),s=new O2e(n.shape),o=a.runWebGPUProgram(s,[n,r],"float32");return ia().makeTensorFromTensorInfo(o)}(t,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function tH(t){var e=t.shape,n=e[0],r=e[1],a=e[2];return at(function(){var s,o,i=xe(t,[n*r,a]),l=WE(i,0),u=Ga($t(l,bt(r,"int32")),1),c=Ga((s=l,o=r,at(function(){var d=$t(s,bt(o,"int32"));return ft(s,_e(d,bt(o,"int32")))})),1);return fr([u,c],1)})}function D2e(t,e,n){return at(function(){var r=function(a,s){for(var o=[],i=0;i<hi.length;i++){var l=a.get(i,0).valueOf(),u=a.get(i,1).valueOf(),c=j2e(l,u,i,s),d=c.x,f=c.y;o.push(f),o.push(d)}return vs(o,[hi.length,2])}(t,n);return Ke(zt(_e(t.toTensor(),bt(e,"int32")),"float32"),r)})}function j2e(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+hi.length)}}function M2e(t,e,n){return Ot(this,void 0,void 0,function(){var r,a,s,o,i,l,u,c,d,f;return Rt(this,function(h){switch(h.label){case 0:return r=0,a=tH(t),[4,Promise.all([t.buffer(),e.buffer(),a.buffer()])];case 1:return s=h.sent(),o=s[0],i=s[1],l=s[2],[4,(u=D2e(l,n,i)).buffer()];case 2:return c=h.sent(),d=Array.from(function(p,g){for(var y=g.shape[0],v=new Float32Array(y),x=0;x<y;x++){var b=g.get(x,0),w=g.get(x,1);v[x]=p.get(b,w,x)}return v}(o,l)),f=d.map(function(p,g){return r+=p,{y:c.get(g,0),x:c.get(g,1),score:p,name:hi[g]}}),a.dispose(),u.dispose(),[2,{keypoints:f,score:r/f.length}]}})})}function F2e(t,e,n){return Ot(this,void 0,void 0,function(){var r,a,s;return Rt(this,function(o){return r=tH(t),a=function(i,l,u){return at(function(){var c=R2e(i,u);return Ke(zt(_e(i,bt(l,"int32")),"float32"),c)})}(r,n,e),s=P2e(t,r),[2,[a,s]]})})}function bj(t,e){return(t-1)%e==0}var wj="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",Sj="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function Cj(t,e){return function(n,r){return(n-1)%r==0}(t,e)?t:Math.floor(t/e)*e+1}var _j=function(){function t(e,n){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;j(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var a,s,o=(a=n.inputResolution,s=n.outputStride,{height:Cj(a.height,s),width:Cj(a.width,s)});(function(i){j(S2e.indexOf(i)>=0,function(){return"outputStride of ".concat(i," is invalid. ")+"It must be either 8 or 16."})})(n.outputStride),function(i,l){j(bj(i.height,l),function(){return"height of ".concat(i.height," is invalid for output stride ")+"".concat(l,".")}),j(bj(i.width,l),function(){return"width of ".concat(i.width," is invalid for output stride ")+"".concat(l,".")})}(o,n.outputStride),this.inputResolution=o,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=pj),Ot(this,void 0,void 0,function(){return Rt(this,function(r){return[2,this.estimatePosesGPU(e,n,!1)]})})},t.prototype.estimatePosesGPU=function(e,n,r){return n===void 0&&(n=pj),r===void 0&&(r=!1),Ot(this,void 0,void 0,function(){var a,s,o,i,l,u,c,d,f,h,p,g,y,v,x,b,w,C;return Rt(this,function(_){switch(_.label){case 0:return a=function($){var k=$;if(k.maxPoses==null&&(k.maxPoses=1),k.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(k.maxPoses,". Should be > 0."));if(k.maxPoses>1){if((k=yn(yn({},C2e),k)).scoreThreshold<0||k.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(k.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(k.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(k.nmsRadius,"."))}return k}(n),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=a.maxPoses,s=xN(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),o=s.imageTensor,i=s.padding,l=this.architecture==="ResNet50"?Ke(o,_2e):GG(o,[-1,1]),u=this.posenetModel.predict(l),this.architecture==="ResNet50"?(c=tn(u[2],[0]),d=tn(u[3],[0]),f=tn(u[0],[0]),h=tn(u[1],[0])):(c=tn(u[0],[0]),d=tn(u[1],[0]),f=tn(u[2],[0]),h=tn(u[3],[0])),p=ei(d),this.maxPoses!==1?[3,5]:r?[4,F2e(p,c,this.outputStride)]:[3,2]);case 1:return y=_.sent(),x=y[0],v=y[1],g=[x,v],[3,4];case 2:return[4,M2e(p,c,this.outputStride)];case 3:x=_.sent(),g=[x],_.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,E2e(p,c,f,h,this.outputStride,this.maxPoses,a.scoreThreshold,a.nmsRadius)];case 6:g=_.sent(),_.label=7;case 7:if(r){if(a.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");b=this.getCanvasInfo(Jf(e),this.inputResolution,i)}else C=Jf(e),w=function($,k,A,P){var O=k.height,R=k.width,B=O/(A.height*(1-P.top-P.bottom)),F=R/(A.width*(1-P.left-P.right)),L=-P.top*A.height,H=-P.left*A.width;if(F===1&&B===1&&L===0&&H===0)return $;for(var te=0,V=$;te<V.length;te++)for(var Q=0,se=V[te].keypoints;Q<se.length;Q++){var le=se[Q];le.x=(le.x+H)*F,le.y=(le.y+L)*B}return $}(g,C,this.inputResolution,i),a.flipHorizontal&&(w=function($,k){for(var A=0,P=$;A<P.length;A++)for(var O=0,R=P[A].keypoints;O<R.length;O++){var B=R[O];B.x=k.width-1-B.x}return $}(w,C));return o.dispose(),l.dispose(),Jt(u),c.dispose(),d.dispose(),f.dispose(),h.dispose(),p.dispose(),[2,r?[g,b]:w]}})})},t.prototype.getCanvasInfo=function(e,n,r){var a=e.height,s=e.width,o=a/(n.height*(1-r.top-r.bottom)),i=s/(n.width*(1-r.left-r.right)),l=-r.top*n.height;return[-r.left*n.width,l,i,o,e.width,e.height]},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function L2e(t){return t===void 0&&(t=uj),Ot(this,void 0,void 0,function(){var e,n,r,a,s;return Rt(this,function(o){switch(o.label){case 0:return(e=function(c){var d=c||uj;if(d.architecture==null&&(d.architecture="MobileNetV1"),cj.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(cj));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),dj[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(dj[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),fj[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(fj[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),hj.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat(hj," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(i=e.outputStride,l=e.quantBytes,u="model-stride".concat(i,".json"),n=l===4?Sj+"float/"+u:Sj+"quant".concat(l,"/")+u,[4,Yf(e.modelUrl||n)]);case 1:return r=o.sent(),[2,new _j(r,e)];case 2:return a=function(c,d,f){var h={1:"100",.75:"075",.5:"050"},p="model-stride".concat(c,".json");return f===4?wj+"float/".concat(h[d],"/")+p:wj+"quant".concat(f,"/").concat(h[d],"/")+p}(e.outputStride,e.multiplier,e.quantBytes),[4,Yf(e.modelUrl||a)];case 3:return s=o.sent(),[2,new _j(s,e)]}var i,l,u})})}function nH(t,e){return Ot(this,void 0,void 0,function(){var n,r;return Rt(this,function(a){switch(t){case Io.PoseNet:return[2,L2e(e)];case Io.BlazePose:if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,p2e(e)];if(n.runtime==="mediapipe")return[2,BSe(e)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case Io.MoveNet:return[2,w2e(e)];default:throw new Error("".concat(t," is not a supported model name."))}})})}var rH={modelType:{SINGLEPOSE_LIGHTNING:"SinglePose.Lightning",SINGLEPOSE_THUNDER:"SinglePose.Thunder",MULTIPOSE_LIGHTNING:"MultiPose.Lightning"}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xu={},Zb={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function B2e(t,e){Xu[t]=e}function Ao(t,e){if(!(t in Xu)||e!=null){const r=U2e(t,e);if(r!==null)Xu[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Xu[t];return n==null||n.isContextLost()?(delete Xu[t],Ao(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Xu[t])}function z2e(t){if(!ee().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function U2e(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??z2e(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Xu[t]},!1),ee().getBool("SOFTWARE_WEBGL_ENABLED")&&(Zb.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Zb)||n.getContext("experimental-webgl",Zb):n.getContext("webgl2",Zb)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fy;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(fy||(fy={}));var ps;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ps||(ps={}));var Dr;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Dr||(Dr={}));function eb(t,e){return[e,t]}function V2e(t,e){return t*e}function e0(t){const e=ne(t),n=Math.ceil(e/4);return Ew(n)}function Rp(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function W2e(t,e){const[n,r]=Rp(t,e);return n*r*4}function EP(t,e){const n=t;let r,a,s,o,i,l,u,c,d,f;return ee().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,s=n.RGBA16F,o=n.RGBA32F,i=n.RED,u=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,l=n.RGBA8):(r=t.RGBA,a=t.RGBA,s=t.RGBA,o=n.RGBA,i=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(t,e){const n=e();return ee().getBool("DEBUG")&&G2e(t),n}function G2e(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+sH(t,e))}const H2e=596e-10,q2e=65504;function aH(t){return!!(ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||H2e<Math.abs(t)&&Math.abs(t)<q2e)}function sH(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Zm(t,e){return nl(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function oH(t,e){const n=nl(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Me(t,()=>t.shaderSource(n,e)),Me(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function iH(t,e){const n=nl(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Me(t,()=>t.shaderSource(n,e)),Me(t,()=>t.compileShader(n)),ee().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw AP(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const K2e=/ERROR: [0-9]+:([0-9]+):/g;function AP(t,e){const n=K2e.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],a=t.split(`
`),s=a.length.toString().length+2,o=a.map((d,f)=>fc((f+1).toString(),s)+d);let i=0;for(let d=0;d<o.length;d++)i=Math.max(o[d].length,i);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${fc(u[0],i)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function lH(t){return nl(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function uH(t,e){if(Me(t,()=>t.linkProgram(e)),!ee().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function K0(t,e){if(Me(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function cH(t,e){const n=nl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Me(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function dH(t,e){const n=nl(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Me(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Me(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function X2e(){return ee().getNumber("WEBGL_VERSION")===2?1:4}function fH(t){return nl(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function hH(t,e){const n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function pH(t){return nl(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function SN(t,e,n,r,a,s,o){const i=t.getAttribLocation(e,n);return i===-1?!1:(Me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),Me(t,()=>t.vertexAttribPointer(i,a,t.FLOAT,!1,s,o)),Me(t,()=>t.enableVertexAttribArray(i)),!0)}function mH(t,e,n){bH(t,n),Me(t,()=>t.activeTexture(t.TEXTURE0+n)),Me(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Y2e(t,e){bH(t,e),Me(t,()=>t.activeTexture(t.TEXTURE0+e)),Me(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function gH(t,e,n){return nl(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function yH(t,e,n){return t.getUniformLocation(e,n)}function vH(t,e,n,r){Me(t,()=>mH(t,e,r)),Me(t,()=>t.uniform1i(n,r))}function Q2e(t){Me(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Me(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),Me(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function X0(t,e,n){Me(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Me(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function CN(t,e){Me(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Me(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function eg(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+xH(t,e))}function xH(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function nl(t,e,n){const r=Me(t,()=>e());if(r==null)throw new Error(n);return r}function bH(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function Bc(t,e=2){return ne(t.slice(0,t.length-e))}function zc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function tg(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Bc(t),...zc(t)]),e}function wH(t,e=!1){let n=ee().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ee().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ee().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((i,l)=>l>=t.length-2?bS(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Ji(t).newShape);let a=ne(t),s=null;t.length<=1&&a<=n?s=[1,a]:t.length===2&&t[0]<=n&&t[1]<=n?s=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?s=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?s=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?s=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(s=[t[0],t[1]*t[2]*t[3]]);const o=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(e?2:1)&&Math.min(...s)>0;if(s==null||o)if(e){const i=Bc(t);let l=2,u=2;t.length&&([l,u]=zc(t)),a=i*(l/2)*(u/2),s=Ew(a).map(c=>c*2)}else s=Ew(a);return s}function t0(t){return t%2===0}function hy(t,e){if(t=t.slice(-2),e=e.slice(-2),Kt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||t0(n)&&t0(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&t0(t[0])&&t0(e[0])}let Y0,Q0;function SH(t){if(Y0==null){const e=Ao(t);Y0=e.getParameter(e.MAX_TEXTURE_SIZE)}return Y0}function J2e(){Y0=null}function Z2e(){Q0=null}function CH(t){if(Q0==null){const e=Ao(t);Q0=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Q0)}function _H(t){if(t===0)return 0;let e;const n=Ao(t);return ms(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ms(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ms(t,e){return t.getExtension(e)!=null}function _N(t){try{if(Ao(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function $H(t){if(t===0)return!1;const e=Ao(t);if(t===1){if(!ms(e,"OES_texture_float"))return!1}else if(!ms(e,"EXT_color_buffer_float"))return!1;return $N(e)}function kH(t){if(t===0)return!1;const e=Ao(t);if(t===1){if(!ms(e,"OES_texture_float")||!ms(e,"WEBGL_color_buffer_float"))return!1}else{if(ms(e,"EXT_color_buffer_float"))return $N(e);const r="EXT_color_buffer_half_float";if(ms(e,r)){const a=e.getExtension(r);return eCe(e,a)}return!1}return $N(e)}function $N(t){const e=EP(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(s),o}function eCe(t,e){const n=EP(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),i}function NH(t){return t!==2?!1:Ao(t).fenceSync!=null}function Dp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const Fpt=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:Dp,bindCanvasToFramebuffer:Q2e,bindColorTextureToFramebuffer:X0,bindTextureToProgramUniformSampler:vH,bindTextureUnit:mH,bindVertexBufferToProgramAttribute:SN,callAndCheck:Me,canBeRepresented:aH,createFragmentShader:iH,createFramebuffer:pH,createProgram:lH,createStaticIndexBuffer:dH,createStaticVertexBuffer:cH,createTexture:fH,createVertexShader:oH,getBatchDim:Bc,getExtensionOrThrow:Zm,getFramebufferErrorMessage:xH,getMaxTexturesInShader:CH,getNumChannels:X2e,getProgramUniformLocation:yH,getProgramUniformLocationOrThrow:gH,getRowsCols:zc,getShapeAs3D:tg,getTextureShapeFromLogicalShape:wH,getWebGLDisjointQueryTimerVersion:_H,getWebGLErrorMessage:sH,getWebGLMaxTextureSize:SH,hasExtension:ms,isCapableOfRenderingToFloatTexture:$H,isDownloadFloatTextureEnabled:kH,isReshapeFree:hy,isWebGLFenceEnabled:NH,isWebGLVersionEnabled:_N,linkProgram:uH,logShaderSourceAndInfoLog:AP,resetMaxTextureSize:J2e,resetMaxTexturesInShader:Z2e,unbindColorTextureFromFramebuffer:CN,unbindTextureUnit:Y2e,validateFramebuffer:eg,validateProgram:K0,validateTextureSize:hH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xe=ee();Xe.registerFlag("HAS_WEBGL",()=>Xe.getNumber("WEBGL_VERSION")>0);Xe.registerFlag("WEBGL_VERSION",()=>_N(2)?2:_N(1)?1:0);Xe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Xe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Xe.get("WEBGL_VERSION")===2);Xe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Xe.registerFlag("WEBGL_PACK",()=>Xe.getBool("HAS_WEBGL"));Xe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_CLIP",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_REDUCE",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_LAZILY_UNPACK",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_CONV_IM2COL",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Xe.getBool("WEBGL_PACK"));Xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>SH(Xe.getNumber("WEBGL_VERSION")));Xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>CH(Xe.getNumber("WEBGL_VERSION")));Xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Xe.getNumber("WEBGL_VERSION");return t===0?0:_H(t)});Xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ME());Xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>$H(Xe.getNumber("WEBGL_VERSION")));Xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Xe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>kH(Xe.getNumber("WEBGL_VERSION")));Xe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>NH(Xe.getNumber("WEBGL_VERSION")));Xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Xe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Xe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>ME()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Xe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Xe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Xe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Xe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Xe.registerFlag("WEBGL_EXP_CONV",()=>!1);Xe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Xe.getBool("IS_TEST"));Xe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Xe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Xe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Xe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(){let t,e,n,r,a,s,o,i,l,u;return ee().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",a="texture",s="outputColor",o="out vec4 outputColor;",i=ee().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",a="texture2D",s="gl_FragColor",o="",i=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:s,defineOutput:o,defineSpecialNaN:i,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cd(t,e,n="index"){const r=Dt(e);return r.map((a,s)=>{const o=`int ${t[s]} = ${n} / ${a}`,i=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * ${a}`:`index -= ${t[s]} * ${a}`;return`${o}; ${i};`}).join("")}function N2(t,e,n="index"){const r=Dt(e);return r.map((a,s)=>{const o=`int ${t[s]} = ${n} / outShapeStrides[${s}]`,i=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * outShapeStrides[${s}]`:`index -= ${t[s]} * outShapeStrides[${s}]`;return`${o}; ${i};`}).join("")}function tCe(t,e){const n=t.length,r=t.map(s=>`${e}[${s}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let s=n-3;s>=0;--s)a[s]=`(${a[s+1]} * ${r[s+1]})`;return a}function nCe(t,e,n="index"){const r=t.map((s,o)=>o),a=tCe(r,e);return a.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${a[o]}`,l=o===a.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${a[o]}`:`index -= ${t[o]} * ${a[o]}`;return`${i}; ${l};`}).join("")}function PP(t){const e=Dt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function OP(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const IH=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:TH}=Q5;function rCe(t,e,n){const r=[];if(t.forEach(h=>{const p=ne(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:g}=RP(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const a=r.join(`
`),s=t.map(h=>aCe(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,i=ga(),l=iCe(i);let u,c,d=cCe(i);return e.isPacked?(u=sCe(e.logicalShape,o,n.enableShapeUniforms),c=uCe(i)):(u=oCe(e.logicalShape,o,n.enableShapeUniforms),c=lCe(i)),n.packedInputs&&(d+=pCe),[d,l,c,a,u,s,n.userCode].join(`
`)}function jp(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return kCe(t,e);case 1:return ICe(t,e);case 2:return ECe(t,e);case 3:return PCe(t,e);case 4:return RCe(t,e);case 5:return DCe(t);case 6:return jCe(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function EH(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return $Ce(t);case 1:return NCe(t,e);case 2:return TCe(t,e);case 3:return ACe(t,e);default:return OCe(t,e)}}function aCe(t,e,n=!1,r){let a="";n?a+=EH(t,r):a+=jp(t,r);const s=t.shapeInfo.logicalShape,o=e.logicalShape;return s.length<=o.length&&(n?a+=MCe(t,e):a+=FCe(t,e)),a}function sCe(t,e,n){switch(t.length){case 0:return AH();case 1:return mCe(t,e,n);case 2:return CCe(t,e,n);case 3:return yCe(t,e,n);default:return xCe(t,e,n)}}function oCe(t,e,n){switch(t.length){case 0:return AH();case 1:return gCe(t,e,n);case 2:return _Ce(t,e,n);case 3:return vCe(t,e,n);case 4:return bCe(t,e,n);case 5:return wCe(t,e);case 6:return SCe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function iCe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function lCe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function uCe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function cCe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${dCe}
    ${fCe}
    ${hCe}
  `}const dCe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,fCe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hCe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,pCe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function AH(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function mCe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function gCe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function yCe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),s=a*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function vCe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${N2(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=cd(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function xCe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),s=a*Math.ceil(t[t.length-2]/2);let o=s,i="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],i=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+i,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${i}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${t.length}(${l});
    }
  `}function bCe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${N2(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=cd(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function wCe(t,e){const n=cd(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function SCe(t,e){const n=cd(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function CCe(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Kt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const a=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function _Ce(t,e,n){return Kt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function dd(t){return`offset${t}`}function $Ce(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ga();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function kCe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[a,s]=t.shapeInfo.texShape;if(a===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=dd(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[i,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${i}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function NCe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,s=ga();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function ICe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Mp(t)}
      }
    `;const a=t.shapeInfo.texShape,s=a[0],o=a[1];if(o===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=dd(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${i});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${o}, index + ${i});
      return sampleTexture(${n}, uv);
    }
  `}function TCe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,o=s[0],i=s[1],l=ga();if(s!=null&&Kt(n,s))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function ECe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(s!=null&&Kt(n,s)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const f=s[0],h=s[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:i}=Ji(n),l=o;if(l.length<n.length){const f=Fp(t,l),h=["row","col"];return`
      ${jp(f,e)}
      float ${a}(int row, int col) {
        return ${a}(${Lp(h,i)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Mp(t)}
      }
    `;const u=s[0],c=s[1],d=dd(r);return c===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function ACe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const f=n.slice(1),h=[1,2],p=Fp(t,f),g=["b","row","col"];return`
        ${EH(p,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${Lp(g,h)});
        }
      `}const i=ga();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${i.texture2D}(${r}, uv);
    }
  `}function PCe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],o=n[2],{newShape:i,keptDims:l}=Ji(n),u=i;if(u.length<n.length){const g=Fp(t,u),y=["row","col","depth"];return`
        ${jp(g,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${Lp(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${o}, 1)));
        ${Mp(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===s&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===o&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=dd(r);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${o} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function OCe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ga();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;const s=t.shapeInfo.logicalShape,o=s.length,i=t.shapeInfo.texShape,l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=l[0],c=l[1],d=Math.ceil(s[o-1]/2);let f=d*Math.ceil(s[o-2]/2),h="int b, int row, int col",p=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<o-1;g++)h=`int b${g}, `+h,f*=s[o-g-1],p=`b${g} * ${f} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${a.texture2D}(${n}, uv);
    }
  `}function RCe(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],o=n[2]*s,i=n[1]*o,{newShape:l,keptDims:u}=Ji(n);if(l.length<n.length){const x=Fp(t,l),b=["row","col","depth","depth2"];return`
      ${jp(x,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${Lp(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${i}, ${o}, ${s}, 1)));
        ${Mp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1],p=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(h===i&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===s&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;const v=dd(r);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${v});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${o} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${f}, ${h}, index + ${v});
      return sampleTexture(${r}, uv);
    }
  `}function DCe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],s=e[3]*a,o=e[2]*s,i=e[1]*o,{newShape:l,keptDims:u}=Ji(e);if(l.length<e.length){const g=Fp(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${jp(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Lp(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${i}, ${o}, ${s}, ${a})) +
          depth3;
        ${Mp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=dd(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${i} + col * ${o} + depth * ${s} +
          depth2 * ${a} + depth3 + ${p};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function jCe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:s}=Ji(e);if(a.length<e.length){const y=Fp(t,a),v=["row","col","depth","depth2","depth3","depth4"];return`
      ${jp(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Lp(v,s)});
      }
    `}const o=e[5],i=e[4]*o,l=e[3]*i,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${i})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Mp(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${i}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=dd(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${i} + depth3 * ${o} + depth4 + ${g};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Mp(t){const e=t.name,n=ne(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function MCe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",s=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,i=TH(t.shapeInfo.logicalShape,e.logicalShape),l=hn(o),u=o-s;let c;const d=["x","y","z","w","u","v"];s===0?c="":o<2&&i.length>=1?c="coords = 0;":c=i.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let f="";o<2&&s>0?f="coords":f=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+u]}`).join(", ");let h="return outputValue;";const g=ne(t.shapeInfo.logicalShape)===1,v=ne(e.logicalShape)===1;if(s===1&&!g&&!v)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!v)o===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(i.length){const x=s-2,b=s-1;i.indexOf(x)>-1&&i.indexOf(b)>-1?h="return vec4(outputValue.x);":i.indexOf(x)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":i.indexOf(b)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${f});
      ${h}
    }
  `}function FCe(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",s=e.texShape,o=t.shapeInfo.texShape,i=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&i===l&&t.shapeInfo.flatOffset==null&&Kt(o,s))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=hn(l),c=TH(t.shapeInfo.logicalShape,e.logicalShape),d=l-i;let f;const h=["x","y","z","w","u","v"];i===0?f="":l<2&&c.length>=1?f="coords = 0;":f=c.map(g=>`coords.${h[g+d]} = 0;`).join(`
`);let p="";return l<2&&i>0?p="coords":p=t.shapeInfo.logicalShape.map((g,y)=>`coords.${h[y+d]}`).join(", "),`
    float ${a}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${r}(${p});
    }
  `}function hn(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function RP(t,e,n){const{newShape:r,keptDims:a}=Ji(e),s=e.length,o=t&&s===3&&e[0]===1,i=o?e.slice(1):r,l=!t&&s>1&&!Kt(e,n)&&r.length<s||o;return{useSqueezeShape:l,uniformShape:l?i:e,keptDims:a}}function Fp(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Lp(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(t,e,n,r){const a=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),s=a.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},i=rCe(a,o,e),l=iH(t.gl,i),u=t.createProgram(l);return ee().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:s,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:s,outShapeInfo:o},PH(t,e,u)))}function PH(t,e,n){const r=[],a=[];let s,o,i,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),ee().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(f)}if(e.enableShapeUniforms&&(s=t.getUniformLocation(n,"outShape",c),i=t.getUniformLocation(n,"outShapeStrides",c),o=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)a.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:a,infLoc:l,nanLoc:u,outShapeLocation:s,outShapeStridesLocation:i,outTexShapeLocation:o}}function $j(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const a=n.logicalShape,s=e[r],o=s.shape;if(!Kt(a,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${o} must match`);if(n.isUniform&&s.isUniform)return;const i=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!Kt(i,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${i} and ${l} must match`)})}function BCe(t,e,n,r,a){e.program.enableShapeUniforms||($j(e.inShapeInfos,n),$j([e.outShapeInfo],[r]));const s=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,o[0],o[1]):t.setOutputMatrixTexture(s.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),ee().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:f,texShape:h}=e.variablesLocations[l];if(f){const{uniformShape:p}=RP(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(f,new Int32Array(p));break;case 2:t.gl.uniform2iv(f,new Int32Array(p));break;case 3:t.gl.uniform3iv(f,new Int32Array(p));break;case 4:t.gl.uniform4iv(f,new Int32Array(p));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(ne(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const i=e.outShapeLocation;if(i)switch(r.shape.length){case 1:t.gl.uniform1iv(i,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(i,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(i,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(i,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Dt(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=a[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function zCe(t,e,n){let r="";e.concat(n).forEach(o=>{const i=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=RP(t.packedInputs,o.shape,l);let f="",h="",p="";if(c.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const C=Dt(c);p=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const g=o.shape.length,y=c.length===2&&Kt(o.shape,l),v=ne(o.shape)===1,x=Mc(o.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&Kt(l,n.texData.texShape),w=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${b}_${u?d:""}_${c.length}_${v}_${x}_${y}_${f}_${h}_${p}_${w}_${i}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${i}`}});const a=t.userCode;let s=t.constructor.name;return s+="_"+r+"_"+a+`${ee().getNumber("WEBGL_VERSION")}`,s}function Jr(t){return ee().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=fy.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ga();this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?N2(["r","c","d"],e):cd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VCe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=fy.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ga();this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?N2(["r","c","d"],e):cd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WCe{constructor(e){this.variableNames=["A"],this.outTexUsage=ps.DOWNLOAD;const n=ga();this.outputShape=e,this.userCode=`
      ${IH}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GCe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ps.DOWNLOAD;const n=ga();this.outputShape=e,this.userCode=`
      ${IH}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HCe={R:0,G:1,B:2,A:3};class kj{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=ga();this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let o="";for(let i=0;i<r.length;i++){const l=r[i];o+=`
          if(offset == ${i}) {
            result = values[${HCe[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?OP():PP(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${a.texture2D}(A, uv);
          ${o}
        }
        ${a.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qCe{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ga();this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length);let a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let i=0;i<=1;i++){const l=o*2+i;a+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?OP():PP(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(t){const e=ga(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return oH(t,n)}function RH(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return cH(t,e)}function DH(t){const e=new Uint16Array([0,1,2,2,1,3]);return dH(t,e)}function tb(t,e,n,r,a,s){hH(e,n);const o=fH(t),i=t.TEXTURE_2D;return Me(t,()=>t.bindTexture(i,o)),Me(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Me(t,()=>t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Me(t,()=>t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST)),Me(t,()=>t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST)),ee().getNumber("WEBGL_VERSION")===1?Me(t,()=>t.texImage2D(i,0,r,e,n,0,a,s,null)):Me(t,()=>t.texStorage2D(i,1,r,e,n)),Me(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function DP(t){return t.internalFormatFloat}function jH(t,e,n,r){const[a,s]=eb(e,n);return tb(t,a,s,DP(r),r.textureFormatFloat,t.FLOAT)}function jP(t){return t.internalFormatHalfFloat}function MH(t,e,n,r){const[a,s]=eb(e,n);return tb(t,a,s,jP(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function MP(t){return t.downloadTextureFormat}function FH(t,e,n,r){const[a,s]=eb(e,n);return tb(t,a,s,MP(r),t.RGBA,t.UNSIGNED_BYTE)}function FP(t){return t.internalFormatPackedFloat}function LH(t,e,n,r){const[a,s]=Rp(e,n);return tb(t,a,s,FP(r),t.RGBA,t.FLOAT)}function LP(t){return t.internalFormatPackedHalfFloat}function BH(t,e,n,r){const[a,s]=Rp(e,n);return tb(t,a,s,LP(r),t.RGBA,r.textureTypeHalfFloat)}function zH(t,e,n){return Me(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),SN(t,e,"clipSpacePos",n,3,20,0)&&SN(t,e,"uv",n,2,20,12)}function UH(t,e,n,r,a,s){Me(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,i,l;a instanceof Uint8Array?(o=new Uint8Array(n*r*4),i=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),i=t.FLOAT,l=s.internalFormatPackedFloat),o.set(a),ee().getNumber("WEBGL_VERSION")===2?Me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,i,o)):Me(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,i,o)),Me(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function VH(t,e,n){Me(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ee().getNumber("WEBGL_VERSION")===2?Me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Me(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ee().getNumber("WEBGL_VERSION")===2?Me(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Me(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Me(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function WH(t,e,n,r){const a=t.createBuffer();Me(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const i=4*4*e*n;return Me(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),Me(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Me(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function GH(t,e,n){const r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function HH(t,e,n,r){const[a,s]=eb(e,n),o=4,i=new Uint8Array(V2e(e*n,o));return Me(t,()=>t.readPixels(0,0,a,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,i)),new Float32Array(i.buffer)}function qH(t,e,n,r,a,s,o,i){const l=t,u=new Float32Array(W2e(s,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function KH(t,e,n){const r=new Float32Array(e*n*4);return Me(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}const Lpt=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:zH,createBufferFromOutputTexture:WH,createFloat16MatrixTexture:MH,createFloat16PackedMatrixTexture:BH,createFloat32MatrixTexture:jH,createIndexBuffer:DH,createPackedMatrixTexture:LH,createUnsignedBytesMatrixTexture:FH,createVertexBuffer:RH,createVertexShader:OH,downloadByteEncodedFloatMatrixFromOutputTexture:HH,downloadFloat32MatrixFromBuffer:GH,downloadMatrixFromPackedOutputTexture:KH,downloadPackedMatrixFromBuffer:qH,getInternalFormatForFloat16MatrixTexture:jP,getInternalFormatForFloat16PackedMatrixTexture:LP,getInternalFormatForFloat32MatrixTexture:DP,getInternalFormatForPackedMatrixTexture:FP,getInternalFormatForUnsignedBytesMatrixTexture:MP,uploadDenseMatrixToTexture:UH,uploadPixelDataToTexture:VH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z_{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ee().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,B2e(n,e)):this.gl=Ao(n),e=this.gl,ee().getNumber("WEBGL_VERSION")===2){const s=e;this.createVertexArray=()=>Me(s,()=>s.createVertexArray()),this.bindVertexArray=o=>Me(s,()=>s.bindVertexArray(o)),this.deleteVertexArray=o=>Me(s,()=>s.deleteVertexArray(o)),this.getVertexArray=()=>Me(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(e!=null){const s=e.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Me(e,()=>s.createVertexArrayOES()),this.bindVertexArray=o=>Me(e,()=>s.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Me(e,()=>s.deleteVertexArrayOES(o)),this.getVertexArray=()=>Me(e,()=>e.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ee().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=Zm(this.gl,s),ms(this.gl,o))this.textureHalfFloatExtension=Zm(this.gl,o);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ms(this.gl,a))this.colorBufferHalfFloatExtension=Zm(this.gl,a);else if(ee().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ms(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ms(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=RH(this.gl),this.indexBuffer=DH(this.gl),this.framebuffer=pH(this.gl),this.textureConfig=EP(this.gl,this.textureHalfFloatExtension)}get debug(){return ee().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Me(e,()=>e.finish()),Me(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Me(e,()=>e.deleteFramebuffer(this.framebuffer)),Me(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Me(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Me(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),jH(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),MH(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),FH(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),VH(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,a){this.throwIfDisposed(),UH(this.gl,e,n,r,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),BH(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),LH(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(CN(this.gl,this.framebuffer),this.outputTexture=null),Me(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>HH(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,a,s,o){return qH(this.gl,e,n,r,a,s,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return GH(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const a=WH(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(ee().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,s=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=a.clientWaitSync(s,0,0);return o===a.ALREADY_SIGNALED||o===a.CONDITION_SATISFIED},n=s}else ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>KH(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=OH(n));const r=lH(n);Me(n,()=>n.attachShader(r,this.vertexShader)),Me(n,()=>n.attachShader(r,e)),uH(n,r);const a=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&K0(n,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Me(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),zH(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Me(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&K0(this.gl,this.program),Me(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?gH(this.gl,e,n):yH(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Me(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),vH(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[a,s]=Rp(n,r);this.setOutputMatrixTextureDriver(e,a,s)}setOutputMatrixWriteRegion(e,n,r,a){this.setOutputMatrixWriteRegionDriver(r,e,a,n)}setOutputPackedMatrixWriteRegion(e,n,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&K0(this.gl,this.program),eg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Me(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Me(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Zm(this.gl,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(a.TIME_ELAPSED_EXT,s),s}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Fk(()=>this.disposed||this.isQueryAvailable(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),a=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=KCe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ee().platform&&(r=ee().platform.setTimeoutCustom.bind(ee().platform)),Fk(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),X0(this.gl,e,this.framebuffer),this.debug&&eg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(X0(this.gl,this.outputTexture,this.framebuffer),this.debug&&eg(this.gl)):CN(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const a=this.gl;X0(a,e,this.framebuffer),this.debug&&eg(a),this.outputTexture=e,Me(a,()=>a.viewport(0,0,n,r)),Me(a,()=>a.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,a){this.throwIfDisposed(),Me(this.gl,()=>this.gl.scissor(e,n,r,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function KCe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:XCe,bincountImpl:XH,bincountReduceImpl:YCe,bitwiseAndImpl:QCe,castImpl:JCe,ceilImpl:ZCe,concatImpl:e_e,equalImpl:t_e,expImpl:n_e,expm1Impl:r_e,floorImpl:a_e,gatherNdImpl:s_e,gatherV2Impl:o_e,greaterImpl:i_e,greaterEqualImpl:l_e,lessImpl:u_e,lessEqualImpl:c_e,linSpaceImpl:d_e,logImpl:f_e,maxImpl:h_e,maximumImpl:p_e,minimumImpl:m_e,multiplyImpl:g_e,negImpl:y_e,notEqualImpl:v_e,prodImpl:x_e,raggedGatherImpl:b_e,raggedRangeImpl:w_e,raggedTensorToTensorImpl:S_e,rangeImpl:C_e,rsqrtImpl:__e,scatterImpl:$_e,sigmoidImpl:k_e,simpleAbsImpl:YH,sliceImpl:N_e,sparseFillEmptyRowsImpl:I_e,sparseReshapeImpl:T_e,sparseSegmentReductionImpl:QH,sqrtImpl:E_e,staticRegexReplaceImpl:A_e,stridedSliceImpl:P_e,stringNGramsImpl:O_e,stringSplitImpl:R_e,stringToHashBucketFastImpl:D_e,subImpl:j_e,tileImpl:M_e,topKImpl:F_e,transposeImpl:BP,uniqueImpl:L_e}=mG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function fa(t,e){return e===1?[t]:JH(t,e)}function B_e(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z_e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Jr(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=fa("rc",this.rank),r=hn(this.rank),a=this.getOutOfBoundsCondition(n),s=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let s=`${r===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)s=`${e[e.length-1-o]},`+s;n.push(s)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZH{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length);let r="";for(let a=0;a<4;a++){let s="thisRC = rc;";a%2===1&&(s+="thisRC.z += 1;"),a>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${U_e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?OP():PP(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function U_e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?nCe(["r","c","d"],"inputShape"):cd(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V_e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const a=Ij(n,r),s=Tj(e,a,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const o=Nj(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let i;return a===Dr.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Dr.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Dr.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Dr.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Dr.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}releaseTexture(e,n,r,a){if(this.freeTextures==null)return;const s=Ij(r,a),o=Tj(n,s,a);o in this.freeTextures||(this.freeTextures[o]=[]);const i=Nj(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,a),l=ee().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=i):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;const u=this.usedTextures[o],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function W_e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Nj(t,e,n,r,a){const s=G_e(e,r);let o;if(a){const[l,u]=Rp(t[0],t[1]);o=l*u}else{const[l,u]=eb(t[0],t[1]);o=l*u}const i=W_e(n,s);return o*i}function G_e(t,e){switch(t){case Dr.PACKED_2X2_FLOAT32:return FP(e);case Dr.PACKED_2X2_FLOAT16:return LP(e);case Dr.UNPACKED_FLOAT32:return DP(e);case Dr.UNPACKED_FLOAT16:return jP(e);case Dr.PACKED_4X1_UNSIGNED_BYTE:return MP(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function H_e(t){return ee().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Dr.PACKED_2X2_FLOAT32:Dr.UNPACKED_FLOAT32:t?Dr.PACKED_2X2_FLOAT16:Dr.UNPACKED_FLOAT16}function Ij(t,e){if(t===ps.UPLOAD)return Dr.PACKED_2X2_FLOAT32;if(t===ps.RENDER||t==null)return H_e(e);if(t===ps.DOWNLOAD||t===ps.PIXELS)return Dr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function Tj(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xo{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ao="if (isnan(x)) return x;",q_e="return x;",Ej="return abs(x);",K_e="return (x >= 0.0) ? x : (exp(x) - 1.0);",X_e=ao+`
  return (x < 0.0) ? 0.0 : x;
`,Y_e=ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,vl="return x;",Q_e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J_e="return x;",Z_e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,e$e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,t$e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,n$e="return 1.0 / (1.0 + exp(-1.0 * x));";class Pl{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r$e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length);const n=e.length,r=fa("rc",n),a=hn(n),s=B_e(n,r),o=r.slice(-2),i=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${i}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a$e=RA,s$e=1e-7,o$e=1e-4,n0={};function i$e(t){return t in n0||(n0[t]={}),n0[t]}const l$e=ee().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),u$e=600;function c$e(){return ee().global.screen==null?1024:ee().global.screen.height*ee().global.screen.width*window.devicePixelRatio*u$e/1024/1024}class I2 extends iv{nextDataId(){return I2.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ee().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof z_)n=e;else{const r=Ao(ee().getNumber("WEBGL_VERSION"),e);n=new z_(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Ao(ee().getNumber("WEBGL_VERSION"));n=new z_(r),this.binaryCache=i$e(ee().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new V_e(this.gpgpu),this.numMBBeforeWarning=c$e(),this.texData=new xS(this,ia())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,a,s,o){const i=this.makeTensorInfo(n,r),l=this.texData.get(i.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[a,s]},l.texShape=[a,s];const u=tg(n),c=new kj(u,!1,o),d=this.runWebGLProgram(c,[i],r,[[a,s]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(i),d.dataId}write(e,n,r){if((ee().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ee().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:r,values:e,usage:ps.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,a,s){if(ee().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:a,values:n,usage:ps.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:a,complexTensorInfos:s,slice:o,shape:i,isPacked:l}=n;if(o!=null){let f;l?f=new Pl(i,vl):f=new Xo(i,vl);const h=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:a}],a),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Va());let d;if(a==="complex64"){const f=this.readSync(s.real.dataId),h=this.readSync(s.imag.dataId);d=iy(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Va()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:r,shape:a,slice:s,dtype:o,complexTensorInfos:i,isPacked:l}=n;if(s!=null){let p;l?p=new Pl(a,vl):p=new Xo(a,vl);const g=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:o}],o),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(ee().getBool("DEBUG")&&!ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ee().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&ee().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...e0(a))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const p=await Promise.all([this.read(i.real.dataId),this.read(i.imag.dataId)]),g=p[0],y=p[1];d=iy(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=ne(a);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Me(p,()=>p.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(p=>p(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ia().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const r=this.texData.get(e),{values:a,shape:s,slice:o,dtype:i,isPacked:l,texture:u}=r;if(i==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let h;l?h=new Pl(s,vl):h=new Xo(s,vl);const p=this.runWebGLProgram(h,[{dataId:e,shape:s,dtype:i}],i),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(u==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=ia().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>si(a));return en(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return en(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!aH(r))throw ee().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:a}=this.texData.get(e),s=ne(n);if(ee().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),h=this.texData.get(f.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...e0(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(f),p}const o=ee().getBool("WEBGL_PACK")&&a===!0,i=o?tg(n):n,l=o?new GCe(i):new WCe(i),u=this.runWebGLProgram(l,[{shape:i,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();const s=eo(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=eo(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(s);i.kernelMs=$E(l),i.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else i.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,i})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Va(),endMs:null}}endTimer(e){return ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Va(),e)}async getQueryTime(e){if(ee().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:a,usage:s,isPacked:o,slice:i}=this.texData.get(e),l=i&&i.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,s,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=l$e){return ee().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&ne(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Us("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return a$e(e.shape,n)}packedUnaryOp(e,n,r){const a=new Pl(e.shape,n),s=this.compileAndRun(a,[e],r);return ia().makeTensorFromTensorInfo(s)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=YH(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(ee().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Ej,e.dtype);const n=new Xo(e.shape,Ej),r=this.compileAndRun(n,[e]);return ia().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&Ko(r[0])){const s=r.map(o=>Zo(o));a=this.write(s,e,n)}else a=this.write(r,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}}makeOutput(e,n,r){return ia().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new r$e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new z_e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[Bc(e.shape),...zc(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Bc(n),...zc(n)],o=new ZH(s,r),i=!0,l=[r],u=this.runWebGLProgram(o,[a],e.dtype,l,i);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:a,shape:s,dtype:o}=r;if(n!=null){const f=ne(s),h=n[0]*n[1]*4;j(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const i=tg(s);let l;a?l=new VCe(i):l=new UCe(i);const u=!0,c=[n??e0(i)],d=this.runWebGLProgram(l,[{shape:i,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:s,dataId:d.dataId}}runWebGLProgram(e,n,r,a,s=!1,o){const i=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(i.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===fy.DENSE){const v=o??e0(e.outputShape);l.texShape=v.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),ne(i.shape)===0)return l.values=Eo(i.dtype,0),i;const u=[],c=n.map(v=>{if(v.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(v.dataId);if(x.texture==null){if(!e.packedInputs&&ne(v.shape)<=ee().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:v.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=v.shape)}if(this.uploadToGPU(v.dataId),!!x.isPacked!=!!e.packedInputs)v=x.isPacked?this.unpackTensor(v):this.packTensor(v),u.push(v),x=this.texData.get(v.dataId);else if(x.isPacked&&!hy(x.shape,v.shape)){const b=v,w=v.shape;v.shape=x.shape,v=this.packedReshape(v,w),u.push(v),x=this.texData.get(v.dataId),b.shape=w}return{shape:v.shape,texData:x,isUniform:!1}});this.uploadToGPU(i.dataId);const d={shape:i.shape,texData:l,isUniform:!1},f=zCe(e,c,d),h=this.getAndSaveBinary(f,()=>LCe(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),ee().get("ENGINE_COMPILE_ONLY")||BCe(this.gpgpu,h,c,d,a),u.forEach(v=>this.disposeIntermediateTensorInfo(v)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=ee().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const v=Va();v-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=v)}if(!ee().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){const v=this.unpackTensor(i);return this.disposeIntermediateTensorInfo(i),v}return i}compileAndRun(e,n,r,a,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,a,s)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ee().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=at(()=>{if(!ee().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ee().getBool("DEBUG");ee().set("DEBUG",!1);const n=this.abs(bt(1e-8)).dataSync()[0];if(ee().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?s$e:o$e}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:a,values:s,texture:o,usage:i,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Va());let d=n.texShape;if(d==null&&(d=wH(r,l),n.texShape=d),s!=null){const f=tg(r);let h,p=d[1],g=d[0];const y=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!y)&&([p,g]=Rp(d[0],d[1])),l?h=new qCe(f,y):h=new kj(f,y);const v=y?[g,p]:d,x=this.makeTensorInfo(v,a),b=this.texData.get(x.dataId);y?b.usage=ps.PIXELS:b.usage=ps.UPLOAD,b.texShape=v,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,g,s);const w=[[g,p]],_=this.runWebGLProgram(h,[x],a,w,!0),$=this.texData.get(_.dataId);n.texShape=$.texShape,n.isPacked=$.isPacked,n.usage=$.usage,ee().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(n.texture=$.texture,n.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=Va()-c)}else{const f=this.acquireTexture(d,i,a,l);n.texture=f}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:a}=r;return n!=null&&(r.values=d$e(n,a)),r.values}acquireTexture(e,n,r,a){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,a)}computeBytes(e,n){return e[0]*e[1]*Nc(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(s){throw s}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await YA(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(AP(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:a,nanLoc:s,outShapeLocation:o,outShapeStridesLocation:i,outTexShapeLocation:l}=PH(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=a,e.nanLoc=s,e.outShapeLocation=o,e.outShapeStridesLocation=i,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:a,height:s,width:o,channels:i}=e,l=ia().backend;if(!l.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(a,n,r,s,o,i);return ia().makeTensorFromDataId(u,n,r,l)}}I2.nextDataId=0;function d$e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$e(){ee().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */FE()&&qS("webgl",()=>new I2,2);const Bpt={forceHalfFloat:f$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zP=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Uc{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=ct(n,r),this.enableShapeUniforms=Jr(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fd=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Bp{constructor(e,n,r,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ct(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Jr(s);let o="";if(a)if(s===0||ne(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${hn(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=fa("coords",s);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ts(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const h$e={kernelName:Zh,backendName:"webgl",kernelFunc:ts};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pu(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,s=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(s.dataId),i=ts({inputs:{x:r},backend:n}),l=ts({inputs:{x:a},backend:n});return o.complexTensorInfos={real:i,imag:l},s}const p$e={kernelName:kS,backendName:"webgl",kernelFunc:pu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e8="return (a < 0.) ? b * a : a;",t8=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function m$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:s}=r,o=n.makeTensorInfo([],"float32",td(s,"float32")),i=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bp(t8,a.shape,o.shape):new Uc(e8,a.shape,o.shape),l=n.runWebGLProgram(i,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const g$e={kernelName:ep,backendName:"webgl",kernelFunc:m$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8="return (a < 0.) ? b * a : a;",r8=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function y$e(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bp(r8,r.shape,a.shape):new Uc(n8,r.shape,a.shape);return n.runWebGLProgram(s,[r,a],"float32")}const v$e={kernelName:hp,backendName:"webgl",kernelFunc:y$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zp="if (isnan(x)) return x;";function Ft({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:s})=>{const{x:o}=a,i=s,l=r||o.dtype;if(i.shouldExecuteOnCPU([o])&&n!=null){const d=i.texData.get(o.dataId),f=n(d.values,l);return i.makeTensorInfo(o.shape,l,f)}const u=ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Pl(o.shape,e):c=new Xo(o.shape,t),i.runWebGLProgram(c,[o],l)}}function Lr({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:s}){return({inputs:o,backend:i})=>{const{a:l,b:u}=o,c=i;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[y,v]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[w,C]=b,_={dataId:w.dataId,dtype:w.dtype,shape:l.shape},$={dataId:C.dataId,dtype:C.dtype,shape:u.shape},k=new Uc(t,l.shape,u.shape);return c.runWebGLProgram(k,[_,$],pa(w.dtype,C.dtype))}),x=pu({inputs:{real:y,imag:v},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(v),x}const d=s||pa(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&a!=null){const p=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,y=l.dtype==="string"?tu(p):p,v=l.dtype==="string"?tu(g):g,[x,b]=a(l.shape,u.shape,y,v,d),w=c.makeTensorInfo(b,d),C=c.texData.get(w.dataId);return C.values=x,w}const f=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return f?h=new Bp(e,l.shape,u.shape,n):h=new Uc(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function py(t,e=!1){if(t==="linear")return e?J_e:q_e;if(t==="relu")return e?e$e:X_e;if(t==="elu")return e?Z_e:K_e;if(t==="relu6")return e?t$e:Y_e;if(t==="prelu")return e?r8:n8;if(t==="leakyrelu")return e?t8:e8;if(t==="sigmoid")return e?n$e:Q_e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a8{constructor(e,n,r,a=!1,s=!1,o=!1,i=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Jr(this.outputShape.length);const c=a?e[1]:e[2],d=Math.ceil(c/2),f=a?"i * 2, rc.y":"rc.y, i * 2",h=s?"rc.z, i * 2":"i * 2, rc.z",p=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",v="";i&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${i}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${i}
        }`:y=`vec4 activation(vec4 x) {
          ${i}
        }`,v="result = activation(result);");const x=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",w="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(w=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${w};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${v}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aj={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Pj{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ct(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oj="return a * b;";function UP(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,s=pa(r.dtype,a.dtype);if(r.dtype==="complex64"){const i=n.texData.get(r.dataId),l=n.texData.get(a.dataId),u=new Pj(Aj.REAL,r.shape,a.shape),c=new Pj(Aj.IMAG,r.shape,a.shape),d=[{dataId:i.complexTensorInfos.real.dataId,dtype:i.complexTensorInfos.real.dtype,shape:r.shape},{dataId:i.complexTensorInfos.imag.dataId,dtype:i.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=pu({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,a])){const i=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[u,c]=g_e(r.shape,a.shape,i.values,l.values,s),d=n.makeTensorInfo(c,s),f=n.texData.get(d.dataId);return f.values=u,d}let o;return ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Bp(Oj,r.shape,a.shape):o=new Uc(Oj,r.shape,a.shape),n.runWebGLProgram(o,[r,a],s)}const x$e={kernelName:ax,backendName:"webgl",kernelFunc:UP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$e(t,e,n){const r=[Bc(t.shape),...zc(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Bc(e),...zc(e)],o=new ZH(s,r),i=!0,l=[r],u=n.runWebGLProgram(o,[a],t.dtype,l,i);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Re(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:s}=r,o=n,i=ne(a.shape),l=wS(s,i),u=ne(l);j(i===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(a.dataId);return c.isPacked&&!hy(a.shape,l)&&!(c.texture!==null&&hy(c.shape,l))?b$e(a,l,o):(o.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}const w$e={kernelName:px,backendName:"webgl",kernelFunc:Re};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rj{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:s,outSize:o}=e;this.outputShape=[a,o];const i=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${kc(d)?d.toPrecision(2):d}, ones);`}let c="";s%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${i};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S$e{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:s,outSize:o}=e;this.outputShape=[a,o];let i="0.0",l="";n==="prod"?i="1.0":n==="min"?(i="1.0 / 1e-20",l="min"):n==="max"&&(i="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(i="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(i="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${i};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${i});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=y2(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function hd(t,e,n,r){const a=C$e(t.shape);let s=t;for(let o=0;o<a.length;o++){const{inSize:i,windowSize:l,outSize:u}=a[o];let c,d;n==="mean"?c=o===0?new Rj({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u},i):new Rj({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u}):c=new S$e({windowSize:l,inSize:i,batchSize:t.shape[0],outSize:u},n),d=s,s=r.runWebGLProgram(c,[s],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _$e{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const a=hn(this.rank),s=$$e(n);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function $$e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k$e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=hn(this.rank),s=JH("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=s[c];const i=`vec2(${o.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${i})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(t,e,n){const r=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new k$e(t.shape,e):new _$e(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$e(t,e,n,r){const a=e,s=t.shape.length,o=Yt(a,t.shape);let i=o;const l=gr(i,s),u=l!=null;let c=t;u&&(c=T2(t,l,r),i=Qn(i.length,s)),Yn("sum",i,s);const[d,f]=mr(c.shape,i);let h=d;n&&(h=ir(d,o));const p=ne(f),y=ne(t.shape)/p,v=Re({inputs:{x:c},attrs:{shape:[y,p]},backend:r}),x=Wx(t.dtype),b=hd(v,x,"sum",r),w=Re({inputs:{x:b},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r;return N$e(a,s,o,n)}const I$e={kernelName:wp,backendName:"webgl",kernelFunc:E2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:s}=r,o=n,i=a.shape.length,l=new Array(i);for(let c=0;c<l.length;c++)l[c]=a.shape[s[c]];let u;if(o.shouldExecuteOnCPU([a])){const d=o.texData.get(a.dataId).values,f=BP(d,a.shape,a.dtype,s,l);u=o.makeTensorInfo(l,a.dtype);const h=o.texData.get(u.dataId);h.values=f}else u=T2(a,s,o);return u}const T$e={kernelName:Wl,backendName:"webgl",kernelFunc:ma};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8=1e3;function Hw({a:t,b:e,transposeA:n,transposeB:r,backend:a,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=r?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),v=ne(g),x=ne(y),w=ct(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);j(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const C=n?[v,d,h]:[v,h,d],_=r?[x,p,f]:[x,f,p],$=Re({inputs:{x:t},backend:a,attrs:{shape:C}}),k=Re({inputs:{x:e},backend:a,attrs:{shape:_}}),A=[$,k],P=Math.max(v,x),O=n?$.shape[1]:$.shape[2],R=s!=null,B=o!=null,F=l==="leakyrelu",L=l!=null?py(l,!0):null,H=R||B||F||L!=null;let te;if((h===1||p===1)&&O>s8&&H===!1){let Q=$,se=k;n&&(Q=ma({inputs:{x:$},backend:a,attrs:{perm:[0,2,1]}}),A.push(Q)),r&&(se=ma({inputs:{x:k},backend:a,attrs:{perm:[0,2,1]}}),A.push(se));const le=p!==1,ue=p===1;let ce=Q;le&&(ce=Re({inputs:{x:Q},backend:a,attrs:{shape:[P,O,1]}}),A.push(ce));const re=p===1?2:1;let ge=se;ue&&(ge=Re({inputs:{x:se},backend:a,attrs:{shape:[P,1,O]}}),A.push(ge));const Se=UP({inputs:{a:ce,b:ge},backend:a});te=E2({inputs:{x:Se},backend:a,attrs:{axis:re,keepDims:!0}}),A.push(Se)}else{const Q=pa(t.dtype,e.dtype),se=new a8(C,_,[P,h,p],n,r,R,L,B,F),le=[$,k];if(s!=null&&le.push(s),B&&le.push(o),F){const ue=a.makeTensorInfo([],"float32",td(i,"float32"));le.push(ue),A.push(ue)}te=a.runWebGLProgram(se,le,Q)}const V=Re({inputs:{x:te},backend:a,attrs:{shape:w}});A.push(te);for(const Q of A)a.disposeIntermediateTensorInfo(Q);return V}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$e(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s,bias:o,preluActivationWeights:i}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return Hw({a,b:s,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:i,leakyreluAlpha:d,activation:c})}const A$e={kernelName:Ic,backendName:"webgl",kernelFunc:E$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dj="return abs(x);";function P$e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),o=YH(s.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let a;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Pl(r.shape,Dj):a=new Xo(r.shape,Dj),n.runWebGLProgram(a,[r],r.dtype)}const O$e={kernelName:lv,backendName:"webgl",kernelFunc:P$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R$e=ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,D$e=Ft({opSnippet:R$e}),j$e={kernelName:uv,backendName:"webgl",kernelFunc:D$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$e=ao+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,F$e=Ft({opSnippet:M$e}),L$e={kernelName:cv,backendName:"webgl",kernelFunc:F$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jj="return a + b;",B$e=Lr({opSnippet:jj,packedOpSnippet:jj,supportsComplex:!0,cpuKernelImpl:XCe}),z$e={kernelName:Ah,backendName:"webgl",kernelFunc:B$e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U$e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const a=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V$e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((s,o)=>`T${o}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const a=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return ts({inputs:{x:r[0]},backend:n});if(r.length>ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=J0({inputs:r.slice(0,l),backend:n}),c=J0({inputs:r.slice(l),backend:n});return J0({inputs:[u,c],backend:n})}const a=r.map(l=>l.dtype).reduce((l,u)=>pa(l,u)),s=r.map(l=>l.shape),i=ee().getBool("WEBGL_PACK")?new V$e(r[0].shape,s):new U$e(r[0].shape,s);return n.runWebGLProgram(i,r,a)}const W$e={kernelName:Ph,backendName:"webgl",kernelFunc:J0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r,i=a.shape.length,l=Yt(s,a.shape);let u=l;const c=gr(u,i);let d=a;c!=null&&(d=ma({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Qn(u.length,i)),Yn("all",u,i);const[f,h]=mr(d.shape,u),p=ne(h),g=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=hd(g,g.dtype,"all",n);let v;if(o){const x=ir(f,l);v=Re({inputs:{x:y},backend:n,attrs:{shape:x}})}else v=Re({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),v}const H$e={kernelName:Oh,backendName:"webgl",kernelFunc:G$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r,i=a.shape.length,l=Yt(s,a.shape);let u=l;const c=gr(u,i);let d=a;c!=null&&(d=ma({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Qn(u.length,i)),Yn("any",u,i);const[f,h]=mr(d.shape,u),p=ne(h),g=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=hd(g,g.dtype,"any",n);let v;if(o){const x=ir(f,l);v=Re({inputs:{x:y},backend:n,attrs:{shape:x}})}else v=Re({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),v}const K$e={kernelName:Rh,backendName:"webgl",kernelFunc:q$e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X$e{constructor(e,n,r){this.variableNames=["A"];const{windowSize:a,batchSize:s,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,o];const i=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${i} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y$e{constructor(e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,j(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=e[e.length-1],o=Math.ceil(s/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");const i=this.outputShape,l=i.length,u=hn(l),c=fa("coords",l);let d,f;if(o===1){f=l+1;const k=hn(f);d=`
        ${k} sourceLocR = ${k}(${c.join()}, 0);
        ++${c[l-1]};
        ${k} sourceLocG = ${k}(${c.join()}, 0);
        ++${c[l-2]};
        ${k} sourceLocA = ${k}(${c.join()}, 0);
        --${c[l-1]};
        ${k} sourceLocB = ${k}(${c.join()}, 0);
        --${c[l-2]};`}else f=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],g=h.map(k=>"int "+k),y=fa("sourceLocR",f-1).concat("inIdx.r"),v=fa("sourceLocG",f-1).concat("inIdx.g"),x=fa("sourceLocB",f-1).concat("inIdx.b"),b=fa("sourceLocA",f-1).concat("inIdx.a"),w=r==="max"?"greaterThan":"lessThan",C=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()})));`,_=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,$=a?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${$}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${i[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${i[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${_};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${_};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${w}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n,r=null){let a=e.shape[0],s=e.shape[1];r!=null&&(a=r.shape[0],s=r.shape[1]);const o=y2(s),i={windowSize:o,inSize:s,batchSize:a,outSize:Math.ceil(s/o)},l=new X$e(i,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=o8(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function i8(t,e,n,r=null){const a=r!=null?r.shape:e.shape,s=a[a.length-1],o=y2(s),i=new Y$e(a,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(i,l,"int32");if(u.shape.length===e.shape.length){const c=i8(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function l8(t,e,n,r){const a=[n];if(Yn("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!ee().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const s=[],o=t.texData.get(e.dataId),i=o!==null&&o.isPacked;let l=e;i&&(l=t.unpackTensor(e),s.push(l));const[u,c]=mr(l.shape,a),d=ne(c),f=Re({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});s.push(f);const h=o8(t,f,r);s.push(h);const p=Re({inputs:{x:h},backend:t,attrs:{shape:u}});return s.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return i8(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s}=r;let o=Yt(s,a.shape);const i=gr(o,a.shape.length);let l=a;const u=[];i!=null&&(l=ma({inputs:{x:a},backend:n,attrs:{perm:i}}),u.push(l),o=Qn(o.length,l.shape.length)),Yn("argMax",[o[0]],l.shape.length);const c=l8(n,l,o[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const J$e={kernelName:dv,backendName:"webgl",kernelFunc:Q$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s}=r;let o=Yt(s,a.shape);const i=gr(o,a.shape.length);let l=a;const u=[];i!=null&&(l=ma({inputs:{x:a},backend:n,attrs:{perm:i}}),u.push(l),o=Qn(o.length,l.shape.length)),Yn("argMin",[o[0]],l.shape.length);const c=l8(n,l,o[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const eke={kernelName:fv,backendName:"webgl",kernelFunc:Z$e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tke=ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,nke=Ft({opSnippet:tke}),rke={kernelName:hv,backendName:"webgl",kernelFunc:nke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ake=ao+"return log(x + sqrt(x * x + 1.0));",ske=Ft({opSnippet:ake}),oke={kernelName:pv,backendName:"webgl",kernelFunc:ske};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike=ao+`
  return atan(x);
`,lke=Ft({opSnippet:ike}),uke={kernelName:mv,backendName:"webgl",kernelFunc:lke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke=zP+`
  return atan(a, b);
`,dke=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+fd+`
  return result;
`,fke=Lr({opSnippet:cke,packedOpSnippet:dke}),hke={kernelName:yv,backendName:"webgl",kernelFunc:fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pke=ao+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,mke=Ft({opSnippet:pke}),gke={kernelName:gv,backendName:"webgl",kernelFunc:mke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class my{constructor(e,n,r,a=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,v=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(g||(x="-1.0 / 1e-20"),r){const k=">=";this.userCode=`
        const ivec2 strides = ivec2(${i}, ${l});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${k} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?s?y:v:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let w=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(w="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,_=o%4,$=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${l});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${$}
          }

          int xC = xCCorner + ${C};
          if (${_===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${_===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${$}
          } else if (${_===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${$}
          }
        }
        setOutput(${w});
      }
    `}}class VP{constructor(e,n,r,a=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,i=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,v=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let w="0.0";if(b||(w="-1.0 / 1e-20"),r){const P=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${i}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${v}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${P} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?s?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / max(count, 1.0)");const $=Math.floor(o/4)*4,k=o%4,A=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${i}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${v}, ${x});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${$}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${$};
            if (${k===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${k===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${k===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${_});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;Dp(a,"avgPool");const{filterSize:s,strides:o,pad:i,dimRoundingMode:l}=r,u=1;j(Qr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Yr(a.shape,s,o,u,i,l);if(c.filterWidth===1&&c.filterHeight===1&&Kt(c.inShape,c.outShape))return ts({inputs:{x:a},backend:n});const d=new my(c,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}const vke={kernelName:Dh,backendName:"webgl",kernelFunc:yke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=$s(a.shape,s,o,c,i,l,u),f=new VP(d,"avg",!1);return n.runWebGLProgram(f,[a],"float32")}const bke={kernelName:vv,backendName:"webgl",kernelFunc:xke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wke{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,s=e.strideWidth,o=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,f=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${i}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ske{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,s=e.strideDepth,o=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=d-1-e.padInfo.front,g=f-1-e.padInfo.top,y=h-1-e.padInfo.left,v=1/(n*r*a);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${y});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=$s(o.shape,i,l,d,u,c),h=new Ske(f);return n.runWebGLProgram(h,[a],o.dtype)}const _ke={kernelName:_S,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s;Dp([a,s],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=r,c=Yr(o.shape,i,l,1,u),d=new wke(c);return n.runWebGLProgram(d,[a],o.dtype)}const kke={kernelName:CS,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s}=e,{transposeA:o,transposeB:i}=r;return Hw({a,b:s,transposeA:o,transposeB:i,backend:n})}const Ike={kernelName:jh,backendName:"webgl",kernelFunc:Nke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tke{constructor(e,n,r,a,s,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ct(e,n),ct(e,r);let i="0.0";a!=null&&(ct(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="1.0";s!=null&&(ct(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${i};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eke{constructor(e,n,r,a,s,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ct(e,n),ct(e,r);let i="vec4(0.0)";a!=null&&(ct(e,a),this.variableNames.push("offset"),i="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(ct(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${i};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ake=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:a,variance:s,offset:o,scale:i}=t;j(a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,a,s];let c=null;o!=null&&(c=o.shape,u.push(o));let d=null;i!=null&&(d=i.shape,u.push(i));const f=ee().getBool("WEBGL_PACK_NORMALIZATION")?new Eke(r.shape,a.shape,s.shape,c,d,l):new Tke(r.shape,a.shape,s.shape,c,d,l);return e.runWebGLProgram(f,u,u[0].dtype)},Pke={kernelName:Qh,backendName:"webgl",kernelFunc:Ake};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oke{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=hn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Rke(this.rank);let a;const s=e.map((o,i)=>`sourceLoc.${kN[i]} = start[${i}] + coords.${kN[i]};`);a=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${r}));
      }
    `}}const kN=["x","y","z","w","u","v"];function Rke(t){if(t===1)return"sourceLoc";if(t<=6)return kN.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dke{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=hn(this.rank),r=fa("coords",this.rank),a=fa("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,o=`getChannel(getSource(${a.join()}), ${s})`,i=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${o};
        --${a[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${a[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${i}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t,e,n,r){const a=r.texData.get(t.dataId),s=r.makeTensorInfo(n,t.dtype),o=r.texData.get(s.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=t.dtype;let i=h2(e,Dt(t.shape));a.slice&&(i+=a.slice.flatOffset),o.slice={flatOffset:i,origDataId:a.slice&&a.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),s}function Up(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:s,size:o}=r,[i,l]=p2(a,s,o);if(XA(a,i,l),ne(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.texData.get(a.dataId),f=N_e(d.values,i,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,f)}const{isPacked:u}=n.texData.get(a.dataId),c=f2(a.shape,i,l);if(u||!c){const d=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dke(l):new Oke(l),f=[i];return n.runWebGLProgram(d,[a],a.dtype,f)}return n.uploadToGPU(a.dataId),jke(a,i,l,n)}const Mke={kernelName:Sx,backendName:"webgl",kernelFunc:Up};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fke=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,crops:o}=r;j(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=s.reduce((x,b)=>x*b),l=ad(a.shape,s,i),u=sd(l.length,s.length),c=od(a.shape,s,i),d=x2(o,s.length),f=b2(c,o,s.length),h=[],p=Re({inputs:{x:a},backend:n,attrs:{shape:l}}),g=ma({inputs:{x:p},backend:n,attrs:{perm:u}}),y=Re({inputs:{x:g},backend:n,attrs:{shape:c}}),v=Up({inputs:{x:y},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(g),h.push(y),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),v},Lke={kernelName:xv,backendName:"webgl",kernelFunc:Fke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:s}=e,{size:o}=r,i=n.readSync(a.dataId),l=n.readSync(s.dataId),u=XH(i,l,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,u)}const zke={kernelName:Mh,backendName:"webgl",kernelFunc:Bke};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uke=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Vke=`
  return float(int(a.r) & int(b.r));
`;function Wke(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=ee().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,a])||o===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(a.dataId).values,[c,d]=QCe(r.shape,a.shape,l,u,r.dtype),f=n.makeTensorInfo(d,r.dtype),h=n.texData.get(f.dataId);return h.values=c,f}let i;return s?i=new Bp(Uke,r.shape,a.shape,!1):i=new Uc(Vke,r.shape,a.shape),n.runWebGLProgram(i,[r,a],r.dtype)}const Gke={kernelName:$S,backendName:"webgl",kernelFunc:Wke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hke(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,s=n.readSync(r.dataId),o=n.readSync(a.dataId),i=ct(Array.from(s),Array.from(o));return n.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const qke={kernelName:bv,backendName:"webgl",kernelFunc:Hke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kke="return float(a != b);",u8=Lr({opSnippet:Kke,cpuKernelImpl:v_e,dtype:"bool"}),Xke={kernelName:ox,backendName:"webgl",kernelFunc:u8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nb(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return ts({inputs:{x:a.complexTensorInfos.real},backend:n})}const Yke={kernelName:BS,backendName:"webgl",kernelFunc:nb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qke="return float(int(x));";function Jke(t,e){const n=new Xo(t.shape,Qke),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NN(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:s}=r;if(s==="complex64"){if(a.dtype==="complex64")return ts({inputs:{x:a},backend:n});const o=ci(a.shape),i=NN({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=pu({inputs:{real:i,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(i),l}if(a.dtype==="complex64"){const o=nb({inputs:{input:a},backend:n}),i=NN({inputs:{x:o},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(o),i}if(!kE(a.dtype,s)){const o=ts({inputs:{x:a},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:s}}if(n.shouldExecuteOnCPU([a])){const o=n.texData.get(a.dataId).values,[i,l,u]=JCe(o,a.shape,a.dtype,s);return n.makeTensorInfo(i,l,u)}if(s==="int32")return Jke(a,n);if(s==="bool"){const o=n.makeTensorInfo([],"bool",Eo("bool",1)),l=u8({inputs:{a,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}const Zke={kernelName:Fh,backendName:"webgl",kernelFunc:NN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mj="return ceil(x);",eNe=Ft({opSnippet:Mj,packedOpSnippet:Mj,cpuKernelImpl:ZCe}),tNe={kernelName:wv,backendName:"webgl",kernelFunc:eNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nNe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rNe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:s,clipValueMax:o}=r;let i;ee().getBool("WEBGL_PACK_CLIP")?i=new rNe(a.shape):i=new nNe(a.shape);const l=[[s],[o]];return n.runWebGLProgram(i,[a],a.dtype,l)}const sNe={kernelName:Lh,backendName:"webgl",kernelFunc:aNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oNe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function iNe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.texData.get(r.dataId),s=new oNe(r.shape),o=[Fj(r,a.complexTensorInfos.real),Fj(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(s,o,o[0].dtype)}const lNe={kernelName:NS,backendName:"webgl",kernelFunc:iNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uNe{constructor(e){this.outputShape=[],this.outputShape=Na(e,1),this.variableNames=e.map((o,i)=>`T${i}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const i=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${i}));`)}const a=n.length,s=n[n.length-1];r.push(`else setOutput(getT${a}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cNe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Na(e,n);const r=this.outputShape,a=r.length,s=hn(a),o=fa("coords",a),i=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=i[n],c=i.slice(-2),d=i.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];f+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${r0(i,u,y)}),
            vec2(${r0(c,u,y)}));
        }`}const h=l.length,p=l[l.length-1];f+=`
        return getChannel(
          getT${h}(${r0(i,u,p)}),
          vec2(${r0(c,u,p)}));`,this.userCode=`
      float getValue(${i.map(g=>"int "+g)}) {
        ${f}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[a-1]} = ${o[a-1]} + 1;
        if (${o[a-1]} < ${r[a-1]}) {
          result.g = getValue(${o});
        }

        ${o[a-2]} = ${o[a-2]} + 1;
        if (${o[a-2]} < ${r[a-2]}) {
          result.a = getValue(${o});
        }

        ${o[a-1]} = ${o[a-1]} - 1;
        if (${o[a-2]} < ${r[a-2]} &&
            ${o[a-1]} < ${r[a-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function r0(t,e,n){const r=t.indexOf(e);return t.map((s,o)=>o===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return ts({inputs:{x:a.complexTensorInfos.imag},backend:n})}const dNe={kernelName:MS,backendName:"webgl",kernelFunc:A2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ng(t,e,n){const r=t[0].dtype;if(r==="complex64"){const h=t.map(x=>nb({inputs:{input:x},backend:n})),p=t.map(x=>A2({inputs:{input:x},backend:n})),g=ng(h,e,n),y=ng(p,e,n),v=pu({inputs:{real:g,imag:y},backend:n});return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),v}let a=n.shouldExecuteOnCPU(t);if(r==="string"&&(a=!0),a){const h=t.map(w=>{const _=[-1,ne(w.shape.slice(e))];return Re({inputs:{x:w},backend:n,attrs:{shape:_}})}),p=h.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),g=Na(h.map(w=>w.shape),1),y=h[0].shape[0]===1,v=e_e(p,g,r,y),x=Na(t.map(w=>w.shape),e),b=n.makeTensorInfo(x,r,v);return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const s=t.filter(h=>ne(h.shape)>0),o=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const h=o?new Xo(t[0].shape,vl):new Pl(t[0].shape,vl);return n.runWebGLProgram(h,t,r)}const i=ee().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>i){const h=[];for(let g=0;g<s.length;g+=i){const y=s.slice(g,g+i);h.push(ng(y,e,n))}const p=ng(h,e,n);for(const g of h)n.disposeIntermediateTensorInfo(g);return p}if(o){const h=new cNe(s.map(p=>p.shape),e);return n.runWebGLProgram(h,s,r)}const{tensors2D:l,outShape:u}=fNe(s,e,n),c=new uNe(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const f=Re({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),f}function fNe(t,e,n){const r=Na(t.map(s=>s.shape),e);return{tensors2D:t.map(s=>Re({inputs:{x:s},attrs:{shape:[-1,ne(s.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,s=Yt(a,e[0].shape)[0],o=e.map(u=>u.shape);g2(o,s);const i=Na(e.map(u=>u.shape),s);if(ne(i)===0)return n.makeTensorInfo(i,e[0].dtype,[]);const l=e.filter(u=>ne(u.shape)>0);return l.length===1?ts({inputs:{x:l[0]},backend:n}):ng(l,s,n)}const hNe={kernelName:Sv,backendName:"webgl",kernelFunc:c8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d8{constructor(e,n=!1,r=null,a=!1,s=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,i=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",v=y?1:2,x=y?2:3,b=y?3:1;let w="",C="";r&&(a?w=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?w=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:w=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${w}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${_}
        ${C}
        setOutput(result);
      }
    `}}class pNe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,a=e.padInfo.left,s=e.strideDepth,o=e.strideHeight,i=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${o}, ${i});
      const ivec3 pads = ivec3(${n}, ${r}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f8{constructor(e,n=!1,r=null,a=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jr(this.outputShape.length);const o=e.padInfo.left,i=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)f+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)f+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const v=y*2;if(f+=`
           xC = xCCorner + ${v*l};
           `,i===1){if(v<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }
               `,l===1&&v>0?f+=`
                 xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                   } else {
                     xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xC${v} = xTexelC${v};
                 `,v+1<c)){const x=o%2===0?bS(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                     xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${v+1}.zw = vec2(0.0);
                     }
                     xTexelC${v+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                     } else {
                      xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                     }
                     `:f+=`
                     xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                     `):x===1?f+=`
                     xC${v+1} = xTexelC${v};
                     `:f+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                       xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${v+1}.zw = vec2(0.0);
                       }
                       xTexelC${v+1}Ready = 1;
                     }

                     xC${v+1} = xTexelC${v+1};
                     `}}else v<c&&(o%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.0);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
               `,v+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(
                   xTexelC${v}.xy, xTexelC${v+1}.xy);
               `,v+1<c&&(f+=`
                   xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                 `)));v<c&&(f+=`
             wTexel = getW(r, ${v}, d1, d2);
             dotProd += xC${v}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${v}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,v+1<c&&(f+=`
               wTexel = getW(r, ${v+1}, d1, d2);
               dotProd += xC${v+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${v+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let h="",p="";r&&(a?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mNe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Jr(this.outputShape.length);const{dataFormat:r}=n,a=ga(),s=r==="channelsLast",o=s?1:2,i=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${i}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${a.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qw(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function h8({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:i=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],f=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,g=!1;let y;const v=[];if(s!=null){const w=qw(s.shape,h);w!=null&&(s=Re({inputs:{x:s},backend:r,attrs:{shape:w}}),v.push(s))}if(a!=null){const w=qw(a.shape,h);w!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:w}}),v.push(a))}if(!((d===1||f===1)&&c>s8)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&Kt(u.shape.slice(-3),l.slice(-3))){const w=l[0]*l[1]*(l[2]+1),C={dataId:t.dataId,shape:[1,w,n.inChannels],dtype:t.dtype},_=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,j(hy(u.shape,C.shape),()=>`packed reshape ${u.shape} to ${C.shape} isn't free`);const $=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});v.push($);const k=Hw({a:C,b:$,backend:r,transposeA:p,transposeB:g,bias:a,activation:i,preluActivationWeights:s,leakyreluAlpha:o}),A=r.texData.get(k.dataId);j(A.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=_,A.shape=n.outShape,y=ts({inputs:{x:k},backend:r}),y.shape=n.outShape,v.push(k)}else{const w=n.outHeight*n.outWidth,C=Re({inputs:{x:t},backend:r,attrs:{shape:h?[n.batchSize,w,n.inChannels]:[n.batchSize,n.inChannels,w]}}),_=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),$=Hw({a:h?C:_,b:h?_:C,transposeA:!h,transposeB:g,backend:r,bias:a,activation:i,preluActivationWeights:s,leakyreluAlpha:o});y=Re({inputs:{x:$},backend:r,attrs:{shape:n.outShape}}),v.push(C),v.push(_),v.push($)}for(const w of v)r.disposeIntermediateTensorInfo(w);return y}function p8({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:i=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:f,dataFormat:h}=n,p=h==="channelsLast",g=l*u*c,y=f*d,v=[n.batchSize,g,y],x=!0,b=!1,w=[];if(s!=null){const V=qw(s.shape,p);V!=null&&(s=Re({inputs:{x:s},backend:r,attrs:{shape:V}}),w.push(s))}if(a!=null){const V=qw(a.shape,p);V!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:V}}),w.push(a))}const C=Re({inputs:{x:e},backend:r,attrs:{shape:[1,g,ne(e.shape)/g]}});w.push(C);const _=new mNe(v,n),$=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],k=r.runWebGLProgram(_,[t],"float32",$),A=Re({inputs:{x:k},backend:r,attrs:{shape:v}});w.push(k),w.push(A);const P=a!=null,O=s!=null,R=i==="leakyrelu",B=i?py(i,!0):null,F=new a8(p?A.shape:C.shape,p?C.shape:A.shape,p?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],x,b,P,B,O,R),L=p?[A,C]:[C,A];if(a&&L.push(a),O&&L.push(s),R){const V=r.makeTensorInfo([],"float32",td(o,"float32"));L.push(V),w.push(V)}const H=r.runWebGLProgram(F,L,"float32"),te=Re({inputs:{x:H},backend:r,attrs:{shape:n.outShape}});w.push(H);for(const V of w)r.disposeIntermediateTensorInfo(V);return te}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=ks(l),f=Rn(a.shape,s.shape,o,u,i,c,!1,d);let h;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))h=h8({x:a,filter:s,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const g=new f8(f),y=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];h=n.runWebGLProgram(g,[a,s],"float32",y)}else if(ee().getBool("WEBGL_CONV_IM2COL"))h=p8({x:a,filter:s,convInfo:f,backend:n});else{const g=new d8(f);h=n.runWebGLProgram(g,[a,s],"float32")}const p=Re({inputs:{x:h},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(h),p}const yNe={kernelName:Bh,backendName:"webgl",kernelFunc:gNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vNe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,s=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xNe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,s=e.strideWidth,o=e.dataFormat==="channelsLast",i=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class bNe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,s=e.padInfo.front,o=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${i};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wNe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,s=e.strideDepth,o=e.strideHeight,i=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=ks(l),f=Rn(a.shape,c,o,1,i,u,!1,d),h=new vNe(f);return n.runWebGLProgram(h,[a,s],"float32")}const CNe={kernelName:IS,backendName:"webgl",kernelFunc:SNe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ne{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Jr(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,a=n-1-e.padInfo.top,s=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{inputShape:o,strides:i,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=ks(u),f=Rn(o,s.shape,i,1,l,c,!1,d);if(ee().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[f.strideHeight,f.strideWidth]],p=new _Ne(f);return n.runWebGLProgram(p,[a,s],"float32",h)}else{const h=new xNe(f);return n.runWebGLProgram(h,[a,s],"float32")}}const kNe={kernelName:zh,backendName:"webgl",kernelFunc:$Ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r,u=Do(a.shape,s.shape,o,l,i),c=new pNe(u);return n.runWebGLProgram(c,[a,s],"float32")}const INe={kernelName:Uh,backendName:"webgl",kernelFunc:NNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,pad:i,filterShape:l}=r,u=Do(a.shape,l,o,1,i),c=new bNe(u);return n.runWebGLProgram(c,[a,s],"float32")}const ENe={kernelName:Cv,backendName:"webgl",kernelFunc:TNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ANe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{pad:o,strides:i,inputShape:l}=r,u=Do(l,s.shape,i,1,o),c=new wNe(u);return n.runWebGLProgram(c,[a,s],"float32")}const PNe={kernelName:Vh,backendName:"webgl",kernelFunc:ANe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ONe=zp+`
  return cos(x);
`,RNe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${fd}
  return result;
`,DNe=Ft({opSnippet:ONe,packedOpSnippet:RNe}),jNe={kernelName:_v,backendName:"webgl",kernelFunc:DNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MNe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,FNe=Ft({opSnippet:MNe}),LNe={kernelName:$v,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BNe{constructor(e,n,r,a,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,i,l,u]=e,[c]=n,[d,f]=r;this.outputShape=[c,d,f,u];const h=a==="bilinear"?1:0,[p,g]=[`${i-1}.0`,`${l-1}.0`],[y,v,x]=d>1?[`${(i-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,w,C]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${w};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zNe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:s,boxInd:o}=e,{cropSize:i,method:l,extrapolationValue:u}=r,c=new BNe(a.shape,s.shape,i,l,u);return n.runWebGLProgram(c,[a,s,o],"float32")},UNe={kernelName:Hh,backendName:"webgl",kernelFunc:zNe};var gy;(function(t){t.Prod="*",t.Sum="+"})(gy||(gy={}));class Lj{constructor(e,n,r,a){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,o=this.op===gy.Prod?"1.0":"0.0",i=r?o:`getX(${Bj(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=a?`end != ${l-1}`:"end != 0",c=a?"end + 1":"end - 1"):(u=a?`end + pow2 < ${l}`:"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${hn(s)} coords = getOutputCoords();
        int end = ${zj(s,"coords",this.op)};
        float val = ${i};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${zj(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${Bj(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Bj(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function zj(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t,e,n,r,a,s){const o=e.shape.length,i=gr([r],o);let l=e;i!=null&&(l=ma({inputs:{x:e},backend:n,attrs:{perm:i}}));const u=Qn(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=ts({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new Lj(t,l.shape,!1,s),p=[[f]],g=d;d=n.runWebGLProgram(h,[d],d.dtype,p),n.disposeIntermediateTensorInfo(g)}if(a){const f=new Lj(t,l.shape,a,s),h=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(i!=null){const f=nd(i),h=ma({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r;return m8(gy.Prod,a,n,s,o,i)}const WNe={kernelName:Wh,backendName:"webgl",kernelFunc:VNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r;return m8(gy.Sum,a,n,s,o,i)}const HNe={kernelName:Gh,backendName:"webgl",kernelFunc:GNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:s}=e,{size:o,binaryOutput:i}=r;if(a.shape.length===1){const l=n.readSync(a.dataId),u=n.readSync(s.dataId),c=XH(l,u,s.dtype,s.shape,o);return n.makeTensorInfo([o],s.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(s),c=YCe(l,u,o,i);return n.makeTensorInfo(c.shape,s.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const KNe={kernelName:kv,backendName:"webgl",kernelFunc:qNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XNe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:s,dataFormat:o}=r,i=a.shape[0],l=o==="NHWC"?a.shape[1]:a.shape[2],u=o==="NHWC"?a.shape[2]:a.shape[3],c=o==="NHWC"?a.shape[3]:a.shape[1],d=l*s,f=u*s,h=c/(s*s),p=o==="NHWC"?[i,d,f,h]:[i,h,d,f],g=new XNe(p,s,o);return n.runWebGLProgram(g,[a],a.dtype)}const QNe={kernelName:qh,backendName:"webgl",kernelFunc:YNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g8{constructor(e,n=!1,r=null,a=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jr(this.outputShape.length);const o=e.filterHeight,i=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(a?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${i}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y8{constructor(e,n=!1,r=null,a=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jr(this.outputShape.length);const o=e.outChannels/e.inChannels,i=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<d;v++)h+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let v=0;v<d;v++)h+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(f+1)/2;v++){const x=v*2;if(h+=`
          xC = xCCorner + ${x*u};
          `,l===1){if(x<d&&(i%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?h+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const b=i%2===0?bS(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:h+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):b===1?h+=`
                    xC${x+1} = xTexelC${x};
                    `:h+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(i%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(h+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(h+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(h+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",g="";r&&(a?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),j(Qr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=Rn(a.shape,s.shape,o,c,i,u,!0);let f;ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new y8(d):f=new g8(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[a,s],"float32",h)}const ZNe={kernelName:Kh,backendName:"webgl",kernelFunc:JNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eIe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,s=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tIe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,s=e.strideWidth,o=n-1-e.padInfo.top,i=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,dilations:i,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Rn(a.shape,c,o,i,l,u,!0),f=new eIe(d);return n.runWebGLProgram(f,[a,s],"float32")}const rIe={kernelName:TS,backendName:"webgl",kernelFunc:nIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aIe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{strides:o,dilations:i,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Rn(c,s.shape,o,i,l,u,!0),f=new tIe(d);return n.runWebGLProgram(f,[a,s],"float32")}const sIe={kernelName:ES,backendName:"webgl",kernelFunc:aIe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oIe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],s=ne(r.shape),o=Re({inputs:{x:r},backend:n,attrs:{shape:[s]}}),i=new oIe(s),l=n.runWebGLProgram(i,[o],o.dtype),u=Re({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const lIe={kernelName:Nv,backendName:"webgl",kernelFunc:iIe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uIe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:a,strideHeight:s,strideWidth:o,filterHeight:i,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:f}=a;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${o});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${i}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r,u=cu(a.shape,s.shape,o,i,"NHWC",l);let c;const d=new uIe(u);c=n.runWebGLProgram(d,[a,s],"float32");const f=Re({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),f}const dIe={kernelName:Xh,backendName:"webgl",kernelFunc:cIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fIe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,s=e,{allDims:o,summedDims:i,idDims:l}=oP(a,s.length);lP(o.length,l,s);const{path:u,steps:c}=uP(i,l),d=c.length;let f=null,h=o.length;const p=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:v,expandDims:x}=iP(h,l[y]);let b;cP(v)?b=s[y]:(b=ma({inputs:{x:s[y]},backend:n,attrs:{perm:v}}),p.push(b));const w=b.shape.slice();for(let C=0;C<x.length;++C)w.splice(x[C],0,1);Kt(b.shape,w)||(b=Re({inputs:{x:b},backend:n,attrs:{shape:w}}),p.push(b)),f===null?f=b:(f=UP({inputs:{a:b,b:f},backend:n}),p.push(f))}g<d-1&&(u[g]>=0&&(f=E2({inputs:{x:f},backend:n,attrs:{axis:u[g]-(o.length-h),keepDims:!1}}),p.push(f)),h--)}for(const g of p)g!==f&&n.disposeIntermediateTensorInfo(g);return f}const hIe={kernelName:RS,backendName:"webgl",kernelFunc:fIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIe="return (x >= 0.0) ? x : (exp(x) - 1.0);",mIe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,gIe=Ft({opSnippet:pIe,packedOpSnippet:mIe}),yIe={kernelName:Tv,backendName:"webgl",kernelFunc:gIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vIe="return (b >= 0.0) ? a : a * (b + 1.0);",xIe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,bIe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,s=ee().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Bp(xIe,r.shape,a.shape):new Uc(vIe,r.shape,a.shape);return n.runWebGLProgram(s,[r,a],r.dtype)},wIe={kernelName:Ev,backendName:"webgl",kernelFunc:bIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIe=`
  return vec4(equal(a, b));
`,CIe="return float(a == b);",_Ie=Lr({opSnippet:CIe,packedOpSnippet:SIe,dtype:"bool",cpuKernelImpl:t_e}),$Ie={kernelName:Pv,backendName:"webgl",kernelFunc:_Ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${eP};
  float a1 = ${tP};
  float a2 = ${nP};
  float a3 = ${rP};
  float a4 = ${aP};
  float a5 = ${sP};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,NIe=Ft({opSnippet:kIe}),IIe={kernelName:Av,backendName:"webgl",kernelFunc:NIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TIe=zp+`
  return exp(x);
`,EIe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,v8=Ft({opSnippet:TIe,packedOpSnippet:EIe,cpuKernelImpl:n_e,dtype:"float32"}),AIe={kernelName:Ov,backendName:"webgl",kernelFunc:v8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:s}=e,o=s.shape.length,i=s.shape.slice();let l=a;return a<0&&(j(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+a+1),i.splice(l,0,1),Re({inputs:{x:s},backend:r,attrs:{shape:i}})}const PIe={kernelName:Rv,backendName:"webgl",kernelFunc:IN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uj="return exp(x) - 1.0;",OIe=Ft({opSnippet:Uj,packedOpSnippet:Uj,cpuKernelImpl:r_e}),RIe={kernelName:Dv,backendName:"webgl",kernelFunc:OIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vj{constructor(e,n,r){this.variableNames=["real","imag"];const a=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${a}.0`:"1.0";let i;if(e==="real")i="return real * expR - imag * expI;";else if(e==="imag")i="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${i}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x8(t,e,n){const r=n.texData.get(t.dataId),a=ne(t.shape),s=t.shape[t.shape.length-1],o=a/s,i=Re({inputs:{x:t},backend:n,attrs:{shape:[o,s]}}),l=i.shape,u=new Vj("real",l,e),c=new Vj("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=pu({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);const g=Re({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIe(t){const{inputs:e,backend:n}=t,{input:r}=e;return x8(r,!1,n)}const jIe={kernelName:DS,backendName:"webgl",kernelFunc:DIe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MIe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rb(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:s}=n;if(s=s||lu(a),s==="string"){const o=or(s,ne(r));return o.fill(a),e.makeTensorInfo(r,s,o)}else{const o=new MIe(r,a),i=[[a]];return e.runWebGLProgram(o,[],s,i)}}const FIe={kernelName:jv,backendName:"webgl",kernelFunc:rb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LIe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BIe={kernelName:Yh,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,a=new LIe(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj="return floor(x);",zIe=Ft({opSnippet:Wj,packedOpSnippet:Wj,cpuKernelImpl:a_e}),UIe={kernelName:Mv,backendName:"webgl",kernelFunc:zIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,WIe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,GIe=Lr({opSnippet:VIe,packedOpSnippet:WIe,dtype:"int32"}),HIe={kernelName:Fv,backendName:"webgl",kernelFunc:GIe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qIe{constructor(e){this.variableNames=["A"];const n=ga(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KIe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ga(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe={kernelName:Xg,backendName:"webgl",kernelFunc:YIe};let Dd,U_=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function YIe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:s}=r,o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,i=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,u]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[u,l],d=[u,l,s];if(i||o){const g=ee().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Dd==null||g!==U_)&&(U_=g,Dd=document.createElement("canvas").getContext("2d",{willReadFrequently:U_})),Dd.canvas.width=l,Dd.canvas.height=u,Dd.drawImage(a,0,0,l,u),a=Dd.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=ps.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);const h=ee().getBool("WEBGL_PACK")?new KIe(d):new qIe(d),p=n.runWebGLProgram(h,[f],"int32");return n.disposeData(f.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,g=ks(c),y=Rn(a.shape,s.shape,l,d,u,f,!1,g);let v;const x=[],b=o!=null,w=i!=null,C=h==="leakyrelu",_=()=>{const k=[a,s],A=(P,O)=>{if(O==="NCHW"&&P.shape.length===1&&P.shape[0]!==1){const R=Re({inputs:{x:P},backend:n,attrs:{shape:[P.shape[0],1,1]}});return x.push(R),R}return P};if(b&&k.push(A(o,c)),w&&k.push(A(i,c)),C){const P=n.makeTensorInfo([],"float32",td(p,"float32"));k.push(P),x.push(P)}return k};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))v=h8({x:a,filter:s,convInfo:y,backend:n,bias:o,activation:h,preluActivationWeights:i,leakyreluAlpha:p});else if(y.strideWidth<=2&&g==="channelsLast"&&ee().getBool("WEBGL_EXP_CONV")){const k=h?py(h,!0):null,A=new f8(y,b,k,w,C),P=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],O=_();v=n.runWebGLProgram(A,O,"float32",P)}else if(ee().getBool("WEBGL_CONV_IM2COL"))v=p8({x:a,filter:s,convInfo:y,backend:n,bias:o,activation:h,preluActivationWeights:i,leakyreluAlpha:p});else{const k=h?py(h,!1):null,A=new d8(y,b,k,w,C),P=_();v=n.runWebGLProgram(A,P,"float32")}const $=Re({inputs:{x:v},backend:n,attrs:{shape:y.outShape}});return x.push(v),x.forEach(k=>n.disposeIntermediateTensorInfo(k)),$}const JIe={kernelName:Tc,backendName:"webgl",kernelFunc:QIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,p=[];let g=c;g==null&&(g=[1,1]),j(Qr(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=Rn(a.shape,s.shape,l,g,u,d,!0),v=ee().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,x=f?py(f,v):null,b=[a,s],w=o!=null,C=i!=null,_=f==="leakyrelu";if(w&&b.push(o),C&&b.push(i),_){const P=n.makeTensorInfo([],"float32",td(h,"float32"));b.push(P),p.push(P)}let $;v?$=new y8(y,w,x,C,_):$=new g8(y,w,x,C,_);const k=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],A=n.runWebGLProgram($,b,"float32",k);return p.forEach(P=>n.disposeIntermediateTensorInfo(P)),A}const eTe={kernelName:Ec,backendName:"webgl",kernelFunc:ZIe};class tTe{constructor(e,n,r,a){this.sliceDim=e,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;const s=hn(r.length);let o=`
    int index;`;for(let i=0;i<this.sliceDim;i++)o+=`
          index = round(getIndices(coords[0], ${i}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[i]};
          flattenIndex += index * ${this.strides[i]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nTe(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,s=a.shape,o=s[s.length-1],i=ne(r.shape),[l,u,c,d]=Jx(r,a),f=Re({inputs:{x:a},backend:n,attrs:{shape:[u,o]}}),h=Re({inputs:{x:r},backend:n,attrs:{shape:[ne(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const v=n.readSync(a.dataId),x=n.bufferSync(r),b=s_e(v,x,r.dtype,u,o,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new tTe(o,d,[u,c],r.shape),g=n.runWebGLProgram(p,[h,f],h.dtype),y=Re({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),y}const rTe={kernelName:Jh,backendName:"webgl",kernelFunc:nTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aTe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=hn(this.rank),a=sTe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function sTe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<t.length;a++)a===2?r.push("index"):r.push(`${n[a]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:s}=e,{axis:o,batchDims:i}=r,l=Yt(o,a.shape)[0];if(ee().get("DEBUG")){const x=n.readSync(s.dataId),b=a.shape[l];for(let w=0;w<x.length;++w){const C=x[w];j(C<=b-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${b-1}]`)}}const u=S2(a,s,l,i),c=ne(s.shape),d=[],f=Re({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=Re({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(h);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,s])||a.dtype==="string"){const x=n.bufferSync(h),b=n.bufferSync(f),w=o_e(b,x,p);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,w.dtype,w.values)}const g=new aTe(f.shape,p),y=n.runWebGLProgram(g,[f,h],f.dtype);d.push(y);const v=Re({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),v}const oTe={kernelName:Lv,backendName:"webgl",kernelFunc:b8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iTe="return float(a > b);",lTe=`
  return vec4(greaterThan(a, b));
`,uTe=Lr({opSnippet:iTe,packedOpSnippet:lTe,cpuKernelImpl:i_e,dtype:"bool"}),cTe={kernelName:Bv,backendName:"webgl",kernelFunc:uTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dTe="return float(a >= b);",fTe=`
  return vec4(greaterThanEqual(a, b));
`,hTe=Lr({opSnippet:dTe,packedOpSnippet:fTe,dtype:"bool",cpuKernelImpl:l_e}),pTe={kernelName:zv,backendName:"webgl",kernelFunc:hTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTe(t){const{inputs:e,backend:n}=t,{input:r}=e;return x8(r,!0,n)}const gTe={kernelName:jS,backendName:"webgl",kernelFunc:mTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yTe="return float(!isnan(x) && !isinf(x));",vTe=Ft({opSnippet:yTe,dtype:"bool"}),xTe={kernelName:Uv,backendName:"webgl",kernelFunc:vTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bTe="return float(isinf(x));",wTe=Ft({opSnippet:bTe,dtype:"bool"}),STe={kernelName:Vv,backendName:"webgl",kernelFunc:wTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CTe="return float(isnan(x));",_Te=Ft({opSnippet:CTe,dtype:"bool"}),$Te={kernelName:Wv,backendName:"webgl",kernelFunc:_Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kTe="return float(a < b);",NTe=`
  return vec4(lessThan(a, b));
`,ITe=Lr({opSnippet:kTe,packedOpSnippet:NTe,cpuKernelImpl:u_e,dtype:"bool"}),TTe={kernelName:Gv,backendName:"webgl",kernelFunc:ITe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ETe="return float(a <= b);",ATe=`
  return vec4(lessThanEqual(a, b));
`,PTe=Lr({opSnippet:ETe,packedOpSnippet:ATe,cpuKernelImpl:c_e,dtype:"bool"}),OTe={kernelName:Hv,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RTe(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:s}=n,o=d_e(r,a,s);return e.makeTensorInfo([o.length],"float32",o)}const DTe={kernelName:tp,backendName:"webgl",kernelFunc:RTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jTe=zp+`
  return x < 0.0 ? 0./0. : log(x);
`,MTe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,FTe=Ft({opSnippet:jTe,packedOpSnippet:MTe,cpuKernelImpl:f_e}),LTe={kernelName:qv,backendName:"webgl",kernelFunc:FTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BTe=zp+`
  return log(1.0 + x);
`,zTe=Ft({opSnippet:BTe}),UTe={kernelName:Kv,backendName:"webgl",kernelFunc:zTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VTe="return float(a >= 1.0 && b >= 1.0);",WTe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,GTe=Lr({opSnippet:VTe,packedOpSnippet:WTe,dtype:"bool"}),HTe={kernelName:Xv,backendName:"webgl",kernelFunc:GTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe="return float(!(x >= 1.0));",KTe=Ft({opSnippet:qTe}),XTe={kernelName:Yv,backendName:"webgl",kernelFunc:KTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YTe="return float(a >= 1.0 || b >= 1.0);",QTe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,JTe=Lr({opSnippet:YTe,packedOpSnippet:QTe,dtype:"bool"}),ZTe={kernelName:Qv,backendName:"webgl",kernelFunc:JTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eEe{constructor(e,n,r,a,s){this.variableNames=["x"],this.outputShape=[];const o=n,i=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${i}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tEe{constructor(e,n,r,a,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,i=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;s===.5?l=`inversesqrt(${u})`:s===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${i}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nEe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:s,bias:o,alpha:i,beta:l}=r,u=ee().getBool("WEBGL_PACK_NORMALIZATION")?new tEe(a.shape,s,o,i,l):new eEe(a.shape,s,o,i,l);return n.runWebGLProgram(u,[a],a.dtype)},rEe={kernelName:np,backendName:"webgl",kernelFunc:nEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aEe{constructor(e,n,r,a,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:s,dy:o}=e,{depthRadius:i,bias:l,alpha:u,beta:c}=r,d=new aEe(a.shape,i,l,u,c);return n.runWebGLProgram(d,[a,s,o],a.dtype)},oEe={kernelName:Jv,backendName:"webgl",kernelFunc:sEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(t,e,n,r){const a=ne(e),o=ne(t.shape)/a,i=Re({inputs:{x:t},attrs:{shape:[o,a]},backend:r}),l=hd(i,t.dtype,"max",r),u=Re({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w8(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:s,keepDims:o}=r,i=a.shape.length,l=Yt(s,a.shape);let u=l;const c=gr(u,i),d=c!=null,f=n.shouldExecuteOnCPU([a]);let h=a;if(d){if(f){const b=n.texData.get(h.dataId).values,w=new Array(i);for(let $=0;$<w.length;$++)w[$]=a.shape[c[$]];const C=BP(b,a.shape,a.dtype,c,w);h=n.makeTensorInfo(w,a.dtype);const _=n.texData.get(h.dataId);_.values=C}else h=T2(a,c,n);u=Qn(u.length,i)}Yn("max",u,i);const[p,g]=mr(h.shape,u);let y=p;o&&(y=ir(p,l));let v;if(f){const b=n.texData.get(h.dataId).values,w=h_e(b,ne(g),y,a.dtype);v=n.makeTensorInfo(y,a.dtype);const C=n.texData.get(v.dataId);C.values=w}else v=iEe(h,g,y,n);return d&&n.disposeIntermediateTensorInfo(h),v}const lEe={kernelName:rp,backendName:"webgl",kernelFunc:w8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uEe=zP+`
  return max(a, b);
`,cEe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+fd+`
  return result;
`,dEe=Lr({opSnippet:uEe,packedOpSnippet:cEe,cpuKernelImpl:p_e}),fEe={kernelName:Zv,backendName:"webgl",kernelFunc:dEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;Dp(a,"maxPool");const{filterSize:s,strides:o,pad:i,dimRoundingMode:l}=r,u=1;j(Qr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Yr(a.shape,s,o,u,i,l);if(c.filterWidth===1&&c.filterHeight===1&&Kt(c.inShape,c.outShape))return ts({inputs:{x:a},backend:n});const d=new my(c,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}const pEe={kernelName:ap,backendName:"webgl",kernelFunc:hEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=$s(a.shape,s,o,c,i,u,l),f=new VP(d,"max",!1);return n.runWebGLProgram(f,[a],a.dtype)}const gEe={kernelName:ex,backendName:"webgl",kernelFunc:mEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,a=e.dilationHeight,s=e.effectiveFilterHeight,o=e.effectiveFilterWidth,i=s-1-e.padInfo.top,l=o-1-e.padInfo.left,u=s*o-1;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class vEe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,o=e.dilationHeight,i=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${i}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xEe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,o=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=$s(o.shape,i,l,d,u,c),h=new VP(f,"max",!0),p=n.runWebGLProgram(h,[o],o.dtype),g=new vEe(f),y=n.runWebGLProgram(g,[a,p],o.dtype);return n.disposeIntermediateTensorInfo(p),y}const bEe={kernelName:LS,backendName:"webgl",kernelFunc:xEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wEe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s,output:o}=e,i=s;Dp([s,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=Yr(i.shape,l,u,1,c,d),h=!0,p=new my(f,"max",h),g=n.runWebGLProgram(p,[i],i.dtype),y=new yEe(f),v=n.runWebGLProgram(y,[a,g],i.dtype);return n.disposeIntermediateTensorInfo(g),v}const SEe={kernelName:FS,backendName:"webgl",kernelFunc:wEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CEe(t,e,n,r){let a=new my(n,"max",!1);const s=r.runWebGLProgram(a,[t],"float32");a=new my(n,"max",!0,!0,e);const o=r.runWebGLProgram(a,[t],"float32");return[s,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ee={kernelName:tx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:s,pad:o,includeBatchInIndex:i}=e,l=n;j(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];j(Qr(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Yr(r.shape,a,s,u,o),[d,f]=CEe(r,i,c,l);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ee(t,e,n,r){const a=ne(e),o=ne(t.shape)/a,i=Re({inputs:{x:t},attrs:{shape:[o,a]},backend:r}),l=hd(i,"float32","mean",r),u=Re({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kEe={kernelName:sp,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:a,axis:s}=e,o=n,i=r.shape.length,l=Yt(s,r.shape);let u=l;const c=gr(u,i),d=c!=null,f=o.shouldExecuteOnCPU([r]),h=[];let p=r;if(d){if(f){const w=o.texData.get(p.dataId).values,C=new Array(i);for(let k=0;k<C.length;k++)C[k]=r.shape[c[k]];const _=BP(w,r.shape,r.dtype,c,C);p=o.makeTensorInfo(C,r.dtype);const $=o.texData.get(p.dataId);$.values=_}else p=T2(r,c,o);h.push(p),u=Qn(u.length,i)}Yn("sum",u,i);const[g,y]=mr(p.shape,u);let v=g;a&&(v=ir(g,l));const x=$Ee(p,y,v,o);for(const b of h)o.disposeIntermediateTensorInfo(b);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NEe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r,i=a.shape.length,l=Yt(s,a.shape);let u=l;const c=gr(u,i);let d=a;c!=null&&(d=ma({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Qn(u.length,a.shape.length)),Yn("min",u,i);const[f,h]=mr(d.shape,u),p=ne(h),g=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),y=hd(g,g.dtype,"min",n);let v;if(o){const x=ir(f,l);v=Re({inputs:{x:y},backend:n,attrs:{shape:x}})}else v=Re({inputs:{x:y},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),v}const IEe={kernelName:op,backendName:"webgl",kernelFunc:NEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TEe=zP+`
  return min(a, b);
`,EEe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+fd+`
  return result;
`,AEe=Lr({opSnippet:TEe,packedOpSnippet:EEe,cpuKernelImpl:m_e}),PEe={kernelName:nx,backendName:"webgl",kernelFunc:AEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OEe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const a=e.length,s=hn(a),o=n.map(c=>c[0]).join(","),i=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u=r==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${o};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${i});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class REe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const a=e.length,s=hn(a),o=n.map(p=>p[0]).join(","),i=n.map((p,g)=>p[0]+e[g]).join(","),l=fa("rc",a),u=fa("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,f=r==="reflect"?0:1;let h="";if(a===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;h=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[a-2]} += 1;
        if(${l[a-2]} < ${this.outputShape[a-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[a-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${i});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DEe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:a,mode:s}=n,o=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new REe(r.shape,a,s):new OEe(r.shape,a,s);return e.runWebGLProgram(o,[r],r.dtype)},jEe={kernelName:ip,backendName:"webgl",kernelFunc:DEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MEe=`if (b == 0.0) return NAN;
  return mod(a, b);`,FEe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+fd+`
  return result;
`,LEe=Lr({opSnippet:MEe,packedOpSnippet:FEe}),BEe={kernelName:rx,backendName:"webgl",kernelFunc:LEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zEe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UEe=`
if (a == b) {
  return 1.0;
};
return a / b;`,VEe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,S8=Lr({opSnippet:UEe,packedOpSnippet:VEe,checkOutOfBounds:!0}),WEe={kernelName:Iv,backendName:"webgl",kernelFunc:S8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gj="return a - b;",C8=Lr({opSnippet:Gj,packedOpSnippet:Gj,supportsComplex:!0,cpuKernelImpl:j_e}),GEe={kernelName:jx,backendName:"webgl",kernelFunc:C8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:s}=r,o=Yt([s],a.shape),i=w8({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=ir(i.shape,o),u=Re({inputs:{x:i},backend:n,attrs:{shape:l}}),c=C8({inputs:{a,b:u},backend:n}),d=v8({inputs:{x:c},backend:n}),f=E2({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),h=Re({inputs:{x:f},backend:n,attrs:{shape:l}}),p=S8({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}const HEe={kernelName:Sp,backendName:"webgl",kernelFunc:_8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qEe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:s,seed:o,normalized:i}=r,l=i?a:_8({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new zEe(u,c,s),f=[[o]],h=n.runWebGLProgram(d,[l],"int32",f);return i||n.disposeIntermediateTensorInfo(l),h}const KEe={kernelName:lp,backendName:"webgl",kernelFunc:qEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XEe=ao+`
  return -x;
`,YEe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function QEe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[o,i]=y_e(s.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,o)}let a;return ee().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Pl(r.shape,YEe):a=new Xo(r.shape,XEe),n.runWebGLProgram(a,[r],r.dtype)}const JEe={kernelName:sx,backendName:"webgl",kernelFunc:QEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZEe=i2;function eAe(t){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:s}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:l}=r,u=n.readSync(a.dataId),c=n.readSync(s.dataId),{selectedIndices:d}=ZEe(u,c,o,i,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const tAe={kernelName:up,backendName:"webgl",kernelFunc:eAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nAe=MA;function rAe(t){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:s}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(a.dataId),d=n.readSync(s.dataId),{selectedIndices:f,validOutputs:h}=nAe(c,d,o,i,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const aAe={kernelName:ix,backendName:"webgl",kernelFunc:rAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sAe=l2;function oAe(t){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:s}=e,{maxOutputSize:o,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(a.dataId),d=n.readSync(s.dataId),f=o,h=i,p=l,g=u,{selectedIndices:y,selectedScores:v}=sAe(c,d,f,h,p,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const iAe={kernelName:cp,backendName:"webgl",kernelFunc:oAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lAe{constructor(e,n,r,a){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uAe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:s,depth:o,onValue:i,offValue:l}=r,u=ne(a.shape),c=new lAe(u,o,i,l),d=Re({inputs:{x:a},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[d],s);n.disposeIntermediateTensorInfo(d);const h=[...a.shape,o],p=Re({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),p},cAe={kernelName:dp,backendName:"webgl",kernelFunc:uAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kw(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const a=nb({inputs:{input:r},backend:n}),s=Kw({inputs:{x:a},backend:n}),o=A2({inputs:{input:r},backend:n}),i=Kw({inputs:{x:o},backend:n}),l=pu({inputs:{real:s,imag:i},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),l}else return rb({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const dAe={kernelName:Bx,backendName:"webgl",kernelFunc:Kw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const a=nb({inputs:{input:r},backend:n}),s=$8({inputs:{x:a},backend:n}),o=A2({inputs:{input:r},backend:n}),i=Kw({inputs:{x:o},backend:n}),l=pu({inputs:{real:s,imag:i},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),l}else return rb({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const fAe={kernelName:lx,backendName:"webgl",kernelFunc:$8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hAe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return IN({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const s=e[0].shape,o=e[0].dtype;e.forEach(c=>{_r(s,c.shape,"All tensors passed to stack must have matching shapes"),j(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(c=>{const d=IN({inputs:{input:c},backend:n,attrs:{dim:a}});return i.push(d),d}),u=c8({inputs:l,backend:n,attrs:{axis:a}});return i.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const pAe={kernelName:ux,backendName:"webgl",kernelFunc:hAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mAe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const a=e.length,s=hn(a),o=n.map(u=>u[0]).join(","),i=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${o};
        int end = ${i};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${o});
      ${s} end = ${s}(${i});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gAe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const a=e.length,s=hn(a),o=n.map(g=>g[0]).join(","),i=n.map((g,y)=>g[0]+e[y]).join(","),l=fa("rc",a),u=fa("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${s} rc = outputLoc;`,`${l[a-1]} += 1;
       if(${c}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${l[a-2]} += 1;
       if(${l[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${l[a-1]} += 1;
         if(${c}) {`],h=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,y=a===1?2:4;g<y;g++)p+=`
        ${f[g]}
        if (${h}) {
          result[${g}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=a===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${o});
      const ${s} end = ${s}(${i});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:s,constantValue:o}=r;if(ne(a.shape)===0){const u=s.map((c,d)=>c[0]+a.shape[d]+c[1]);return rb({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}const i=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gAe(a.shape,s,o):new mAe(a.shape,s,o),l=[[o]];return n.runWebGLProgram(i,[a],a.dtype,l)},yAe={kernelName:fp,backendName:"webgl",kernelFunc:k8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vAe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,xAe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+fd+`
  return result;
`,bAe=Lr({opSnippet:vAe,packedOpSnippet:xAe}),wAe={kernelName:cx,backendName:"webgl",kernelFunc:bAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SAe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r,i=a.shape.length,l=[],u=Yt(s,a.shape);let c=u;const d=gr(c,i);let f=a;d!=null&&(f=ma({inputs:{x:a},backend:n,attrs:{perm:d}}),c=Qn(c.length,i),l.push(f)),Yn("prod",c,i);let h;if(n.shouldExecuteOnCPU([f])){const p=n.texData.get(f.dataId).values,{outVals:g,outShape:y,outDtype:v}=x_e(f.shape,f.dtype,p,c);h=n.makeTensorInfo(y,v,g)}else{const[p,g]=mr(f.shape,c),y=ne(g),v=Re({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),x=Wx(a.dtype),b=hd(v,x,"prod",n);h=Re({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(v),l.push(b)}if(o){l.push(h);const p=ir(h.shape,u);h=Re({inputs:{x:h},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const CAe={kernelName:pp,backendName:"webgl",kernelFunc:SAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ae(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:s,indices:o}=e,{outputRaggedRank:i}=r,l=a.map(v=>n.readSync(v.dataId)),u=a.map(v=>v.shape),c=n.readSync(s.dataId),d=n.readSync(o.dataId),[f,h,p]=b_e(l,u,c,s.shape,s.dtype,d,o.shape,i),g=f.map(v=>n.makeTensorInfo([v.length],"int32",v)),y=n.makeTensorInfo(p,s.dtype,h);return g.concat([y])}const $Ae={kernelName:EE,backendName:"webgl",kernelFunc:_Ae};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kAe(t){const{inputs:e,backend:n}=t,{starts:r,limits:a,deltas:s}=e,o=n.readSync(r.dataId),i=n.readSync(a.dataId),l=n.readSync(s.dataId),[u,c]=w_e(o,r.shape,r.dtype,i,a.shape,l,s.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const NAe={kernelName:AE,backendName:"webgl",kernelFunc:kAe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IAe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:s,defaultValue:o,rowPartitionTensors:i}=e,{rowPartitionTypes:l}=r,u=n.readSync(a.dataId),c=n.readSync(s.dataId),d=n.readSync(o.dataId),f=i.map(y=>n.readSync(y.dataId)),h=i.map(y=>y.shape),[p,g]=S_e(u,a.shape,c,s.shape,s.dtype,d,o.shape,f,h,l);return n.makeTensorInfo(p,s.dtype,g)}const TAe={kernelName:PE,backendName:"webgl",kernelFunc:IAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:s,dtype:o}=n,i=C_e(r,a,s,o);return e.makeTensorInfo([i.length],o,i)},EAe={kernelName:dx,backendName:"webgl",kernelFunc:N8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AAe="return 1.0 / x;",PAe=Ft({opSnippet:AAe}),OAe={kernelName:fx,backendName:"webgl",kernelFunc:PAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RAe=ao+`
  return (x < 0.0) ? 0.0 : x;
`,DAe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jAe=Ft({opSnippet:RAe,packedOpSnippet:DAe}),MAe={kernelName:hx,backendName:"webgl",kernelFunc:jAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FAe=ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,LAe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,BAe=Ft({opSnippet:FAe,packedOpSnippet:LAe}),zAe={kernelName:yx,backendName:"webgl",kernelFunc:BAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UAe{constructor(e,n,r,a,s){this.variableNames=["A"],this.outputShape=[];const[o,i,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?i-1:i,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let f;s?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VAe{constructor(e,n,r,a,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?i-1:i,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let f;s?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WAe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:s,halfPixelCenters:o,size:i}=r,[l,u]=i,c=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new VAe(a.shape,l,u,s,o):new UAe(a.shape,l,u,s,o);return n.runWebGLProgram(c,[a],"float32")}const GAe={kernelName:gp,backendName:"webgl",kernelFunc:WAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HAe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,s]=n,[,o,i]=e,l=[r&&o>1?a-1:a,r&&i>1?s-1:s],u=[r&&o>1?o-1:o,r&&i>1?i-1:i],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qAe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,i=new HAe(s.shape,a.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const KAe={kernelName:gx,backendName:"webgl",kernelFunc:qAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XAe{constructor(e,n,r,a,s){this.variableNames=["A"],this.outputShape=[];const[o,i,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?i-1:i,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],f=a?"0.5":"0.0";let h;s?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${i}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YAe{constructor(e,n,r,a,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,i,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?i-1:i,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],f=a?"0.5":"0.0";let h;s?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${i}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QAe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:s,halfPixelCenters:o,size:i}=r,[l,u]=i,c=ee().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new YAe(a.shape,l,u,s,o):new XAe(a.shape,l,u,s,o);return n.runWebGLProgram(c,[a],a.dtype)}const JAe={kernelName:mp,backendName:"webgl",kernelFunc:QAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZAe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,s]=n,[,o,i]=e,l=[r&&o>1?a-1:a,r&&i>1?s-1:s],u=[r&&o>1?o-1:o,r&&i>1?i-1:i],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${i}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,i=new ZAe(s.shape,a.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const tPe={kernelName:mx,backendName:"webgl",kernelFunc:ePe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nPe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=i=>n.indexOf(i)!==-1&&e[i]!==1?`${e[i]} - coords[${i}] - 1`:`coords[${i}]`,s=e.map((i,l)=>a(l)).join(","),o=hn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rPe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const a=fa("rc",r),s=`${a[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${a[r-2]} + 1 < ${this.outputShape[r-2]}`,i=hn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${i} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(a.slice())};
          if(${s}){
            result.g = ${u(a.slice())};
          }
          if(${o}) {
            result.b = ${c(a.slice())};
            if(${s}) {
              result.a = ${d(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return f(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",f(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",f(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",f(p)}function f(p){const g=e.map((x,b)=>h(b,p)),y=g.join(","),v=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${v}))`}function h(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aPe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:s}=r,o=a.shape.length,i=Yt(s,a.shape);if(o===0)return ts({inputs:{x:a},backend:n});const l=ee().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rPe(a.shape,i):new nPe(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}const sPe={kernelName:yp,backendName:"webgl",kernelFunc:aPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oPe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],a=e[2];this.outputShape=e;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iPe={kernelName:Ip,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:s,center:o}=e,i=n,l=new oPe(r.shape,s),[u,c]=v2(o,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(a),Math.cos(a)]];return i.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lPe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,uPe=Ft({opSnippet:lPe}),cPe={kernelName:vx,backendName:"webgl",kernelFunc:uPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dPe="return inversesqrt(x);",fPe=Ft({opSnippet:dPe,cpuKernelImpl:__e}),hPe={kernelName:xx,backendName:"webgl",kernelFunc:fPe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WP{constructor(e,n,r,a,s,o,i=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=hn(s.length),c=hn(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${v};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pPe{constructor(e,n,r,a,s,o,i=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=hn(s.length),c=hn(o.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,v=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${s});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${v};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mPe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:s}=e,{shape:o}=r,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=jo(s,a,o),f=[d/u,u];if(d===0)return n.makeTensorInfo(o,a.dtype);const h=Re({inputs:{x:a},backend:n,attrs:{shape:[l,i]}}),p=Re({inputs:{x:s},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;ee().getBool("WEBGL_PACK")?y=new pPe(l,i,h.shape.length,p.shape.length,c,f):y=new WP(l,i,h.shape.length,p.shape.length,c,f);const v=n.runWebGLProgram(y,[p,h,g],p.dtype),x=Re({inputs:{x:v},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),x}const gPe={kernelName:vp,backendName:"webgl",kernelFunc:mPe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yPe{constructor(e,n,r,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const s="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,i=ee().getNumber("WEBGL_VERSION")===2?s:o,l=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vPe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:s}=e,{side:o}=r,i=new yPe(a.shape[0],a.shape[1],s.shape[1],o),l=[[a.shape[1]]];return n.runWebGLProgram(i,[a,s],"int32",l)}const xPe={kernelName:bp,backendName:"webgl",kernelFunc:vPe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bPe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let a,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",a="resRC";else{const i=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${i[c]}`),c<e&&l.push(`${i[c]}`);a=l.join(),s=u.join()}const o=hn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wPe(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:s}=e,o=new bPe(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,s],pa(a.dtype,s.dtype))}const SPe={kernelName:bx,backendName:"webgl",kernelFunc:wPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CPe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${JA};
  float scale = ${ZA};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,_Pe=Ft({opSnippet:CPe}),$Pe={kernelName:wx,backendName:"webgl",kernelFunc:_Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kPe=zp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,NPe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,IPe=Ft({opSnippet:kPe,packedOpSnippet:NPe,cpuKernelImpl:k_e}),TPe={kernelName:kx,backendName:"webgl",kernelFunc:IPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,APe=Ft({opSnippet:EPe}),PPe={kernelName:$x,backendName:"webgl",kernelFunc:APe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OPe=zp+`
  return sin(x);
`,RPe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${fd}
  return result;
`,DPe=Ft({opSnippet:OPe,packedOpSnippet:RPe}),jPe={kernelName:Cx,backendName:"webgl",kernelFunc:DPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MPe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,FPe=Ft({opSnippet:MPe}),LPe={kernelName:_x,backendName:"webgl",kernelFunc:FPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BPe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,zPe=Ft({opSnippet:BPe}),UPe={kernelName:Nx,backendName:"webgl",kernelFunc:zPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VPe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,paddings:o}=r;j(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=s.reduce((v,x)=>v*x),l=[[0,0]];l.push(...o);for(let v=1+s.length;v<a.shape.length;++v)l.push([0,0]);const u=[],c=k8({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=ad(c.shape,s,i,!1),f=sd(d.length,s.length,!1),h=od(c.shape,s,i,!1),p=Re({inputs:{x:c},backend:n,attrs:{shape:d}}),g=ma({inputs:{x:p},backend:n,attrs:{perm:f}}),y=Re({inputs:{x:g},backend:n,attrs:{shape:h}});return u.push(c),u.push(p),u.push(g),u.forEach(v=>n.disposeIntermediateTensorInfo(v)),y},WPe={kernelName:Tx,backendName:"webgl",kernelFunc:VPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GPe(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:s,defaultValue:o}=e;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const i=n.readSync(r.dataId),l=n.readSync(a.dataId),u=n.readSync(s.dataId),c=n.readSync(o.dataId)[0],[d,f,h,p,g]=I_e(i,r.shape,r.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],a.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const HPe={kernelName:zS,backendName:"webgl",kernelFunc:GPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qPe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:s}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=Array.from(n.readSync(a.dataId)),i=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[u,c,d]=T_e(i,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}const KPe={kernelName:Ax,backendName:"webgl",kernelFunc:qPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XPe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const o=n.readSync(r.dataId),i=n.readSync(a.dataId),l=n.readSync(s.dataId),[u,c]=QH(o,r.shape,r.dtype,i,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const YPe={kernelName:Px,backendName:"webgl",kernelFunc:XPe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QPe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const o=n.readSync(r.dataId),i=n.readSync(a.dataId),l=n.readSync(s.dataId),[u,c]=QH(o,r.shape,r.dtype,i,l);return n.makeTensorInfo(c,r.dtype,u)}const JPe={kernelName:Ox,backendName:"webgl",kernelFunc:QPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZPe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:s,defaultValue:o}=e,{outputShape:i}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=jo(s,a,i),h=!1;if(s.dtype==="string"){const v=n.bufferSync(a),x=n.bufferSync(s),b=si(n.readSync(o.dataId)[0]),w=$_e(v,x,i,f,c,u,l,d,b,h);return n.makeTensorInfo(i,w.dtype,w.values)}const p=new WP(u,l,a.shape.length,s.shape.length,d,[f,1],h),g=n.runWebGLProgram(p,[s,a,o],s.dtype),y=Re({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(g),y}const eOe={kernelName:Cp,backendName:"webgl",kernelFunc:ZPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:s,axis:o}=r,i=Yt(o,a.shape)[0],l=w2(a,s,i),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(f=>{const h=[...d];h[i]=f;const p=Up({inputs:{x:a},backend:n,attrs:{begin:c,size:h}});return c[i]+=f,p})}const nOe={kernelName:Ex,backendName:"webgl",kernelFunc:tOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hj="return sqrt(x);",rOe=Ft({opSnippet:Hj,packedOpSnippet:Hj,cpuKernelImpl:E_e}),aOe={kernelName:Ix,backendName:"webgl",kernelFunc:rOe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sOe="return x * x;",oOe=Ft({opSnippet:sOe}),iOe={kernelName:US,backendName:"webgl",kernelFunc:oOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qj="return (a - b) * (a - b);",lOe=Lr({opSnippet:qj,packedOpSnippet:qj}),uOe={kernelName:Rx,backendName:"webgl",kernelFunc:lOe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(a.dataId),o=tu(s),i=A_e(o,"string",r);return n.makeTensorInfo(a.shape,"string",i)}const dOe={kernelName:OE,backendName:"webgl",kernelFunc:cOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fOe({inputs:t,attrs:e,backend:n}){const{x:r}=t,a=ao+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,s=new Xo(r.shape,a);return n.runWebGLProgram(s,[r],r.dtype)}const hOe={kernelName:Np,backendName:"webgl",kernelFunc:fOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pOe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const a=r.length,s=hn(r.length),o=hn(r.length);let i="";if(a===1)i="coords * strides + begin";else{let l=0;i=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${e});
      ${s} strides = ${s}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:s,end:o,strides:i,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:y,isSimpleSlice:v,begin:x,end:b,strides:w}=m2(a.shape,s,o,i,l,u,c,d,f);let C;if(g)C=Re({inputs:{x:a},backend:n,attrs:{shape:p}});else if(y||v){j(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const $=d2(x,b,w),k=Up({inputs:{x:a},backend:n,attrs:{begin:x,size:$}});C=Re({inputs:{x:k},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(k)}else if(n.shouldExecuteOnCPU([a])){const k=n.readSync(a.dataId),A=en(a.shape,a.dtype,k),P=P_e(h,A,w,x);C=n.makeTensorInfo(p,a.dtype,P.values)}else{const k=new pOe(x,w,h);C=n.runWebGLProgram(k,[a],a.dtype)}const _=Re({inputs:{x:C},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(C),_}const gOe={kernelName:_p,backendName:"webgl",kernelFunc:mOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:s,leftPad:o,rightPad:i,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,g]=O_e(f,h,a,s,o,i,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const vOe={kernelName:Dx,backendName:"webgl",kernelFunc:yOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xOe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:s,delimiter:o}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const i=n.readSync(s.dataId),l=n.readSync(o.dataId)[0],[u,c,d]=R_e(i,l,a),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const bOe={kernelName:VS,backendName:"webgl",kernelFunc:xOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(s.dataId),i=D_e(o,a);return n.makeTensorInfo(s.shape,"int32",i)}const SOe={kernelName:WS,backendName:"webgl",kernelFunc:wOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const COe="return tan(x);",_Oe=Ft({opSnippet:COe}),$Oe={kernelName:Mx,backendName:"webgl",kernelFunc:_Oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kOe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,NOe=Ft({opSnippet:kOe}),IOe={kernelName:Fx,backendName:"webgl",kernelFunc:NOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TOe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:a,indices:s,updates:o}=e,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=jo(o,s,a.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(a.shape,s.dtype);const h=Re({inputs:{x:s},backend:n,attrs:{shape:[l,i]}}),p=Re({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),g=Re({inputs:{x:a},backend:n,attrs:{shape:f}}),y=new WP(l,i,h.shape.length,p.shape.length,c,f,!1,!0),v=n.runWebGLProgram(y,[p,h,g],g.dtype),x=Re({inputs:{x:v},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),x}const EOe={kernelName:xp,backendName:"webgl",kernelFunc:TOe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AOe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const a=hn(this.rank),s=POe(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function POe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<t.length;a++)r.push(`imod(${n[a]}, ${t[a]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:s}=r;if(a.dtype==="string"||a.shape.length>5){const l=n.readSync(a.dataId),u=a.dtype==="string"?l.map(f=>si(f)):l,c=en(a.shape,a.dtype,u),d=M_e(c,s);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const o=new AOe(a.shape,s);return n.runWebGLProgram(o,[a],a.dtype)}const OOe={kernelName:Zc,backendName:"webgl",kernelFunc:I8};class ROe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class DOe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function Kj(t){let e=1;for(;e<t;)e*=2;return e}function jOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:s,sorted:o}=r,i=ee().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ee().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([a])||c<i||s>l){const P=n.readSync(a.dataId),[O,R]=F_e(P,u,a.dtype,s,o);return[n.makeTensorInfo(O.shape,O.dtype,O.values),n.makeTensorInfo(R.shape,R.dtype,R.values)]}if(s===0)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[a,rb({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),f=d!==null&&d.isPacked,h=f?n.unpackTensor(a):a,g=ne(u)/c,y=Re({inputs:{x:h},attrs:{shape:[g,c]},backend:n});f&&Pu(n,h);const v=Kj(s),x=Kj(c);let b=null;const w=()=>b===null?[y,y]:[y,b],C=(P,O,R)=>{const B=w(),F=new ROe(R),H=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[P],[O]],te=b;b=n.runWebGLProgram(F,B,"int32",H),Pu(n,te)};for(let P=1;P<v;P*=2){const O=P*2;for(let R=P;R>=1;R/=2)C(O,R,[g,x])}for(let P=x;P>v;P/=2){const O=w(),R=new DOe([g,P/2]),F=[[c],[b===null?1:0],[v]],L=b;b=n.runWebGLProgram(R,O,"int32",F),Pu(n,L);const H=v/2,te=H*2;for(let V=H;V>=1;V/=2)C(te,V,b.shape)}let _=b;b=Up({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,s]}}),Pu(n,_);let $=b8({inputs:{x:y,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Pu(n,y);const k=u.slice(0,-1);k.push(s),_=b,b=Re({inputs:{x:b},attrs:{shape:k},backend:n}),Pu(n,_);const A=$;return $=Re({inputs:{x:$},attrs:{shape:k},backend:n}),Pu(n,A),[$,b]}const MOe={kernelName:$p,backendName:"webgl",kernelFunc:jOe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FOe{constructor(e,n,r,a,s,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const i=r==="nearest"?1:2;let l;switch(a){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${i} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LOe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:s}=e,{interpolation:o,fillMode:i,fillValue:l,outputShape:u}=r,[c,d,f,h]=a.shape,[p,g]=u??[d,f],y=[c,p,g,h],v=new FOe(d,f,o,i,l,y);return n.runWebGLProgram(v,[a,s],"float32")}const BOe={kernelName:kp,backendName:"webgl",kernelFunc:LOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:s}=e;Dp(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(s.dataId),{outputValues:i,outputShape:l,indices:u}=L_e(o,a,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,i),r.makeTensorInfo([u.length],"int32",u)]}const UOe={kernelName:GS,backendName:"webgl",kernelFunc:zOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:s}=r;s<0&&(s+=a.shape.length);const o=a,i=o.shape.length,l=a.shape[s],u=new Array(i-1);let c=0;for(let g=0;g<i;g++)g!==s&&(u[c++]=o.shape[g]);const d=[],f=new Array(i).fill(0),h=o.shape.slice();h[s]=1;const p=new Array(l);for(let g=0;g<p.length;g++){f[s]=g;const y=Up({inputs:{x:o},backend:n,attrs:{begin:f,size:h}}),v=Re({inputs:{x:y},backend:n,attrs:{shape:u}});p[g]=v,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const WOe={kernelName:Lx,backendName:"webgl",kernelFunc:VOe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GOe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,a=e.batchSize,s=e.inSize,o=e.numSegments,i=o*Math.ceil(s/r);this.outputShape=[a,i];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,f=`
        sumValue += dot(values, segFilter);
    `;let h="";s%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HOe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:s}=e,{numSegments:o}=r,i=a.shape.length,l=[];let u=0;const c=gr([u],i);let d=a;c!=null&&(d=ma({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=Qn(1,i)[0]);const f=SP(d.shape,u,o),h=ne([d.shape[u]]),p=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(p);const g=Wx(a.dtype),y=(w,C,_,$,k)=>{const A=w.shape[0],P=w.shape[1],O=Y5(P,k),R={windowSize:O,inSize:P,batchSize:A,numSegments:k},B=new GOe(R,C),F=n.compileAndRun(B,[w,_],$);if(l.push(F),F.shape[1]===k)return F;const L=N8({backend:n,attrs:{start:0,stop:k,step:1,dtype:"float32"}}),H=I8({inputs:{x:L},backend:n,attrs:{reps:[P/O]}});return l.push(L),l.push(H),y(F,C,H,$,k)},v=y(p,"unsortedSegmentSum",s,g,o),x=Re({inputs:{x:v},backend:n,attrs:{shape:f}});let b=x;if(c!=null){l.push(x);const w=nd(c);b=ma({inputs:{x:b},backend:n,attrs:{perm:w}})}return l.forEach(w=>n.disposeIntermediateTensorInfo(w)),b}const qOe={kernelName:HS,backendName:"webgl",kernelFunc:HOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KOe=[A$e,O$e,j$e,L$e,z$e,W$e,H$e,K$e,J$e,eke,rke,oke,uke,hke,gke,vke,bke,_ke,kke,Ike,Pke,Lke,zke,Gke,qke,Zke,tNe,sNe,p$e,lNe,hNe,yNe,CNe,kNe,INe,ENe,PNe,jNe,LNe,UNe,WNe,HNe,KNe,QNe,ZNe,rIe,sIe,lIe,dIe,hIe,yIe,wIe,$Ie,IIe,AIe,PIe,RIe,jIe,FIe,BIe,UIe,HIe,XIe,JIe,eTe,rTe,oTe,cTe,pTe,h$e,gTe,dNe,xTe,STe,$Te,g$e,TTe,OTe,DTe,LTe,UTe,HTe,XTe,ZTe,rEe,oEe,lEe,fEe,pEe,gEe,bEe,SEe,_Ee,kEe,IEe,PEe,jEe,BEe,KEe,x$e,JEe,tAe,aAe,iAe,Xke,cAe,fAe,pAe,yAe,wAe,v$e,CAe,$Ae,NAe,TAe,EAe,Yke,WEe,OAe,MAe,zAe,w$e,GAe,KAe,JAe,tPe,sPe,iPe,cPe,hPe,gPe,xPe,SPe,$Pe,TPe,PPe,jPe,LPe,Mke,HEe,UPe,WPe,HPe,KPe,YPe,JPe,eOe,nOe,aOe,iOe,uOe,dOe,hOe,gOe,vOe,bOe,SOe,GEe,I$e,$Oe,IOe,EOe,OOe,MOe,BOe,T$e,UOe,WOe,qOe,dAe];for(const t of KOe)zx(t);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Lt;(function(t){t[t.float32=0]="float32",t[t.int32=1]="int32",t[t.bool=2]="bool",t[t.string=3]="string",t[t.complex64=4]="complex64"})(Lt||(Lt={}));var yy;(function(t){t[t.linear=0]="linear",t[t.relu=1]="relu",t[t.relu6=2]="relu6",t[t.prelu=3]="prelu",t[t.leakyrelu=4]="leakyrelu",t[t.sigmoid=5]="sigmoid",t[t.elu=6]="elu"})(yy||(yy={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let T8;function XOe(t){T8=t.wasm.cwrap(Ic,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])}function YOe(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s,bias:o,preluActivationWeights:i}=e;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r,f=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(s.dataId).id;let p=0;if(o!=null){const k=n.dataIdMap.get(o.dataId);if(k.shape.length!==1)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${k.shape.length}.`);p=k.id}const g=i==null?0:n.dataIdMap.get(i.dataId).id,y=yy[c];if(y==null)throw new Error(`${c} activation not yet supported for FusedConv2D in the wasm backend.`);const v=l?a.shape[2]:a.shape[1],x=u?s.shape[1]:s.shape[2],b=ct(a.shape.slice(0,-2),s.shape.slice(0,-2)),w=n.makeOutput([...b,v,x],a.dtype),C=n.dataIdMap.get(w.dataId).id,_=new Uint8Array(new Int32Array(a.shape).buffer),$=new Uint8Array(new Int32Array(s.shape).buffer);return T8(f,_,a.shape.length,h,$,s.shape.length,l,u,y,p,g,d||0,C),w}const QOe={kernelName:Ic,backendName:"wasm",setupFunc:XOe,kernelFunc:YOe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(t,e){let n;function r(s){n=s.wasm.cwrap(t,null,["number","number","number"])}function a(s){const{backend:o,inputs:{x:i}}=s,l=o.dataIdMap.get(i.dataId).id,u=o.makeOutput(i.shape,e||i.dtype),c=o.dataIdMap.get(u.dataId).id;return ne(u.shape)===0||n(l,Lt[i.dtype],c),u}return{kernelName:t,backendName:"wasm",setupFunc:r,kernelFunc:a}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JOe=jt(lv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZOe=jt(uv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eRe=jt(cv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(t,e,n){let r;function a(o){r=o.wasm.cwrap(t,null,["number","array","number","number","array","number","number","number"])}function s(o){const{backend:i,inputs:l}=o,{a:u,b:c}=l,d=i.dataIdMap.get(u.dataId).id,f=i.dataIdMap.get(c.dataId).id,h=n??u.dtype,p=ct(u.shape,c.shape),g=i.makeOutput(p,h);if(ne(p)===0)return g;const y=new Uint8Array(new Int32Array(u.shape).buffer),v=new Uint8Array(new Int32Array(c.shape).buffer),x=i.dataIdMap.get(g.dataId).id;return r(d,y,u.shape.length,f,v,c.shape.length,Lt[u.dtype],x),g}return{kernelName:t,backendName:"wasm",setupFunc:a,kernelFunc:s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tRe=lr(Ah);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let E8;function nRe(t){E8=t.wasm.cwrap(Ph,null,["array","number","number","number"])}function rRe(t){const{inputs:e,backend:n}=t,r=n.makeOutput(e[0].shape,e[0].dtype);if(ne(r.shape)===0)return r;const a=e.map(i=>n.dataIdMap.get(i.dataId).id),s=new Uint8Array(new Int32Array(a).buffer),o=n.dataIdMap.get(r.dataId).id;return E8(s,a.length,Lt[r.dtype],o),r}const aRe={kernelName:Ph,backendName:"wasm",setupFunc:nRe,kernelFunc:rRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2(t){const{inputs:{x:e},backend:n}=t;if(e.dtype==="string")return Qs(n.readSync(e.dataId),e.shape,e.dtype);const r=n.makeOutput(e.shape,e.dtype),a=n.typedArrayFromHeap(e);return n.typedArrayFromHeap(r).set(a),r}const sRe={kernelName:Zh,backendName:"wasm",kernelFunc:P2};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let A8;function oRe(t){A8=t.wasm.cwrap(Wl,null,["number","array","number","number","number","array","number"])}function nu(t){const{inputs:e,backend:n,attrs:r}=t,[a,s]=lRe(e.x.shape,r.perm);let o=!0;for(let p=0;p<s.length;p++)s[p]!==p&&(o=!1);const i=iRe(e.x.shape,r.perm),l={dataId:e.x.dataId,shape:a,dtype:e.x.dtype};if(o){const p=P2({inputs:e,backend:n});return p.shape=i,p}const u=n.makeOutput(i,l.dtype),c=n.dataIdMap.get(l.dataId).id,d=n.dataIdMap.get(u.dataId).id,f=new Uint8Array(new Int32Array(s).buffer),h=new Uint8Array(new Int32Array(l.shape).buffer);return A8(c,h,l.shape.length,Lt[l.dtype],d,f,s.length),u}function iRe(t,e){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[e[r]];return n}function lRe(t,e){const n=[],r=[];for(let a=0;a<t.length;++a)t[a]!==1&&n.push(t[a]),t[e[a]]!==1&&r.push(e[a]);for(let a=0;a<r.length;++a){let s=-1;for(let o=0;o<r.length;++o)r[o]>=a&&(s===-1||r[s]>r[o])&&(s=o);r[s]=a}return[n,r]}const uRe={kernelName:Wl,backendName:"wasm",kernelFunc:nu,setupFunc:oRe};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mu(t,e,n){const r=t.shape,a=t.shape.length,s=Yt(e,r);let o=s;const i=gr(o,a);let l=null,u=!1;if(i!=null){const c=new Array(a);for(let h=0;h<c.length;h++)c[h]=r[i[h]];o=Qn(o.length,a),l=nu({inputs:{x:t},attrs:{perm:i},backend:n});const d=n.dataIdMap.get(t.dataId).id;n.dataIdMap.get(l.dataId).id!==d&&(u=!0)}return{transposed:l,originalAxes:s,axes:o,inputWasTransposed:u}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let P8;function cRe(t){P8=t.wasm.cwrap(Oh,null,["number, number, number"])}function dRe(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n;let l=e.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);if(h){const b=e.dataIdMap.get(c.dataId).id;u=c,l=b}const p=u.shape.length;Yn("all",d,p);const[g,y]=mr(u.shape,d),v=ne(y),x=e.makeOutput(g,o.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;P8(l,v,b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const fRe={kernelName:Oh,backendName:"wasm",setupFunc:cRe,kernelFunc:dRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let O8;function hRe(t){O8=t.wasm.cwrap(Rh,null,["number, number, number"])}function pRe(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n;let l=e.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);if(h){const b=e.dataIdMap.get(c.dataId).id;u=c,l=b}const p=u.shape.length;Yn("any",d,p);const[g,y]=mr(u.shape,d),v=ne(y),x=e.makeOutput(g,o.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;O8(l,v,b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const mRe={kernelName:Rh,backendName:"wasm",setupFunc:hRe,kernelFunc:pRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(t){let e;function n(a){e=a.wasm.cwrap(t,null,["number","number","number","number","number"])}function r(a){const{backend:s,inputs:o,attrs:i}=a,{axis:l}=i,{x:u}=o,c=s.dataIdMap.get(u.dataId).id;let d=c,f=u;const{transposed:h,axes:p,inputWasTransposed:g}=mu(u,l,s);if(g){const C=s.dataIdMap.get(h.dataId).id;C!==c&&(f=h,d=C)}const y=f.shape.slice(0,-1),v=s.makeOutput(y,"int32"),x=s.dataIdMap.get(v.dataId).id,b=ne(v.shape),w=f.shape[p[0]];return e(d,Lt[f.dtype],b,w,x),g&&s.disposeData(h.dataId),v}return{kernelName:t,backendName:"wasm",setupFunc:n,kernelFunc:r}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gRe=R8(dv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yRe=R8(fv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vRe=jt(hv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xRe=jt(pv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bRe=jt(mv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wRe=lr(yv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SRe=jt(gv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let D8;function CRe(t){D8=t.wasm.cwrap(Dh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function _Re(t){const{inputs:e,attrs:n,backend:r}=t,a=e.x,s=r.dataIdMap.get(a.dataId).id,{filterSize:o,strides:i,pad:l,dimRoundingMode:u}=n,c=Yr(a.shape,o,i,1,l,u),d=c.filterHeight,f=c.filterWidth,h=c.padInfo.top,p=c.padInfo.right,g=c.padInfo.bottom,y=c.padInfo.left,v=c.strideHeight,x=c.strideWidth,b=c.inChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);if(c.dilationWidth!==1||c.dilationHeight!==1)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${c.dilationHeight}, ${c.dilationWidth}].`);const w=r.makeOutput(c.outShape,"float32"),C=r.dataIdMap.get(w.dataId).id;return D8(s,a.shape[0],a.shape[1],a.shape[2],d,f,h,p,g,y,v,x,b,C),w}const $Re={kernelName:Dh,backendName:"wasm",setupFunc:CRe,kernelFunc:_Re};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let j8;function kRe(t){j8=t.wasm.cwrap("AvgPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function NRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:l,dataFormat:u}=r,c=$s(a.shape,s,o,1,i,l,u),d=n.makeOutput(c.outShape,a.dtype);return j8(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}const IRe={kernelName:vv,backendName:"wasm",setupFunc:kRe,kernelFunc:NRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let M8;function TRe(t){M8=t.wasm.cwrap("AvgPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ERe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,{filterSize:o,strides:i,pad:l,dimRoundingMode:u}=r,c=$s(s.shape,o,i,1,l,u),d=n.makeOutput(s.shape,s.dtype);return M8(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left,c.filterDepth,c.filterHeight,c.filterWidth),d}const ARe={kernelName:_S,backendName:"wasm",setupFunc:TRe,kernelFunc:ERe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let F8;function PRe(t){F8=t.wasm.cwrap("AvgPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function ORe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,{filterSize:o,strides:i,pad:l}=r,u=Yr(s.shape,o,i,1,l),c=n.makeOutput(s.shape,s.dtype);return F8(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.effectiveFilterHeight,u.effectiveFilterWidth,u.padInfo.top,u.padInfo.left,u.filterHeight,u.filterWidth),c}const RRe={kernelName:CS,backendName:"wasm",setupFunc:PRe,kernelFunc:ORe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(t){const{inputs:e,attrs:n}=t,{x:r}=e,{shape:a}=n,s=ne(r.shape),o=wS(a,s);return j(s===ne(o),()=>`new shape: ${o}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`),t.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const DRe={kernelName:px,backendName:"wasm",kernelFunc:Ta};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let L8;function jRe(t){L8=t.wasm.cwrap(jh,null,["number","array","number","number","array","number","number","number","number"])}function MRe(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:s}=e,{transposeA:o,transposeB:i}=r;if(a.dtype!=="float32"||s.dtype!=="float32")throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const l=a.shape.length,u=s.shape.length,c=o?a.shape[l-2]:a.shape[l-1],d=i?s.shape[u-1]:s.shape[u-2],f=o?a.shape[l-1]:a.shape[l-2],h=i?s.shape[u-2]:s.shape[u-1],p=a.shape.slice(0,-2),g=s.shape.slice(0,-2),y=ne(p),v=ne(g),b=ct(a.shape.slice(0,-2),s.shape.slice(0,-2)).concat([f,h]);j(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${o} and transposeB=${i} must match.`);const w=o?[y,c,f]:[y,f,c],C=i?[v,h,d]:[v,d,h],_=Ta({inputs:{x:a},backend:n,attrs:{shape:w}}),$=Ta({inputs:{x:s},backend:n,attrs:{shape:C}}),k=n.dataIdMap.get(_.dataId).id,A=n.dataIdMap.get($.dataId).id,P=o?_.shape[2]:_.shape[1],O=i?$.shape[1]:$.shape[2],R=Math.max(y,v),B=n.makeOutput([R,P,O],_.dtype),F=n.dataIdMap.get(B.dataId).id,L=new Uint8Array(new Int32Array(_.shape).buffer),H=new Uint8Array(new Int32Array($.shape).buffer);return L8(k,L,_.shape.length,A,H,$.shape.length,o,i,F),n.disposeData(_.dataId),n.disposeData($.dataId),B.shape=b,B}const FRe={kernelName:jh,backendName:"wasm",setupFunc:jRe,kernelFunc:MRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vc(t){const{inputs:{x:e},attrs:{begin:n,size:r},backend:a}=t,[s,o]=p2(e,n,r),i=f2(e.shape,s,o),l=a.readSync(e.dataId),u=a.makeOutput(o,e.dtype),c=Dt(e.shape),d=a.dataIdMap.get(u.dataId);if(i){const p=h2(s,c);return e.dtype==="string"?d.stringBytes=l.slice(p,p+ne(o)):a.typedArrayFromHeap(u).set(l.subarray(p,p+ne(o))),u}if(e.dtype==="string"){const p=pN(l,s,o,e.shape,e.dtype);return d.stringBytes=p,u}const f=a.typedArrayFromHeap(u),h=e.shape.length;if(h===2)LRe(l,c[0],f,s,o);else if(h===3)BRe(l,c[0],c[1],f,s,o);else if(h===4)zRe(l,c[0],c[1],c[2],f,s,o);else{const p=pN(l,s,o,e.shape,e.dtype);f.set(p)}return u}function LRe(t,e,n,r,a){let s=0;const o=r[0],i=r[1],l=o+a[0];for(let u=o;u<l;u++){const c=u*e+i;n.set(t.subarray(c,c+a[1]),s),s+=a[1]}}function BRe(t,e,n,r,a,s){let o=0;const i=a[0],l=a[1],u=a[2],c=i+s[0],d=l+s[1];for(let f=i;f<c;f++)for(let h=l;h<d;h++){const p=f*e+h*n+u;r.set(t.subarray(p,p+s[2]),o),o+=s[2]}}function zRe(t,e,n,r,a,s,o){let i=0;const l=s[0],u=s[1],c=s[2],d=l+o[0],f=u+o[1],h=c+o[2],p=s[3];for(let g=l;g<d;g++)for(let y=u;y<f;y++)for(let v=c;v<h;v++){const x=g*e+y*n+v*r+p;a.set(t.subarray(x,x+o[3]),i),i+=o[3]}}const URe={kernelName:Sx,backendName:"wasm",kernelFunc:Vc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VRe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,crops:o}=r,i=s.reduce((v,x)=>v*x),l=ad(a.shape,s,i),u=sd(l.length,s.length),c=od(a.shape,s,i),d=x2(o,s.length),f=b2(c,o,s.length),h=Ta({inputs:{x:a},backend:n,attrs:{shape:l}}),p=nu({inputs:{x:h},backend:n,attrs:{perm:u}}),g=Ta({inputs:{x:p},backend:n,attrs:{shape:c}}),y=Vc({inputs:{x:g},backend:n,attrs:{begin:d,size:f}});return n.disposeData(h.dataId),n.disposeData(p.dataId),n.disposeData(g.dataId),y}const WRe={kernelName:xv,backendName:"wasm",kernelFunc:VRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let B8;function GRe(t){B8=t.wasm.cwrap(Mh,null,["number","number","boolean","number","number","number"])}function HRe(t){const{backend:e,inputs:n,attrs:r}=t,{x:a,weights:s}=n,{size:o}=r,i=s.shape.reduce((d,f)=>d*f,1)!==0,l=a.shape.length===1?[o]:[a.shape[0],o],u=e.makeOutput(l,s.dtype);function c(d){return e.dataIdMap.get(d.dataId).id}return B8(c(a),o,i,c(s),Lt[s.dtype],c(u)),u}const qRe={kernelName:Mh,backendName:"wasm",setupFunc:GRe,kernelFunc:HRe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KRe=lr($S);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XRe(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,s=n.typedArrayFromHeap(r),o=n.typedArrayFromHeap(a),i=ct(Array.from(s),Array.from(o));return n.makeOutput([i.length],"int32",void 0,new Int32Array(i))}const YRe={kernelName:bv,backendName:"wasm",kernelFunc:XRe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gu(t){const{inputs:{x:e},attrs:{dtype:n},backend:r}=t,a=r.makeOutput(e.shape,n),s=r.typedArrayFromHeap(e);return r.typedArrayFromHeap(a).set(s),a}const QRe={kernelName:Fh,backendName:"wasm",kernelFunc:gu};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JRe=jt(wv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let z8;function ZRe(t){z8=t.wasm.cwrap(Lh,null,["number","number","number","number"])}function eDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:s,clipValueMax:o}=r,i=n.dataIdMap.get(a.dataId).id,l=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(l.dataId).id;return z8(i,s,o,u),l}const tDe={kernelName:Lh,backendName:"wasm",setupFunc:ZRe,kernelFunc:eDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U8(t){const{inputs:e,backend:n}=t,r=Yt(t.attrs.axis,e[0].shape)[0],a=e.map(h=>h.shape);g2(a,r);let s=Na(e.map(h=>h.shape),r);const o=e.filter(h=>ne(h.shape)>0);if(o.length===1)return P2({inputs:{x:o[0]},backend:n});const i=n.makeOutput(s,e[0].dtype);if(ne(s)===0)return i;if(o[0].dtype==="string"){const h=o.map(b=>{const C=[-1,ne(b.shape.slice(r))];return Ta({inputs:{x:b},backend:n,attrs:{shape:C}})}),p=h.map(b=>({vals:n.readSync(b.dataId),shape:b.shape}));s=Na(h.map(b=>b.shape),1);const g=h[0].shape[0]===1,y=iG(p,s,e[0].dtype,g),v=Na(o.map(b=>b.shape),r);i.shape=v;const x=n.dataIdMap.get(i.dataId);return x.stringBytes=CP(y),h.forEach(b=>n.disposeData(b.dataId)),i}const l=ne(o[0].shape.slice(0,r));let u=0;const c=o.map(h=>{const p=ne(h.shape.slice(r));return u+=p,p}),d=o.map(h=>n.typedArrayFromHeap(h)),f=n.typedArrayFromHeap(i);for(let h=0;h<l;h++){let p=h*u;for(let g=0;g<d.length;g++){const y=c[g],v=h*y,x=d[g].subarray(v,v+y);f.set(x,p),p+=y}}return i}const nDe={kernelName:Sv,backendName:"wasm",kernelFunc:U8};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let V8;function rDe(t){V8=t.wasm.cwrap(Bh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function aDe(t){const{inputs:e,attrs:n,backend:r}=t,{x:a,filter:s}=e,o=r.dataIdMap.get(a.dataId).id,i=r.dataIdMap.get(s.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d,dataFormat:f}=n,h=ks(f),p=Rn(a.shape,s.shape,l,u,c,d,!1,h),g=p.filterHeight,y=p.filterWidth,v=p.padInfo.top,x=p.padInfo.right,b=p.padInfo.bottom,w=p.padInfo.left,C=p.dilationHeight,_=p.dilationWidth,$=p.strideHeight,k=p.strideWidth,A=p.inChannels,P=p.outChannels,O=p.padInfo.type==="SAME"?1:0;if(p.dataFormat!=="channelsLast")throw new Error(`wasm backend Conv2D does not support dataFormat:'${p.dataFormat}'. Please use 'channelsLast'.`);const R=r.makeOutput(p.outShape,"float32"),B=r.dataIdMap.get(R.dataId).id;return V8(o,a.shape[0],a.shape[1],a.shape[2],i,g,y,v,x,b,w,O,C,_,$,k,A,P,B),R}const sDe={kernelName:Bh,backendName:"wasm",setupFunc:rDe,kernelFunc:aDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let W8;function oDe(t){W8=t.wasm.cwrap(zh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function iDe(t){const{backend:e,inputs:n,attrs:r}=t,{dy:a,filter:s}=n,{strides:o,pad:i,dataFormat:l,dimRoundingMode:u,inputShape:c}=r,d=1,f=ks(l),h=Rn(c,s.shape,o,d,i,u,!1,f),{batchSize:p,filterHeight:g,filterWidth:y,inChannels:v,inHeight:x,inWidth:b,outChannels:w,outHeight:C,outWidth:_,strideHeight:$,strideWidth:k}=h,A=g-1-h.padInfo.top,P=y-1-h.padInfo.left,O=h.dataFormat==="channelsLast",R=Dt(h.inShape),B=Dt(a.shape),[F,L,H]=Dt(s.shape),te=R[0],V=O?R[1]:R[2],Q=O?R[2]:1,se=O?1:R[1],le=B[0],ue=O?B[1]:B[2],ce=O?B[2]:1,re=O?1:B[1],ge=e.makeOutput(h.inShape,"float32"),Se=e.dataIdMap.get(ge.dataId).id,Ne=e.dataIdMap.get(a.dataId).id,we=e.dataIdMap.get(s.dataId).id;return W8(Ne,we,p,g,y,x,b,v,C,_,w,$,k,A,P,F,L,H,te,V,Q,se,le,ue,ce,re,Se),ge}const lDe={kernelName:zh,backendName:"wasm",setupFunc:oDe,kernelFunc:iDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let G8;function uDe(t){G8=t.wasm.cwrap(Uh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function cDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor x must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);const u=Do(a.shape,s.shape,o,l,i),c=n.makeOutput(u.outShape,a.dtype);return G8(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}const dDe={kernelName:Uh,backendName:"wasm",setupFunc:uDe,kernelFunc:cDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let H8;function fDe(t){H8=t.wasm.cwrap(Cv,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function hDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:s}=e,{strides:o,pad:i,filterShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);const u=Do(a.shape,l,o,1,i),c=n.makeOutput(u.filterShape,s.dtype);return H8(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}const pDe={kernelName:Cv,backendName:"wasm",setupFunc:fDe,kernelFunc:hDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let q8;function mDe(t){q8=t.wasm.cwrap(Vh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function gDe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:s}=e,{pad:o,strides:i,inputShape:l}=r;if(a.dtype!=="float32")throw new Error(`Tensor dy must have dtype float32, got ${a.dtype}`);if(s.dtype!=="float32")throw new Error(`Tensor filter must have dtype float32, got ${s.dtype}`);const u=Do(l,s.shape,i,1,o),c=n.makeOutput(u.inShape,a.dtype);return q8(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(c.dataId).id,u.batchSize,u.inDepth,u.inHeight,u.inWidth,u.inChannels,u.outDepth,u.outHeight,u.outWidth,u.outChannels,u.strideDepth,u.strideHeight,u.strideWidth,u.dilationDepth,u.dilationHeight,u.dilationWidth,u.filterDepth,u.filterHeight,u.filterWidth,u.padInfo.front,u.padInfo.top,u.padInfo.left),c}const yDe={kernelName:Vh,backendName:"wasm",setupFunc:mDe,kernelFunc:gDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vDe=jt(_v);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xDe=jt($v);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var TN;(function(t){t[t.bilinear=0]="bilinear",t[t.nearest=1]="nearest"})(TN||(TN={}));let K8;function bDe(t){K8=t.wasm.cwrap(Hh,null,["number","number","number","number","array","number","number","number","number","number"])}function wDe(t){const{backend:e,inputs:n,attrs:r}=t,{method:a,extrapolationValue:s,cropSize:o}=r,{image:i,boxes:l,boxInd:u}=n,c=l.shape[0],[d,f]=o,h=[c,d,f,i.shape[3]];let p=e.dataIdMap.get(i.dataId),g;i.dtype!=="float32"&&(g=gu({backend:e,inputs:{x:i},attrs:{dtype:"float32"}}),p=e.dataIdMap.get(g.dataId));const y=p.id,v=e.dataIdMap.get(l.dataId).id,x=e.dataIdMap.get(u.dataId).id,b=e.makeOutput(h,"float32"),w=e.dataIdMap.get(b.dataId).id,C=new Uint8Array(new Int32Array(i.shape).buffer);return K8(y,v,x,c,C,d,f,TN[a],s,w),g!=null&&e.disposeData(g.dataId),b}const SDe={kernelName:Hh,backendName:"wasm",setupFunc:bDe,kernelFunc:wDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let X8;function CDe(t){X8=t.wasm.cwrap(Wh,null,["number","number","number","number","number","number"])}function _De(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r,l=a.shape.length;j(a.dtype==="float32"||a.dtype==="int32",()=>`cumprod does not support ${a.dtype} tensors in the WASM backend`);const u=gr([s],l);let c=a;u!==null&&(c=nu({inputs:{x:a},attrs:{perm:u},backend:n}));const d=Qn(1,l)[0];Yn("cumprod",[d],l);const f=n.makeOutput(c.shape,c.dtype),h=c.shape[d],p=n.dataIdMap.get(c.dataId).id,g=n.dataIdMap.get(f.dataId).id;X8(p,o?1:0,i?1:0,h,g,Lt[a.dtype]);let y=f;if(u!==null){const v=nd(u);y=nu({inputs:{x:f},attrs:{perm:v},backend:n}),n.disposeData(c.dataId),n.disposeData(f.dataId)}return y}const $De={kernelName:Wh,backendName:"wasm",setupFunc:CDe,kernelFunc:_De};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Y8;function kDe(t){Y8=t.wasm.cwrap(Gh,null,["number","number","number","number","number","number"])}function NDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,exclusive:o,reverse:i}=r,l=a.shape.length;j(a.dtype==="float32"||a.dtype==="int32",()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`);const u=gr([s],l);let c=a;u!==null&&(c=nu({inputs:{x:a},attrs:{perm:u},backend:n}));const d=Qn(1,l)[0];Yn("cumsum",[d],l);const f=n.makeOutput(c.shape,c.dtype),h=c.shape[d],p=n.dataIdMap.get(c.dataId).id,g=n.dataIdMap.get(f.dataId).id;Y8(p,o?1:0,i?1:0,h,g,Lt[a.dtype]);let y=f;if(u!==null){const v=nd(u);y=nu({inputs:{x:f},attrs:{perm:v},backend:n}),n.disposeData(c.dataId),n.disposeData(f.dataId)}return y}const IDe={kernelName:Gh,backendName:"wasm",setupFunc:kDe,kernelFunc:NDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Q8;function TDe(t){Q8=t.wasm.cwrap("DenseBincount",null,["number","array","number","number","boolean","number","number","boolean","number"])}function EDe(t){const{backend:e,inputs:n,attrs:r}=t,{x:a,weights:s}=n,{size:o,binaryOutput:i}=r,l=s.shape.reduce((f,h)=>f*h,1)!==0,u=a.shape.length===1?[o]:[a.shape[0],o],c=e.makeOutput(u,s.dtype);function d(f){return e.dataIdMap.get(f.dataId).id}return Q8(d(a),new Uint8Array(new Int32Array(a.shape).buffer),a.shape.length,o,l,d(s),Lt[s.dtype],i,d(c)),c}const ADe={kernelName:kv,backendName:"wasm",setupFunc:TDe,kernelFunc:EDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let J8;function PDe(t){J8=t.wasm.cwrap(qh,null,["number","number","number","array","number","array","array","number","number"])}function ODe(t){const{backend:e,inputs:n,attrs:r}=t,{x:a}=n,{blockSize:s,dataFormat:o}=r,i=a.shape[0],l=o==="NHWC"?a.shape[1]:a.shape[2],u=o==="NHWC"?a.shape[2]:a.shape[3],c=o==="NHWC"?a.shape[3]:a.shape[1],d=l*s,f=u*s,h=c/(s*s),p=o==="NHWC"?[i,d,f,h]:[i,h,d,f],g=e.makeOutput(p,"float32"),v=e.dataIdMap.get(a.dataId).id,x=new Uint8Array(new Int32Array(Dt(a.shape)).buffer),b=new Uint8Array(new Int32Array(p).buffer),w=new Uint8Array(new Int32Array(Dt(p)).buffer),C=e.dataIdMap.get(g.dataId).id;return J8(v,s,o==="NHWC"?1:0,x,a.shape.length-1,b,w,p.length,C),g}const RDe={kernelName:qh,backendName:"wasm",setupFunc:PDe,kernelFunc:ODe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Z8;function DDe(t){Z8=t.wasm.cwrap(Kh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function jDe(t){const{inputs:e,attrs:n,backend:r}=t,{x:a,filter:s}=e,o=r.dataIdMap.get(a.dataId).id,i=r.dataIdMap.get(s.dataId).id,{strides:l,dilations:u,pad:c,dimRoundingMode:d}=n,f=u??[1,1],h=Rn(a.shape,s.shape,l,f,c,d,!0),p=h.filterHeight,g=h.filterWidth,y=h.padInfo.top,v=h.padInfo.right,x=h.padInfo.bottom,b=h.padInfo.left,w=h.dilationHeight,C=h.dilationWidth,_=h.strideHeight,$=h.strideWidth,k=h.inChannels,A=h.outChannels,P=h.padInfo.type==="SAME"?1:0;if(h.dataFormat!=="channelsLast")throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const O=r.makeOutput(h.outShape,"float32"),R=r.dataIdMap.get(O.dataId).id;return Z8(o,a.shape[0],a.shape[1],a.shape[2],i,p,g,y,v,x,b,P,w,C,_,$,k,A,R),O}const MDe={kernelName:Kh,backendName:"wasm",setupFunc:DDe,kernelFunc:jDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eq;function FDe(t){eq=t.wasm.cwrap("Diag",null,["number","number","number","number"])}function LDe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=ne(r.shape),s=n.makeOutput([...r.shape,...r.shape],r.dtype);return eq(n.dataIdMap.get(r.dataId).id,Lt[r.dtype],a,n.dataIdMap.get(s.dataId).id),s}const BDe={kernelName:Nv,backendName:"wasm",setupFunc:FDe,kernelFunc:LDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tq;function zDe(t){tq=t.wasm.cwrap(Xh,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function UDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s}=e,{strides:o,pad:i,dilations:l}=r;if(a.dtype!==s.dtype)throw new Error(`Dilation2D error: x must have the same dtype as filter. Got ${a.dtype} and ${s.dtype}`);const u=cu(a.shape,s.shape,o,i,"NHWC",l),c=n.makeOutput(u.outShape,a.dtype);return tq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(c.dataId).id,Lt[a.dtype],u.batchSize,u.inChannels,u.inHeight,u.inWidth,u.outHeight,u.outWidth,u.strideHeight,u.strideWidth,u.dilationHeight,u.dilationWidth,u.filterHeight,u.filterWidth,u.padInfo.top,u.padInfo.left),c}const VDe={kernelName:Xh,backendName:"wasm",setupFunc:zDe,kernelFunc:UDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nq;function WDe(t){nq=t.wasm.cwrap(PS,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function GDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,dy:o}=e,{strides:i,pad:l,dilations:u}=r;if(a.dtype!==s.dtype||a.dtype!==o.dtype)throw new Error(`Dilation2DBackpropFilter error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${o.dtype}`);const c=cu(a.shape,s.shape,i,l,"NHWC",u),d=n.makeOutput(s.shape,s.dtype);return nq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,Lt[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}const HDe={kernelName:PS,backendName:"wasm",setupFunc:WDe,kernelFunc:GDe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rq;function qDe(t){rq=t.wasm.cwrap(AS,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function KDe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:s,dy:o}=e,{strides:i,pad:l,dilations:u}=r;if(a.dtype!==s.dtype||a.dtype!==o.dtype)throw new Error(`Dilation2DBackpropInput error: x must have the same dtype as filter and dy. Got ${a.dtype}, ${s.dtype}, and ${o.dtype}`);const c=cu(a.shape,s.shape,i,l,"NHWC",u),d=n.makeOutput(a.shape,a.dtype);return rq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,Lt[a.dtype],c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.filterHeight,c.filterWidth,c.padInfo.top,c.padInfo.left),d}const XDe={kernelName:AS,backendName:"wasm",setupFunc:qDe,kernelFunc:KDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YDe=jt(Tv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let aq;function QDe(t){aq=t.wasm.cwrap(Ev,null,["number","number","number"])}function JDe(t){const{inputs:e,backend:n}=t,{dy:r,y:a}=e,s=n.makeOutput(a.shape,"float32"),o=i=>n.dataIdMap.get(i.dataId).id;return aq(o(a),o(r),o(s)),s}const ZDe={kernelName:Ev,backendName:"wasm",setupFunc:QDe,kernelFunc:JDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e3e=!1,t3e=lr(Pv,e3e,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n3e=jt(Av);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3e=jt(Ov,"float32");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(t){const{inputs:e,attrs:n,backend:r}=t,{input:a}=e,{dim:s}=n,o=a.shape.length,i=a.shape.slice();let l=s;return s<0&&(j(-(o+1)<=s,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+s+1),i.splice(l,0,1),Ta({inputs:{x:a},backend:r,attrs:{shape:i}})}const a3e={kernelName:Rv,backendName:"wasm",kernelFunc:EN};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s3e=jt(Dv,"float32");/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t){const{attrs:{shape:e,value:n},backend:r}=t;let{attrs:{dtype:a}}=t;a=a||lu(n);const s=r.makeOutput(e,a);return r.typedArrayFromHeap(s).fill(n),s}const o3e={kernelName:jv,backendName:"wasm",kernelFunc:sq};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oq;function i3e(t){oq=t.wasm.cwrap(Yh,null,["number","number","number","number","number","number"])}function l3e(t){const{inputs:e,backend:n}=t,{image:r}=e,a=n.makeOutput(r.shape,r.dtype),s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,[i,l,u,c]=r.shape;return oq(s,i,l,u,c,o),a}const u3e={kernelName:Yh,backendName:"wasm",kernelFunc:l3e,setupFunc:i3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c3e=jt(Mv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3e=lr(Fv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let iq;function f3e(t){iq=t.wasm.cwrap(Qh,null,["number","number","number","number","number","number","number"])}function h3e(t){const{backend:e,inputs:n,attrs:r}=t,{varianceEpsilon:a}=r,{x:s,mean:o,variance:i,offset:l,scale:u}=n,c=e.dataIdMap.get(s.dataId).id,d=e.dataIdMap.get(o.dataId).id,f=e.dataIdMap.get(i.dataId).id,h=l!=null?e.dataIdMap.get(l.dataId).id:0,p=u!=null?e.dataIdMap.get(u.dataId).id:0,g=e.makeOutput(s.shape,s.dtype);if(ne(s.shape)===0)return g;const y=e.dataIdMap.get(g.dataId).id;return iq(c,d,f,h,p,a,y),g}const p3e={kernelName:Qh,backendName:"wasm",setupFunc:f3e,kernelFunc:h3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lq;function m3e(t){lq=t.wasm.cwrap(Tc,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function g3e(t){const{inputs:e,attrs:n,backend:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=n,g=Rn(a.shape,s.shape,l,c,u,f),y=yy[h];if(y==null)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);const v=r.dataIdMap.get(a.dataId).id,x=r.dataIdMap.get(s.dataId).id,b=g.outChannels;let w=0;if(o!=null){const ce=r.dataIdMap.get(o.dataId);if(ce.shape.length!==1)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${ce.shape.length}.`);if(ce.shape[0]!==b)throw new Error(`FusedConv2D bias shape (${ce.shape}) does not match the number of output channels (${b})`);w=ce.id}const C=g.filterHeight,_=g.filterWidth,$=g.padInfo.top,k=g.padInfo.right,A=g.padInfo.bottom,P=g.padInfo.left,O=g.dilationHeight,R=g.dilationWidth,B=g.strideHeight,F=g.strideWidth,L=g.inChannels,H=g.padInfo.type==="SAME"?1:0,te=g.batchSize,V=g.inHeight,Q=g.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);const se=r.makeOutput(g.outShape,"float32"),le=r.dataIdMap.get(se.dataId).id,ue=i==null?0:r.dataIdMap.get(i.dataId).id;return lq(v,te,V,Q,x,C,_,w,$,k,A,P,H,O,R,B,F,L,b,y,ue,p||0,le),se}const y3e={kernelName:Tc,backendName:"wasm",setupFunc:m3e,kernelFunc:g3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let uq;function v3e(t){uq=t.wasm.cwrap(Ec,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function x3e(t){const{inputs:e,attrs:n,backend:r}=t,{x:a,filter:s,bias:o,preluActivationWeights:i}=e,{strides:l,pad:u,dilations:c,dataFormat:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=n,g=Rn(a.shape,s.shape,l,c,u,f,!0),y=yy[h];if(y==null)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const v=r.dataIdMap.get(a.dataId).id,x=r.dataIdMap.get(s.dataId).id,b=g.outChannels;let w=0;if(o!=null){const ce=r.dataIdMap.get(o.dataId);if(ce.shape.length!==1)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${ce.shape.length}.`);if(ce.shape[0]!==b)throw new Error(`FusedDepthwiseConv2D bias shape (${ce.shape}) does not match the number of output channels (${b})`);w=ce.id}const C=g.filterHeight,_=g.filterWidth,$=g.padInfo.top,k=g.padInfo.right,A=g.padInfo.bottom,P=g.padInfo.left,O=g.dilationHeight,R=g.dilationWidth,B=g.strideHeight,F=g.strideWidth,L=g.inChannels,H=g.padInfo.type==="SAME"?1:0,te=g.batchSize,V=g.inHeight,Q=g.inWidth;if(d!=="NHWC")throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${d}'. Please use 'NHWC'.`);const se=r.makeOutput(g.outShape,"float32"),le=r.dataIdMap.get(se.dataId).id,ue=i==null?0:r.dataIdMap.get(i.dataId).id;return uq(v,te,V,Q,x,C,_,w,$,k,A,P,H,O,R,B,F,L,b,y,ue,p||0,le),se}const b3e={kernelName:Ec,backendName:"wasm",setupFunc:v3e,kernelFunc:x3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let cq;function w3e(t){cq=t.wasm.cwrap(Jh,null,["number","number","number","number","number","number","array","number"])}function S3e(t){const{backend:e,inputs:n}=t,{params:r,indices:a}=n,[s,o,i,l]=Jx(r,a),u=e.makeOutput(s,r.dtype);if(o===0)return u;const c=a.shape,d=c[c.length-1],h=e.dataIdMap.get(r.dataId).id,g=e.dataIdMap.get(a.dataId).id,y=new Uint8Array(new Int32Array(l).buffer),v=e.dataIdMap.get(u.dataId).id;return cq(h,Lt[r.dtype],g,o,d,i,y,v),u}const C3e={kernelName:Jh,backendName:"wasm",setupFunc:w3e,kernelFunc:S3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let dq;function _3e(t){dq=t.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])}function $3e(t){const{backend:e,inputs:n,attrs:r}=t,{x:a,indices:s}=n,{axis:o,batchDims:i}=r,l=Yt(o,a.shape)[0],u=e.readSync(s.dataId),c=a.shape[l];for(let A=0;A<u.length;++A){const P=u[A];j(P<=c-1&&P>=0,()=>`GatherV2: the index value ${P} is not in [0, ${c-1}]`)}const d=S2(a,s,l,i),f=Ta({inputs:{x:a},attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]},backend:e}),h=ne(s.shape),p=Ta({inputs:{x:s},attrs:{shape:[d.batchSize,h/d.batchSize]},backend:e}),g=[d.batchSize,d.outerSize,h/d.batchSize,d.sliceSize],y=e.makeOutput(g,a.dtype);if(ne(a.shape)===0)return y;const v=f.shape.length-1,b=e.dataIdMap.get(f.dataId).id,C=e.dataIdMap.get(p.dataId).id,_=e.dataIdMap.get(y.dataId).id,$=new Uint8Array(new Int32Array(Dt(f.shape)).buffer),k=new Uint8Array(new Int32Array(Dt(g)).buffer);return dq(b,Lt[a.dtype],$,v,C,d.batchSize,k,_),e.disposeData(f.dataId),e.disposeData(p.dataId),y.shape=d.outputShape,y}const k3e={kernelName:Lv,backendName:"wasm",setupFunc:_3e,kernelFunc:$3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3e=!1,I3e=lr(Bv,N3e,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T3e=!1,E3e=lr(zv,T3e,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A3e=jt(Uv,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3e=jt(Vv,"bool");/**
 * @license
 * Copyright 2022 The TensorFlow Authors. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O3e=jt(Wv,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fq;function R3e(t){fq=t.wasm.cwrap(ep,null,["number","number","number","number"])}function D3e(t){const{inputs:{x:e},attrs:{alpha:n},backend:r}=t,a=r.dataIdMap.get(e.dataId).id,s=r.makeOutput(e.shape,"float32");if(ne(e.shape)!==0){const o=r.dataIdMap.get(s.dataId).id;fq(a,Lt[e.dtype],n,o)}return s}const j3e={kernelName:ep,backendName:"wasm",setupFunc:R3e,kernelFunc:D3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3e=!1,F3e=lr(Gv,M3e,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3e=!1,B3e=lr(Hv,L3e,"bool");/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hq;function z3e(t){hq=t.wasm.cwrap(tp,null,["number","number","number","number"])}function U3e(t){const{attrs:e,backend:n}=t,{start:r,stop:a,num:s}=e,o=Math.floor(s),i=n.makeOutput([o],"float32");return hq(n.dataIdMap.get(i.dataId).id,r,a,o),i}const V3e={kernelName:tp,backendName:"wasm",setupFunc:z3e,kernelFunc:U3e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W3e=jt(qv);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3e=jt(Kv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3e=!1,q3e=lr(Xv,H3e,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K3e=jt(Yv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3e=!1,Y3e=lr(Qv,X3e,"bool");/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q3e=!1,J3e=lr(PV,Q3e,"bool");/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pq;function Z3e(t){pq=t.wasm.cwrap(np,null,["number","number","number","number","number","number","number"])}function eje(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:s,bias:o,alpha:i,beta:l}=r;if(a.dtype!=="float32")throw new Error("LRN error: x must have dtype float32");const u=n.makeOutput(a.shape,a.dtype);return pq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(u.dataId).id,a.shape[3],s,o,i,l),u}const tje={kernelName:np,backendName:"wasm",setupFunc:Z3e,kernelFunc:eje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let mq;function nje(t){mq=t.wasm.cwrap(Jv,null,["number","number","number","number","number","number","number","number","number"])}function rje(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,y:s,dy:o}=e,{depthRadius:i,bias:l,alpha:u,beta:c}=r;if(a.dtype!=="float32"||s.dtype!=="float32"||o.dtype!=="float32")throw new Error("LRNGrad error: x, y, and dy must have dtype float32");const d=n.makeOutput(a.shape,a.dtype);return mq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(o.dataId).id,n.dataIdMap.get(d.dataId).id,o.shape[3],i,l,u,c),d}const aje={kernelName:Jv,backendName:"wasm",setupFunc:nje,kernelFunc:rje};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let gq;function sje(t){gq=t.wasm.cwrap(rp,null,["number","number","number","number"])}function oje(t){const{backend:e,inputs:n,attrs:r}=t,{reductionIndices:a,keepDims:s}=r,{x:o}=n;let l=e.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);if(h){const b=e.dataIdMap.get(c.dataId).id;u=c,l=b}const p=u.shape.length;Yn("max",d,p);const[g,y]=mr(u.shape,d),v=ne(y),x=e.makeOutput(g,o.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;gq(l,Lt[o.dtype],v,b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const ije={kernelName:rp,backendName:"wasm",setupFunc:sje,kernelFunc:oje};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lje=lr(Zv);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yq;function uje(t){yq=t.wasm.cwrap(ap,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function cje(t){const{inputs:e,attrs:n,backend:r}=t,a=e.x,s=r.dataIdMap.get(a.dataId).id;j(a.dtype==="float32",()=>`Error in MaxPool: only float32 input is supported. Got ${a.dtype}.`);const{filterSize:o,strides:i,pad:l,dimRoundingMode:u}=n,c=Yr(a.shape,o,i,1,l,u),d=c.filterHeight,f=c.filterWidth,h=c.padInfo.top,p=c.padInfo.right,g=c.padInfo.bottom,y=c.padInfo.left,v=c.dilationHeight,x=c.dilationWidth,b=c.strideHeight,w=c.strideWidth,C=c.inChannels,_=c.outChannels;if(c.dataFormat!=="channelsLast")throw new Error(`wasm backend does not support dataFormat:'${c.dataFormat}'. Please use 'channelsLast'.`);const $=r.makeOutput(c.outShape,"float32"),k=r.dataIdMap.get($.dataId).id;return yq(s,a.shape[0],a.shape[1],a.shape[2],d,f,h,p,g,y,v,x,b,w,C,_,k),$}const dje={kernelName:ap,backendName:"wasm",setupFunc:uje,kernelFunc:cje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vq;function fje(t){vq=t.wasm.cwrap("MaxPool3D",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function hje(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:l,dataFormat:u}=r,c=$s(a.shape,s,o,1,i,l,u),d=n.makeOutput(c.outShape,a.dtype);return vq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}const pje={kernelName:ex,backendName:"wasm",setupFunc:fje,kernelFunc:hje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let xq;function mje(t){xq=t.wasm.cwrap("MaxPool3DGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function gje(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,{filterSize:o,strides:i,pad:l,dimRoundingMode:u}=r,c=$s(s.shape,o,i,1,l,u),d=n.makeOutput(s.shape,s.dtype);return xq(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inDepth,c.inHeight,c.inWidth,c.outDepth,c.outHeight,c.outWidth,c.strideDepth,c.strideHeight,c.strideWidth,c.dilationDepth,c.dilationHeight,c.dilationWidth,c.effectiveFilterDepth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.front,c.padInfo.top,c.padInfo.left),d}const yje={kernelName:LS,backendName:"wasm",setupFunc:mje,kernelFunc:gje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bq;function vje(t){bq=t.wasm.cwrap("MaxPoolGrad",null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function xje(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:s}=e,{filterSize:o,strides:i,pad:l,dimRoundingMode:u}=r,c=Yr(s.shape,o,i,1,l,u),d=n.makeOutput(s.shape,s.dtype);return bq(n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),d}const bje={kernelName:FS,backendName:"wasm",setupFunc:vje,kernelFunc:xje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let wq;function wje(t){wq=t.wasm.cwrap("MaxPoolWithArgmax",null,["number","number","number","number","boolean","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])}function Sje(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:s,strides:o,pad:i,includeBatchInIndex:l}=r;j(a.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.shape.length}.`);const u=[1,1];j(Qr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Yr(a.shape,s,o,[1,1],i),d=n.makeOutput(c.outShape,a.dtype),f=n.makeOutput(c.outShape,"int32");return wq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(d.dataId).id,n.dataIdMap.get(f.dataId).id,Lt[a.dtype],l,c.batchSize,c.inChannels,c.inHeight,c.inWidth,c.outHeight,c.outWidth,c.strideHeight,c.strideWidth,c.dilationHeight,c.dilationWidth,c.effectiveFilterHeight,c.effectiveFilterWidth,c.padInfo.top,c.padInfo.left),[d,f]}const Cje={kernelName:tx,backendName:"wasm",setupFunc:wje,kernelFunc:Sje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Sq;function _je(t){Sq=t.wasm.cwrap(sp,null,["number, number, number"])}function $je(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let l=i,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);let p=d;if(h){const w=e.dataIdMap.get(c.dataId).id;w!==i&&(u=c,l=w,p=Qn(p.length,u.shape.length))}Yn("mean",p,u.shape.length);const[g,y]=mr(u.shape,p),v=ne(y);let x=u;u.dtype!=="float32"&&(x=gu({backend:e,inputs:{x:u},attrs:{dtype:"float32"}}),l=e.dataIdMap.get(x.dataId).id);const b=e.makeOutput(g,"float32");if(ne(u.shape)!==0){const w=e.dataIdMap.get(b.dataId).id;Sq(l,v,w)}if(h&&e.disposeData(c.dataId),s){const w=ir(b.shape,f);b.shape=w}return u.dtype!=="float32"&&e.disposeData(x.dataId),b}const kje={kernelName:sp,backendName:"wasm",setupFunc:_je,kernelFunc:$je};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Cq;function Nje(t){Cq=t.wasm.cwrap(op,null,["number","number","number","number"])}function Ije(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let l=i,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);if(h){const b=e.dataIdMap.get(c.dataId).id;b!==i&&(u=c,l=b)}const p=u.shape.length;Yn("min",d,p);const[g,y]=mr(u.shape,d),v=ne(y),x=e.makeOutput(g,u.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;Cq(l,Lt[o.dtype],v,b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const Tje={kernelName:op,backendName:"wasm",setupFunc:Nje,kernelFunc:Ije};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eje=lr(nx);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var AN;(function(t){t[t.reflect=0]="reflect",t[t.symmetric=1]="symmetric"})(AN||(AN={}));let _q;function Aje(t){_q=t.wasm.cwrap(ip,null,["number","array","number","number","array","array","number","number"])}function Pje(t){const{inputs:{x:e},backend:n,attrs:{paddings:r,mode:a}}=t,s=r.map((p,g)=>p[0]+e.shape[g]+p[1]),o=n.dataIdMap.get(e.dataId).id,i=n.makeOutput(s,e.dtype),l=n.dataIdMap.get(i.dataId).id,u=new Uint8Array(new Int32Array(e.shape).buffer),c=r.map(p=>p[0]),d=r.map(p=>p[1]),f=new Uint8Array(new Int32Array(c).buffer),h=new Uint8Array(new Int32Array(d).buffer);return _q(o,u,e.shape.length,Lt[e.dtype],f,h,AN[a],l),i}const Oje={kernelName:ip,backendName:"wasm",kernelFunc:Pje,setupFunc:Aje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let $q;function Rje(t){$q=t.wasm.cwrap(Sp,null,["number","number","number","number"])}function kq(t){const{backend:e,inputs:{logits:n},attrs:{dim:r}}=t,a=e.dataIdMap.get(n.dataId).id,s=e.makeOutput(n.shape,n.dtype),o=e.dataIdMap.get(s.dataId).id,i=n.shape[r],l=ne(n.shape)/i;return ne(s.shape)===0||$q(a,o,i,l),s}const Dje={kernelName:Sp,backendName:"wasm",setupFunc:Rje,kernelFunc:kq};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Nq;function jje(t){Nq=t.wasm.cwrap(lp,null,["number","number","number","number","number","number"])}function Mje(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:s,seed:o,normalized:i}=r;if(a.dtype!=="float32")throw new Error(`Tensor logits must have dtype float32, got ${a.dtype}`);const l=i?a:kq({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),[u,c]=l.shape,d=n.makeOutput([u,s],"int32");return Nq(n.dataIdMap.get(l.dataId).id,u,c,s,o,n.dataIdMap.get(d.dataId).id),i||n.disposeData(l.dataId),d}const Fje={kernelName:lp,backendName:"wasm",setupFunc:jje,kernelFunc:Mje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lje=lr(rx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bje=lr(ax);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zje=jt(sx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GP(t,e){const n=new Int32Array(t.wasm.HEAPU8.buffer,e,4),r=n[0],a=n[1],s=n[2],o=n[3];return t.wasm._free(e),{pSelectedIndices:r,selectedSize:a,pSelectedScores:s,pValidOutputs:o}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Iq;function Uje(t){Iq=t.wasm.cwrap(up,"number",["number","number","number","number","number"])}function Vje(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o}=r,{boxes:i,scores:l}=n,u=e.dataIdMap.get(i.dataId).id,c=e.dataIdMap.get(l.dataId).id,d=Iq(u,c,s,a,o),{pSelectedIndices:f,selectedSize:h,pSelectedScores:p,pValidOutputs:g}=GP(e,d);return e.wasm._free(p),e.wasm._free(g),e.makeOutput([h],"int32",f)}const Wje={kernelName:up,backendName:"wasm",setupFunc:Uje,kernelFunc:Vje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Tq;function Gje(t){Tq=t.wasm.cwrap(ix,"number",["number","number","number","number","number","bool"])}function Hje(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o,padToMaxOutputSize:i}=r,{boxes:l,scores:u}=n,c=e.dataIdMap.get(l.dataId).id,d=e.dataIdMap.get(u.dataId).id,f=Tq(c,d,s,a,o,i),{pSelectedIndices:h,selectedSize:p,pSelectedScores:g,pValidOutputs:y}=GP(e,f);e.wasm._free(g);const v=e.makeOutput([p],"int32",h),x=e.makeOutput([],"int32",y);return[v,x]}const qje={kernelName:ix,backendName:"wasm",setupFunc:Gje,kernelFunc:Hje};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Eq;function Kje(t){Eq=t.wasm.cwrap(cp,"number",["number","number","number","number","number","number"])}function Xje(t){const{backend:e,inputs:n,attrs:r}=t,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o,softNmsSigma:i}=r,{boxes:l,scores:u}=n,c=e.dataIdMap.get(l.dataId).id,d=e.dataIdMap.get(u.dataId).id,f=Eq(c,d,s,a,o,i),{pSelectedIndices:h,selectedSize:p,pSelectedScores:g,pValidOutputs:y}=GP(e,f);e.wasm._free(y);const v=e.makeOutput([p],"int32",h),x=e.makeOutput([p],"float32",g);return[v,x]}const Yje={kernelName:cp,backendName:"wasm",setupFunc:Kje,kernelFunc:Xje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qje=!1,Jje=lr(ox,Qje,"bool");/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Aq;function Zje(t){Aq=t.wasm.cwrap(dp,null,["number","number","number","number","number"])}function eMe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:s,depth:o,onValue:i,offValue:l}=r,u=n.makeOutput([...a.shape,o],s),c=n.dataIdMap.get(u.dataId).id,f=n.dataIdMap.get(a.dataId).id;return Aq(f,o,i,l,c),u}const tMe={kernelName:dp,backendName:"wasm",setupFunc:Zje,kernelFunc:eMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nMe(t){const{inputs:{x:e},backend:n}=t,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(1),r}const rMe={kernelName:lx,backendName:"wasm",kernelFunc:nMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return EN({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const s=e[0].shape,o=e[0].dtype;e.forEach(c=>{_r(s,c.shape,"All tensors passed to stack must have matching shapes"),j(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],l=e.map(c=>{const d=EN({inputs:{input:c},backend:n,attrs:{dim:a}});return i.push(d),d}),u=U8({inputs:l,backend:n,attrs:{axis:a}});return i.forEach(c=>n.disposeData(c.dataId)),u}const sMe={kernelName:ux,backendName:"wasm",kernelFunc:aMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Pq;function oMe(t){Pq=t.wasm.cwrap(fp,null,["number","array","number","number","array","array","number","number"])}function iMe(t){const{inputs:{x:e},backend:n,attrs:{paddings:r,constantValue:a}}=t,s=r.map((g,y)=>g[0]+e.shape[y]+g[1]);if(ne(e.shape)===0)return sq({backend:n,attrs:{shape:s,value:a,dtype:e.dtype}});const o=n.dataIdMap.get(e.dataId).id,i=n.makeOutput(s,e.dtype),u=n.dataIdMap.get(i.dataId).id,c=new Uint8Array(new Int32Array(e.shape).buffer),d=r.map(g=>g[0]),f=r.map(g=>g[1]),h=new Uint8Array(new Int32Array(d).buffer),p=new Uint8Array(new Int32Array(f).buffer);return Pq(o,c,e.shape.length,Lt[e.dtype],h,p,a,u),i}const Oq={kernelName:fp,backendName:"wasm",kernelFunc:iMe,setupFunc:oMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lMe=lr(cx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Rq;function uMe(t){Rq=t.wasm.cwrap(hp,null,["number","number","number"])}function cMe(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id;let i=s;const l=r;let u=l;l.dtype!=="float32"&&(u=gu({backend:n,inputs:{x:r},attrs:{dtype:"float32"}}),i=n.dataIdMap.get(u.dataId).id);const c=n.makeOutput(r.shape,"float32"),d=n.dataIdMap.get(c.dataId).id;return Rq(i,o,d),l.dtype!=="float32"&&n.disposeData(u.dataId),c}const dMe={kernelName:hp,backendName:"wasm",setupFunc:uMe,kernelFunc:cMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Dq;function fMe(t){Dq=t.wasm.cwrap(pp,null,["number","number","number","number"])}function hMe(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let l=i,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);let p=d;if(h){const b=e.dataIdMap.get(c.dataId).id;b!==i&&(u=c,l=b,p=Qn(p.length,u.shape.length))}Yn("prod",p,u.shape.length);const[g,y]=mr(u.shape,p),v=ne(y),x=e.makeOutput(g,u.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;Dq(l,v,Lt[x.dtype],b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const pMe={kernelName:pp,backendName:"wasm",setupFunc:fMe,kernelFunc:hMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mMe=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:s,dtype:o}=n,i=uG(r,a,s,o),l=e.makeOutput([i.length],o);return e.typedArrayFromHeap(l).set(i),l},gMe={kernelName:dx,backendName:"wasm",kernelFunc:mMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yMe=lr(Iv);/**
 * @license
 * Copyright 2022 The TensorFlow Authors. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vMe=jt(fx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xMe=jt(hx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bMe=jt(yx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let jq;function wMe(t){jq=t.wasm.cwrap(gp,null,["number","number","number","number","number","number","number","number","number","number"])}function SMe(t){const{backend:e,inputs:n,attrs:r}=t,{images:a}=n,{alignCorners:s,halfPixelCenters:o,size:i}=r,[l,u]=i,[c,d,f,h]=a.shape,p=[c,l,u,h];let g=e.dataIdMap.get(a.dataId),y;g.dtype!=="float32"&&(y=gu({backend:e,inputs:{x:a},attrs:{dtype:"float32"}}),g=e.dataIdMap.get(y.dataId));const v=g.id,x=e.makeOutput(p,"float32");if(ne(a.shape)===0)return x;const b=e.dataIdMap.get(x.dataId).id;return jq(v,c,d,f,h,l,u,s?1:0,o?1:0,b),y!=null&&e.disposeData(y.dataId),x}const CMe={kernelName:gp,backendName:"wasm",setupFunc:wMe,kernelFunc:SMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Mq;function _Me(t){Mq=t.wasm.cwrap(gx,null,["number","number","number","array","array","boolean"])}function $Me(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,i=n.makeOutput(a.shape,"float32");let l=n.dataIdMap.get(a.dataId),u;return l.dtype!=="float32"&&(u=gu({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(u.dataId)),Mq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),u!=null&&n.disposeData(u.dataId),i}const kMe={kernelName:gx,backendName:"wasm",setupFunc:_Me,kernelFunc:$Me};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Fq;function NMe(t){Fq=t.wasm.cwrap(mp,null,["number","number","number","number","number","number","number","number","number","number"])}function IMe(t){const{backend:e,inputs:n,attrs:r}=t,{images:a}=n,{alignCorners:s,halfPixelCenters:o,size:i}=r,[l,u]=i,[c,d,f,h]=a.shape,p=[c,l,u,h],g=e.makeOutput(p,"float32");if(ne(a.shape)===0)return g;let y=e.dataIdMap.get(a.dataId),v;y.dtype!=="float32"&&(v=gu({backend:e,inputs:{x:a},attrs:{dtype:"float32"}}),y=e.dataIdMap.get(v.dataId));const x=y.id,b=e.dataIdMap.get(g.dataId).id;return Fq(x,c,d,f,h,l,u,s?1:0,o?1:0,b),v!=null&&e.disposeData(v.dataId),g}const TMe={kernelName:mp,backendName:"wasm",setupFunc:NMe,kernelFunc:IMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Lq;function EMe(t){Lq=t.wasm.cwrap(mx,null,["number","number","number","array","array","boolean"])}function AMe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:s}=e,{alignCorners:o}=r,i=n.makeOutput(a.shape,"float32");let l=n.dataIdMap.get(a.dataId),u;return l.dtype!=="float32"&&(u=gu({backend:n,inputs:{x:a},attrs:{dtype:"float32"}}),l=n.dataIdMap.get(u.dataId)),Lq(n.dataIdMap.get(a.dataId).id,n.dataIdMap.get(s.dataId).id,n.dataIdMap.get(i.dataId).id,new Uint8Array(new Int32Array(a.shape).buffer),new Uint8Array(new Int32Array(s.shape).buffer),o),u!=null&&n.disposeData(u.dataId),i}const PMe={kernelName:mx,backendName:"wasm",setupFunc:EMe,kernelFunc:AMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Bq;function OMe(t){Bq=t.wasm.cwrap(yp,null,["number","array","number","array","number","number"])}function RMe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:s}=r,o=Yt(s,a.shape);if(a.shape.length===0)return P2({inputs:{x:a},backend:n});const i=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(i.dataId).id,c=new Uint8Array(new Int32Array(o).buffer),d=new Uint8Array(new Int32Array(a.shape).buffer);Bq(l,c,o.length,d,a.shape.length,u);const f=Ta({inputs:{x:i},attrs:{shape:a.shape},backend:n});return n.disposeData(i.dataId),f}const DMe={kernelName:yp,backendName:"wasm",kernelFunc:RMe,setupFunc:OMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zq;function jMe(t){zq=t.wasm.cwrap(Ip,null,["number","number","number","number","number","number","number","number","array","number","number"])}function MMe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a}=e,{radians:s,fillValue:o,center:i}=r,l=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(a.dataId).id,c=n.dataIdMap.get(l.dataId).id,[d,f,h,p]=a.shape,[g,y]=v2(i,f,h),v=o===0,x=255,b=typeof o=="number"?[o,o,o,v?0:x]:[...o,x],w=new Uint8Array(new Int32Array(b).buffer);return zq(u,d,f,h,p,s,g,y,w,b.length,c),l}const FMe={kernelName:Ip,backendName:"wasm",kernelFunc:MMe,setupFunc:jMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMe=jt(vx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BMe=jt(xx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Uq;function zMe(t){Uq=t.wasm.cwrap(vp,null,["number","number","number","number","number","number","array","number","number"])}function UMe(t){const{backend:e,inputs:n,attrs:r}=t,{indices:a,updates:s}=n,{shape:o}=r,i=e.makeOutput(o,s.dtype);if(ne(o)===0)return i;const{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=jo(s,a,o),p=e.dataIdMap.get(a.dataId).id,y=e.dataIdMap.get(s.dataId).id,v=new Uint8Array(new Int32Array(d).buffer),x=e.dataIdMap.get(i.dataId).id;return Uq(p,y,Lt[s.dtype],l,u,c,v,f,x),i}const VMe={kernelName:vp,backendName:"wasm",setupFunc:zMe,kernelFunc:UMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Vq;function WMe(t){Vq=t.wasm.cwrap(bp,null,["number","number","number","number","number","number","bool","number"])}function GMe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:s}=e,{side:o}=r;if(a.dtype!==s.dtype)throw new Error(`SearchSorted error: sorted_sequence must have the same dtype as values. Got ${a.dtype} and ${s.dtype}`);const i=n.makeOutput(s.shape,"int32");function l(u){return n.dataIdMap.get(u.dataId).id}return Vq(l(a),l(s),a.shape[0],a.shape[1],s.shape[1],Lt[a.dtype],o==="left",l(i)),i}const HMe={kernelName:bp,backendName:"wasm",setupFunc:WMe,kernelFunc:GMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Wq;function qMe(t){Wq=t.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}function KMe(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:s}=e,o=n.dataIdMap.get(r.dataId).id,i=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(s.dataId).id,u=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(u.dataId).id,d=r.shape.length,f=a.shape.length,h=d===0||d>1||f===1?1:ne(a.shape.slice(1));return Wq(o,i,l,h,c),u}const XMe={kernelName:bx,backendName:"wasm",kernelFunc:KMe,setupFunc:qMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YMe=jt(wx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Gq;function QMe(t){Gq=t.wasm.cwrap(kx,null,["number","number"])}function JMe(t){const{backend:e,inputs:{x:n}}=t,r=e.dataIdMap.get(n.dataId).id,a=e.makeOutput(n.shape,n.dtype),s=e.dataIdMap.get(a.dataId).id;return ne(a.shape)===0||Gq(r,s),a}const ZMe={kernelName:"Sigmoid",backendName:"wasm",setupFunc:QMe,kernelFunc:JMe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eFe=jt($x);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tFe=jt(Cx);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nFe=jt(_x);/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rFe=jt(Nx);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:s,paddings:o}=r,i=ne(s),l=[[0,0]];l.push(...o);for(let _=1+s.length;_<a.shape.length;++_)l.push([0,0]);const u=Oq.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=ad(u.shape,s,i,!1),d=sd(c.length,s.length,!1),f=od(u.shape,s,i,!1),g=Ta({inputs:{x:u},backend:n,attrs:{shape:c}}),x=nu({inputs:{x:g},backend:n,attrs:{perm:d}}),C=Ta({inputs:{x},backend:n,attrs:{shape:f}});return n.disposeData(u.dataId),n.disposeData(g.dataId),n.disposeData(x.dataId),C}const sFe={kernelName:Tx,backendName:"wasm",kernelFunc:aFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Hq;function oFe(t){Hq=t.wasm.cwrap("SparseFillEmptyRows","number",["number","number","number","number","number","number","number","number","number","number","number","number"])}function iFe(t){const{backend:e,inputs:n}=t,{indices:r,values:a,denseShape:s,defaultValue:o}=n,i=r.shape[0],l=r.shape[1],u=e.readSync(s.dataId)[0],c=[i+u,l],d=e.dataIdMap.get(r.dataId).id,f=e.dataIdMap.get(a.dataId).id,h=e.dataIdMap.get(o.dataId).id,p=e.makeOutput(c,r.dtype),g=e.dataIdMap.get(p.dataId).id,y=e.makeOutput(c.slice(0,1),a.dtype),v=e.dataIdMap.get(y.dataId).id,x=e.makeOutput([u],"bool"),b=e.dataIdMap.get(x.dataId).id,w=e.makeOutput([i],r.dtype),C=e.dataIdMap.get(w.dataId).id,_=e.makeOutput([4],"int32"),$=e.dataIdMap.get(_.dataId).id,k=Hq(d,f,Lt[a.dtype],i,u,l,h,g,v,b,C,$),A=e.readSync(_.dataId);let P;switch(A[0]){case 1:{P=dP(A[1]);break}case 2:{P=fP(A[1],A[2]);break}case 3:P=hP(A[1],A[2],A[3]);break;default:P=""}if(e.disposeData(_.dataId),P)throw e.disposeData(p.dataId),e.disposeData(y.dataId),e.disposeData(x.dataId),e.disposeData(w.dataId),new Error(P);let O=p,R=y;return k!==c[0]&&(O=Vc({inputs:{x:p},attrs:{begin:0,size:[k,l]},backend:e}),R=Vc({inputs:{x:y},attrs:{begin:0,size:k},backend:e}),e.disposeData(p.dataId),e.disposeData(y.dataId)),[O,R,x,w]}const lFe={kernelName:zS,backendName:"wasm",setupFunc:oFe,kernelFunc:iFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let qq;function uFe(t){qq=t.wasm.cwrap(Ax,null,["number","number","number","number","number","number","number"])}function cFe(t){const{backend:e,inputs:n}=t,{inputIndices:r,inputShape:a,newShape:s}=n;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const o=e.dataIdMap.get(r.dataId).id,i=e.dataIdMap.get(a.dataId).id,l=e.dataIdMap.get(s.dataId).id,u=r.shape[0],c=ne(s.shape),d=e.makeOutput([u,c],r.dtype),f=e.dataIdMap.get(d.dataId).id,h=e.makeOutput([c],s.dtype),p=e.dataIdMap.get(h.dataId).id,g=e.makeOutput([3],"int32"),y=e.dataIdMap.get(g.dataId).id;qq(o,i,l,u,f,p,y);const v=e.readSync(g.dataId);let x;switch(v[0]){case 0:{x=pP(v[1],v[2]);break}case 1:{x=mP(v[1],v[2]);break}case 2:x=gP();break;case 3:{const b=Array.from(e.readSync(a.dataId)),w=Array.from(e.readSync(h.dataId));x=yP(b,w);break}case 4:{const b=Array.from(e.readSync(a.dataId)),w=Array.from(e.readSync(h.dataId));x=vP(b,w);break}default:x=""}if(e.disposeData(g.dataId),x)throw e.disposeData(d.dataId),e.disposeData(h.dataId),new Error(x);return[d,h]}const dFe={kernelName:Ax,backendName:"wasm",setupFunc:uFe,kernelFunc:cFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Kq;function Xq(t){Kq=t.wasm.cwrap("SparseSegmentReduction",null,["number","number","number","number","number","number","number","number","number"])}function Yq(t,e){const{backend:n,inputs:r}=t,{data:a,indices:s,segmentIds:o}=r,i=s.shape[0],l=n.readSync(o.dataId,i-1,i)[0],c=i>0?l+1:0;if(c<0)throw new Error(ly());const d=a.shape.slice();d[0]=c;const f=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(s.dataId).id,p=n.dataIdMap.get(o.dataId).id,g=n.makeOutput(d,a.dtype),y=n.dataIdMap.get(g.dataId).id,v=n.makeOutput([4],"int32"),x=n.dataIdMap.get(v.dataId).id;Kq(f,Lt[a.dtype],a.shape[0],h,p,y,x,e,0);const b=n.readSync(v.dataId);let w;switch(b[0]){case 0:{w=ly();break}case 1:{w=xP();break}case 2:w=bP(b[1],b[2]);break;case 3:w=wP(b[1],b[2],b[3]);break;default:w=""}if(n.disposeData(v.dataId),w)throw n.disposeData(g.dataId),new Error(w);return g}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fFe(t){return Yq(t,!0)}const hFe={kernelName:Px,backendName:"wasm",setupFunc:Xq,kernelFunc:fFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pFe(t){return Yq(t,!1)}const mFe={kernelName:Ox,backendName:"wasm",setupFunc:Xq,kernelFunc:pFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Qq;function gFe(t){Qq=t.wasm.cwrap(Cp,null,["number","number","number","number","number","number","number","number","array","number","number"])}function yFe(t){const{backend:e,inputs:n,attrs:r}=t,{sparseIndices:a,sparseValues:s,defaultValue:o}=n,{outputShape:i}=r,l=e.makeOutput(i,o.dtype);if(ne(i)===0)return l;const{sliceRank:u,numUpdates:c,sliceSize:d,strides:f,outputSize:h}=jo(s,a,i),p=e.dataIdMap.get(a.dataId).id,g=e.dataIdMap.get(s.dataId).id,y=e.dataIdMap.get(o.dataId).id,v=new Uint8Array(new Int32Array(f).buffer),x=e.dataIdMap.get(l.dataId).id;return Qq(p,g,s.shape.length,y,Lt[o.dtype],u,c,d,v,h,x),l}const vFe={kernelName:Cp,backendName:"wasm",setupFunc:gFe,kernelFunc:yFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe(t){const{inputs:e,attrs:n,backend:r}=t,{x:a}=e,{numOrSizeSplits:s,axis:o}=n,i=Yt(o,a.shape)[0],l=w2(a,s,i),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return l.map(d=>{const f=[...c];f[i]=d;const h=Vc({inputs:{x:a},attrs:{begin:u,size:f},backend:r});return u[i]+=d,h})}const bFe={kernelName:Ex,backendName:"wasm",kernelFunc:xFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wFe=jt(Ix);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SFe=jt(US);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CFe=lr(Rx);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Jq;function _Fe(t){Jq=t.wasm.cwrap(Np,null,["number","number","number","number"])}function $Fe(t){const{backend:e,inputs:n,attrs:r}=t,{alpha:a}=r,{x:s}=n,o=e.dataIdMap.get(s.dataId).id,i=e.makeOutput(s.shape,s.dtype),l=e.dataIdMap.get(i.dataId).id;return Jq(o,a,Lt[s.dtype],l),i}const kFe={kernelName:Np,backendName:"wasm",setupFunc:_Fe,kernelFunc:$Fe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Zq;function NFe(t){Zq=t.wasm.cwrap(_p,null,["number","array","number","array","array","array","array","array","number","number"])}function IFe(t){const{backend:e,inputs:n,attrs:r}=t,{x:a}=n,{begin:s,end:o,strides:i,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:g,sliceDim0:y,isSimpleSlice:v,begin:x,end:b,strides:w}=m2(a.shape,s,o,i,l,u,c,d,f);let C;if(g)C=Ta({inputs:{x:a},backend:e,attrs:{shape:p}});else if(y||v){j(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const _=d2(x,b,w),$=Vc({inputs:{x:a},backend:e,attrs:{begin:x,size:_}});C=Ta({inputs:{x:$},backend:e,attrs:{shape:p}}),e.disposeData($.dataId)}else{const _=e.makeOutput(h,"float32"),$=e.dataIdMap.get(a.dataId).id,k=new Uint8Array(new Int32Array(Dt(a.shape)).buffer),A=new Uint8Array(new Int32Array(x).buffer),P=new Uint8Array(new Int32Array(b).buffer),O=new Uint8Array(new Int32Array(w).buffer),R=new Uint8Array(new Int32Array(h).buffer),B=new Uint8Array(new Int32Array(Dt(h)).buffer),F=e.dataIdMap.get(_.dataId).id;Zq($,k,a.shape.length,A,P,O,R,B,h.length,F),C=Ta({inputs:{x:_},backend:e,attrs:{shape:p}}),e.disposeData(_.dataId)}return C}const TFe={kernelName:_p,backendName:"wasm",setupFunc:NFe,kernelFunc:IFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EFe(t){const{backend:e,inputs:n,attrs:r}=t,{data:a,dataSplits:s}=n,{separator:o,nGramWidths:i,leftPad:l,rightPad:u,padWidth:c,preserveShortSequences:d}=r,f=e.readSync(a.dataId),h=e.readSync(s.dataId),[p,g]=cG(f,h,o,i,l,u,c,d),y=e.makeOutput([p.length],"string"),v=e.dataIdMap.get(y.dataId);v.stringBytes=p;const x=e.makeOutput(s.shape,"int32");return e.typedArrayFromHeap(x).set(g),[y,x]}const AFe={kernelName:Dx,backendName:"wasm",kernelFunc:EFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PFe(t){const{backend:e,inputs:n,attrs:r}=t,{input:a,delimiter:s}=n,{skipEmpty:o}=r,i=e.readSync(a.dataId),l=e.readSync(s.dataId),[u,c,d]=dG(i,l[0],o),f=c.length,h=e.makeOutput([f,2],"int32");e.typedArrayFromHeap(h).set(u);const g=e.makeOutput([f],"string"),y=e.dataIdMap.get(g.dataId);y.stringBytes=c;const v=e.makeOutput([2],"int32");return e.typedArrayFromHeap(v).set(d),[h,g,v]}const OFe={kernelName:VS,backendName:"wasm",kernelFunc:PFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RFe(t){const{backend:e,inputs:n,attrs:r}=t,{input:a}=n,{numBuckets:s}=r,o=e.readSync(a.dataId),i=fG(o,s),l=e.makeOutput(a.shape,"int32");return e.typedArrayFromHeap(l).set(i),l}const DFe={kernelName:WS,backendName:"wasm",kernelFunc:RFe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jFe=lr(jx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let eK;function MFe(t){eK=t.wasm.cwrap(wp,null,["number","number","number","number"])}function FFe(t){const{backend:e,inputs:n,attrs:r}=t,{axis:a,keepDims:s}=r,{x:o}=n,i=e.dataIdMap.get(o.dataId).id;let l=i,u=o;const{transposed:c,axes:d,originalAxes:f,inputWasTransposed:h}=mu(o,a,e);let p=d;if(h){const b=e.dataIdMap.get(c.dataId).id;b!==i&&(u=c,l=b,p=Qn(p.length,u.shape.length))}Yn("sum",p,u.shape.length);const[g,y]=mr(u.shape,p),v=ne(y),x=e.makeOutput(g,u.dtype);if(ne(u.shape)!==0){const b=e.dataIdMap.get(x.dataId).id;eK(l,v,Lt[x.dtype],b)}if(h&&e.disposeData(c.dataId),s){const b=ir(x.shape,f);x.shape=b}return x}const LFe={kernelName:wp,backendName:"wasm",setupFunc:MFe,kernelFunc:FFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BFe=jt(Mx);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zFe=jt(Fx);/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let tK;function UFe(t){tK=t.wasm.cwrap(xp,null,["number","number","number","number","number","number","array","number","number","number"])}function VFe(t){const{backend:e,inputs:n,attrs:r}=t,{tensor:a,indices:s,updates:o}=n,i=e.makeOutput(a.shape,a.dtype);if(ne(a.shape)===0)return i;const{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=jo(o,s,a.shape),p=e.dataIdMap.get(s.dataId).id,y=e.dataIdMap.get(o.dataId).id,x=e.dataIdMap.get(a.dataId).id,b=new Uint8Array(new Int32Array(d).buffer),w=e.dataIdMap.get(i.dataId).id;return tK(p,y,Lt[o.dtype],l,u,c,b,f,w,x),i}const WFe={kernelName:xp,backendName:"wasm",setupFunc:UFe,kernelFunc:VFe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let nK;function GFe(t){nK=t.wasm.cwrap(Zc,null,["number","array","number","array","number","number"])}function HFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,s=n.dataIdMap.get(a.dataId).id,{reps:o}=r,i=new Array(a.shape.length);for(let f=0;f<i.length;f++)i[f]=a.shape[f]*o[f];const l=new Uint8Array(new Int32Array(a.shape).buffer),u=new Uint8Array(new Int32Array(i).buffer),c=n.makeOutput(i,a.dtype),d=n.dataIdMap.get(c.dataId).id;return nK(s,l,a.shape.length,u,i.length,Lt[c.dtype],d),c}const qFe={kernelName:Zc,backendName:"wasm",setupFunc:GFe,kernelFunc:HFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let rK;function KFe(t){rK=t.wasm.cwrap($p,null,["number","array","number","number","number","bool","number","number"])}const XFe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{k:a,sorted:s}=n,o=e.dataIdMap.get(r.dataId).id,i=new Uint8Array(new Int32Array(r.shape).buffer),l=r.shape.slice();l[l.length-1]=a;const u=e.makeOutput(l,r.dtype),c=e.dataIdMap.get(u.dataId).id,d=e.makeOutput(l,"int32"),f=e.dataIdMap.get(d.dataId).id;return rK(o,i,r.shape.length,Lt[r.dtype],a,s,c,f),[u,d]},YFe={kernelName:$p,backendName:"wasm",setupFunc:KFe,kernelFunc:XFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let aK;function QFe(t){aK=t.wasm.cwrap(kp,null,["number","number","bool","number","number","number","number","number","number","array","number","array","number","number","number","number","number"])}function JFe(t){const{backend:e,inputs:n,attrs:r}=t,{image:a,transforms:s}=n,{interpolation:o,fillMode:i,fillValue:l,outputShape:u}=r,[c,d,f,h]=a.shape,[p,g]=u??[d,f],y=[c,p,g,h],v=new Uint8Array(new Int32Array(Dt(a.shape)).buffer),x=new Uint8Array(new Int32Array(Dt(y)).buffer),b=e.makeOutput(y,a.dtype),w=e.dataIdMap.get(b.dataId).id,_=e.dataIdMap.get(a.dataId).id,k=e.dataIdMap.get(s.dataId).id,A=o==="nearest"?1:2;let P;switch(i){case"constant":P=1;break;case"reflect":P=2;break;case"wrap":P=3;break;case"nearest":P=4;break;default:P=1;break}return aK(_,k,s.shape[0]>1,c,p,g,h,f,d,v,a.shape.length-1,x,y.length-1,A,P,l,w),b}const ZFe={kernelName:kp,backendName:"wasm",setupFunc:QFe,kernelFunc:JFe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eLe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:s}=e,{outputValues:o,outputShape:i,indices:l}=pG(r.readSync(s.dataId),a,s.shape,s.dtype);return[r.makeOutput(i,s.dtype,void 0,o),r.makeOutput([l.length],"int32",void 0,l)]}const tLe={kernelName:GS,backendName:"wasm",kernelFunc:eLe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nLe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:s}=r;s<0&&(s+=a.shape.length);const o=a.shape[s],i=a.shape.length,l=new Array(i-1);let u=0;for(let h=0;h<i;h++)h!==s&&(l[u++]=a.shape[h]);const c=new Array(o),d=new Array(i).fill(0),f=a.shape.slice();f[s]=1;for(let h=0;h<c.length;h++)d[s]=h,c[h]=Vc({inputs:{x:a},attrs:{begin:d,size:f},backend:n});return c.map(({dataId:h,dtype:p})=>({dataId:h,dtype:p,shape:l}))}const rLe={kernelName:Lx,backendName:"wasm",kernelFunc:nLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aLe(t){const{inputs:{x:e},backend:n}=t,r=n.makeOutput(e.shape,e.dtype);return n.typedArrayFromHeap(r).fill(0),r}const sLe={kernelName:Bx,backendName:"wasm",kernelFunc:aLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oLe=[QOe,JOe,ZOe,eRe,tRe,aRe,fRe,mRe,gRe,yRe,vRe,xRe,bRe,wRe,SRe,$Re,RRe,IRe,ARe,FRe,WRe,qRe,KRe,YRe,QRe,JRe,tDe,nDe,sDe,lDe,dDe,pDe,yDe,vDe,xDe,SDe,$De,IDe,ADe,RDe,MDe,BDe,VDe,HDe,XDe,YDe,ZDe,t3e,n3e,r3e,a3e,s3e,o3e,u3e,c3e,d3e,p3e,y3e,b3e,C3e,k3e,I3e,E3e,sRe,A3e,P3e,O3e,j3e,F3e,B3e,V3e,G3e,W3e,q3e,K3e,Y3e,J3e,tje,aje,ije,lje,dje,pje,yje,bje,Cje,kje,Tje,Eje,Oje,Fje,Lje,Bje,zje,Wje,qje,Yje,Jje,tMe,rMe,sMe,Oq,lMe,dMe,pMe,gMe,yMe,vMe,xMe,bMe,DRe,CMe,kMe,TMe,PMe,DMe,FMe,LMe,BMe,VMe,HMe,XMe,YMe,ZMe,eFe,tFe,nFe,URe,Dje,rFe,sFe,lFe,dFe,hFe,mFe,vFe,bFe,wFe,SFe,CFe,kFe,TFe,AFe,OFe,DFe,jFe,LFe,BFe,zFe,WFe,qFe,YFe,ZFe,uRe,tLe,rLe,sLe];for(const t of oLe)zx(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PN=ee();PN.registerFlag("WASM_HAS_SIMD_SUPPORT",async()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]))}catch{return!1}});PN.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",async()=>{if(PN.get("IS_NODE"))return!1;try{return new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}});var sK={exports:{}};(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};function s(){return V.buffer!=we&&ye(V.buffer),de}function o(){return V.buffer!=we&&ye(V.buffer),J}function i(){return V.buffer!=we&&ye(V.buffer),ae}function l(){return V.buffer!=we&&ye(V.buffer),U}function u(){return V.buffer!=we&&ye(V.buffer),oe}var c=typeof a<"u"?a:{},d,f;c.ready=new Promise(function(G,ie){d=G,f=ie});var h;typeof process<"u"&&process.listeners&&(h={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var p=Object.assign({},c),g=(G,ie)=>{throw ie},y=typeof window=="object",v=typeof importScripts=="function",x=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",b=c.ENVIRONMENT_IS_PTHREAD||!1,w="";function C(G){return c.locateFile?c.locateFile(G,w):w+G}var _,$,k;function A(G){if(G instanceof va)return;L("exiting due to exception: "+G)}if(x){var P=Cl,O=Cl;v?w=O.dirname(w)+"/":w=__dirname+"/",_=(ie,Ie)=>(ie=Vt(ie)?new URL(ie):O.normalize(ie),P.readFileSync(ie,Ie?void 0:"utf8")),k=ie=>{var Ie=_(ie,!0);return Ie.buffer||(Ie=new Uint8Array(Ie)),Ie},$=(ie,Ie,tt)=>{ie=Vt(ie)?new URL(ie):O.normalize(ie),P.readFile(ie,function(ot,dt){ot?tt(ot):Ie(dt.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(ie){if(!(ie instanceof va))throw ie}),process.on("unhandledRejection",function(ie){throw ie}),g=(ie,Ie)=>{if(Ze())throw process.exitCode=ie,Ie;A(Ie),process.exit(ie)},c.inspect=function(){return"[Emscripten Module object]"};let G;try{G=Cl}catch(ie){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),ie}gn.Worker=G.Worker}else(y||v)&&(v?w=self.location.href:typeof document<"u"&&document.currentScript&&(w=document.currentScript.src),typeof r<"u"&&r&&(w=r),w.indexOf("blob:")!==0?w=w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):w="",x||(_=G=>{var ie=new XMLHttpRequest;return ie.open("GET",G,!1),ie.send(null),ie.responseText},v&&(k=G=>{var ie=new XMLHttpRequest;return ie.open("GET",G,!1),ie.responseType="arraybuffer",ie.send(null),new Uint8Array(ie.response)}),$=(G,ie,Ie)=>{var tt=new XMLHttpRequest;tt.open("GET",G,!0),tt.responseType="arraybuffer",tt.onload=()=>{if(tt.status==200||tt.status==0&&tt.response){ie(tt.response);return}Ie()},tt.onerror=Ie,tt.send(null)}));x&&typeof performance>"u"&&(gn.performance=Cl.performance);var R=console.log.bind(console),B=console.warn.bind(console);x&&(R=G=>P.writeSync(1,G+`
`),B=G=>P.writeSync(2,G+`
`));var F=c.print||R,L=c.printErr||B;Object.assign(c,p),p=null,c.arguments&&c.arguments,c.thisProgram&&c.thisProgram,c.quit&&(g=c.quit);var H;c.wasmBinary&&(H=c.wasmBinary);var te=c.noExitRuntime||!0;typeof WebAssembly!="object"&&Jn("no native wasm support detected");var V,Q,se=!1,le;function ue(G,ie){G||Jn(ie)}var ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function re(G,ie,Ie){ie>>>=0;for(var tt=ie+Ie,ot=ie;G[ot]&&!(ot>=tt);)++ot;if(ot-ie>16&&G.buffer&&ce)return ce.decode(G.buffer instanceof SharedArrayBuffer?G.slice(ie,ot):G.subarray(ie,ot));for(var dt="";ie<ot;){var ze=G[ie++];if(!(ze&128)){dt+=String.fromCharCode(ze);continue}var qe=G[ie++]&63;if((ze&224)==192){dt+=String.fromCharCode((ze&31)<<6|qe);continue}var Et=G[ie++]&63;if((ze&240)==224?ze=(ze&15)<<12|qe<<6|Et:ze=(ze&7)<<18|qe<<12|Et<<6|G[ie++]&63,ze<65536)dt+=String.fromCharCode(ze);else{var ba=ze-65536;dt+=String.fromCharCode(55296|ba>>10,56320|ba&1023)}}return dt}function ge(G,ie){return G>>>=0,G?re(o(),G,ie):""}function Se(G,ie,Ie,tt){if(Ie>>>=0,!(tt>0))return 0;for(var ot=Ie,dt=Ie+tt-1,ze=0;ze<G.length;++ze){var qe=G.charCodeAt(ze);if(qe>=55296&&qe<=57343){var Et=G.charCodeAt(++ze);qe=65536+((qe&1023)<<10)|Et&1023}if(qe<=127){if(Ie>=dt)break;ie[Ie++>>>0]=qe}else if(qe<=2047){if(Ie+1>=dt)break;ie[Ie++>>>0]=192|qe>>6,ie[Ie++>>>0]=128|qe&63}else if(qe<=65535){if(Ie+2>=dt)break;ie[Ie++>>>0]=224|qe>>12,ie[Ie++>>>0]=128|qe>>6&63,ie[Ie++>>>0]=128|qe&63}else{if(Ie+3>=dt)break;ie[Ie++>>>0]=240|qe>>18,ie[Ie++>>>0]=128|qe>>12&63,ie[Ie++>>>0]=128|qe>>6&63,ie[Ie++>>>0]=128|qe&63}}return ie[Ie>>>0]=0,Ie-ot}function Ne(G,ie,Ie){return Se(G,o(),ie,Ie)}var we,de,J,ae,U,oe;b&&(we=c.buffer);function ye(G){we=G,c.HEAP8=de=new Int8Array(G),c.HEAP16=new Int16Array(G),c.HEAP32=ae=new Int32Array(G),c.HEAPU8=J=new Uint8Array(G),c.HEAPU16=new Uint16Array(G),c.HEAPU32=U=new Uint32Array(G),c.HEAPF32=new Float32Array(G),c.HEAPF64=oe=new Float64Array(G)}var be=c.INITIAL_MEMORY||16777216;if(b)V=c.wasmMemory,we=c.buffer;else if(c.wasmMemory)V=c.wasmMemory;else if(V=new WebAssembly.Memory({initial:be/65536,maximum:65536,shared:!0}),!(V.buffer instanceof SharedArrayBuffer))throw L("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),x&&L("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");V&&(we=V.buffer),be=we.byteLength,ye(we);var he,De=[],Ve=[],Ye=[];function Ze(){return te}function It(){if(c.preRun)for(typeof c.preRun=="function"&&(c.preRun=[c.preRun]);c.preRun.length;)ar(c.preRun.shift());on(De)}function rn(){b||on(Ve)}function an(){if(!b){if(c.postRun)for(typeof c.postRun=="function"&&(c.postRun=[c.postRun]);c.postRun.length;)Zr(c.postRun.shift());on(Ye)}}function ar(G){De.unshift(G)}function Nr(G){Ve.unshift(G)}function Zr(G){Ye.unshift(G)}var Te=0,st=null;function pt(G){Te++,c.monitorRunDependencies&&c.monitorRunDependencies(Te)}function $n(G){if(Te--,c.monitorRunDependencies&&c.monitorRunDependencies(Te),Te==0&&st){var ie=st;st=null,ie()}}function Jn(G){c.onAbort&&c.onAbort(G),G="Aborted("+G+")",L(G),se=!0,le=1,G+=". Build with -sASSERTIONS for more info.";var ie=new WebAssembly.RuntimeError(G);throw f(ie),ie}var ya="data:application/octet-stream;base64,";function wt(G){return G.startsWith(ya)}function Vt(G){return G.startsWith("file://")}var sn;sn="tfjs-backend-wasm-threaded-simd.wasm",wt(sn)||(sn=C(sn));function Is(G){try{if(G==sn&&H)return new Uint8Array(H);if(k)return k(G);throw"both async and sync fetching of the wasm failed"}catch(ie){Jn(ie)}}function _u(){if(!H&&(y||v)){if(typeof fetch=="function"&&!Vt(sn))return fetch(sn,{credentials:"same-origin"}).then(function(G){if(!G.ok)throw"failed to load wasm binary file at '"+sn+"'";return G.arrayBuffer()}).catch(function(){return Is(sn)});if($)return new Promise(function(G,ie){$(sn,function(Ie){G(new Uint8Array(Ie))},ie)})}return Promise.resolve().then(function(){return Is(sn)})}function il(){var G={env:hm,wasi_snapshot_preview1:hm};function ie(ze,qe){var Et=ze.exports;if(c.asm=Et,Qt(c.asm._emscripten_tls_init),he=c.asm.__indirect_function_table,Nr(c.asm.__wasm_call_ctors),Q=qe,!b){var ba=Oe.unusedWorkers.length;Oe.unusedWorkers.forEach(function(uo){Oe.loadWasmModuleToWorker(uo,function(){--ba||$n()})})}}b||pt();function Ie(ze){ie(ze.instance,ze.module)}function tt(ze){return _u().then(function(qe){return WebAssembly.instantiate(qe,G)}).then(function(qe){return qe}).then(ze,function(qe){L("failed to asynchronously prepare wasm: "+qe),Jn(qe)})}function ot(){return!H&&typeof WebAssembly.instantiateStreaming=="function"&&!wt(sn)&&!Vt(sn)&&!x&&typeof fetch=="function"?fetch(sn,{credentials:"same-origin"}).then(function(ze){var qe=WebAssembly.instantiateStreaming(ze,G);return qe.then(Ie,function(Et){return L("wasm streaming compile failed: "+Et),L("falling back to ArrayBuffer instantiation"),tt(Ie)})}):tt(Ie)}if(c.instantiateWasm)try{var dt=c.instantiateWasm(G,ie);return dt}catch(ze){L("Module.instantiateWasm callback failed with error: "+ze),f(ze)}return ot().catch(f),{}}var Ts={};function va(G){this.name="ExitStatus",this.message="Program terminated with exit("+G+")",this.status=G}function yi(G){var ie=Oe.pthreads[G];delete Oe.pthreads[G],ie.terminate(),_d(G),Oe.runningWorkers.splice(Oe.runningWorkers.indexOf(ie),1),ie.pthread_ptr=0}function $u(G){var ie=Oe.pthreads[G];ie.postMessage({cmd:"cancel"})}function io(G){var ie=Oe.pthreads[G];ue(ie),Oe.returnWorkerToPool(ie)}function Lo(G){var ie=Oe.getNewWorker();if(!ie)return 6;Oe.runningWorkers.push(ie),Oe.pthreads[G.pthread_ptr]=ie,ie.pthread_ptr=G.pthread_ptr;var Ie={cmd:"run",start_routine:G.startRoutine,arg:G.arg,pthread_ptr:G.pthread_ptr};return ie.runPthread=()=>{x&&ie.ref(),ie.postMessage(Ie,G.transferList),delete ie.runPthread},ie.loaded&&ie.runPthread(),0}function Es(G){if(b)return lo(1,1,G);le=G,Ze()||(Oe.terminateAllThreads(),c.onExit&&c.onExit(G),se=!0),g(G,new va(G))}function me(G,ie){if(le=G,!ie&&b)throw mt(G),"unwind";Es(G)}var $e=me;function Qe(G){if(G instanceof va||G=="unwind")return le;g(1,G)}var Oe={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){b?Oe.initWorker():Oe.initMainThread()},initMainThread:function(){for(var G=8;G--;)Oe.allocateUnusedWorker()},initWorker:function(){te=!1},setExitStatus:function(G){le=G},terminateAllThreads:function(){for(var G of Object.values(Oe.pthreads))Oe.returnWorkerToPool(G);for(var G of Oe.unusedWorkers)G.terminate();Oe.unusedWorkers=[]},returnWorkerToPool:function(G){var ie=G.pthread_ptr;delete Oe.pthreads[ie],Oe.unusedWorkers.push(G),Oe.runningWorkers.splice(Oe.runningWorkers.indexOf(G),1),G.pthread_ptr=0,x&&G.unref(),_d(ie)},receiveObjectTransfer:function(G){},threadInitTLS:function(){Oe.tlsInitFunctions.forEach(G=>G())},loadWasmModuleToWorker:function(G,ie){G.onmessage=dt=>{var ze=dt.data,qe=ze.cmd;if(G.pthread_ptr&&(Oe.currentProxiedOperationCallerThread=G.pthread_ptr),ze.targetThread&&ze.targetThread!=Iu()){var Et=Oe.pthreads[ze.targetThread];Et?Et.postMessage(ze,ze.transferList):L('Internal error! Worker sent a message "'+qe+'" to target pthread '+ze.targetThread+", but that thread no longer exists!"),Oe.currentProxiedOperationCallerThread=void 0;return}qe==="processProxyingQueue"?xd(ze.queue):qe==="spawnThread"?Lo(ze):qe==="cleanupThread"?io(ze.thread):qe==="killThread"?yi(ze.thread):qe==="cancelThread"?$u(ze.thread):qe==="loaded"?(G.loaded=!0,x&&G.unref(),ie&&ie(G),G.runPthread&&G.runPthread()):qe==="print"?F("Thread "+ze.threadId+": "+ze.text):qe==="printErr"?L("Thread "+ze.threadId+": "+ze.text):qe==="alert"?alert("Thread "+ze.threadId+": "+ze.text):ze.target==="setimmediate"?G.postMessage(ze):qe==="callHandler"?c[ze.handler](...ze.args):qe&&L("worker sent an unknown command "+qe),Oe.currentProxiedOperationCallerThread=void 0},G.onerror=dt=>{var ze="worker sent an error!";throw L(ze+" "+dt.filename+":"+dt.lineno+": "+dt.message),dt},x&&(G.on("message",function(dt){G.onmessage({data:dt})}),G.on("error",function(dt){G.onerror(dt)}),G.on("detachedExit",function(){}));var Ie=[],tt=["onExit","onAbort","print","printErr"];for(var ot of tt)c.hasOwnProperty(ot)&&Ie.push(ot);G.postMessage({cmd:"load",handlers:Ie,urlOrBlob:c.mainScriptUrlOrBlob||r,wasmMemory:V,wasmModule:Q})},allocateUnusedWorker:function(){var G,ie=C("tfjs-backend-wasm-threaded-simd.worker.js");G=new Worker(ie),Oe.unusedWorkers.push(G)},getNewWorker:function(){return Oe.unusedWorkers.length==0&&(Oe.allocateUnusedWorker(),Oe.loadWasmModuleToWorker(Oe.unusedWorkers[0])),Oe.unusedWorkers.pop()}};c.PThread=Oe;function on(G){for(;G.length>0;)G.shift()(c)}function Wt(){var G=Iu(),ie=i()[G+52>>>2],Ie=i()[G+56>>>2],tt=ie-Ie;mm(ie,tt),Bo(ie)}c.establishStackSpace=Wt;function mt(G){if(b)return lo(2,0,G);try{$e(G)}catch(ie){Qe(ie)}}var et=[];function ln(G){var ie=et[G];return ie||(G>=et.length&&(et.length=G+1),et[G]=ie=he.get(G)),ie}function ea(G,ie){var Ie=ln(G)(ie);Ze()?Oe.setExitStatus(Ie):Tu(Ie)}c.invokeEntryPoint=ea;function Qt(G){Oe.tlsInitFunctions.push(G)}function xa(G){kb(G,!v,1,!y),Oe.threadInitTLS()}function vi(G){b?postMessage({cmd:"cleanupThread",thread:G}):io(G)}function vd(G,ie,Ie,tt){return b?lo(3,1,G,ie,Ie,tt):Zn(G,ie,Ie,tt)}function Zn(G,ie,Ie,tt){if(typeof SharedArrayBuffer>"u")return L("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var ot=[],dt=0;if(b&&(ot.length===0||dt))return vd(G,ie,Ie,tt);var ze={startRoutine:Ie,pthread_ptr:G,arg:tt,transferList:ot};return b?(ze.cmd="spawnThread",postMessage(ze,ot),0):Lo(ze)}function As(){return 65536}var xi=!0;function ku(){return xi}function xd(G){Atomics.store(i(),G>>2,1),Iu()&&pm(G),Atomics.compareExchange(i(),G>>2,1,0)}c.executeNotifiedProxyingQueue=xd;function om(G,ie,Ie,tt){if(G==ie)setTimeout(()=>xd(tt));else if(b)postMessage({targetThread:G,cmd:"processProxyingQueue",queue:tt});else{var ot=Oe.pthreads[G];if(!ot)return;ot.postMessage({cmd:"processProxyingQueue",queue:tt})}return 1}function im(G,ie,Ie){return-1}function yb(){Jn("")}function zr(G){zr.shown||(zr.shown={}),zr.shown[G]||(zr.shown[G]=1,x&&(G="warning: "+G),L(G))}function Ps(){x||v||zr("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")}function Nu(){return Date.now()}function bd(){return 4294901760}function lm(){return bd()}var wd;x?wd=()=>{var G=process.hrtime();return G[0]*1e3+G[1]/1e6}:wd=()=>performance.timeOrigin+performance.now();function um(G,ie,Ie){o().copyWithin(G>>>0,ie>>>0,ie+Ie>>>0)}function Os(){return x?Cl.cpus().length:navigator.hardwareConcurrency}function vb(G){var ie=$d(),Ie=G();return Bo(ie),Ie}function lo(G,ie){var Ie=arguments.length-2,tt=arguments;return vb(()=>{for(var ot=Ie,dt=kd(ot*8),ze=dt>>3,qe=0;qe<Ie;qe++){var Et=tt[2+qe];u()[ze+qe>>>0]=Et}return Nb(G,ot,dt,ie)})}var ja=[];function Sd(G,ie,Ie){ja.length=ie;for(var tt=Ie>>3,ot=0;ot<ie;ot++)ja[ot]=u()[tt+ot>>>0];var dt=G<0,ze=dt?Ts[-G-1]:Cd[G];return ze.apply(null,ja)}function zC(G){try{return V.grow(G-we.byteLength+65535>>>16),ye(V.buffer),1}catch{}}function xb(G){var ie=o().length;if(G=G>>>0,G<=ie)return!1;var Ie=bd();if(G>Ie)return!1;let tt=(Et,ba)=>Et+(ba-Et%ba)%ba;for(var ot=1;ot<=4;ot*=2){var dt=ie*(1+.2/ot);dt=Math.min(dt,G+100663296);var ze=Math.min(Ie,tt(Math.max(G,dt),65536)),qe=zC(ze);if(qe)return!0}return!1}function cm(){throw"unwind"}function bb(G){return b?lo(4,1,G):52}function wb(G,ie,Ie,tt,ot){return b?lo(5,1,G,ie,Ie,tt,ot):70}var Sb=[null,[],[]];function Cb(G,ie){var Ie=Sb[G];ie===0||ie===10?((G===1?F:L)(re(Ie,0)),Ie.length=0):Ie.push(ie)}function dm(G,ie,Ie,tt){if(b)return lo(6,1,G,ie,Ie,tt);for(var ot=0,dt=0;dt<Ie;dt++){var ze=l()[ie>>>2],qe=l()[ie+4>>>2];ie+=8;for(var Et=0;Et<qe;Et++)Cb(G,o()[ze+Et>>>0]);ot+=qe}return l()[tt>>>2]=ot,0}function fm(G){var ie=c["_"+G];return ie}function ta(G,ie){s().set(G,ie>>>0)}function _b(G,ie,Ie,tt,ot){var dt={string:Ir=>{var ss=0;if(Ir!=null&&Ir!==0){var vm=(Ir.length<<2)+1;ss=kd(vm),Ne(Ir,ss,vm)}return ss},array:Ir=>{var ss=kd(Ir.length);return ta(Ir,ss),ss}};function ze(Ir){return ie==="string"?ge(Ir):ie==="boolean"?!!Ir:Ir}var qe=fm(G),Et=[],ba=0;if(tt)for(var uo=0;uo<tt.length;uo++){var gm=dt[Ie[uo]];gm?(ba===0&&(ba=$d()),Et[uo]=gm(tt[uo])):Et[uo]=tt[uo]}var Td=qe.apply(null,Et);function ym(Ir){return ba!==0&&Bo(ba),ze(Ir)}return Td=ym(Td),Td}function $b(G,ie,Ie,tt){Ie=Ie||[];var ot=Ie.every(ze=>ze==="number"||ze==="boolean"),dt=ie!=="string";return dt&&ot&&!tt?fm(G):function(){return _b(G,ie,Ie,arguments)}}Oe.init();var Cd=[null,Es,mt,vd,bb,wb,dm],hm={__emscripten_init_main_thread_js:xa,__emscripten_thread_cleanup:vi,__pthread_create_js:Zn,_emscripten_default_pthread_stack_size:As,_emscripten_get_now_is_monotonic:ku,_emscripten_notify_task_queue:om,_emscripten_set_offscreencanvas_size:im,abort:yb,emscripten_check_blocking_allowed:Ps,emscripten_date_now:Nu,emscripten_get_heap_max:lm,emscripten_get_now:wd,emscripten_memcpy_big:um,emscripten_num_logical_cores:Os,emscripten_receive_on_main_thread_js:Sd,emscripten_resize_heap:xb,emscripten_unwind_to_js_event_loop:cm,exit:$e,fd_close:bb,fd_seek:wb,fd_write:dm,memory:V||c.wasmMemory};il(),c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.__wasm_call_ctors).apply(null,arguments)},c._init=function(){return(c._init=c.asm.init).apply(null,arguments)},c._init_with_threads_count=function(){return(c._init_with_threads_count=c.asm.init_with_threads_count).apply(null,arguments)},c._get_threads_count=function(){return(c._get_threads_count=c.asm.get_threads_count).apply(null,arguments)},c._register_tensor=function(){return(c._register_tensor=c.asm.register_tensor).apply(null,arguments)},c._dispose_data=function(){return(c._dispose_data=c.asm.dispose_data).apply(null,arguments)},c._dispose=function(){return(c._dispose=c.asm.dispose).apply(null,arguments)},c._Abs=function(){return(c._Abs=c.asm.Abs).apply(null,arguments)},c._Acos=function(){return(c._Acos=c.asm.Acos).apply(null,arguments)},c._Acosh=function(){return(c._Acosh=c.asm.Acosh).apply(null,arguments)},c._Add=function(){return(c._Add=c.asm.Add).apply(null,arguments)},c._AddN=function(){return(c._AddN=c.asm.AddN).apply(null,arguments)},c._All=function(){return(c._All=c.asm.All).apply(null,arguments)},c._Any=function(){return(c._Any=c.asm.Any).apply(null,arguments)},c._ArgMax=function(){return(c._ArgMax=c.asm.ArgMax).apply(null,arguments)},c._ArgMin=function(){return(c._ArgMin=c.asm.ArgMin).apply(null,arguments)},c._Asin=function(){return(c._Asin=c.asm.Asin).apply(null,arguments)},c._Asinh=function(){return(c._Asinh=c.asm.Asinh).apply(null,arguments)},c._Atan=function(){return(c._Atan=c.asm.Atan).apply(null,arguments)},c._Atan2=function(){return(c._Atan2=c.asm.Atan2).apply(null,arguments)},c._Atanh=function(){return(c._Atanh=c.asm.Atanh).apply(null,arguments)},c._AvgPool=function(){return(c._AvgPool=c.asm.AvgPool).apply(null,arguments)},c._AvgPool3D=function(){return(c._AvgPool3D=c.asm.AvgPool3D).apply(null,arguments)},c._AvgPool3DGrad=function(){return(c._AvgPool3DGrad=c.asm.AvgPool3DGrad).apply(null,arguments)},c._AvgPoolGrad=function(){return(c._AvgPoolGrad=c.asm.AvgPoolGrad).apply(null,arguments)},c._BatchMatMul=function(){return(c._BatchMatMul=c.asm.BatchMatMul).apply(null,arguments)},c._Bincount=function(){return(c._Bincount=c.asm.Bincount).apply(null,arguments)},c._BitwiseAnd=function(){return(c._BitwiseAnd=c.asm.BitwiseAnd).apply(null,arguments)},c._Ceil=function(){return(c._Ceil=c.asm.Ceil).apply(null,arguments)},c._ClipByValue=function(){return(c._ClipByValue=c.asm.ClipByValue).apply(null,arguments)},c._Conv2D=function(){return(c._Conv2D=c.asm.Conv2D).apply(null,arguments)},c._Conv2DBackpropInput=function(){return(c._Conv2DBackpropInput=c.asm.Conv2DBackpropInput).apply(null,arguments)},c._Conv3D=function(){return(c._Conv3D=c.asm.Conv3D).apply(null,arguments)},c._Conv3DBackpropFilterV2=function(){return(c._Conv3DBackpropFilterV2=c.asm.Conv3DBackpropFilterV2).apply(null,arguments)},c._Conv3DBackpropInputV2=function(){return(c._Conv3DBackpropInputV2=c.asm.Conv3DBackpropInputV2).apply(null,arguments)},c._Cos=function(){return(c._Cos=c.asm.Cos).apply(null,arguments)},c._Cosh=function(){return(c._Cosh=c.asm.Cosh).apply(null,arguments)},c._CropAndResize=function(){return(c._CropAndResize=c.asm.CropAndResize).apply(null,arguments)},c._Cumprod=function(){return(c._Cumprod=c.asm.Cumprod).apply(null,arguments)},c._Cumsum=function(){return(c._Cumsum=c.asm.Cumsum).apply(null,arguments)},c._DenseBincount=function(){return(c._DenseBincount=c.asm.DenseBincount).apply(null,arguments)},c._DepthToSpace=function(){return(c._DepthToSpace=c.asm.DepthToSpace).apply(null,arguments)},c._DepthwiseConv2dNative=function(){return(c._DepthwiseConv2dNative=c.asm.DepthwiseConv2dNative).apply(null,arguments)},c._Diag=function(){return(c._Diag=c.asm.Diag).apply(null,arguments)},c._Dilation2D=function(){return(c._Dilation2D=c.asm.Dilation2D).apply(null,arguments)},c._Dilation2DBackpropFilter=function(){return(c._Dilation2DBackpropFilter=c.asm.Dilation2DBackpropFilter).apply(null,arguments)},c._Dilation2DBackpropInput=function(){return(c._Dilation2DBackpropInput=c.asm.Dilation2DBackpropInput).apply(null,arguments)},c._Elu=function(){return(c._Elu=c.asm.Elu).apply(null,arguments)},c._EluGrad=function(){return(c._EluGrad=c.asm.EluGrad).apply(null,arguments)},c._Equal=function(){return(c._Equal=c.asm.Equal).apply(null,arguments)},c._Erf=function(){return(c._Erf=c.asm.Erf).apply(null,arguments)},c._Exp=function(){return(c._Exp=c.asm.Exp).apply(null,arguments)},c._Expm1=function(){return(c._Expm1=c.asm.Expm1).apply(null,arguments)},c._FlipLeftRight=function(){return(c._FlipLeftRight=c.asm.FlipLeftRight).apply(null,arguments)},c._Floor=function(){return(c._Floor=c.asm.Floor).apply(null,arguments)},c._FloorDiv=function(){return(c._FloorDiv=c.asm.FloorDiv).apply(null,arguments)},c._FusedBatchNorm=function(){return(c._FusedBatchNorm=c.asm.FusedBatchNorm).apply(null,arguments)},c._FusedConv2D=function(){return(c._FusedConv2D=c.asm.FusedConv2D).apply(null,arguments)},c._FusedDepthwiseConv2D=function(){return(c._FusedDepthwiseConv2D=c.asm.FusedDepthwiseConv2D).apply(null,arguments)},c._Gather=function(){return(c._Gather=c.asm.Gather).apply(null,arguments)},c._GatherNd=function(){return(c._GatherNd=c.asm.GatherNd).apply(null,arguments)},c._Greater=function(){return(c._Greater=c.asm.Greater).apply(null,arguments)},c._GreaterEqual=function(){return(c._GreaterEqual=c.asm.GreaterEqual).apply(null,arguments)},c._IsFinite=function(){return(c._IsFinite=c.asm.IsFinite).apply(null,arguments)},c._IsInf=function(){return(c._IsInf=c.asm.IsInf).apply(null,arguments)},c._IsNan=function(){return(c._IsNan=c.asm.IsNan).apply(null,arguments)},c._LRN=function(){return(c._LRN=c.asm.LRN).apply(null,arguments)},c._LRNGrad=function(){return(c._LRNGrad=c.asm.LRNGrad).apply(null,arguments)},c._LeakyRelu=function(){return(c._LeakyRelu=c.asm.LeakyRelu).apply(null,arguments)},c._Less=function(){return(c._Less=c.asm.Less).apply(null,arguments)},c._LessEqual=function(){return(c._LessEqual=c.asm.LessEqual).apply(null,arguments)},c._LinSpace=function(){return(c._LinSpace=c.asm.LinSpace).apply(null,arguments)},c._Log=function(){return(c._Log=c.asm.Log).apply(null,arguments)},c._Log1p=function(){return(c._Log1p=c.asm.Log1p).apply(null,arguments)},c._LogicalAnd=function(){return(c._LogicalAnd=c.asm.LogicalAnd).apply(null,arguments)},c._LogicalNot=function(){return(c._LogicalNot=c.asm.LogicalNot).apply(null,arguments)},c._LogicalOr=function(){return(c._LogicalOr=c.asm.LogicalOr).apply(null,arguments)},c._LogicalXor=function(){return(c._LogicalXor=c.asm.LogicalXor).apply(null,arguments)},c._Max=function(){return(c._Max=c.asm.Max).apply(null,arguments)},c._MaxPool=function(){return(c._MaxPool=c.asm.MaxPool).apply(null,arguments)},c._MaxPool3D=function(){return(c._MaxPool3D=c.asm.MaxPool3D).apply(null,arguments)},c._MaxPool3DGrad=function(){return(c._MaxPool3DGrad=c.asm.MaxPool3DGrad).apply(null,arguments)},c._MaxPoolGrad=function(){return(c._MaxPoolGrad=c.asm.MaxPoolGrad).apply(null,arguments)},c._MaxPoolWithArgmax=function(){return(c._MaxPoolWithArgmax=c.asm.MaxPoolWithArgmax).apply(null,arguments)},c._Maximum=function(){return(c._Maximum=c.asm.Maximum).apply(null,arguments)},c._Mean=function(){return(c._Mean=c.asm.Mean).apply(null,arguments)},c._Min=function(){return(c._Min=c.asm.Min).apply(null,arguments)},c._Minimum=function(){return(c._Minimum=c.asm.Minimum).apply(null,arguments)},c._MirrorPad=function(){return(c._MirrorPad=c.asm.MirrorPad).apply(null,arguments)},c._Mod=function(){return(c._Mod=c.asm.Mod).apply(null,arguments)},c._Multinomial=function(){return(c._Multinomial=c.asm.Multinomial).apply(null,arguments)},c._Multiply=function(){return(c._Multiply=c.asm.Multiply).apply(null,arguments)},c._Neg=function(){return(c._Neg=c.asm.Neg).apply(null,arguments)},c._NonMaxSuppressionV3=function(){return(c._NonMaxSuppressionV3=c.asm.NonMaxSuppressionV3).apply(null,arguments)},c._NonMaxSuppressionV4=function(){return(c._NonMaxSuppressionV4=c.asm.NonMaxSuppressionV4).apply(null,arguments)},c._NonMaxSuppressionV5=function(){return(c._NonMaxSuppressionV5=c.asm.NonMaxSuppressionV5).apply(null,arguments)},c._NotEqual=function(){return(c._NotEqual=c.asm.NotEqual).apply(null,arguments)},c._OneHot=function(){return(c._OneHot=c.asm.OneHot).apply(null,arguments)},c._PadV2=function(){return(c._PadV2=c.asm.PadV2).apply(null,arguments)},c._Pow=function(){return(c._Pow=c.asm.Pow).apply(null,arguments)},c._Prelu=function(){return(c._Prelu=c.asm.Prelu).apply(null,arguments)},c._Prod=function(){return(c._Prod=c.asm.Prod).apply(null,arguments)},c._RealDiv=function(){return(c._RealDiv=c.asm.RealDiv).apply(null,arguments)},c._Reciprocal=function(){return(c._Reciprocal=c.asm.Reciprocal).apply(null,arguments)},c._Relu=function(){return(c._Relu=c.asm.Relu).apply(null,arguments)},c._Relu6=function(){return(c._Relu6=c.asm.Relu6).apply(null,arguments)},c._ResizeBilinear=function(){return(c._ResizeBilinear=c.asm.ResizeBilinear).apply(null,arguments)},c._ResizeBilinearGrad=function(){return(c._ResizeBilinearGrad=c.asm.ResizeBilinearGrad).apply(null,arguments)},c._ResizeNearestNeighbor=function(){return(c._ResizeNearestNeighbor=c.asm.ResizeNearestNeighbor).apply(null,arguments)},c._ResizeNearestNeighborGrad=function(){return(c._ResizeNearestNeighborGrad=c.asm.ResizeNearestNeighborGrad).apply(null,arguments)},c._Reverse=function(){return(c._Reverse=c.asm.Reverse).apply(null,arguments)},c._RotateWithOffset=function(){return(c._RotateWithOffset=c.asm.RotateWithOffset).apply(null,arguments)},c._Round=function(){return(c._Round=c.asm.Round).apply(null,arguments)},c._Rsqrt=function(){return(c._Rsqrt=c.asm.Rsqrt).apply(null,arguments)},c._ScatterNd=function(){return(c._ScatterNd=c.asm.ScatterNd).apply(null,arguments)},c._SearchSorted=function(){return(c._SearchSorted=c.asm.SearchSorted).apply(null,arguments)},c._SelectV2=function(){return(c._SelectV2=c.asm.SelectV2).apply(null,arguments)},c._Selu=function(){return(c._Selu=c.asm.Selu).apply(null,arguments)},c._Sigmoid=function(){return(c._Sigmoid=c.asm.Sigmoid).apply(null,arguments)},c._Sign=function(){return(c._Sign=c.asm.Sign).apply(null,arguments)},c._Sin=function(){return(c._Sin=c.asm.Sin).apply(null,arguments)},c._Sinh=function(){return(c._Sinh=c.asm.Sinh).apply(null,arguments)},c._Softmax=function(){return(c._Softmax=c.asm.Softmax).apply(null,arguments)},c._Softplus=function(){return(c._Softplus=c.asm.Softplus).apply(null,arguments)},c._SparseFillEmptyRows=function(){return(c._SparseFillEmptyRows=c.asm.SparseFillEmptyRows).apply(null,arguments)},c._SparseReshape=function(){return(c._SparseReshape=c.asm.SparseReshape).apply(null,arguments)},c._SparseSegmentReduction=function(){return(c._SparseSegmentReduction=c.asm.SparseSegmentReduction).apply(null,arguments)},c._SparseToDense=function(){return(c._SparseToDense=c.asm.SparseToDense).apply(null,arguments)},c._Sqrt=function(){return(c._Sqrt=c.asm.Sqrt).apply(null,arguments)},c._Square=function(){return(c._Square=c.asm.Square).apply(null,arguments)},c._SquaredDifference=function(){return(c._SquaredDifference=c.asm.SquaredDifference).apply(null,arguments)},c._Step=function(){return(c._Step=c.asm.Step).apply(null,arguments)},c._StridedSlice=function(){return(c._StridedSlice=c.asm.StridedSlice).apply(null,arguments)},c._Sub=function(){return(c._Sub=c.asm.Sub).apply(null,arguments)},c._Sum=function(){return(c._Sum=c.asm.Sum).apply(null,arguments)},c._Tan=function(){return(c._Tan=c.asm.Tan).apply(null,arguments)},c._Tanh=function(){return(c._Tanh=c.asm.Tanh).apply(null,arguments)},c._TensorScatterUpdate=function(){return(c._TensorScatterUpdate=c.asm.TensorScatterUpdate).apply(null,arguments)},c._Tile=function(){return(c._Tile=c.asm.Tile).apply(null,arguments)},c._TopK=function(){return(c._TopK=c.asm.TopK).apply(null,arguments)},c._Transform=function(){return(c._Transform=c.asm.Transform).apply(null,arguments)},c._Transpose=function(){return(c._Transpose=c.asm.Transpose).apply(null,arguments)},c.__FusedMatMul=function(){return(c.__FusedMatMul=c.asm._FusedMatMul).apply(null,arguments)},c._malloc=function(){return(c._malloc=c.asm.malloc).apply(null,arguments)},c._free=function(){return(c._free=c.asm.free).apply(null,arguments)},c.__emscripten_tls_init=function(){return(c.__emscripten_tls_init=c.asm._emscripten_tls_init).apply(null,arguments)};var Iu=c._pthread_self=function(){return(Iu=c._pthread_self=c.asm.pthread_self).apply(null,arguments)};c.___errno_location=function(){return(c.___errno_location=c.asm.__errno_location).apply(null,arguments)};var kb=c.__emscripten_thread_init=function(){return(kb=c.__emscripten_thread_init=c.asm._emscripten_thread_init).apply(null,arguments)};c.__emscripten_thread_crashed=function(){return(c.__emscripten_thread_crashed=c.asm._emscripten_thread_crashed).apply(null,arguments)},c._emscripten_main_thread_process_queued_calls=function(){return(c._emscripten_main_thread_process_queued_calls=c.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},c._emscripten_main_browser_thread_id=function(){return(c._emscripten_main_browser_thread_id=c.asm.emscripten_main_browser_thread_id).apply(null,arguments)};var Nb=c._emscripten_run_in_main_runtime_thread_js=function(){return(Nb=c._emscripten_run_in_main_runtime_thread_js=c.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)};c._emscripten_dispatch_to_thread_=function(){return(c._emscripten_dispatch_to_thread_=c.asm.emscripten_dispatch_to_thread_).apply(null,arguments)};var pm=c.__emscripten_proxy_execute_task_queue=function(){return(pm=c.__emscripten_proxy_execute_task_queue=c.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)},_d=c.__emscripten_thread_free_data=function(){return(_d=c.__emscripten_thread_free_data=c.asm._emscripten_thread_free_data).apply(null,arguments)},Tu=c.__emscripten_thread_exit=function(){return(Tu=c.__emscripten_thread_exit=c.asm._emscripten_thread_exit).apply(null,arguments)},mm=c._emscripten_stack_set_limits=function(){return(mm=c._emscripten_stack_set_limits=c.asm.emscripten_stack_set_limits).apply(null,arguments)},$d=c.stackSave=function(){return($d=c.stackSave=c.asm.stackSave).apply(null,arguments)},Bo=c.stackRestore=function(){return(Bo=c.stackRestore=c.asm.stackRestore).apply(null,arguments)},kd=c.stackAlloc=function(){return(kd=c.stackAlloc=c.asm.stackAlloc).apply(null,arguments)};c.dynCall_iijjiiii=function(){return(c.dynCall_iijjiiii=c.asm.dynCall_iijjiiii).apply(null,arguments)},c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.dynCall_jiji).apply(null,arguments)},c.keepRuntimeAlive=Ze,c.wasmMemory=V,c.cwrap=$b,c.ExitStatus=va,c.PThread=Oe;var Nd;st=function G(){Nd||Ib(),Nd||(st=G)};function Ib(G){if(Te>0)return;if(b){d(c),rn(),startWorker(c);return}if(It(),Te>0)return;function ie(){Nd||(Nd=!0,c.calledRun=!0,!se&&(rn(),d(c),c.onRuntimeInitialized&&c.onRuntimeInitialized(),an()))}c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),ie()},1)):ie()}if(c.preInit)for(typeof c.preInit=="function"&&(c.preInit=[c.preInit]);c.preInit.length>0;)c.preInit.pop()();Ib();var Id;h&&(Id={uncaughtException:process.listeners("uncaughtException").filter(function(G){return!h.uncaughtException.indexOf(G)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(G){return!h.unhandledRejection.indexOf(G)>-1})});var ll;if(typeof WasmBackendModule<"u")ll=WasmBackendModule;else if(typeof a<"u")ll=a;else throw new Error("Could not find wasm module in post.js");if(Id){var Eu=ll._dispose;ll._dispose=function(){Eu(),Id.uncaughtException.forEach(function(G){process.removeListener("uncaughtException",G)}),Id.unhandledRejection.forEach(function(G){process.removeListener("unhandledRejection",G)})}}return a.ready}})();t.exports=n})(sK);var oK=sK.exports;const iK=Ut(oK),iLe=Z1({__proto__:null,default:iK},[oK]);var lLe=`"use strict";var Module={};var ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads");var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",data=>onmessage({data:data}));var fs=require("fs");Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(f){(0,eval)(fs.readFileSync(f,"utf8")+"//# sourceURL="+f)},postMessage:function(msg){parentPort.postMessage(msg)},performance:global.performance||{now:function(){return Date.now()}}})}var initializedJS=false;var pendingNotifiedProxyingQueues=[];function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,text+"
");return}console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;self.alert=threadAlert;Module["instantiateWasm"]=(info,receiveInstance)=>{var instance=new WebAssembly.Instance(Module["wasmModule"],info);receiveInstance(instance);Module["wasmModule"]=null;return instance.exports};self.onunhandledrejection=e=>{throw e.reason??e};self.startWorker=instance=>{Module=instance;postMessage({"cmd":"loaded"})};self.onmessage=e=>{try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;for(const handler of e.data.handlers){Module[handler]=function(){postMessage({cmd:"callHandler",handler:handler,args:[...arguments]})}}Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob=="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module)}else if(e.data.cmd==="run"){Module["__emscripten_thread_init"](e.data.pthread_ptr,0,0,1);Module["establishStackSpace"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].threadInitTLS();if(!initializedJS){pendingNotifiedProxyingQueues.forEach(queue=>{Module["executeNotifiedProxyingQueue"](queue)});pendingNotifiedProxyingQueues=[];initializedJS=true}try{Module["invokeEntryPoint"](e.data.start_routine,e.data.arg)}catch(ex){if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["keepRuntimeAlive"]()){}else{Module["__emscripten_thread_exit"](ex.status)}}else{throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["__emscripten_thread_exit"](-1)}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processProxyingQueue"){if(initializedJS){Module["executeNotifiedProxyingQueue"](e.data.queue)}else{pendingNotifiedProxyingQueues.push(e.data.queue)}}else if(e.data.cmd){err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){if(Module["__emscripten_thread_crashed"]){Module["__emscripten_thread_crashed"]()}throw ex}};`,lK={exports:{}};(function(t,e){var n=(()=>{var r=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(r=r||__filename),function(a){a=a||{};var s=typeof a<"u"?a:{},o,i;s.ready=new Promise(function(me,$e){o=me,i=$e});var l;typeof process<"u"&&process.listeners&&(l={uncaughtException:process.listeners("uncaughtException"),unhandledRejection:process.listeners("unhandledRejection")});var u=Object.assign({},s),c=typeof window=="object",d=typeof importScripts=="function",f=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",h="";function p(me){return s.locateFile?s.locateFile(me,h):h+me}var g,y,v;if(f){var x=Cl,b=Cl;d?h=b.dirname(h)+"/":h=__dirname+"/",g=(me,$e)=>(me=be(me)?new URL(me):b.normalize(me),x.readFileSync(me,$e?void 0:"utf8")),v=me=>{var $e=g(me,!0);return $e.buffer||($e=new Uint8Array($e)),$e},y=(me,$e,Qe)=>{me=be(me)?new URL(me):b.normalize(me),x.readFile(me,function(Oe,on){Oe?Qe(Oe):$e(on.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(me){if(!(me instanceof Ze))throw me}),process.on("unhandledRejection",function(me){throw me}),s.inspect=function(){return"[Emscripten Module object]"}}else(c||d)&&(d?h=self.location.href:typeof document<"u"&&document.currentScript&&(h=document.currentScript.src),r&&(h=r),h.indexOf("blob:")!==0?h=h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):h="",g=me=>{var $e=new XMLHttpRequest;return $e.open("GET",me,!1),$e.send(null),$e.responseText},d&&(v=me=>{var $e=new XMLHttpRequest;return $e.open("GET",me,!1),$e.responseType="arraybuffer",$e.send(null),new Uint8Array($e.response)}),y=(me,$e,Qe)=>{var Oe=new XMLHttpRequest;Oe.open("GET",me,!0),Oe.responseType="arraybuffer",Oe.onload=()=>{if(Oe.status==200||Oe.status==0&&Oe.response){$e(Oe.response);return}Qe()},Oe.onerror=Qe,Oe.send(null)});var w=s.print||console.log.bind(console),C=s.printErr||console.warn.bind(console);Object.assign(s,u),u=null,s.arguments&&s.arguments,s.thisProgram&&s.thisProgram,s.quit&&s.quit;var _;s.wasmBinary&&(_=s.wasmBinary),s.noExitRuntime,typeof WebAssembly!="object"&&U("no native wasm support detected");var $,k=!1,A=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function P(me,$e,Qe){$e>>>=0;for(var Oe=$e+Qe,on=$e;me[on]&&!(on>=Oe);)++on;if(on-$e>16&&me.buffer&&A)return A.decode(me.subarray($e,on));for(var Wt="";$e<on;){var mt=me[$e++];if(!(mt&128)){Wt+=String.fromCharCode(mt);continue}var et=me[$e++]&63;if((mt&224)==192){Wt+=String.fromCharCode((mt&31)<<6|et);continue}var ln=me[$e++]&63;if((mt&240)==224?mt=(mt&15)<<12|et<<6|ln:mt=(mt&7)<<18|et<<12|ln<<6|me[$e++]&63,mt<65536)Wt+=String.fromCharCode(mt);else{var ea=mt-65536;Wt+=String.fromCharCode(55296|ea>>10,56320|ea&1023)}}return Wt}function O(me,$e){return me>>>=0,me?P(H,me,$e):""}function R(me,$e,Qe,Oe){if(Qe>>>=0,!(Oe>0))return 0;for(var on=Qe,Wt=Qe+Oe-1,mt=0;mt<me.length;++mt){var et=me.charCodeAt(mt);if(et>=55296&&et<=57343){var ln=me.charCodeAt(++mt);et=65536+((et&1023)<<10)|ln&1023}if(et<=127){if(Qe>=Wt)break;$e[Qe++>>>0]=et}else if(et<=2047){if(Qe+1>=Wt)break;$e[Qe++>>>0]=192|et>>6,$e[Qe++>>>0]=128|et&63}else if(et<=65535){if(Qe+2>=Wt)break;$e[Qe++>>>0]=224|et>>12,$e[Qe++>>>0]=128|et>>6&63,$e[Qe++>>>0]=128|et&63}else{if(Qe+3>=Wt)break;$e[Qe++>>>0]=240|et>>18,$e[Qe++>>>0]=128|et>>12&63,$e[Qe++>>>0]=128|et>>6&63,$e[Qe++>>>0]=128|et&63}}return $e[Qe>>>0]=0,Qe-on}function B(me,$e,Qe){return R(me,H,$e,Qe)}var F,L,H,te;function V(me){F=me,s.HEAP8=L=new Int8Array(me),s.HEAP16=new Int16Array(me),s.HEAP32=new Int32Array(me),s.HEAPU8=H=new Uint8Array(me),s.HEAPU16=new Uint16Array(me),s.HEAPU32=te=new Uint32Array(me),s.HEAPF32=new Float32Array(me),s.HEAPF64=new Float64Array(me)}s.INITIAL_MEMORY;var Q=[],se=[],le=[];function ue(){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)ge(s.preRun.shift());It(Q)}function ce(){It(se)}function re(){if(s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;)Ne(s.postRun.shift());It(le)}function ge(me){Q.unshift(me)}function Se(me){se.unshift(me)}function Ne(me){le.unshift(me)}var we=0,de=null;function J(me){we++,s.monitorRunDependencies&&s.monitorRunDependencies(we)}function ae(me){if(we--,s.monitorRunDependencies&&s.monitorRunDependencies(we),we==0&&de){var $e=de;de=null,$e()}}function U(me){s.onAbort&&s.onAbort(me),me="Aborted("+me+")",C(me),k=!0,me+=". Build with -sASSERTIONS for more info.";var $e=new WebAssembly.RuntimeError(me);throw i($e),$e}var oe="data:application/octet-stream;base64,";function ye(me){return me.startsWith(oe)}function be(me){return me.startsWith("file://")}var he;he="tfjs-backend-wasm.wasm",ye(he)||(he=p(he));function De(me){try{if(me==he&&_)return new Uint8Array(_);if(v)return v(me);throw"both async and sync fetching of the wasm failed"}catch($e){U($e)}}function Ve(){if(!_&&(c||d)){if(typeof fetch=="function"&&!be(he))return fetch(he,{credentials:"same-origin"}).then(function(me){if(!me.ok)throw"failed to load wasm binary file at '"+he+"'";return me.arrayBuffer()}).catch(function(){return De(he)});if(y)return new Promise(function(me,$e){y(he,function(Qe){me(new Uint8Array(Qe))},$e)})}return Promise.resolve().then(function(){return De(he)})}function Ye(){var me={env:_u,wasi_snapshot_preview1:_u};function $e(mt,et){var ln=mt.exports;s.asm=ln,$=s.asm.memory,V($.buffer),s.asm.__indirect_function_table,Se(s.asm.__wasm_call_ctors),ae()}J();function Qe(mt){$e(mt.instance)}function Oe(mt){return Ve().then(function(et){return WebAssembly.instantiate(et,me)}).then(function(et){return et}).then(mt,function(et){C("failed to asynchronously prepare wasm: "+et),U(et)})}function on(){return!_&&typeof WebAssembly.instantiateStreaming=="function"&&!ye(he)&&!be(he)&&!f&&typeof fetch=="function"?fetch(he,{credentials:"same-origin"}).then(function(mt){var et=WebAssembly.instantiateStreaming(mt,me);return et.then(Qe,function(ln){return C("wasm streaming compile failed: "+ln),C("falling back to ArrayBuffer instantiation"),Oe(Qe)})}):Oe(Qe)}if(s.instantiateWasm)try{var Wt=s.instantiateWasm(me,$e);return Wt}catch(mt){C("Module.instantiateWasm callback failed with error: "+mt),i(mt)}return on().catch(i),{}}function Ze(me){this.name="ExitStatus",this.message="Program terminated with exit("+me+")",this.status=me}function It(me){for(;me.length>0;)me.shift()(s)}function rn(){U("")}function an(){return 4294901760}function ar(){return an()}function Nr(me,$e,Qe){H.copyWithin(me>>>0,$e>>>0,$e+Qe>>>0)}function Zr(me){try{return $.grow(me-F.byteLength+65535>>>16),V($.buffer),1}catch{}}function Te(me){var $e=H.length;me=me>>>0;var Qe=an();if(me>Qe)return!1;let Oe=(ln,ea)=>ln+(ea-ln%ea)%ea;for(var on=1;on<=4;on*=2){var Wt=$e*(1+.2/on);Wt=Math.min(Wt,me+100663296);var mt=Math.min(Qe,Oe(Math.max(me,Wt),65536)),et=Zr(mt);if(et)return!0}return!1}function st(me){return 52}function pt(me,$e,Qe,Oe,on){return 70}var $n=[null,[],[]];function Jn(me,$e){var Qe=$n[me];$e===0||$e===10?((me===1?w:C)(P(Qe,0)),Qe.length=0):Qe.push($e)}function ya(me,$e,Qe,Oe){for(var on=0,Wt=0;Wt<Qe;Wt++){var mt=te[$e>>>2],et=te[$e+4>>>2];$e+=8;for(var ln=0;ln<et;ln++)Jn(me,H[mt+ln>>>0]);on+=et}return te[Oe>>>2]=on,0}function wt(me){var $e=s["_"+me];return $e}function Vt(me,$e){L.set(me,$e>>>0)}function sn(me,$e,Qe,Oe,on){var Wt={string:Zn=>{var As=0;if(Zn!=null&&Zn!==0){var xi=(Zn.length<<2)+1;As=va(xi),B(Zn,As,xi)}return As},array:Zn=>{var As=va(Zn.length);return Vt(Zn,As),As}};function mt(Zn){return $e==="string"?O(Zn):$e==="boolean"?!!Zn:Zn}var et=wt(me),ln=[],ea=0;if(Oe)for(var Qt=0;Qt<Oe.length;Qt++){var xa=Wt[Qe[Qt]];xa?(ea===0&&(ea=il()),ln[Qt]=xa(Oe[Qt])):ln[Qt]=Oe[Qt]}var vi=et.apply(null,ln);function vd(Zn){return ea!==0&&Ts(ea),mt(Zn)}return vi=vd(vi),vi}function Is(me,$e,Qe,Oe){Qe=Qe||[];var on=Qe.every(mt=>mt==="number"||mt==="boolean"),Wt=$e!=="string";return Wt&&on&&!Oe?wt(me):function(){return sn(me,$e,Qe,arguments)}}var _u={abort:rn,emscripten_get_heap_max:ar,emscripten_memcpy_big:Nr,emscripten_resize_heap:Te,fd_close:st,fd_seek:pt,fd_write:ya};Ye(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._init=function(){return(s._init=s.asm.init).apply(null,arguments)},s._init_with_threads_count=function(){return(s._init_with_threads_count=s.asm.init_with_threads_count).apply(null,arguments)},s._get_threads_count=function(){return(s._get_threads_count=s.asm.get_threads_count).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.register_tensor).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.dispose_data).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.dispose).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.Abs).apply(null,arguments)},s._Acos=function(){return(s._Acos=s.asm.Acos).apply(null,arguments)},s._Acosh=function(){return(s._Acosh=s.asm.Acosh).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.Add).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.AddN).apply(null,arguments)},s._All=function(){return(s._All=s.asm.All).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.Any).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.ArgMax).apply(null,arguments)},s._ArgMin=function(){return(s._ArgMin=s.asm.ArgMin).apply(null,arguments)},s._Asin=function(){return(s._Asin=s.asm.Asin).apply(null,arguments)},s._Asinh=function(){return(s._Asinh=s.asm.Asinh).apply(null,arguments)},s._Atan=function(){return(s._Atan=s.asm.Atan).apply(null,arguments)},s._Atan2=function(){return(s._Atan2=s.asm.Atan2).apply(null,arguments)},s._Atanh=function(){return(s._Atanh=s.asm.Atanh).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.AvgPool).apply(null,arguments)},s._AvgPool3D=function(){return(s._AvgPool3D=s.asm.AvgPool3D).apply(null,arguments)},s._AvgPool3DGrad=function(){return(s._AvgPool3DGrad=s.asm.AvgPool3DGrad).apply(null,arguments)},s._AvgPoolGrad=function(){return(s._AvgPoolGrad=s.asm.AvgPoolGrad).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.BatchMatMul).apply(null,arguments)},s._Bincount=function(){return(s._Bincount=s.asm.Bincount).apply(null,arguments)},s._BitwiseAnd=function(){return(s._BitwiseAnd=s.asm.BitwiseAnd).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.Ceil).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.ClipByValue).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.Conv2D).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.Conv2DBackpropInput).apply(null,arguments)},s._Conv3D=function(){return(s._Conv3D=s.asm.Conv3D).apply(null,arguments)},s._Conv3DBackpropFilterV2=function(){return(s._Conv3DBackpropFilterV2=s.asm.Conv3DBackpropFilterV2).apply(null,arguments)},s._Conv3DBackpropInputV2=function(){return(s._Conv3DBackpropInputV2=s.asm.Conv3DBackpropInputV2).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.Cos).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.Cosh).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.CropAndResize).apply(null,arguments)},s._Cumprod=function(){return(s._Cumprod=s.asm.Cumprod).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.Cumsum).apply(null,arguments)},s._DenseBincount=function(){return(s._DenseBincount=s.asm.DenseBincount).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.DepthToSpace).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.DepthwiseConv2dNative).apply(null,arguments)},s._Diag=function(){return(s._Diag=s.asm.Diag).apply(null,arguments)},s._Dilation2D=function(){return(s._Dilation2D=s.asm.Dilation2D).apply(null,arguments)},s._Dilation2DBackpropFilter=function(){return(s._Dilation2DBackpropFilter=s.asm.Dilation2DBackpropFilter).apply(null,arguments)},s._Dilation2DBackpropInput=function(){return(s._Dilation2DBackpropInput=s.asm.Dilation2DBackpropInput).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.Elu).apply(null,arguments)},s._EluGrad=function(){return(s._EluGrad=s.asm.EluGrad).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.Equal).apply(null,arguments)},s._Erf=function(){return(s._Erf=s.asm.Erf).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.Exp).apply(null,arguments)},s._Expm1=function(){return(s._Expm1=s.asm.Expm1).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.FlipLeftRight).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.Floor).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.FloorDiv).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.FusedBatchNorm).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.FusedConv2D).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.FusedDepthwiseConv2D).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Gather).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.GatherNd).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.Greater).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.GreaterEqual).apply(null,arguments)},s._IsFinite=function(){return(s._IsFinite=s.asm.IsFinite).apply(null,arguments)},s._IsInf=function(){return(s._IsInf=s.asm.IsInf).apply(null,arguments)},s._IsNan=function(){return(s._IsNan=s.asm.IsNan).apply(null,arguments)},s._LRN=function(){return(s._LRN=s.asm.LRN).apply(null,arguments)},s._LRNGrad=function(){return(s._LRNGrad=s.asm.LRNGrad).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.LeakyRelu).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.Less).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.LessEqual).apply(null,arguments)},s._LinSpace=function(){return(s._LinSpace=s.asm.LinSpace).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.Log).apply(null,arguments)},s._Log1p=function(){return(s._Log1p=s.asm.Log1p).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.LogicalAnd).apply(null,arguments)},s._LogicalNot=function(){return(s._LogicalNot=s.asm.LogicalNot).apply(null,arguments)},s._LogicalOr=function(){return(s._LogicalOr=s.asm.LogicalOr).apply(null,arguments)},s._LogicalXor=function(){return(s._LogicalXor=s.asm.LogicalXor).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Max).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm.MaxPool).apply(null,arguments)},s._MaxPool3D=function(){return(s._MaxPool3D=s.asm.MaxPool3D).apply(null,arguments)},s._MaxPool3DGrad=function(){return(s._MaxPool3DGrad=s.asm.MaxPool3DGrad).apply(null,arguments)},s._MaxPoolGrad=function(){return(s._MaxPoolGrad=s.asm.MaxPoolGrad).apply(null,arguments)},s._MaxPoolWithArgmax=function(){return(s._MaxPoolWithArgmax=s.asm.MaxPoolWithArgmax).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.Maximum).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.Mean).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.Min).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.Minimum).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.MirrorPad).apply(null,arguments)},s._Mod=function(){return(s._Mod=s.asm.Mod).apply(null,arguments)},s._Multinomial=function(){return(s._Multinomial=s.asm.Multinomial).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.Multiply).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.Neg).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.NonMaxSuppressionV3).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.NonMaxSuppressionV4).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.NonMaxSuppressionV5).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.NotEqual).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.OneHot).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.PadV2).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.Pow).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.Prelu).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.Prod).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.RealDiv).apply(null,arguments)},s._Reciprocal=function(){return(s._Reciprocal=s.asm.Reciprocal).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.Relu).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.Relu6).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.ResizeBilinear).apply(null,arguments)},s._ResizeBilinearGrad=function(){return(s._ResizeBilinearGrad=s.asm.ResizeBilinearGrad).apply(null,arguments)},s._ResizeNearestNeighbor=function(){return(s._ResizeNearestNeighbor=s.asm.ResizeNearestNeighbor).apply(null,arguments)},s._ResizeNearestNeighborGrad=function(){return(s._ResizeNearestNeighborGrad=s.asm.ResizeNearestNeighborGrad).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.Reverse).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.RotateWithOffset).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.Round).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.Rsqrt).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.ScatterNd).apply(null,arguments)},s._SearchSorted=function(){return(s._SearchSorted=s.asm.SearchSorted).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.SelectV2).apply(null,arguments)},s._Selu=function(){return(s._Selu=s.asm.Selu).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.Sigmoid).apply(null,arguments)},s._Sign=function(){return(s._Sign=s.asm.Sign).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Sin).apply(null,arguments)},s._Sinh=function(){return(s._Sinh=s.asm.Sinh).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Softmax).apply(null,arguments)},s._Softplus=function(){return(s._Softplus=s.asm.Softplus).apply(null,arguments)},s._SparseFillEmptyRows=function(){return(s._SparseFillEmptyRows=s.asm.SparseFillEmptyRows).apply(null,arguments)},s._SparseReshape=function(){return(s._SparseReshape=s.asm.SparseReshape).apply(null,arguments)},s._SparseSegmentReduction=function(){return(s._SparseSegmentReduction=s.asm.SparseSegmentReduction).apply(null,arguments)},s._SparseToDense=function(){return(s._SparseToDense=s.asm.SparseToDense).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Sqrt).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Square).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.SquaredDifference).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Step).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.StridedSlice).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Sub).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Sum).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Tan).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Tanh).apply(null,arguments)},s._TensorScatterUpdate=function(){return(s._TensorScatterUpdate=s.asm.TensorScatterUpdate).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.Tile).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.TopK).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Transform).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Transpose).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm._FusedMatMul).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.malloc).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)};var il=s.stackSave=function(){return(il=s.stackSave=s.asm.stackSave).apply(null,arguments)},Ts=s.stackRestore=function(){return(Ts=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},va=s.stackAlloc=function(){return(va=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)};s.dynCall_iijjiiii=function(){return(s.dynCall_iijjiiii=s.asm.dynCall_iijjiiii).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)},s.cwrap=Is;var yi;de=function me(){yi||$u(),yi||(de=me)};function $u(me){if(we>0||(ue(),we>0))return;function $e(){yi||(yi=!0,s.calledRun=!0,!k&&(ce(),o(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),re()))}s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),$e()},1)):$e()}if(s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();$u();var io;l&&(io={uncaughtException:process.listeners("uncaughtException").filter(function(me){return!l.uncaughtException.indexOf(me)>-1}),unhandledRejection:process.listeners("unhandledRejection").filter(function(me){return!l.unhandledRejection.indexOf(me)>-1})});var Lo;if(typeof a<"u")Lo=a;else if(typeof WasmBackendModuleThreadedSimd<"u")Lo=WasmBackendModuleThreadedSimd;else throw new Error("Could not find wasm module in post.js");if(io){var Es=Lo._dispose;Lo._dispose=function(){Es(),io.uncaughtException.forEach(function(me){process.removeListener("uncaughtException",me)}),io.unhandledRejection.forEach(function(me){process.removeListener("unhandledRejection",me)})}}return a.ready}})();t.exports=n})(lK);var uK=lK.exports;const cK=Ut(uK),uLe=Z1({__proto__:null,default:cK},[uK]);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xj=iK||iLe,cLe=cK||uLe;class dLe extends iv{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.initWithThreadsCount(gLe),this.wasm.tfjs.getThreadsCount(),this.dataIdMap=new xS(this,ia())}write(e,n,r){const a={id:this.dataIdNextNumber++};return this.move(a,e,n,r,1),a}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const n=Va();return e(),{kernelMs:Va()-n}}move(e,n,r,a,s){const o=this.dataIdNextNumber++;if(a==="string"){const c=n;this.dataIdMap.set(e,{id:o,stringBytes:c,shape:r,dtype:a,memoryOffset:null,refCount:s});return}const i=ne(r),l=i*Nc(a),u=this.wasm._malloc(l)>>>0;this.dataIdMap.set(e,{id:o,memoryOffset:u,shape:r,dtype:a,refCount:s}),this.wasm.tfjs.registerTensor(o,i,u),n!=null&&this.wasm.HEAPU8.set(new Uint8Array(n.buffer,n.byteOffset,l),u)}async read(e){return this.readSync(e)}readSync(e,n,r){const{memoryOffset:a,dtype:s,shape:o,stringBytes:i}=this.dataIdMap.get(e);if(s==="string")return(n==null||n===0)&&(r==null||r>=i.length)?i:i.slice(n,r);n=n||0,r=r||ne(o);const l=Nc(s),u=this.wasm.HEAPU8.slice(a+n*l,a+r*l);return pLe(u.buffer,s)}disposeData(e,n=!1){if(this.dataIdMap.has(e)){const r=this.dataIdMap.get(e);if(r.refCount--,!n&&r.refCount>0)return!1;this.wasm._free(r.memoryOffset),this.wasm.tfjs.disposeData(r.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){const n=this.dataIdMap.get(e);n!=null&&n.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,n,r,a){let s;if(r==null)s=this.write(a??null,e,n);else{const o=this.dataIdNextNumber++;s={id:o},this.dataIdMap.set(s,{id:o,memoryOffset:r,shape:e,dtype:n,refCount:1});const i=ne(e);this.wasm.tfjs.registerTensor(o,i,r)}return{dataId:s,shape:e,dtype:n}}typedArrayFromHeap({shape:e,dtype:n,dataId:r}){const a=this.wasm.HEAPU8.buffer,{memoryOffset:s}=this.dataIdMap.get(r),o=ne(e);switch(n){case"float32":return new Float32Array(a,s,o);case"int32":return new Int32Array(a,s,o);case"bool":return new Uint8Array(a,s,o);default:throw new Error(`Unknown dtype ${n}`)}}}function fLe(t,e,n){let r="tfjs-backend-wasm.wasm";return t&&e?r="tfjs-backend-wasm-threaded-simd.wasm":t&&(r="tfjs-backend-wasm-simd.wasm"),V_!=null&&V_[r]!=null?V_[r]:n+r}async function hLe(){const[t,e]=await Promise.all([ee().getAsync("WASM_HAS_SIMD_SUPPORT"),ee().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise((n,r)=>{const a={};a.locateFile=(i,l)=>{if(i.endsWith(".worker.js")){const u=lLe.replace(/\n/g,"\\n"),c=new Blob([u],{type:"application/javascript"});return URL.createObjectURL(c)}return i.endsWith(".wasm")?fLe(t,e,l):l+i};let s=!1;a.onAbort=()=>{if(s||W_)return;W_=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"})};let o;e&&t&&mLe==null?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+Xj.toString()],{type:"text/javascript"}),o=Xj(a)):o=cLe(a),o.then(i=>{s=!0,W_=!1;const l=null;i.tfjs={init:i.cwrap("init",null,[]),initWithThreadsCount:i.cwrap("init_with_threads_count",null,["number"]),getThreadsCount:i.cwrap("get_threads_count","number",[]),registerTensor:i.cwrap("register_tensor",null,["number","number","number"]),disposeData:i.cwrap("dispose_data",l,["number"]),dispose:i.cwrap("dispose",l,[])},n({wasm:i})}).catch(r)})}function pLe(t,e){switch(e){case"float32":return new Float32Array(t);case"int32":return new Int32Array(t);case"bool":return new Uint8Array(t);default:throw new Error(`Unknown dtype ${e}`)}}let mLe=null,V_={},W_=!1,gLe=-1;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yLe=2;qS("wasm",async()=>{const{wasm:t}=await hLe();return new dLe(t)},yLe);const ON={squat:{name:"Agachamento",requiredKeypoints:["left_hip","left_knee","left_ankle","right_hip","right_knee","right_ankle"],positioningInstructions:"Afaste-se para a câmera ver suas pernas completas",detectionMessage:"AGACHAMENTO DETECTADO!",thresholds:{good:90,average:110},animationUrl:"/animations/squat-animation.gif"},lunge:{name:"Avanço",requiredKeypoints:["left_hip","left_knee","left_ankle","right_hip","right_knee","right_ankle"],positioningInstructions:"Afaste-se para a câmera ver suas pernas completas",detectionMessage:"AVANÇO DETECTADO!",thresholds:{good:90,average:110},animationUrl:"/animations/lunge-animation.gif"},pushup:{name:"Flexão",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione a câmera para ver seu tronco e braços completos",detectionMessage:"FLEXÃO DETECTADA!",thresholds:{good:90,average:110},animationUrl:"/animations/pushup-animation.gif"},curl:{name:"Rosca Bíceps",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione-se para que seus braços estejam visíveis",detectionMessage:"CONTRAÇÃO DETECTADA!",thresholds:{good:50,average:70},animationUrl:"/animations/curl-animation.gif"},plank:{name:"Prancha",requiredKeypoints:["left_shoulder","left_hip","left_knee","left_ankle","right_shoulder","right_hip"],positioningInstructions:"Posicione a câmera lateralmente para ver seu corpo na horizontal",detectionMessage:"PRANCHA DETECTADA!",thresholds:{good:170,average:160},animationUrl:"/animations/plank-animation.gif"},agachamento:{name:"Agachamento",requiredKeypoints:["left_hip","left_knee","left_ankle","right_hip","right_knee","right_ankle"],positioningInstructions:"Afaste-se para a câmera ver suas pernas completas",detectionMessage:"AGACHAMENTO DETECTADO!",thresholds:{good:90,average:110},animationUrl:"/animations/squat-animation.gif"},avanço:{name:"Avanço",requiredKeypoints:["left_hip","left_knee","left_ankle","right_hip","right_knee","right_ankle"],positioningInstructions:"Afaste-se para a câmera ver suas pernas completas",detectionMessage:"AVANÇO DETECTADO!",thresholds:{good:90,average:110},animationUrl:"/animations/lunge-animation.gif"},flexão:{name:"Flexão",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione a câmera para ver seu tronco e braços completos",detectionMessage:"FLEXÃO DETECTADA!",thresholds:{good:90,average:110},animationUrl:"/animations/pushup-animation.gif"},roscabíceps:{name:"Rosca Bíceps",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione-se para que seus braços estejam visíveis",detectionMessage:"CONTRAÇÃO DETECTADA!",thresholds:{good:50,average:70},animationUrl:"/animations/curl-animation.gif"},prancha:{name:"Prancha",requiredKeypoints:["left_shoulder","left_hip","left_knee","left_ankle","right_shoulder","right_hip"],positioningInstructions:"Posicione a câmera lateralmente para ver seu corpo na horizontal",detectionMessage:"PRANCHA DETECTADA!",thresholds:{good:170,average:160},animationUrl:"/animations/plank-animation.gif"},"levantamento-lateral":{name:"Levantamento Lateral",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione-se de lado para a câmera ver seus ombros e braços",detectionMessage:"LEVANTAMENTO LATERAL DETECTADO!",thresholds:{good:80,average:100},animationUrl:"/animations/lateral-raise.gif"},"levantamento-frontal":{name:"Levantamento Frontal",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione-se de lado para a câmera ver seus ombros e braços",detectionMessage:"LEVANTAMENTO FRONTAL DETECTADO!",thresholds:{good:80,average:100},animationUrl:"/animations/front-raise.gif"},desenvolvimento:{name:"Desenvolvimento",requiredKeypoints:["left_shoulder","left_elbow","left_wrist","right_shoulder","right_elbow","right_wrist"],positioningInstructions:"Posicione-se de frente para a câmera, braços acima da cabeça",detectionMessage:"DESENVOLVIMENTO DETECTADO!",thresholds:{good:60,average:90},animationUrl:"/animations/shoulder-press.gif"}},HP=t=>{const e=t.toLowerCase().replace(/\s+/g,"");return ON[e]||ON.squat},vLe=(t,e,n=.3)=>{const r=HP(e);for(const a of r.requiredKeypoints){const s=t[a];if(!s||!s.score||s.score<n)return!1}return!0},Er=(t,e,n)=>{if(!t||!e||!n)return 180;const r=Math.atan2(n.y-e.y,n.x-e.x)-Math.atan2(t.y-e.y,t.x-e.x);let a=Math.abs(r*180/Math.PI);return a>180&&(a=360-a),a},xLe=({exercise:t,onRepetitionCount:e,onFeedback:n})=>{const r=N.useRef(null),a=N.useRef(null),[s,o]=N.useState(!0),[i,l]=N.useState(!0),[u,c]=N.useState(null),[d,f]=N.useState(!1),[h,p]=N.useState(!1),[g,y]=N.useState(!1),[v,x]=N.useState("poor"),b=N.useRef([]),w=N.useRef(null),C=N.useRef(null),_=N.useRef(0),$=N.useRef(180),k=N.useRef(!1),A=N.useRef(0),P=N.useRef(Date.now()),O=N.useRef(null);Xr();const[R,B]=N.useState("webgl"),[F,L]=N.useState(!1);N.useEffect(()=>{const ce=HP(t.toLowerCase().replace(/\s+/g,""));O.current=ce,f(!1),p(!1),y(!1),_.current=0,A.current=0,n(ce.positioningInstructions||"Posicione-se em frente à câmera")},[t,n]),N.useEffect(()=>{let ce=null;const re=async()=>{if(r.current)try{const we=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:320},height:{ideal:240}},audio:!1});r.current.srcObject=we,await new Promise(de=>{r.current.onloadedmetadata=()=>de(null)})}catch(we){console.error("Erro ao acessar a câmera:",we),c("Erro ao acessar câmera. Verifique suas permissões."),n("Erro ao acessar câmera. Verifique suas permissões.")}},ge=async()=>{o(!0);try{L(!0),await QV(R),await JV(),L(!1);const we=Io.MoveNet,de={modelType:rH.modelType.SINGLEPOSE_LIGHTNING,enableSmoothing:!0};w.current=await nH(we,de),o(!1)}catch(we){console.error("Erro ao carregar o modelo de detecção:",we),c("Erro ao carregar o modelo de detecção. Tente novamente."),n("Erro ao carregar o modelo de detecção. Tente novamente."),o(!1),L(!1)}},Se=async()=>{if(!w.current||!r.current||!a.current||r.current.readyState<2)return;a.current.width=r.current.videoWidth,a.current.height=r.current.videoHeight;const we=a.current.getContext("2d");we==null||we.clearRect(0,0,a.current.width,a.current.height),we==null||we.drawImage(r.current,0,0,a.current.width,a.current.height);try{const de=await w.current.estimatePoses(r.current);if(de.length>0&&de[0].keypoints){for(const J of de[0].keypoints)J.score>.4&&(we==null||we.beginPath(),we==null||we.arc(J.x,J.y,6,0,2*Math.PI),we.fillStyle="red",we==null||we.fill());b.current=de[0].keypoints,H(de[0].keypoints)}}catch(de){console.error("Erro durante a detecção de pose:",de),n("Erro na detecção. Tente reiniciar o exercício.")}await YA()};return(async()=>{await re(),l(!1),await ge(),r.current&&a.current&&w.current&&(ce=setInterval(Se,200))})(),()=>{ce&&clearInterval(ce),C.current&&(typeof C.current=="number"?cancelAnimationFrame(C.current):clearTimeout(C.current)),r.current&&r.current.srcObject&&r.current.srcObject.getTracks().forEach(de=>de.stop())}},[n,R]);const H=ce=>{const re={};if(ce.forEach(de=>{re[de.name]=de}),!O.current)return;const ge=O.current.requiredKeypoints;let Se=0,Ne=ge.length;for(const de of ge){const J=re[de];J&&J.score&&J.score>.2&&Se++}const we=Se/Ne*100;switch(we<50?(x("poor"),A.current=0,_.current%30===0&&n(O.current.positioningInstructions)):we<80?(x("good"),A.current+=1,A.current===10&&n("Posição melhorando! Continue ajustando para visibilidade ideal.")):(x("excellent"),A.current+=1,A.current===10&&n("Excelente posição! Visibilidade perfeita.")),t.toLowerCase().replace(/\s+/g,"")){case"agachamento":case"squat":te(re);break;case"flexãodebraço":case"flexão":case"pushup":V(re);break;case"roscabíceps":case"rosca":case"curl":Q(re);break;case"prancha":case"plank":se(re);break;case"avanço":case"lunge":le(re);break;default:te(re)}_.current++},te=ce=>{const re=ce.left_hip,ge=ce.left_knee,Se=ce.left_ankle,Ne=ce.right_hip,we=ce.right_knee,de=ce.right_ankle;if((re==null?void 0:re.score)>.2&&(ge==null?void 0:ge.score)>.2&&(Se==null?void 0:Se.score)>.2&&(Ne==null?void 0:Ne.score)>.2&&(we==null?void 0:we.score)>.2&&(de==null?void 0:de.score)>.2,re!=null&&re.score&&(ge!=null&&ge.score)&&(Se!=null&&Se.score)){const J=(re.score+ge.score+Se.score)/3;console.log(`Scores de detecção: Quadril=${re.score.toFixed(2)}, Joelho=${ge.score.toFixed(2)}, Tornozelo=${Se.score.toFixed(2)}, Média=${J.toFixed(2)}`),J<.3?(x("poor"),A.current=0):J<.5?(x("good"),A.current+=1,A.current>5&&A.current%10===0&&n("Posição melhorando! Continue ajustando para visibilidade ideal.")):(x("excellent"),A.current+=1,A.current===10&&n("Excelente posição! Suas pernas estão claramente visíveis."))}if(re&&ge&&Se){const J=Er(re,ge,Se);let ae=J;if(Ne&&we&&de){const oe=Er(Ne,we,de);ae=(J+oe)/2}const U=$.current;$.current=ae,console.log(`ANÁLISE DE AGACHAMENTO - Ângulo atual: ${ae.toFixed(1)}°, Ângulo anterior: ${U.toFixed(1)}°, isDown: ${d}, squatDetected: ${g}`),ae<145&&!d&&!k.current?(y(!0),console.log(`🔍 DETECTADO: Possível agachamento iniciado - Ângulo: ${ae.toFixed(1)}°`),console.log(`🔴 POSIÇÃO BAIXA IMEDIATAMENTE CONFIRMADA! Ângulo: ${ae.toFixed(1)}°`),f(!0),_.current=0,n("Agachamento detectado! Mantenha a posição...")):ae>160&&d&&!k.current?(console.log(`🟢 REPETIÇÃO IMEDIATAMENTE CONCLUÍDA! Ângulo: ${ae.toFixed(1)}°`),f(!1),y(!1),p(!1),_.current=0,k.current=!0,ue("Boa! Repetição contabilizada."),e(),console.log("🎯 Chamando callback de repetição - contabilizando agachamento"),setTimeout(()=>{k.current=!1,console.log("⏱️ Debounce resetado, pronto para nova repetição")},300)):ae<150?y(!0):ae>165&&y(!1)}},V=ce=>{const re=ce.left_shoulder,ge=ce.left_elbow,Se=ce.left_wrist,Ne=ce.right_shoulder,we=ce.right_elbow,de=ce.right_wrist;if(re!=null&&re.score&&(ge!=null&&ge.score)&&(Se!=null&&Se.score)&&re.score>.5&&ge.score>.5&&Se.score>.5){const J=Er(re,ge,Se);let ae=J;if(Ne!=null&&Ne.score&&(we!=null&&we.score)&&(de!=null&&de.score)&&Ne.score>.5&&we.score>.5&&de.score>.5){const U=Er(Ne,we,de);ae=(J+U)/2}ae<110&&!d&&!k.current?(f(!0),n("Posição baixa! Mantenha o corpo alinhado.")):ae>160&&d&&!k.current&&(f(!1),k.current=!0,ue("Excelente flexão! Repetição contabilizada."),e(),setTimeout(()=>{k.current=!1},300))}else _.current%30===0&&n("Posicione a câmera para ver seu tronco e braços completos")},Q=ce=>{const re=ce.left_shoulder,ge=ce.left_elbow,Se=ce.left_wrist;if(re!=null&&re.score&&(ge!=null&&ge.score)&&(Se!=null&&Se.score)&&re.score>.5&&ge.score>.5&&Se.score>.5){const Ne=Er(re,ge,Se);Ne<80&&!d&&!k.current?(f(!0),n("Posição alta correta. Segure brevemente.")):Ne>150&&d&&!k.current&&(f(!1),k.current=!0,ue("Correto! Repetição contabilizada."),e(),setTimeout(()=>{k.current=!1},300))}else _.current%30===0&&n("Posicione-se para que seus braços estejam visíveis")},se=ce=>{const re=ce.left_shoulder,ge=ce.left_hip,Se=ce.left_knee,Ne=ce.left_ankle;if(re!=null&&re.score&&(ge!=null&&ge.score)&&(Se!=null&&Se.score)&&(Ne!=null&&Ne.score)&&re.score>.3&&ge.score>.3&&Se.score>.3&&Ne.score>.3){const we=Er({x:re.x,y:re.y-100},re,ge),de=Er(ge,Se,Ne);Math.abs(180-we)<20&&Math.abs(180-de)<30?d||(f(!0),n("Prancha detectada! Mantenha a posição reta.")):d&&(f(!1),n("Mantenha o corpo alinhado em linha reta."))}else _.current%30===0&&n("Posicione a câmera lateralmente para ver seu corpo na horizontal")},le=ce=>{const re=ce.left_hip,ge=ce.left_knee,Se=ce.left_ankle,Ne=ce.right_hip,we=ce.right_knee,de=ce.right_ankle;if(ge!=null&&ge.score&&(Se!=null&&Se.score)&&(we!=null&&we.score)&&(de!=null&&de.score)&&ge.score>.3&&Se.score>.3&&we.score>.3&&de.score>.3){const J=Er(re||{x:ge.x,y:ge.y-100},ge,Se),ae=Er(Ne||{x:we.x,y:we.y-100},we,de);Math.abs(J-ae)>30&&(J<130||ae<130)&&!d&&!k.current?(f(!0),n("Avanço detectado! Mantenha a posição...")):J>160&&ae>160&&d&&!k.current&&(f(!1),k.current=!0,ue("Excelente! Repetição contabilizada."),e(),setTimeout(()=>{k.current=!1},300))}else _.current%30===0&&n("Afaste-se para a câmera ver suas pernas completas")},ue=ce=>{const re=Date.now();re-P.current>1e3&&(P.current=re,n(ce))};return m.jsxs("div",{className:"relative h-full",children:[m.jsxs("div",{className:"absolute top-2 left-2 z-50 flex gap-2 items-center bg-white/80 rounded px-2 py-1 shadow",children:[m.jsx("span",{className:"text-xs font-bold",children:"Backend:"}),m.jsx("button",{className:`px-2 py-1 rounded text-xs font-bold ${R==="webgl"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>B("webgl"),disabled:R==="webgl"||F,children:"webgl"}),m.jsx("button",{className:`px-2 py-1 rounded text-xs font-bold ${R==="wasm"?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>B("wasm"),disabled:R==="wasm"||F,children:"wasm"}),F&&m.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"Carregando backend..."})]}),m.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,style:{display:"none"},width:"480",height:"360",onLoadedData:()=>{a.current&&r.current&&(a.current.width=r.current.videoWidth,a.current.height=r.current.videoHeight)}}),m.jsx("canvas",{ref:a,className:"w-full h-full object-cover rounded-lg",style:{height:"100%",width:"100%"}}),(s||i)&&m.jsxs("div",{className:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center text-white min-h-[180px] sm:min-h-[220px]",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white mb-4"}),m.jsx("p",{children:i?"Acessando câmera...":"Carregando modelo de IA..."})]}),u&&m.jsx("div",{className:"absolute inset-0 bg-red-500/20 flex flex-col items-center justify-center text-white p-4",children:m.jsxs("div",{className:"bg-red-600 p-4 rounded-lg max-w-md",children:[m.jsx("p",{className:"font-bold text-lg mb-2",children:"Erro"}),m.jsx("p",{children:u}),m.jsx("button",{className:"mt-4 bg-white text-red-600 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>{c(null),window.location.reload()},children:"Tentar Novamente"})]})}),g&&t.toLowerCase().includes("agachamento")&&m.jsx("div",{className:"absolute bottom-4 left-4 bg-red-500 px-3 py-1 rounded-full text-white text-sm font-bold",children:"Agachamento Detectado!"}),m.jsx("div",{className:`absolute top-4 left-4 px-3 py-1 rounded-full text-white text-sm font-bold 
                     ${v==="poor"?"bg-red-500":v==="good"?"bg-yellow-500":"bg-green-500"}`,children:v==="poor"?"Detecção Ruim":v==="good"?"Detecção Boa":"Detecção Excelente"})]})},bn=N.forwardRef(({className:t,...e},n)=>m.jsx("div",{ref:n,className:fn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));bn.displayName="Card";const wn=N.forwardRef(({className:t,...e},n)=>m.jsx("div",{ref:n,className:fn("flex flex-col space-y-1.5 p-6",t),...e}));wn.displayName="CardHeader";const Sn=N.forwardRef(({className:t,...e},n)=>m.jsx("h3",{ref:n,className:fn("text-2xl font-semibold leading-none tracking-tight",t),...e}));Sn.displayName="CardTitle";const xs=N.forwardRef(({className:t,...e},n)=>m.jsx("p",{ref:n,className:fn("text-sm text-muted-foreground",t),...e}));xs.displayName="CardDescription";const Cn=N.forwardRef(({className:t,...e},n)=>m.jsx("div",{ref:n,className:fn("p-6 pt-0",t),...e}));Cn.displayName="CardContent";const yc=N.forwardRef(({className:t,...e},n)=>m.jsx("div",{ref:n,className:fn("flex items-center p-6 pt-0",t),...e}));yc.displayName="CardFooter";const bLe=({onSelectExercise:t})=>{const e=[{id:"squat",name:"Agachamento",description:"Posicione seus pés na largura dos ombros e agache mantendo a postura reta.",icon:m.jsx(jk,{className:"h-12 w-12 text-formfit-blue"})},{id:"afundo",name:"Avanço",description:"Dê um passo à frente e agache, mantendo o tronco ereto.",icon:m.jsx(jk,{className:"h-12 w-12 text-formfit-blue"})},{id:"push-up",name:"Flexão de Braço",description:"Mantenha o corpo alinhado e dobre os cotovelos para descer.",icon:m.jsx(pre,{className:"h-12 w-12 text-formfit-purple"})},{id:"biceps-curl",name:"Rosca Bíceps",description:"Segure pesos leves e dobre os cotovelos para trabalhar os bíceps.",icon:m.jsx(Sf,{className:"h-12 w-12 text-formfit-pink"})}];return m.jsxs("div",{className:"space-y-6",children:[m.jsx("h2",{className:"formfit-subheading text-center",children:"Escolha um exercício para começar"}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:e.map(n=>m.jsxs(bn,{className:"cursor-pointer hover:shadow-lg transition-shadow duration-300",onClick:()=>t(n.id),children:[m.jsxs(wn,{className:"flex flex-col items-center",children:[n.icon,m.jsx(Sn,{className:"mt-4",children:n.name})]}),m.jsx(Cn,{children:m.jsx(xs,{className:"text-center",children:n.description})})]},n.id))})]})},dK=({exerciseId:t,onComplete:e})=>{console.log("ExerciseAnimation: exerciseId",t);const[n,r]=N.useState(!0),a=ON[t]||{name:t,positioningInstructions:"",animationUrl:""};N.useEffect(()=>{const o=setTimeout(()=>{r(!1)},1e3);return()=>clearTimeout(o)},[t]);const s=()=>{switch(console.log("Fallback for:",t),t){case"squat":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"🏋️"}),m.jsx("div",{className:"animate-bounce h-20 w-20 mb-4",children:"👤"}),m.jsx("div",{className:"animate-ping h-20 w-20",children:"👤"})]});case"leg-press":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"🦵"}),m.jsx("div",{className:"animate-bounce h-20 w-20 mb-4",children:"👤"}),m.jsx("div",{className:"animate-pulse h-20 w-20",children:"🦶"}),m.jsx("div",{className:"text-gray-500 mt-2",children:"Simulação de Leg Press"})]});case"plank":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"🧘"}),m.jsx("div",{className:"transform rotate-90 text-4xl",children:"👤"})]});case"curl":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"💪"}),m.jsx("div",{className:"animate-pulse text-4xl",children:"👤"})]});case"pushup":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"💪"}),m.jsx("div",{className:"animate-bounce text-4xl",children:"👤"})]});case"lunge":return m.jsxs("div",{className:"flex flex-col items-center",children:[m.jsx("div",{className:"mb-4 text-4xl font-bold",children:"🏃"}),m.jsx("div",{className:"animate-pulse text-4xl",children:"👤"})]});default:return m.jsx("div",{className:"animate-pulse text-6xl",children:"🏋️"})}};return m.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex flex-col items-center justify-center",children:m.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full",children:[m.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:a.name}),m.jsx("div",{className:"aspect-video bg-gray-100 rounded-md mb-6 flex items-center justify-center",children:n?m.jsx("div",{className:"animate-spin h-12 w-12 border-4 border-formfit-blue border-t-transparent rounded-full"}):a.animationUrl?m.jsx("img",{src:a.animationUrl,alt:`Animação de ${a.name}`,className:"w-full h-full object-contain"}):s()}),m.jsxs("div",{className:"text-center mb-6",children:[m.jsx("h3",{className:"font-medium mb-2",children:"Como executar:"}),m.jsxs("ul",{className:"text-gray-700 text-left list-disc pl-5 space-y-1",children:[m.jsx("li",{children:"Posicione-se frente à câmera"}),m.jsx("li",{children:a.positioningInstructions||"Afaste-se para a câmera ver o movimento completo"}),m.jsx("li",{children:"Execute o movimento com controle"}),m.jsx("li",{children:"Mantenha a postura durante todo o exercício"})]})]}),m.jsxs(pe,{onClick:e,className:"w-full bg-formfit-blue hover:bg-formfit-blue/90",size:"lg",children:[m.jsx(ko,{className:"mr-2 h-5 w-5"}),"Iniciar Exercício"]})]})})};function wLe(t,e=[]){let n=[];function r(s,o){const i=N.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:f,children:h,...p}=d,g=(f==null?void 0:f[t][l])||i,y=N.useMemo(()=>p,Object.values(p));return m.jsx(g.Provider,{value:y,children:h})}function c(d,f){const h=(f==null?void 0:f[t][l])||i,p=N.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const a=()=>{const s=n.map(o=>N.createContext(o));return function(i){const l=(i==null?void 0:i[t])||s;return N.useMemo(()=>({[`__scope${t}`]:{...i,[t]:l}}),[i,l])}};return a.scopeName=t,[r,SLe(a,...e)]}function SLe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const o=r.reduce((i,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...i,...d}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var CLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],nn=CLe.reduce((t,e)=>{const n=N.forwardRef((r,a)=>{const{asChild:s,...o}=r,i=s?Lf:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(i,{...o,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function fK(t,e){t&&gS.flushSync(()=>t.dispatchEvent(e))}var qP="Progress",KP=100,[_Le,zpt]=wLe(qP),[$Le,kLe]=_Le(qP),hK=N.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:s=NLe,...o}=t;(a||a===0)&&!Yj(a)&&console.error(ILe(`${a}`,"Progress"));const i=Yj(a)?a:KP;r!==null&&!Qj(r,i)&&console.error(TLe(`${r}`,"Progress"));const l=Qj(r,i)?r:null,u=Xw(l)?s(l,i):void 0;return m.jsx($Le,{scope:n,value:l,max:i,children:m.jsx(nn.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":Xw(l)?l:void 0,"aria-valuetext":u,role:"progressbar","data-state":gK(l,i),"data-value":l??void 0,"data-max":i,...o,ref:e})})});hK.displayName=qP;var pK="ProgressIndicator",mK=N.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,a=kLe(pK,n);return m.jsx(nn.div,{"data-state":gK(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:e})});mK.displayName=pK;function NLe(t,e){return`${Math.round(t/e*100)}%`}function gK(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Xw(t){return typeof t=="number"}function Yj(t){return Xw(t)&&!isNaN(t)&&t>0}function Qj(t,e){return Xw(t)&&!isNaN(t)&&t<=e&&t>=0}function ILe(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${KP}\`.`}function TLe(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${KP} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var yK=hK,ELe=mK;const Ol=N.forwardRef(({className:t,value:e,indicatorClassName:n,...r},a)=>m.jsx(yK,{ref:a,className:fn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:m.jsx(ELe,{className:fn("h-full w-full flex-1 bg-primary transition-all",n),style:{transform:`translateX(-${100-(e||0)}%)`}})}));Ol.displayName=yK.displayName;const vK=({elapsedTime:t,repStats:e,series:n})=>{const r=i=>{const l=Math.floor(i/60),u=i%60;return`${l.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`},a=e.total>0?e.good/e.total*100:0,s=e.total>0?e.average/e.total*100:0,o=e.total>0?e.poor/e.total*100:0;return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsxs(bn,{children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{className:"text-sm font-medium",children:"Tempo de Treino"})}),m.jsx(Cn,{children:m.jsx("div",{className:"text-2xl font-bold",children:r(t)})})]}),m.jsxs(bn,{children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{className:"text-sm font-medium",children:"Séries Completadas"})}),m.jsxs(Cn,{children:[m.jsxs("div",{className:"text-2xl font-bold",children:[n,"/3"]}),m.jsx(Ol,{value:n*33.33,className:"h-2 mt-2"})]})]}),m.jsxs(bn,{children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{className:"text-sm font-medium",children:"Repetições"})}),m.jsx(Cn,{children:m.jsx("div",{className:"text-2xl font-bold",children:e.total})})]})]}),m.jsxs(bn,{children:[m.jsx(wn,{children:m.jsx(Sn,{children:"Qualidade das Repetições"})}),m.jsxs(Cn,{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"h-4 w-4 rounded-full bg-green-500 mr-2"}),m.jsx("span",{children:"Boa execução"})]}),m.jsxs("span",{className:"font-medium",children:[e.good," (",Math.round(a),"%)"]})]}),m.jsx(Ol,{value:a,className:"h-2 bg-gray-200",indicatorClassName:"bg-green-500"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"h-4 w-4 rounded-full bg-yellow-500 mr-2"}),m.jsx("span",{children:"Execução razoável"})]}),m.jsxs("span",{className:"font-medium",children:[e.average," (",Math.round(s),"%)"]})]}),m.jsx(Ol,{value:s,className:"h-2 bg-gray-200",indicatorClassName:"bg-yellow-500"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx("div",{className:"h-4 w-4 rounded-full bg-red-500 mr-2"}),m.jsx("span",{children:"Execução a melhorar"})]}),m.jsxs("span",{className:"font-medium",children:[e.poor," (",Math.round(o),"%)"]})]}),m.jsx(Ol,{value:o,className:"h-2 bg-gray-200",indicatorClassName:"bg-red-500"})]})]})]}),m.jsxs(bn,{children:[m.jsx(wn,{children:m.jsx(Sn,{children:"Linha do Tempo do Treino"})}),m.jsx(Cn,{children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:m.jsxs("div",{className:"flex h-full",children:[m.jsx("div",{className:"bg-green-500 h-full",style:{width:`${a}%`}}),m.jsx("div",{className:"bg-yellow-500 h-full",style:{width:`${s}%`}}),m.jsx("div",{className:"bg-red-500 h-full",style:{width:`${o}%`}})]})}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[m.jsx("span",{children:"Início"}),m.jsx("span",{children:r(Math.floor(t/2))}),m.jsx("span",{children:"Final"})]})]})})]})]})},ALe="modulepreload",PLe=function(t){return"/virtual-move-coach/"+t},Jj={},ru=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(l=>{if(l=PLe(l),l in Jj)return;Jj[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":ALe,u||(d.as="script"),d.crossOrigin="",d.href=l,i&&d.setAttribute("nonce",i),document.head.appendChild(d),u)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return a.then(o=>{for(const i of o||[])i.status==="rejected"&&s(i.reason);return e().catch(s)})},OLe=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ru(async()=>{const{default:r}=await Promise.resolve().then(()=>Vp);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class XP extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class RLe extends XP{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class DLe extends XP{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class jLe extends XP{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var RN;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(RN||(RN={}));var MLe=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};class FLe{constructor(e,{headers:n={},customFetch:r,region:a=RN.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=OLe(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return MLe(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:o}=n;let i={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(i["x-region"]=l);let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(i["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(i["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),a),body:u}).catch(p=>{throw new RLe(p)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new DLe(c);if(!c.ok)throw new jLe(c);let f=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),h;return f==="application/json"?h=yield c.json():f==="application/octet-stream"?h=yield c.blob():f==="text/event-stream"?h=c:f==="multipart/form-data"?h=yield c.formData():h=yield c.text(),{data:h,error:null}}catch(a){return{data:null,error:a}}})}}var Ha={},YP={},O2={},ab={},R2={},D2={},LLe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Zf=LLe();const BLe=Zf.fetch,xK=Zf.fetch.bind(Zf),bK=Zf.Headers,zLe=Zf.Request,ULe=Zf.Response,Vp=Object.freeze(Object.defineProperty({__proto__:null,Headers:bK,Request:zLe,Response:ULe,default:xK,fetch:BLe},Symbol.toStringTag,{value:"Module"})),VLe=A4(Vp);var j2={};Object.defineProperty(j2,"__esModule",{value:!0});let WLe=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};j2.default=WLe;var wK=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(D2,"__esModule",{value:!0});const GLe=wK(VLe),HLe=wK(j2);let qLe=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=GLe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,i,l;let u=null,c=null,d=null,f=s.status,h=s.statusText;if(s.ok){if(this.method!=="HEAD"){const v=await s.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=v:c=JSON.parse(v))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(i=s.headers.get("content-range"))===null||i===void 0?void 0:i.split("/");g&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,f=406,h="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(c=[],u=null,f=200,h="OK")}catch{s.status===404&&g===""?(f=204,h="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,f=200,h="OK"),u&&this.shouldThrowOnError)throw new HLe.default(u)}return{error:u,data:c,count:d,status:f,statusText:h}});return this.shouldThrowOnError||(a=a.catch(s=>{var o,i,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(i=s==null?void 0:s.stack)!==null&&i!==void 0?i:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};D2.default=qLe;var KLe=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(R2,"__esModule",{value:!0});const XLe=KLe(D2);let YLe=class extends XLe.default{select(e){let n=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const o=s?`${s}.order`:"order",i=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${i?`${i},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:o="text"}={}){var i;const l=[e?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(i=this.headers.Accept)!==null&&i!==void 0?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};R2.default=YLe;var QLe=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ab,"__esModule",{value:!0});const JLe=QLe(R2);let ZLe=class extends JLe.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};ab.default=ZLe;var eBe=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(O2,"__esModule",{value:!0});const Om=eBe(ab);let tBe=class{constructor(e,{headers:n={},schema:r,fetch:a}){this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(i=>/\s/.test(i)&&!s?"":(i==='"'&&(s=!s),i)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Om.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),r||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((i,l)=>i.concat(Object.keys(l)),[]);if(o.length>0){const i=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",i.join(","))}}return new Om.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){const o="POST",i=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&i.push(this.headers.Prefer),a&&i.push(`count=${a}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Om.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new Om.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Om.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};O2.default=tBe;var M2={},F2={};Object.defineProperty(F2,"__esModule",{value:!0});F2.version=void 0;F2.version="0.0.0-automated";Object.defineProperty(M2,"__esModule",{value:!0});M2.DEFAULT_HEADERS=void 0;const nBe=F2;M2.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${nBe.version}`};var SK=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(YP,"__esModule",{value:!0});const rBe=SK(O2),aBe=SK(ab),sBe=M2;let oBe=class CK{constructor(e,{headers:n={},schema:r,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},sBe.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new rBe.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new CK(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:a=!1,count:s}={}){let o;const i=new URL(`${this.url}/rpc/${e}`);let l;r||a?(o=r?"HEAD":"GET",Object.entries(n).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{i.searchParams.append(c,d)})):(o="POST",l=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new aBe.default({method:o,url:i,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};YP.default=oBe;var Wp=gn&&gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ha,"__esModule",{value:!0});Ha.PostgrestError=Ha.PostgrestBuilder=Ha.PostgrestTransformBuilder=Ha.PostgrestFilterBuilder=Ha.PostgrestQueryBuilder=Ha.PostgrestClient=void 0;const _K=Wp(YP);Ha.PostgrestClient=_K.default;const $K=Wp(O2);Ha.PostgrestQueryBuilder=$K.default;const kK=Wp(ab);Ha.PostgrestFilterBuilder=kK.default;const NK=Wp(R2);Ha.PostgrestTransformBuilder=NK.default;const IK=Wp(D2);Ha.PostgrestBuilder=IK.default;const TK=Wp(j2);Ha.PostgrestError=TK.default;var iBe=Ha.default={PostgrestClient:_K.default,PostgrestQueryBuilder:$K.default,PostgrestFilterBuilder:kK.default,PostgrestTransformBuilder:NK.default,PostgrestBuilder:IK.default,PostgrestError:TK.default};const{PostgrestClient:lBe,PostgrestQueryBuilder:qpt,PostgrestFilterBuilder:Kpt,PostgrestTransformBuilder:Xpt,PostgrestBuilder:Ypt,PostgrestError:Qpt}=iBe,uBe="2.11.2",cBe={"X-Client-Info":`realtime-js/${uBe}`},dBe="1.0.0",EK=1e4,fBe=1e3;var Nf;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Nf||(Nf={}));var is;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(is||(is={}));var mo;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(mo||(mo={}));var DN;(function(t){t.websocket="websocket"})(DN||(DN={}));var Yu;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Yu||(Yu={}));class hBe{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const i=r.decode(e.slice(o,o+a));o=o+a;const l=r.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:i,event:l,payload:u}}}class AK{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Nn||(Nn={}));const Zj=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,o)=>(s[o]=pBe(o,t,e,a),s),{})},pBe=(t,e,n,r)=>{const a=e.find(i=>i.name===t),s=a==null?void 0:a.type,o=n[t];return s&&!r.includes(s)?PK(s,o):jN(o)},PK=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return vBe(e,n)}switch(t){case Nn.bool:return mBe(e);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return gBe(e);case Nn.json:case Nn.jsonb:return yBe(e);case Nn.timestamp:return xBe(e);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return jN(e);default:return jN(e)}},jN=t=>t,mBe=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},gBe=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},yBe=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},vBe=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(i=>PK(e,i))}return t},xBe=t=>typeof t=="string"?t.replace(" ","T"):t,OK=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class G_{constructor(e,n,r={},a=EK){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var eM;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(eM||(eM={}));class gg{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:s,onLeave:o,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gg.syncState(this.state,a,s,o),this.pendingDiffs.forEach(l=>{this.state=gg.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},a=>{const{onJoin:s,onLeave:o,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=gg.syncDiff(this.state,a,s,o),i())}),this.onJoin((a,s,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:o})}),this.onLeave((a,s,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const s=this.cloneDeep(e),o=this.transformState(n),i={},l={};return this.map(s,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const d=s[u];if(d){const f=c.map(y=>y.presence_ref),h=d.map(y=>y.presence_ref),p=c.filter(y=>h.indexOf(y.presence_ref)<0),g=d.filter(y=>f.indexOf(y.presence_ref)<0);p.length>0&&(i[u]=p),g.length>0&&(l[u]=g)}else i[u]=c}),this.syncDiff(s,{joins:i,leaves:l},r,a)}static syncDiff(e,n,r,a){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(i,l)=>{var u;const c=(u=e[i])!==null&&u!==void 0?u:[];if(e[i]=this.cloneDeep(l),c.length>0){const d=e[i].map(h=>h.presence_ref),f=c.filter(h=>d.indexOf(h.presence_ref)<0);e[i].unshift(...f)}r(i,c,l)}),this.map(o,(i,l)=>{let u=e[i];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[i]=u,a(i,u,l),u.length===0&&delete e[i]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tM;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(tM||(tM={}));var nM;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(nM||(nM={}));var Ci;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ci||(Ci={}));class QP{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=is.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new G_(this,mo.join,this.params,this.timeout),this.rejoinTimer=new AK(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=is.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=is.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=is.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=is.errored,this.rejoinTimer.scheduleTimeout())}),this._on(mo.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new gg(this),this.broadcastEndpointURL=OK(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:i}}=this.params;this._onError(c=>e==null?void 0:e(Ci.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(Ci.CLOSED));const l={},u={broadcast:s,presence:o,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&a!==void 0?a:[],private:i};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e==null||e(Ci.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,h=(d=f==null?void 0:f.length)!==null&&d!==void 0?d:0,p=[];for(let g=0;g<h;g++){const y=f[g],{filter:{event:v,schema:x,table:b,filter:w}}=y,C=c&&c[g];if(C&&C.event===v&&C.schema===x&&C.table===b&&C.filter===w)p.push(Object.assign(Object.assign({},y),{id:C.id}));else{this.unsubscribe(),e==null||e(Ci.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(Ci.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(Ci.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ci.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,i,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(i=(o=this.params)===null||o===void 0?void 0:o.config)===null||i===void 0?void 0:i.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=is.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(mo.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const a=new G_(this,mo.leave,{},e);a.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(s),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new G_(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,s;const o=e.toLocaleLowerCase(),{close:i,error:l,leave:u,join:c}=mo;if(r&&[i,l,u,c].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var p,g,y;return((p=h.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(g=h.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(h=>h.callback(f,r)):(s=this.bindings[o])===null||s===void 0||s.filter(h=>{var p,g,y,v,x,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const w=h.id,C=(p=h.filter)===null||p===void 0?void 0:p.event;return w&&((g=n.ids)===null||g===void 0?void 0:g.includes(w))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const w=(x=(v=h==null?void 0:h.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return w==="*"||w===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:g,table:y,commit_timestamp:v,type:x,errors:b}=p;f=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:v,eventType:x,new:{},old:{},errors:b}),this._getPayloadRecords(p))}h.callback(f,r)})}_isClosed(){return this.state===is.closed}_isJoined(){return this.state===is.joined}_isJoining(){return this.state===is.joining}_isLeaving(){return this.state===is.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),s={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&QP.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(mo.close,{},e)}_onError(e){this._on(mo.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=is.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Zj(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Zj(e.columns,e.old_record)),n}}const bBe=()=>{},wBe=typeof WebSocket<"u",SBe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class CBe{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=cBe,this.params={},this.timeout=EK,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=bBe,this.conn=null,this.sendBuffer=[],this.serializer=new hBe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...i)=>ru(async()=>{const{default:l}=await Promise.resolve().then(()=>Vp);return{default:l}},void 0).then(({default:l})=>l(...i)):o=fetch,(...i)=>o(...i)},this.endPoint=`${e}/${DN.websocket}`,this.httpEndpoint=OK(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new AK(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(wBe){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new _Be(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ru(async()=>{const{default:e}=await import("./browser-DAQ1igi4.js").then(n=>n.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dBe}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Nf.connecting:return Yu.Connecting;case Nf.open:return Yu.Open;case Nf.closing:return Yu.Closing;default:return Yu.Closed}}isConnected(){return this.connectionState()===Yu.Open}channel(e,n={config:{}}){const r=new QP(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:a,ref:s}=e,o=()=>{this.encode(e,i=>{var l;(l=this.conn)===null||l===void 0||l.send(i)})};this.log("push",`${n} ${r} (${s})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(a=>{n&&a.updateJoinPayload({access_token:n}),a.joinedOnce&&a._isJoined()&&a._push(mo.access_token,{access_token:n})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(fBe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:s,ref:o}=n;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${a} ${o&&"("+o+")"||""}`,s),this.channels.filter(i=>i._isMember(r)).forEach(i=>i._trigger(a,s,o)),this.stateChangeCallbacks.message.forEach(i=>i(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(mo.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([SBe],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class _Be{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Nf.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class JP extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Tr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class $Be extends JP{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class MN extends JP{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var kBe=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};const RK=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ru(async()=>{const{default:r}=await Promise.resolve().then(()=>Vp);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},NBe=()=>kBe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ru(()=>Promise.resolve().then(()=>Vp),void 0)).Response:Response}),FN=t=>{if(Array.isArray(t))return t.map(n=>FN(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[a]=FN(r)}),e};var pd=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};const H_=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),IBe=(t,e,n)=>pd(void 0,void 0,void 0,function*(){const r=yield NBe();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new $Be(H_(a),t.status||500))}).catch(a=>{e(new MN(H_(a),a))}):e(new MN(H_(t),t))}),TBe=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function sb(t,e,n,r,a,s){return pd(this,void 0,void 0,function*(){return new Promise((o,i)=>{t(n,TBe(e,r,a,s)).then(l=>{if(!l.ok)throw l;return r!=null&&r.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>IBe(l,i,r))})})}function Yw(t,e,n,r){return pd(this,void 0,void 0,function*(){return sb(t,"GET",e,n,r)})}function xl(t,e,n,r,a){return pd(this,void 0,void 0,function*(){return sb(t,"POST",e,r,a,n)})}function EBe(t,e,n,r,a){return pd(this,void 0,void 0,function*(){return sb(t,"PUT",e,r,a,n)})}function ABe(t,e,n,r){return pd(this,void 0,void 0,function*(){return sb(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function DK(t,e,n,r,a){return pd(this,void 0,void 0,function*(){return sb(t,"DELETE",e,r,a,n)})}var La=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};const PBe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class OBe{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=RK(a)}uploadOrUpdate(e,n,r,a){return La(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},rM),a);let i=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=r,i["cache-control"]=`max-age=${o.cacheControl}`,i["content-type"]=o.contentType,l&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(i=Object.assign(Object.assign({},i),a.headers));const u=this._removeEmptyFolders(n),c=this._getFinalPath(u),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:i},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield d.json();return d.ok?{data:{path:u,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(s){if(Tr(s))return{data:null,error:s};throw s}})}upload(e,n,r){return La(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return La(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),i=new URL(this.url+`/object/upload/sign/${o}`);i.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:rM.upsert},a),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(i.toString(),{method:"PUT",body:l,headers:c}),f=yield d.json();return d.ok?{data:{path:s,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(Tr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return La(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const s=yield xl(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+s.url),i=o.searchParams.get("token");if(!i)throw new JP("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:i},error:null}}catch(r){if(Tr(r))return{data:null,error:r};throw r}})}update(e,n,r){return La(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return La(this,void 0,void 0,function*(){try{return{data:yield xl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Tr(a))return{data:null,error:a};throw a}})}copy(e,n,r){return La(this,void 0,void 0,function*(){try{return{data:{path:(yield xl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Tr(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return La(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),s=yield xl(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(a){if(Tr(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return La(this,void 0,void 0,function*(){try{const a=yield xl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(a){if(Tr(a))return{data:null,error:a};throw a}})}download(e,n){return La(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const i=this._getFinalPath(e);return{data:yield(yield Yw(this.fetch,`${this.url}/${a}/${i}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(i){if(Tr(i))return{data:null,error:i};throw i}})}info(e){return La(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Yw(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:FN(r),error:null}}catch(r){if(Tr(r))return{data:null,error:r};throw r}})}exists(e){return La(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield ABe(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Tr(r)&&r instanceof MN){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&a.push(s);const i=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&a.push(l);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${u}`)}}}remove(e){return La(this,void 0,void 0,function*(){try{return{data:yield DK(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Tr(n))return{data:null,error:n};throw n}})}list(e,n,r){return La(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},PBe),n),{prefix:e||""});return{data:yield xl(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Tr(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const RBe="2.7.1",DBe={"X-Client-Info":`storage-js/${RBe}`};var jd=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};class jBe{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},DBe),n),this.fetch=RK(r)}listBuckets(){return jd(this,void 0,void 0,function*(){try{return{data:yield Yw(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Tr(e))return{data:null,error:e};throw e}})}getBucket(e){return jd(this,void 0,void 0,function*(){try{return{data:yield Yw(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Tr(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return jd(this,void 0,void 0,function*(){try{return{data:yield xl(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Tr(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return jd(this,void 0,void 0,function*(){try{return{data:yield EBe(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Tr(r))return{data:null,error:r};throw r}})}emptyBucket(e){return jd(this,void 0,void 0,function*(){try{return{data:yield xl(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Tr(n))return{data:null,error:n};throw n}})}deleteBucket(e){return jd(this,void 0,void 0,function*(){try{return{data:yield DK(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Tr(n))return{data:null,error:n};throw n}})}}class MBe extends jBe{constructor(e,n={},r){super(e,n,r)}from(e){return new OBe(this.url,this.headers,e,this.fetch)}}const FBe="2.49.4";let rg="";typeof Deno<"u"?rg="deno":typeof document<"u"?rg="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rg="react-native":rg="node";const LBe={"X-Client-Info":`supabase-js-${rg}/${FBe}`},BBe={headers:LBe},zBe={schema:"public"},UBe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},VBe={};var WBe=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};const GBe=t=>{let e;return t?e=t:typeof fetch>"u"?e=xK:e=fetch,(...n)=>e(...n)},HBe=()=>typeof Headers>"u"?bK:Headers,qBe=(t,e,n)=>{const r=GBe(n),a=HBe();return(s,o)=>WBe(void 0,void 0,void 0,function*(){var i;const l=(i=yield e())!==null&&i!==void 0?i:t;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),r(s,Object.assign(Object.assign({},o),{headers:u}))})};var KBe=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};function XBe(t){return t.replace(/\/$/,"")}function YBe(t,e){const{db:n,auth:r,realtime:a,global:s}=t,{db:o,auth:i,realtime:l,global:u}=e,c={db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},i),r),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},u),s),accessToken:()=>KBe(this,void 0,void 0,function*(){return""})};return t.accessToken?c.accessToken=t.accessToken:delete c.accessToken,c}const jK="2.69.1",Xd=30*1e3,LN=3,q_=LN*Xd,QBe="http://localhost:9999",JBe="supabase.auth.token",ZBe={"X-Client-Info":`gotrue-js/${jK}`},BN="X-Supabase-Api-Version",MK={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},e4e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,t4e=6e5;class ZP extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function _t(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class n4e extends ZP{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function r4e(t){return _t(t)&&t.name==="AuthApiError"}class FK extends ZP{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class yu extends ZP{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class hl extends yu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function a4e(t){return _t(t)&&t.name==="AuthSessionMissingError"}class K_ extends yu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class a0 extends yu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class s0 extends yu{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function s4e(t){return _t(t)&&t.name==="AuthImplicitGrantRedirectError"}class aM extends yu{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class zN extends yu{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function X_(t){return _t(t)&&t.name==="AuthRetryableFetchError"}class sM extends yu{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class yg extends yu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const oM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),iM=` 	
\r=`.split(""),o4e=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<iM.length;e+=1)t[iM[e].charCodeAt(0)]=-2;for(let e=0;e<oM.length;e+=1)t[oM[e].charCodeAt(0)]=e;return t})();function LK(t,e,n){const r=o4e[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function lM(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=o=>{u4e(o,r,n)};for(let o=0;o<t.length;o+=1)LK(t.charCodeAt(o),a,s);return e.join("")}function i4e(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function l4e(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}i4e(r,e)}}function u4e(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function c4e(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)LK(t.charCodeAt(a),n,r);return new Uint8Array(e)}function d4e(t){const e=[];return l4e(t,n=>e.push(n)),new Uint8Array(e)}function f4e(t){return Math.round(Date.now()/1e3)+t}function h4e(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Uo=()=>typeof window<"u"&&typeof document<"u",Ou={tested:!1,writable:!1},vg=()=>{if(!Uo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ou.tested)return Ou.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ou.tested=!0,Ou.writable=!0}catch{Ou.tested=!0,Ou.writable=!1}return Ou.writable};function p4e(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,s)=>{e[s]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const BK=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ru(async()=>{const{default:r}=await Promise.resolve().then(()=>Vp);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},m4e=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",zK=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},o0=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},i0=async(t,e)=>{await t.removeItem(e)};class L2{constructor(){this.promise=new L2.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}L2.promiseConstructor=Promise;function Y_(t){const e=t.split(".");if(e.length!==3)throw new yg("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!e4e.test(e[r]))throw new yg("JWT not in base64url format");return{header:JSON.parse(lM(e[0])),payload:JSON.parse(lM(e[1])),signature:c4e(e[2]),raw:{header:e[0],payload:e[1]}}}async function g4e(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function y4e(t,e){return new Promise((r,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){a(o);return}}})()})}function v4e(t){return("0"+t.toString(16)).substr(-2)}function x4e(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let s=0;s<56;s++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,v4e).join("")}async function b4e(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function w4e(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await b4e(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Md(t,e,n=!1){const r=x4e();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await zK(t,`${e}-code-verifier`,a);const s=await w4e(r);return[s,r===s?"plain":"s256"]}const S4e=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function C4e(t){const e=t.headers.get(BN);if(!e||!e.match(S4e))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function _4e(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function $4e(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var k4e=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const zu=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),N4e=[502,503,504];async function uM(t){var e;if(!m4e(t))throw new zN(zu(t),0);if(N4e.includes(t.status))throw new zN(zu(t),t.status);let n;try{n=await t.json()}catch(s){throw new FK(zu(s),s)}let r;const a=C4e(t);if(a&&a.getTime()>=MK["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new sM(zu(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new hl}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new sM(zu(n),t.status,n.weak_password.reasons);throw new n4e(zu(n),t.status||500,r)}const I4e=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function At(t,e,n,r){var a;const s=Object.assign({},r==null?void 0:r.headers);s[BN]||(s[BN]=MK["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const i=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await T4e(t,e,n+i,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(l):{data:Object.assign({},l),error:null}}async function T4e(t,e,n,r,a,s){const o=I4e(e,r,a,s);let i;try{i=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new zN(zu(l),0)}if(i.ok||await uM(i),r!=null&&r.noResolveJson)return i;try{return await i.json()}catch(l){await uM(l)}}function pl(t){var e;let n=null;O4e(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=f4e(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function cM(t){const e=pl(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function $l(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function E4e(t){return{data:t,error:null}}function A4e(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s}=t,o=k4e(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),i={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s},l=Object.assign({},o);return{data:{properties:i,user:l},error:null}}function P4e(t){return t}function O4e(t){return t.access_token&&t.refresh_token&&t.expires_in}var R4e=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class D4e{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=BK(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:$l})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=R4e(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:A4e,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(_t(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$l})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,s,o,i,l;try{const u={nextPage:null,lastPage:0,total:0},c=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:P4e});if(c.error)throw c.error;const d=await c.json(),f=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(l=(i=c.headers.get("link"))===null||i===void 0?void 0:i.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(_t(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await At(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$l})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:$l})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:$l})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await At(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(_t(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}}}const j4e={getItem:t=>vg()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{vg()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{vg()&&globalThis.localStorage.removeItem(t)}};function dM(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function M4e(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fd={debug:!!(globalThis&&vg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class UK extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class F4e extends UK{}async function L4e(t,e,n){Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Fd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new F4e(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Fd.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}M4e();const B4e={url:QBe,storageKey:JBe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ZBe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function fM(t,e,n){return await n()}class vy{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=vy.nextInstanceID,vy.nextInstanceID+=1,this.instanceID>0&&Uo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},B4e),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new D4e({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=BK(a.fetch),this.lock=a.lock||fM,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Uo()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=L4e:this.lock=fM,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:vg()?this.storage=j4e:(this.memoryStorage={},this.storage=dM(this.memoryStorage)):(this.memoryStorage={},this.storage=dM(this.memoryStorage)),Uo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${jK}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=p4e(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Uo()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),s4e(s)){const l=(e=s.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:i}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",i),await this._saveSession(o),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return _t(n)?{error:n}:{error:new FK("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const s=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:pl}),{data:o,error:i}=s;if(i||!o)return{data:{user:null,session:null},error:i};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(_t(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,a;try{let s;if("email"in e){const{email:c,password:d,options:f}=e;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await Md(this.storage,this.storageKey)),s=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:c,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:p},xform:pl})}else if("phone"in e){const{phone:c,password:d,options:f}=e;s=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:pl})}else throw new a0("You must provide either an email or phone number and a password");const{data:o,error:i}=s;if(i||!o)return{data:{user:null,session:null},error:i};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(_t(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:o,options:i}=e;n=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:cM})}else if("phone"in e){const{phone:s,password:o,options:i}=e;n=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:cM})}else throw new a0("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new K_}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(_t(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await o0(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:s,error:o}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:pl});if(await i0(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new K_}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:o})}catch(s){if(_t(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:s,nonce:o}=e,i=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:pl}),{data:l,error:u}=i;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new K_}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(_t(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,s,o;try{if("email"in e){const{email:i,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Md(this.storage,this.storageKey));const{error:d}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:i,options:l}=e,{data:u,error:c}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:i,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new a0("You must provide either an email or phone number.")}catch(i){if(_t(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var n,r;try{let a,s;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:i}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:pl});if(i)throw i;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(a){if(_t(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Md(this.storage,this.storageKey)),await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:E4e})}catch(s){if(_t(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new hl;const{error:a}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(_t(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:s}=e,{error:o}=await At(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:s}=e,{data:o,error:i}=await At(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:i}}throw new a0("You must provide either an email or phone number and a type")}catch(n){if(_t(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await o0(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<q_:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,c)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,c))})}return{data:{session:e},error:null}}const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$l}):await this._useSession(async n=>{var r,a,s;const{data:o,error:i}=n;if(i)throw i;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new hl}:await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:$l})})}catch(n){if(_t(n))return a4e(n)&&(await this._removeSession(),await i0(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new hl;const o=a.session;let i=null,l=null;this.flowType==="pkce"&&e.email!=null&&([i,l]=await Md(this.storage,this.storageKey));const{data:u,error:c}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:l}),jwt:o.access_token,xform:$l});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new hl;const n=Date.now()/1e3;let r=n,a=!0,s=null;const{payload:o}=Y_(e.access_token);if(o.exp&&(r=o.exp,a=r<=n),a){const{session:i,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!i)return{data:{user:null,session:null},error:null};s=i}else{const{data:i,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(_t(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:i}=n;if(i)throw i;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new hl;const{session:a,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(_t(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Uo())throw new s0("No browser detected.");if(e.error||e.error_description||e.error_code)throw new s0(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new aM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new s0("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new aM("No code detected.");const{data:x,error:b}=await this._exchangeCodeForSession(e.code);if(b)throw b;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:o,expires_in:i,expires_at:l,token_type:u}=e;if(!s||!i||!o||!u)throw new s0("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let f=c+d;l&&(f=parseInt(l));const h=f-c;h*1e3<=Xd&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const p=f-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,c);const{data:g,error:y}=await this._getUser(s);if(y)throw y;const v={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(r){if(_t(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await o0(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{error:s};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:i}=await this.admin.signOut(o,e);if(i&&!(r4e(i)&&(i.status===404||i.status===401||i.status===403)))return{error:i}}return e!=="others"&&(await this._removeSession(),await i0(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=h4e(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:s},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Md(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(_t(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async s=>{var o,i,l,u,c;const{data:d,error:f}=s;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",h,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(a)throw a;return Uo()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(_t(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:o}=n;if(o)throw o;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(_t(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await y4e(async a=>(a>0&&await g4e(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pl})),(a,s)=>{const o=200*Math.pow(2,a);return s&&X_(s)&&Date.now()+o-r<Xd})}catch(r){if(this._debug(n,"error",r),_t(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Uo()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await o0(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<q_;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${q_}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:s}=await this._callRefreshToken(r.refresh_token);s&&(console.error(s),X_(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new hl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new L2;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new hl;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const i={session:s.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(s){if(this._debug(a,"error",s),_t(s)){const o={session:null,error:s};return X_(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async i=>{try{await i.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let i=0;i<s.length;i+=1)console.error(s[i]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await zK(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await i0(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Uo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xd);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Xd);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Xd}ms, refresh threshold is ${LN} ticks`),a<=LN&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof UK)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Uo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await Md(this.storage,this.storageKey),i=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(i.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);a.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await At(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(_t(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:s,error:o}=n;if(o)return{data:null,error:o};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await At(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(_t(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:i}=await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:i})})}catch(n){if(_t(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:s}=n;return s?{data:null,error:s}:await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(_t(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:s}=e;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Y_(a.access_token);let i=null;o.aal&&(i=o.aal);let l=i;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+t4e>Date.now()))return r;const{data:a,error:s}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new yg("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(o=>o.kid===e),!r)throw new yg("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:h,error:p}=await this.getSession();if(p||!h.session)return{data:null,error:p};r=h.session.access_token}const{header:a,payload:s,signature:o,raw:{header:i,payload:l}}=Y_(r);if(_4e(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(r);if(h)throw h;return{data:{claims:s,header:a,signature:o},error:null}}const u=$4e(a.alg),c=await this.fetchJwk(a.kid,n),d=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,d,o,d4e(`${i}.${l}`)))throw new yg("Invalid JWT signature");return{data:{claims:s,header:a,signature:o},error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}}}vy.nextInstanceID=0;const z4e=vy;class U4e extends z4e{constructor(e){super(e)}}var V4e=function(t,e,n,r){function a(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(d){o(d)}}function l(c){try{u(r.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):a(c.value).then(i,l)}u((r=r.apply(t,e||[])).next())})};class W4e{constructor(e,n,r){var a,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const i=XBe(e);this.realtimeUrl=`${i}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${i}/auth/v1`,this.storageUrl=`${i}/storage/v1`,this.functionsUrl=`${i}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:zBe,realtime:VBe,auth:Object.assign(Object.assign({},UBe),{storageKey:l}),global:BBe},c=YBe(r??{},u);this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=qBe(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new lBe(`${i}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new FLe(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new MBe(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return V4e(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:s,flowType:o,lock:i,debug:l},u,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new U4e({url:this.authUrl,headers:Object.assign(Object.assign({},d),u),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:o,lock:i,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new CBe(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const G4e=(t,e,n)=>new W4e(t,e,n),H4e="https://ukyfemahvtnezynwxpjt.supabase.co",q4e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVreWZlbWFodnRuZXp5bnd4cGp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDczMDM3MTcsImV4cCI6MjA2Mjg3OTcxN30.fCkOm5u3nP2k6Bdi19DBtR63NT1L8WmJjUvuvXGJ6kg",Pt=G4e(H4e,q4e);async function VK({userId:t,totalTime:e,xp:n,exercises:r}){const{data:a,error:s}=await Pt.from("workout_history").insert({user_id:t,total_time:e,xp:n}).select().single();if(s)throw s;for(const o of r)for(const i of o.sets){const{data:l,error:u}=await Pt.from("workout_sets").insert({workout_id:a.id,exercise_name:o.name,modelo:o.modelo||null,carga:o.carga??null,series_number:i.seriesNumber,repetitions:i.repetitions,completed:i.completed}).select().single();if(u)throw u;for(const c of i.metrics){const{error:d}=await Pt.from("workout_metrics").insert({set_id:l.id,repetition_number:c.repetitionNumber,quality:c.quality,duration_seconds:c.duration_seconds,extra_data:c.extra_data||null});if(d)throw d}}return!0}const K4e=[{nome:"Treinos por semana",valor:2},{nome:"Tempo médio por treino",valor:"35 min"},{nome:"Áreas mais treinadas",valor:"Pernas, Braços"},{nome:"Séries por treino",valor:12}],X4e=[{nome:"Treinos recomendados por semana",valor:3},{nome:"Tempo recomendado por treino",valor:"45 min"},{nome:"Áreas a focar",valor:"Costas, Abdômen"},{nome:"Séries recomendadas",valor:15}],Y4e=["Casa","Academia","Ar livre"],Q4e=[2,3,4,5,6],Ea=["Iniciante","Resistência","Aesthetics","Glúteos +","IFBB Pro","Pilates Slim"],J4e=[{area:"Pernas",exercicios:["Agachamento","Avanço","Leg Press"]},{area:"Braços",exercicios:["Rosca Bíceps","Tríceps"]},{area:"Peito",exercicios:["Supino","Flexão de Braço"]}],Z4e=[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}],eze=()=>{const[t,e]=N.useState("Casa"),[n,r]=N.useState(0),[a,s]=N.useState(!0),[o,i]=N.useState(3),[l,u]=N.useState("Iniciante");N.useState("form");const[c,d]=N.useState(null),[f,h]=N.useState(null),[p,g]=N.useState(()=>{if(typeof window<"u"){const re=localStorage.getItem("treinosIA");return re?JSON.parse(re):[]}return[]}),[y,v]=N.useState(null);N.useState(!1);const[x,b]=N.useState(!1),[w,C]=N.useState(!1),[_,$]=N.useState(()=>{if(typeof window<"u"){const re=localStorage.getItem("mesesDesbloqueados");return re?JSON.parse(re):[1]}return[1]}),[k,A]=N.useState(""),[P,O]=N.useState({}),[R,B]=N.useState(null),[F,L]=N.useState(Ea[0]),[H,te]=N.useState(0),[V,Q]=N.useState(!0),se=zn();N.useEffect(()=>{typeof window<"u"&&localStorage.setItem("mesesDesbloqueados",JSON.stringify(_))},[_]),N.useEffect(()=>{(async()=>{const{data:{user:ge}}=await Pt.auth.getUser();if(ge){const{data:Se,error:Ne}=await Pt.from("treino_ia").select("*").eq("user_id",ge.id).eq("ativo",!0);!Ne&&Se&&(g(Se),localStorage.setItem("treinosIA",JSON.stringify(Se)))}})()},[]);const le=(re,ge)=>`${re}-${ge}`,ue=(re,ge)=>{h(ge);const Se=le(re,ge);if(!P[Se]){const Ne=J4e.flatMap(we=>we.exercicios);O(we=>({...we,[Se]:Ne}))}},ce=async re=>{const{error:ge}=await Pt.from("treino_ia").update({ativo:!1}).eq("id",re);ge||g(Se=>Se.filter(Ne=>Ne.id!==re))};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsxs("main",{className:"flex-grow flex flex-col items-center justify-center py-8",children:[m.jsx("div",{className:"w-full max-w-4xl mb-4 flex",children:m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),"aria-label":"Voltar",children:m.jsx(pr,{className:"h-5 w-5"})})}),m.jsxs("div",{className:"w-full max-w-4xl p-6 bg-white rounded-lg shadow-md flex flex-row gap-8 items-start",children:[m.jsxs("div",{className:"flex flex-col items-start w-full md:w-1/3 max-w-xs",children:[m.jsx(pe,{className:"bg-purple-600 hover:bg-purple-700 text-white font-bold px-8 py-4 rounded-lg text-lg mb-4 w-full",onClick:()=>C(!0),children:"Criar treino com IA"}),w&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Criar treino com IA"}),m.jsxs("form",{className:"space-y-6",onSubmit:async re=>{re.preventDefault();const ge={modelo:l,local:t,carga:a?null:n,diasSemana:o,criadoEm:Date.now(),progresso:{mes:1,semana:1}};g(Se=>{const Ne=[...Se,ge];return localStorage.setItem("treinosIA",JSON.stringify(Ne)),Ne});try{const{data:{user:Se}}=await Pt.auth.getUser();if(Se){const Ne={};for(let we=1;we<=24;we++)Ne[`semana_${we}`]=null;await Pt.from("treino_ia").insert([{user_id:Se.id,modelo:l,local:t,carga:a?null:n,dias_semana:o,...Ne}])}}catch(Se){console.error("Erro ao salvar treino IA no Supabase:",Se)}A(l),v(p.length),C(!1),d(null),h(null)},children:[m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsxs("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:l,onChange:re=>u(re.target.value),children:[m.jsx("option",{value:"",children:"Selecione..."}),Ea.map(re=>m.jsx("option",{value:re,children:re},re))]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Onde você vai treinar?"}),m.jsx("div",{className:"flex gap-2 justify-center",children:Y4e.map(re=>m.jsx(pe,{type:"button",variant:t===re?"default":"outline",className:t===re?"bg-purple-600 text-white":"",onClick:()=>e(re),children:re},re))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{n>0&&r(n-1),s(!1)},disabled:a||n===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:a?"Sem carga":`${n} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{r(n+1),s(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:a?"default":"outline",className:a?"bg-purple-600 text-white":"",onClick:()=>{s(!0),r(0)},children:"Sem carga"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Dias da semana"}),m.jsx("div",{className:"flex gap-2 justify-center",children:Q4e.map(re=>m.jsx(pe,{type:"button",variant:o===re?"default":"outline",className:o===re?"bg-purple-600 text-white":"",onClick:()=>i(re),children:re},re))})]}),m.jsxs("div",{className:"flex justify-center gap-2",children:[m.jsx(pe,{variant:"outline",type:"button",onClick:()=>C(!1),children:"Cancelar"}),m.jsx(pe,{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white font-bold",children:"Gerar treino com IA"})]})]})]})}),p.map((re,ge)=>m.jsxs("div",{className:"w-full flex items-center gap-2 mb-2 max-w-xs",children:[m.jsx(pe,{className:"flex-1 bg-purple-100 text-purple-700 font-bold px-4 py-1 text-sm text-left",onClick:()=>v(y===ge?null:ge),children:re.modelo}),m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>b(ge),"aria-label":"Excluir modelo",children:m.jsx(gV,{className:"w-5 h-5 text-red-500"})}),x===ge&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-sm w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Excluir modelo"}),m.jsx("p",{className:"mb-6",children:"Tem certeza que deseja excluir este modelo de treino? Esta ação não pode ser desfeita."}),m.jsxs("div",{className:"flex justify-end gap-2",children:[m.jsx(pe,{variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),m.jsx(pe,{className:"bg-red-600 hover:bg-red-700 text-white",onClick:async()=>{await ce(re.id),b(!1)},children:"Excluir"})]})]})})]},re.criadoEm)),y!==null&&p[y]&&m.jsx("div",{className:"w-full flex flex-col gap-2 max-w-xs items-start",children:[1,2,3,4,5,6].map(re=>{const ge=_.includes(re);return m.jsxs(K.Fragment,{children:[m.jsxs(pe,{className:`w-full flex justify-between items-center px-4 py-1 text-sm text-left ${c===re?"bg-purple-700 text-white":"bg-purple-100 text-purple-700"} ${ge?"":"opacity-60 cursor-not-allowed"}`,onClick:()=>ge&&d(c===re?null:re),disabled:!ge,children:[m.jsxs("span",{className:"flex items-center gap-2",children:[re,"º mês",!ge&&m.jsx(_E,{className:"w-4 h-4 text-gray-500"})]}),ge&&(c===re?m.jsx(dV,{className:"w-4 h-4 ml-2"}):m.jsx(fV,{className:"w-4 h-4 ml-2"}))]}),c===re&&ge&&m.jsx("div",{className:"mt-2 flex flex-col gap-2 ml-4 items-start",children:[1,2,3,4].map(Se=>m.jsxs(pe,{className:`w-full px-4 py-1 text-sm text-left ${f===Se?"bg-purple-700 text-white":"bg-purple-100 text-purple-700"}`,onClick:()=>{h(Se),ue(re,Se),Se===4&&!_.includes(re+1)&&re<6&&$(Ne=>[...Ne,re+1])},children:[Se,"ª semana"]},Se))})]},re)})})]}),m.jsx("div",{className:"flex-1 flex flex-col",children:f&&y!==null&&p[y]&&m.jsxs("div",{className:"mb-8",children:[m.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Exercícios da ",f,"ª semana do ",c,"º mês"]}),(()=>{const re=p[y],Se=`semana_${(c-1)*4+f}`,Ne=re[Se],we=Array.isArray(Ne)?Ne:Ne&&Array.isArray(Ne.exercicios)?Ne.exercicios:[];if(we.length===0)return m.jsx("div",{className:"text-gray-500",children:"Nenhum exercício cadastrado para esta semana."});const de=(ae,U,oe)=>{g(ye=>{const be=[...ye],De=be[y][Se];if(!De)return ye;const Ve=De.find(It=>It.area===ae);if(!Ve)return ye;const Ye=[...Ve.exercicios],Ze=U+oe;return Ze<0||Ze>=Ye.length?ye:([Ye[U],Ye[Ze]]=[Ye[Ze],Ye[U]],Ve.exercicios=Ye,be)})},J=(ae,U)=>{B({exercicio:typeof ae=="object"?ae:{id:ae,name:ae},area:U}),L(l),te(ae.series||0),Q(!ae.series)};return m.jsx("ul",{className:"space-y-2",children:we.map((ae,U)=>m.jsx(K.Fragment,{children:Array.isArray(ae.exercicios)&&ae.exercicios.map((oe,ye,be)=>{const he=typeof oe=="string"?oe:oe.id,De=Z4e.find(Ze=>Ze.id===he),Ve=De?De.name:he,Ye=typeof oe=="object"&&oe.series?oe.series:"";return m.jsxs("li",{className:"flex items-center justify-between gap-2 bg-gray-100 rounded px-3 py-2 mb-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"font-medium",children:Ve}),m.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",ae.area,")"]}),Ye&&m.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:[Ye," séries"]})]}),m.jsxs("div",{className:"flex gap-1 items-center",children:[m.jsx(pe,{size:"icon",variant:"ghost",onClick:()=>de(ae.area,ye,-1),disabled:ye===0,title:"Mover para cima",children:m.jsx(CE,{className:"w-4 h-4"})}),m.jsx(pe,{size:"icon",variant:"ghost",onClick:()=>de(ae.area,ye,1),disabled:ye===be.length-1,title:"Mover para baixo",children:m.jsx(SE,{className:"w-4 h-4"})}),m.jsx(pe,{size:"icon",className:"bg-indigo-700 hover:bg-indigo-800 text-white rounded-lg",onClick:()=>J(oe,ae.area),title:"Iniciar exercício",children:m.jsx(ko,{className:"w-5 h-5"})})]})]},ye)})},U))})})()]})})]})]}),m.jsx("div",{className:"w-full flex justify-center mt-8",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl w-full",children:[m.jsxs(bn,{children:[m.jsx(wn,{children:m.jsx(Sn,{children:"Suas Métricas"})}),m.jsx(Cn,{children:m.jsx("ul",{className:"space-y-2",children:K4e.map((re,ge)=>m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:re.nome}),m.jsx("span",{className:"font-semibold",children:re.valor})]},ge))})})]}),m.jsxs(bn,{children:[m.jsx(wn,{children:m.jsx(Sn,{children:"Métricas Recomendadas pela IA"})}),m.jsx(Cn,{children:m.jsx("ul",{className:"space-y-2",children:X4e.map((re,ge)=>m.jsxs("li",{className:"flex justify-between",children:[m.jsx("span",{children:re.nome}),m.jsx("span",{className:"font-semibold text-purple-700",children:re.valor})]},ge))})})]})]})}),R&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Configurar Execução"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsx("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:F,onChange:re=>L(re.target.value),children:Ea.map(re=>m.jsx("option",{value:re,children:re},re))})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{H>0&&te(H-1),Q(!1)},disabled:V||H===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:V?"Sem carga":`${H} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{te(H+1),Q(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:V?"default":"outline",className:V?"bg-purple-600 text-white":"",onClick:()=>{Q(!0),te(0)},children:"Sem carga"})]})]}),m.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[m.jsx(pe,{variant:"outline",onClick:()=>B(null),children:"Cancelar"}),m.jsx(pe,{className:"bg-green-600 hover:bg-green-700 text-white font-bold",onClick:()=>{const ge=[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}].find(Se=>Se.id===R.exercicio.id)||{id:R.exercicio.id,name:R.exercicio.name||R.exercicio.id};localStorage.setItem("currentExercise",JSON.stringify({id:ge.id,name:ge.name,modelo:F,carga:V?null:H,area:R.area,series:R.exercicio.series||null})),B(null),se("/workout-flow/execution")},title:"Iniciar exercício",children:m.jsx(ko,{className:"w-5 h-5"})})]})]})}),m.jsx(rr,{})]})};function tze(t){return function(e){return t==null?void 0:t[e]}}var nze=tze,rze=nze,aze={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},sze=rze(aze),oze=sze,ize=typeof gn=="object"&&gn&&gn.Object===Object&&gn,WK=ize,lze=WK,uze=typeof self=="object"&&self&&self.Object===Object&&self,cze=lze||uze||Function("return this")(),gi=cze,dze=gi,fze=dze.Symbol,ob=fze;function hze(t,e){for(var n=-1,r=t==null?0:t.length,a=Array(r);++n<r;)a[n]=e(t[n],n,t);return a}var eO=hze,pze=Array.isArray,as=pze,hM=ob,GK=Object.prototype,mze=GK.hasOwnProperty,gze=GK.toString,Rm=hM?hM.toStringTag:void 0;function yze(t){var e=mze.call(t,Rm),n=t[Rm];try{t[Rm]=void 0;var r=!0}catch{}var a=gze.call(t);return r&&(e?t[Rm]=n:delete t[Rm]),a}var vze=yze,xze=Object.prototype,bze=xze.toString;function wze(t){return bze.call(t)}var Sze=wze,pM=ob,Cze=vze,_ze=Sze,$ze="[object Null]",kze="[object Undefined]",mM=pM?pM.toStringTag:void 0;function Nze(t){return t==null?t===void 0?kze:$ze:mM&&mM in Object(t)?Cze(t):_ze(t)}var rl=Nze;function Ize(t){return t!=null&&typeof t=="object"}var al=Ize,Tze=rl,Eze=al,Aze="[object Symbol]";function Pze(t){return typeof t=="symbol"||Eze(t)&&Tze(t)==Aze}var Gp=Pze,gM=ob,Oze=eO,Rze=as,Dze=Gp,jze=1/0,yM=gM?gM.prototype:void 0,vM=yM?yM.toString:void 0;function HK(t){if(typeof t=="string")return t;if(Rze(t))return Oze(t,HK)+"";if(Dze(t))return vM?vM.call(t):"";var e=t+"";return e=="0"&&1/t==-jze?"-0":e}var Mze=HK,Fze=Mze;function Lze(t){return t==null?"":Fze(t)}var tO=Lze,Bze=oze,zze=tO,Uze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vze="\\u0300-\\u036f",Wze="\\ufe20-\\ufe2f",Gze="\\u20d0-\\u20ff",Hze=Vze+Wze+Gze,qze="["+Hze+"]",Kze=RegExp(qze,"g");function Xze(t){return t=zze(t),t&&t.replace(Uze,Bze).replace(Kze,"")}var Yze=Xze;const nO=Ut(Yze),Qze=[{id:"squat",name:"Agachamento"},{id:"agachamento",name:"Agachamento"},{id:"push-up",name:"Flexão de Braço"},{id:"pushup",name:"Flexão de Braço"},{id:"flexao",name:"Flexão de Braço"},{id:"biceps-curl",name:"Rosca Bíceps"},{id:"curl",name:"Rosca Bíceps"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}],Jze=()=>{const[t,e]=N.useState(null),[n,r]=N.useState(!1),[a,s]=N.useState(!1),[o,i]=N.useState(!1),[l,u]=N.useState({repetitions:0,series:0,quality:{good:0,average:0,poor:0}}),[c,d]=N.useState(0),[f,h]=N.useState(null),{toast:p}=Xr(),g=N.useRef(null),[y,v]=N.useState([]),[x,b]=N.useState(null),[w,C]=N.useState(Ea[0]),[_,$]=N.useState(0),[k,A]=N.useState(!0);N.useEffect(()=>{if(n&&!g.current){const Q=Date.now()-c*1e3;g.current=window.setInterval(()=>{d(Math.floor((Date.now()-Q)/1e3))},1e3)}else!n&&g.current&&(clearInterval(g.current),g.current=null);return()=>{g.current&&(clearInterval(g.current),g.current=null)}},[n,c]);const P=Q=>{b({exercicio:Q}),C(Ea[0]),$(0),A(!0)},O=()=>{s(!1),r(!0),p({title:"Análise iniciada",description:"Posicione-se na frente da câmera e comece o exercício.",duration:3e3})},R=()=>{r(!0),p({title:"Análise iniciada",description:"Posicione-se na frente da câmera e comece o exercício.",duration:3e3})},B=()=>{r(!1),p({title:"Análise pausada",description:"Você pode retomar quando estiver pronto.",duration:3e3})},F=()=>{i(Q=>!Q)},L=()=>{console.log("🏋️ Repetição contabilizada no Workout.tsx!"),u(Q=>{const se=["good","average","poor"],le=Math.floor(Math.random()*3),ue=se[le],ce={good:ue==="good"?Q.quality.good+1:Q.quality.good,average:ue==="average"?Q.quality.average+1:Q.quality.average,poor:ue==="poor"?Q.quality.poor+1:Q.quality.poor},re=Q.repetitions+1;let ge=Q.series;return re%10===0&&re>0&&(ge+=1,p({title:"Série Completa!",description:`Você completou ${ge} séries de ${t}`,duration:3e3,variant:"default"})),p({title:"🏋️ Repetição!",description:`Repetição #${re} contabilizada`,duration:1e3,variant:"default"}),{repetitions:re,series:ge,quality:ce}})},H=Q=>{["Afaste-se para a câmera ver suas pernas completas","Posicione-se em frente à câmera","Posicione-se para que seus braços estejam visíveis","Posicione a câmera para ver seu tronco e braços completos","Posicione a câmera lateralmente para ver seu corpo na horizontal"].some(le=>Q.includes(le))||h(Q)},te=async()=>{console.log("Iniciando gravação do treino:",y);const{data:{user:Q}}=await Pt.auth.getUser();if(!Q){p({title:"Usuário não autenticado",variant:"destructive"});return}try{await VK({userId:Q.id,totalTime:Math.round(c/60),xp:y.reduce((se,le)=>se+le.sets.length*10,0),exercises:y}),console.log("Treino salvo com sucesso!"),p({title:"Treino salvo com sucesso!"}),v([]),e(null),u({repetitions:0,series:0,quality:{good:0,average:0,poor:0}}),d(0),h(null)}catch(se){console.error("Erro ao salvar treino:",se),p({title:"Erro ao salvar treino",description:se.message,variant:"destructive"})}},V=t?t.toLowerCase().replace(/\s+/g,""):"squat";return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Seu Treino"}),t?m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h2",{className:"formfit-subheading",children:t}),m.jsxs("div",{className:"flex space-x-2",children:[m.jsxs(pe,{onClick:F,variant:"outline",children:[m.jsx(yre,{className:"mr-2 h-4 w-4"}),o?"Ocultar Dashboard":"Mostrar Dashboard"]}),m.jsx(pe,{onClick:()=>e(null),variant:"outline",children:"Mudar exercício"})]})]}),m.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md h-[90vh]",children:m.jsx("div",{className:"h-full w-full rounded-lg overflow-hidden bg-gray-100 relative",children:n?m.jsx(xLe,{exercise:t,onRepetitionCount:L,onFeedback:H}):m.jsx("div",{className:"flex items-center justify-center h-full",children:m.jsxs("div",{className:"text-center",children:[m.jsx(gre,{className:"mx-auto h-16 w-16 text-gray-400"}),m.jsx("p",{className:"mt-4 text-gray-500",children:"Câmera desativada"})]})})})}),o?m.jsx(vK,{elapsedTime:c,repStats:{total:l.repetitions,good:l.quality.good,average:l.quality.average,poor:l.quality.poor},series:l.series}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"flex justify-center space-x-4",children:n?m.jsxs(pe,{onClick:B,variant:"outline",size:"lg",children:[m.jsx(pV,{className:"mr-2 h-5 w-5"}),"Pausar"]}):m.jsxs(pe,{onClick:R,className:"bg-formfit-blue hover:bg-formfit-blue/90",size:"lg",children:[m.jsx(ko,{className:"mr-2 h-5 w-5"}),"Iniciar"]})}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[m.jsx("h3",{className:"text-xl font-bold mb-2",children:"Repetições"}),m.jsx("div",{className:"text-5xl font-bold text-formfit-blue",children:l.repetitions})]}),m.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[m.jsx("h3",{className:"text-xl font-bold mb-2",children:"Feedback"}),m.jsx("div",{className:`text-lg ${f!=null&&f.includes("Correto")||f!=null&&f.includes("Boa!")||f!=null&&f.includes("Excelente")?"text-green-500":f!=null&&f.includes("Ruim")||f!=null&&f.includes("Afaste")?"text-amber-500":"text-blue-500"}`,children:!f||["Afaste-se para a câmera ver suas pernas completas","Posicione-se em frente à câmera","Posicione-se para que seus braços estejam visíveis","Posicione a câmera para ver seu tronco e braços completos","Posicione a câmera lateralmente para ver seu corpo na horizontal"].some(se=>f.includes(se))?"Aguardando...":f})]})]}),!o&&t&&m.jsx(pe,{onClick:te,className:"w-full bg-green-600 hover:bg-green-700 mt-4",children:"Finalizar Treino"})]})]}):m.jsx(bLe,{onSelectExercise:P})]})}),m.jsx(rr,{}),m.jsx(wV,{}),a&&t&&m.jsx(dK,{exerciseId:V,onComplete:O}),x&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Configurar Execução"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsx("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:w,onChange:Q=>C(Q.target.value),children:Ea.map(Q=>m.jsx("option",{value:Q,children:Q},Q))})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{_>0&&$(_-1),A(!1)},disabled:k||_===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:k?"Sem carga":`${_} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{$(_+1),A(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:k?"default":"outline",className:k?"bg-purple-600 text-white":"",onClick:()=>{A(!0),$(0)},children:"Sem carga"})]})]}),m.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[m.jsx(pe,{variant:"outline",onClick:()=>b(null),children:"Cancelar"}),m.jsxs(pe,{className:"bg-formfit-blue hover:bg-formfit-blue/90",size:"lg",onClick:()=>{const Q=ue=>nO(ue||"").toLowerCase(),se=Qze.find(ue=>Q(ue.id)===Q(t)||Q(ue.name)===Q(t))||{id:Q(t),name:t},le={id:se.id,name:se.name,modelo:w,carga:k?null:_,muscles:""};console.log("Salvando no localStorage:",le),localStorage.setItem("currentExercise",JSON.stringify(le)),b(null),r(!0)},children:[m.jsx(ko,{className:"mr-2 h-5 w-5"}),"Iniciar"]})]})]})})]})},Zze=()=>{const t=zn(),e=r=>{localStorage.setItem("subscribed","true"),localStorage.setItem("subscriptionPlan",r),t("/onboarding/registration")},n=()=>{t(-1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:n,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Assinatura"})]}),m.jsx("div",{className:"text-center mb-12 max-w-2xl mx-auto",children:m.jsx("p",{className:"text-gray-600",children:"Escolha o plano que melhor atende suas necessidades e comece sua jornada fitness hoje!"})}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[m.jsxs(bn,{className:"relative",children:[m.jsxs(wn,{children:[m.jsx(Sn,{className:"text-lg",children:"Básico"}),m.jsxs("div",{className:"text-3xl font-bold",children:["R$29,90",m.jsx("span",{className:"text-base font-normal text-gray-500",children:"/mês"})]}),m.jsx(xs,{children:"Para iniciantes"})]}),m.jsxs(Cn,{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Treinos para pernas"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Análise de postura"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Dashboard de progresso"})]})]}),m.jsx(yc,{children:m.jsx(pe,{onClick:()=>e("basic"),className:"w-full",children:"Assinar plano Básico"})})]}),m.jsxs(bn,{className:"border-2 border-formfit-blue relative",children:[m.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2 bg-formfit-blue text-white px-4 py-1 rounded-full text-sm font-medium",children:"Mais Popular"}),m.jsxs(wn,{children:[m.jsx(Sn,{className:"text-lg",children:"Pro"}),m.jsxs("div",{className:"text-3xl font-bold",children:["R$49,90",m.jsx("span",{className:"text-base font-normal text-gray-500",children:"/mês"})]}),m.jsx(xs,{children:"Para entusiastas do fitness"})]}),m.jsxs(Cn,{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Todos os treinos disponíveis"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Análise de postura avançada"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Histórico detalhado de treinos"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Planos personalizados"})]})]}),m.jsx(yc,{children:m.jsx(pe,{onClick:()=>e("pro"),className:"w-full bg-formfit-blue hover:bg-formfit-blue/90",children:"Assinar plano Pro"})})]}),m.jsxs(bn,{children:[m.jsxs(wn,{children:[m.jsx(Sn,{className:"text-lg",children:"Premium"}),m.jsxs("div",{className:"text-3xl font-bold",children:["R$79,90",m.jsx("span",{className:"text-base font-normal text-gray-500",children:"/mês"})]}),m.jsx(xs,{children:"Para atletas comprometidos"})]}),m.jsxs(Cn,{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Todos os recursos do plano Pro"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Coach pessoal via chat"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Planos nutricionais"})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(sa,{className:"mr-2 h-4 w-4 text-green-500"}),m.jsx("span",{children:"Avaliações mensais"})]})]}),m.jsx(yc,{children:m.jsx(pe,{onClick:()=>e("premium"),className:"w-full",children:"Assinar plano Premium"})})]})]})]})}),m.jsx(rr,{})]})};function eUe(t,e){const n=N.createContext(e),r=s=>{const{children:o,...i}=s,l=N.useMemo(()=>i,Object.values(i));return m.jsx(n.Provider,{value:l,children:o})};r.displayName=t+"Provider";function a(s){const o=N.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[r,a]}function Hp(t,e=[]){let n=[];function r(s,o){const i=N.createContext(o),l=n.length;n=[...n,o];const u=d=>{var v;const{scope:f,children:h,...p}=d,g=((v=f==null?void 0:f[t])==null?void 0:v[l])||i,y=N.useMemo(()=>p,Object.values(p));return m.jsx(g.Provider,{value:y,children:h})};u.displayName=s+"Provider";function c(d,f){var g;const h=((g=f==null?void 0:f[t])==null?void 0:g[l])||i,p=N.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[u,c]}const a=()=>{const s=n.map(o=>N.createContext(o));return function(i){const l=(i==null?void 0:i[t])||s;return N.useMemo(()=>({[`__scope${t}`]:{...i,[t]:l}}),[i,l])}};return a.scopeName=t,[r,tUe(a,...e)]}function tUe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const o=r.reduce((i,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...i,...d}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Ht(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function to(t){const e=N.useRef(t);return N.useEffect(()=>{e.current=t}),N.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function qp({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,a]=nUe({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,i=to(n),l=N.useCallback(u=>{if(s){const d=typeof u=="function"?u(t):u;d!==t&&i(d)}else a(u)},[s,t,a,i]);return[o,l]}function nUe({defaultProp:t,onChange:e}){const n=N.useState(t),[r]=n,a=N.useRef(r),s=to(e);return N.useEffect(()=>{a.current!==r&&(s(r),a.current=r)},[r,a,s]),n}function qK(t){const e=N.useRef({value:t,previous:t});return N.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var eh=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{};function KK(t){const[e,n]=N.useState(void 0);return eh(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let o,i;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,i=u.blockSize}else o=t.offsetWidth,i=t.offsetHeight;n({width:o,height:i})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}function rUe(t,e){return N.useReducer((n,r)=>e[n][r]??n,t)}var vu=t=>{const{present:e,children:n}=t,r=aUe(e),a=typeof n=="function"?n({present:r.isPresent}):N.Children.only(n),s=Aa(r.ref,sUe(a));return typeof n=="function"||r.isPresent?N.cloneElement(a,{ref:s}):null};vu.displayName="Presence";function aUe(t){const[e,n]=N.useState(),r=N.useRef({}),a=N.useRef(t),s=N.useRef("none"),o=t?"mounted":"unmounted",[i,l]=rUe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const u=l0(r.current);s.current=i==="mounted"?u:"none"},[i]),eh(()=>{const u=r.current,c=a.current;if(c!==t){const f=s.current,h=l0(u);t?l("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&f!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,l]),eh(()=>{if(e){let u;const c=e.ownerDocument.defaultView??window,d=h=>{const g=l0(r.current).includes(h.animationName);if(h.target===e&&g&&(l("ANIMATION_END"),!a.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",u=c.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},f=h=>{h.target===e&&(s.current=l0(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{c.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:N.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function l0(t){return(t==null?void 0:t.animationName)||"none"}function sUe(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var rO="Checkbox",[oUe,Jpt]=Hp(rO),[iUe,lUe]=oUe(rO),XK=N.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:s,required:o,disabled:i,value:l="on",onCheckedChange:u,form:c,...d}=t,[f,h]=N.useState(null),p=Aa(e,w=>h(w)),g=N.useRef(!1),y=f?c||!!f.closest("form"):!0,[v=!1,x]=qp({prop:a,defaultProp:s,onChange:u}),b=N.useRef(v);return N.useEffect(()=>{const w=f==null?void 0:f.form;if(w){const C=()=>x(b.current);return w.addEventListener("reset",C),()=>w.removeEventListener("reset",C)}},[f,x]),m.jsxs(iUe,{scope:n,state:v,disabled:i,children:[m.jsx(nn.button,{type:"button",role:"checkbox","aria-checked":ql(v)?"mixed":v,"aria-required":o,"data-state":JK(v),"data-disabled":i?"":void 0,disabled:i,value:l,...d,ref:p,onKeyDown:Ht(t.onKeyDown,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:Ht(t.onClick,w=>{x(C=>ql(C)?!0:!C),y&&(g.current=w.isPropagationStopped(),g.current||w.stopPropagation())})}),y&&m.jsx(uUe,{control:f,bubbles:!g.current,name:r,value:l,checked:v,required:o,disabled:i,form:c,style:{transform:"translateX(-100%)"},defaultChecked:ql(s)?!1:s})]})});XK.displayName=rO;var YK="CheckboxIndicator",QK=N.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...a}=t,s=lUe(YK,n);return m.jsx(vu,{present:r||ql(s.state)||s.state===!0,children:m.jsx(nn.span,{"data-state":JK(s.state),"data-disabled":s.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...t.style}})})});QK.displayName=YK;var uUe=t=>{const{control:e,checked:n,bubbles:r=!0,defaultChecked:a,...s}=t,o=N.useRef(null),i=qK(n),l=KK(e);N.useEffect(()=>{const c=o.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(i!==n&&h){const p=new Event("click",{bubbles:r});c.indeterminate=ql(n),h.call(c,ql(n)?!1:n),c.dispatchEvent(p)}},[i,n,r]);const u=N.useRef(ql(n)?!1:n);return m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...s,tabIndex:-1,ref:o,style:{...t.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function ql(t){return t==="indeterminate"}function JK(t){return ql(t)?"indeterminate":t?"checked":"unchecked"}var ZK=XK,cUe=QK;const e7=N.forwardRef(({className:t,...e},n)=>m.jsx(ZK,{ref:n,className:fn("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:m.jsx(cUe,{className:fn("flex items-center justify-center text-current"),children:m.jsx(sa,{className:"h-4 w-4"})})}));e7.displayName=ZK.displayName;var dUe="Label",t7=N.forwardRef((t,e)=>m.jsx(nn.label,{...t,ref:e,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));t7.displayName=dUe;var n7=t7;const fUe=bE("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Hr=N.forwardRef(({className:t,...e},n)=>m.jsx(n7,{ref:n,className:fn(fUe(),t),...e}));Hr.displayName=n7.displayName;const hUe=()=>{const[t,e]=N.useState([]),n=zn(),{toast:r}=Xr(),a=[{id:"monday",label:"Segunda-feira"},{id:"tuesday",label:"Terça-feira"},{id:"wednesday",label:"Quarta-feira"},{id:"thursday",label:"Quinta-feira"},{id:"friday",label:"Sexta-feira"},{id:"saturday",label:"Sábado"},{id:"sunday",label:"Domingo"}],s=o=>{if(o.preventDefault(),t.length===0){r({title:"Selecione pelo menos um dia",description:"Escolha os dias em que você pretende treinar",variant:"destructive"});return}localStorage.setItem("trainingDays",JSON.stringify(t)),n("/cadastro")};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex items-center justify-center py-8",children:m.jsxs("div",{className:"w-full max-w-md p-6 bg-white rounded-lg shadow-md",children:[m.jsx("h1",{className:"formfit-heading text-center mb-6",children:"Dias de Treino"}),m.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Selecione os dias da semana em que você pretende treinar"}),m.jsxs("form",{onSubmit:s,className:"space-y-6",children:[m.jsx("div",{className:"space-y-4",children:a.map(o=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(e7,{id:o.id,checked:t.includes(o.id),onCheckedChange:i=>{e(i?[...t,o.id]:t.filter(l=>l!==o.id))}}),m.jsx(Hr,{htmlFor:o.id,children:o.label})]},o.id))}),m.jsx(pe,{type:"submit",className:"w-full bg-formfit-blue hover:bg-formfit-blue/90",disabled:t.length===0,children:"Continuar"})]})]})}),m.jsx(rr,{})]})},pUe=()=>{const[t,e]=K.useState("iniciante"),n=zn(),{toast:r}=Xr(),a=i=>{e(i),r({title:"Nível selecionado",description:`Você selecionou o nível ${i}.`,duration:1500})},s=()=>{t&&(localStorage.setItem("userLevel",t),n("/onboarding/profile"))},o=()=>{n(-1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:o,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Nível"})]}),m.jsxs("div",{className:"space-y-4 max-w-md mx-auto",children:[m.jsxs("button",{onClick:()=>a("iniciante"),className:`w-full p-4 rounded-lg flex items-center justify-between ${t==="iniciante"?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:[m.jsx("span",{className:"font-medium text-lg",children:"Iniciante"}),t==="iniciante"&&m.jsx(sa,{className:"h-5 w-5"})]}),m.jsxs("button",{onClick:()=>a("intermediario"),className:`w-full p-4 rounded-lg flex items-center justify-between ${t==="intermediario"?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:[m.jsx("span",{className:"font-medium text-lg",children:"Intermediário"}),t==="intermediario"&&m.jsx(sa,{className:"h-5 w-5"})]}),m.jsxs("button",{onClick:()=>a("avancado"),className:`w-full p-4 rounded-lg flex items-center justify-between ${t==="avancado"?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:[m.jsx("span",{className:"font-medium text-lg",children:"Avançado"}),t==="avancado"&&m.jsx(sa,{className:"h-5 w-5"})]})]}),m.jsx("div",{className:"mt-12 flex justify-center",children:m.jsxs(pe,{onClick:s,className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white font-medium px-8 py-6 rounded-lg text-lg",size:"lg",children:["Avançar ",m.jsx(ov,{className:"ml-2"})]})})]})}),m.jsx(rr,{})]})},mUe=()=>{const[t,e]=N.useState(null),[n,r]=N.useState(25),[a,s]=N.useState(""),[o,i]=N.useState(!1),l=zn(),{toast:u}=Xr(),c=g=>{e(g),u({title:"Gênero selecionado",description:`Você selecionou ${g}.`,duration:1500})},d=()=>{n<99&&r(g=>g+1)},f=()=>{n>16&&r(g=>g-1)},h=async()=>{if(!a||!t){u({title:"Preencha todos os campos obrigatórios",variant:"destructive"});return}i(!0);const{data:{user:g},error:y}=await Pt.auth.getUser();if(!g||y){i(!1),u({title:"Usuário não autenticado",variant:"destructive"});return}const{error:v}=await Pt.from("user_profiles").upsert({id:g.id,full_name:a,gender:t,age:n});if(i(!1),v){u({title:"Erro ao salvar perfil",description:v.message,variant:"destructive"});return}u({title:"Cadastro realizado!",description:"Bem-vindo ao AI Trainer!"}),l("/dashboard")},p=()=>{l(-1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:p,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Perfil"})]}),m.jsxs("div",{className:"space-y-8 max-w-md mx-auto",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"formfit-subheading mb-4",children:"Gênero"}),m.jsxs("div",{className:"flex justify-between gap-3",children:[m.jsxs("button",{onClick:()=>c("Homem"),className:`flex-1 py-3 px-4 rounded-lg flex items-center justify-center gap-2 ${t==="Homem"?"bg-formfit-blue text-white":"bg-gray-200 text-gray-600"}`,children:[m.jsx(w_,{className:"h-5 w-5"}),m.jsx("span",{className:"font-medium",children:"Homem"})]}),m.jsxs("button",{onClick:()=>c("Mulher"),className:`flex-1 py-3 px-4 rounded-lg flex items-center justify-center gap-2 ${t==="Mulher"?"bg-formfit-blue text-white":"bg-gray-200 text-gray-600"}`,children:[m.jsx(w_,{className:"h-5 w-5"}),m.jsx("span",{className:"font-medium",children:"Mulher"})]}),m.jsxs("button",{onClick:()=>c("Outro"),className:`flex-1 py-3 px-4 rounded-lg flex items-center justify-center gap-2 ${t==="Outro"?"bg-formfit-blue text-white":"bg-gray-200 text-gray-600"}`,children:[m.jsx(w_,{className:"h-5 w-5"}),m.jsx("span",{className:"font-medium",children:"Outro"})]})]})]}),m.jsxs("div",{children:[m.jsx("h2",{className:"formfit-subheading mb-4",children:"Idade"}),m.jsxs("div",{className:"flex items-center justify-between max-w-xs mx-auto",children:[m.jsx("button",{onClick:f,className:"bg-gray-200 hover:bg-gray-300 rounded-full w-12 h-12 flex items-center justify-center",children:m.jsx(hV,{className:"h-6 w-6"})}),m.jsx("span",{className:"text-4xl font-bold text-gray-800",children:n}),m.jsx("button",{onClick:d,className:"bg-gray-200 hover:bg-gray-300 rounded-full w-12 h-12 flex items-center justify-center",children:m.jsx(mV,{className:"h-6 w-6"})})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Nome"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"text",placeholder:"Digite seu nome",value:a,onChange:g=>s(g.target.value),required:!0})]})]}),m.jsx("div",{className:"mt-12 flex justify-center",children:m.jsx(pe,{onClick:h,className:"bg-green-600 hover:bg-green-700 text-white font-medium px-8 py-6 rounded-lg text-lg",size:"lg",disabled:o,children:o?"Cadastrando...":"Cadastrar"})})]})}),m.jsx(rr,{})]})},gUe=()=>{const[t,e]=N.useState({name:"",age:"",weight:"",height:""}),n=zn(),{toast:r}=Xr(),a=i=>{const{name:l,value:u}=i.target;e(c=>({...c,[l]:u}))},s=()=>{if(!t.name||!t.age||!t.weight||!t.height){r({title:"Dados incompletos",description:"Por favor, preencha todos os campos obrigatórios.",variant:"destructive"});return}localStorage.setItem("userData",JSON.stringify(t)),n("/onboarding/availability"),r({title:"Dados salvos",description:"Seus dados pessoais foram registrados com sucesso!"})},o=()=>{n(-1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:o,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Cadastro"})]}),m.jsxs("div",{className:"max-w-md mx-auto space-y-6 bg-white p-6 rounded-lg shadow-sm",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"name",children:"Nome completo"}),m.jsx(So,{id:"name",name:"name",value:t.name,onChange:a,placeholder:"Seu nome completo",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"age",children:"Idade"}),m.jsx(So,{id:"age",name:"age",value:t.age,onChange:a,placeholder:"Ex: 30",type:"number",min:"16",max:"99",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"weight",children:"Peso (kg)"}),m.jsx(So,{id:"weight",name:"weight",value:t.weight,onChange:a,placeholder:"Ex: 70",type:"number",min:"30",max:"200",step:"0.1",required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"height",children:"Altura (cm)"}),m.jsx(So,{id:"height",name:"height",value:t.height,onChange:a,placeholder:"Ex: 175",type:"number",min:"100",max:"250",required:!0})]})]}),m.jsx("div",{className:"mt-12 flex justify-center",children:m.jsxs(pe,{onClick:s,className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white font-medium px-8 py-6 rounded-lg text-lg",size:"lg",children:["Próximo ",m.jsx(ov,{className:"ml-2"})]})})]})}),m.jsx(rr,{})]})};function yUe(t,e=[]){let n=[];function r(s,o){const i=N.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:f,children:h,...p}=d,g=(f==null?void 0:f[t][l])||i,y=N.useMemo(()=>p,Object.values(p));return m.jsx(g.Provider,{value:y,children:h})}function c(d,f){const h=(f==null?void 0:f[t][l])||i,p=N.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const a=()=>{const s=n.map(o=>N.createContext(o));return function(i){const l=(i==null?void 0:i[t])||s;return N.useMemo(()=>({[`__scope${t}`]:{...i,[t]:l}}),[i,l])}};return a.scopeName=t,[r,vUe(a,...e)]}function vUe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const o=r.reduce((i,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...i,...d}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function r7(t){const e=t+"CollectionProvider",[n,r]=yUe(e),[a,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=h=>{const{scope:p,children:g}=h,y=K.useRef(null),v=K.useRef(new Map).current;return m.jsx(a,{scope:p,itemMap:v,collectionRef:y,children:g})};o.displayName=e;const i=t+"CollectionSlot",l=K.forwardRef((h,p)=>{const{scope:g,children:y}=h,v=s(i,g),x=Aa(p,v.collectionRef);return m.jsx(Lf,{ref:x,children:y})});l.displayName=i;const u=t+"CollectionItemSlot",c="data-radix-collection-item",d=K.forwardRef((h,p)=>{const{scope:g,children:y,...v}=h,x=K.useRef(null),b=Aa(p,x),w=s(u,g);return K.useEffect(()=>(w.itemMap.set(x,{ref:x,...v}),()=>void w.itemMap.delete(x))),m.jsx(Lf,{[c]:"",ref:b,children:y})});d.displayName=u;function f(h){const p=s(t+"CollectionConsumer",h);return K.useCallback(()=>{const y=p.collectionRef.current;if(!y)return[];const v=Array.from(y.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((w,C)=>v.indexOf(w.ref.current)-v.indexOf(C.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},f,r]}function xUe(t,e=[]){let n=[];function r(s,o){const i=N.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:f,children:h,...p}=d,g=(f==null?void 0:f[t][l])||i,y=N.useMemo(()=>p,Object.values(p));return m.jsx(g.Provider,{value:y,children:h})}function c(d,f){const h=(f==null?void 0:f[t][l])||i,p=N.useContext(h);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const a=()=>{const s=n.map(o=>N.createContext(o));return function(i){const l=(i==null?void 0:i[t])||s;return N.useMemo(()=>({[`__scope${t}`]:{...i,[t]:l}}),[i,l])}};return a.scopeName=t,[r,bUe(a,...e)]}function bUe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const o=r.reduce((i,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...i,...d}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var wUe=U4.useId||(()=>{}),SUe=0;function xg(t){const[e,n]=N.useState(wUe());return eh(()=>{t||n(r=>r??String(SUe++))},[t]),t||(e?`radix-${e}`:"")}var CUe=N.createContext(void 0);function aO(t){const e=N.useContext(CUe);return t||e||"ltr"}var Q_="rovingFocusGroup.onEntryFocus",_Ue={bubbles:!1,cancelable:!0},B2="RovingFocusGroup",[UN,a7,$Ue]=r7(B2),[kUe,z2]=xUe(B2,[$Ue]),[NUe,IUe]=kUe(B2),s7=N.forwardRef((t,e)=>m.jsx(UN.Provider,{scope:t.__scopeRovingFocusGroup,children:m.jsx(UN.Slot,{scope:t.__scopeRovingFocusGroup,children:m.jsx(TUe,{...t,ref:e})})}));s7.displayName=B2;var TUe=N.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...d}=t,f=N.useRef(null),h=Aa(e,f),p=aO(s),[g=null,y]=qp({prop:o,defaultProp:i,onChange:l}),[v,x]=N.useState(!1),b=to(u),w=a7(n),C=N.useRef(!1),[_,$]=N.useState(0);return N.useEffect(()=>{const k=f.current;if(k)return k.addEventListener(Q_,b),()=>k.removeEventListener(Q_,b)},[b]),m.jsx(NUe,{scope:n,orientation:r,dir:p,loop:a,currentTabStopId:g,onItemFocus:N.useCallback(k=>y(k),[y]),onItemShiftTab:N.useCallback(()=>x(!0),[]),onFocusableItemAdd:N.useCallback(()=>$(k=>k+1),[]),onFocusableItemRemove:N.useCallback(()=>$(k=>k-1),[]),children:m.jsx(nn.div,{tabIndex:v||_===0?-1:0,"data-orientation":r,...d,ref:h,style:{outline:"none",...t.style},onMouseDown:Ht(t.onMouseDown,()=>{C.current=!0}),onFocus:Ht(t.onFocus,k=>{const A=!C.current;if(k.target===k.currentTarget&&A&&!v){const P=new CustomEvent(Q_,_Ue);if(k.currentTarget.dispatchEvent(P),!P.defaultPrevented){const O=w().filter(H=>H.focusable),R=O.find(H=>H.active),B=O.find(H=>H.id===g),L=[R,B,...O].filter(Boolean).map(H=>H.ref.current);l7(L,c)}}C.current=!1}),onBlur:Ht(t.onBlur,()=>x(!1))})})}),o7="RovingFocusGroupItem",i7=N.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:s,...o}=t,i=xg(),l=s||i,u=IUe(o7,n),c=u.currentTabStopId===l,d=a7(n),{onFocusableItemAdd:f,onFocusableItemRemove:h}=u;return N.useEffect(()=>{if(r)return f(),()=>h()},[r,f,h]),m.jsx(UN.ItemSlot,{scope:n,id:l,focusable:r,active:a,children:m.jsx(nn.span,{tabIndex:c?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:Ht(t.onMouseDown,p=>{r?u.onItemFocus(l):p.preventDefault()}),onFocus:Ht(t.onFocus,()=>u.onItemFocus(l)),onKeyDown:Ht(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){u.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const g=PUe(p,u.orientation,u.dir);if(g!==void 0){if(p.metaKey||p.ctrlKey||p.altKey||p.shiftKey)return;p.preventDefault();let v=d().filter(x=>x.focusable).map(x=>x.ref.current);if(g==="last")v.reverse();else if(g==="prev"||g==="next"){g==="prev"&&v.reverse();const x=v.indexOf(p.currentTarget);v=u.loop?OUe(v,x+1):v.slice(x+1)}setTimeout(()=>l7(v))}})})})});i7.displayName=o7;var EUe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function AUe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function PUe(t,e,n){const r=AUe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return EUe[r]}function l7(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function OUe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var u7=s7,c7=i7,sO="Radio",[RUe,d7]=Hp(sO),[DUe,jUe]=RUe(sO),f7=N.forwardRef((t,e)=>{const{__scopeRadio:n,name:r,checked:a=!1,required:s,disabled:o,value:i="on",onCheck:l,form:u,...c}=t,[d,f]=N.useState(null),h=Aa(e,y=>f(y)),p=N.useRef(!1),g=d?u||!!d.closest("form"):!0;return m.jsxs(DUe,{scope:n,checked:a,disabled:o,children:[m.jsx(nn.button,{type:"button",role:"radio","aria-checked":a,"data-state":m7(a),"data-disabled":o?"":void 0,disabled:o,value:i,...c,ref:h,onClick:Ht(t.onClick,y=>{a||l==null||l(),g&&(p.current=y.isPropagationStopped(),p.current||y.stopPropagation())})}),g&&m.jsx(MUe,{control:d,bubbles:!p.current,name:r,value:i,checked:a,required:s,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});f7.displayName=sO;var h7="RadioIndicator",p7=N.forwardRef((t,e)=>{const{__scopeRadio:n,forceMount:r,...a}=t,s=jUe(h7,n);return m.jsx(vu,{present:r||s.checked,children:m.jsx(nn.span,{"data-state":m7(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:e})})});p7.displayName=h7;var MUe=t=>{const{control:e,checked:n,bubbles:r=!0,...a}=t,s=N.useRef(null),o=qK(n),i=KK(e);return N.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==n&&d){const f=new Event("click",{bubbles:r});d.call(l,n),l.dispatchEvent(f)}},[o,n,r]),m.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:s,style:{...t.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function m7(t){return t?"checked":"unchecked"}var FUe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],oO="RadioGroup",[LUe,Zpt]=Hp(oO,[z2,d7]),g7=z2(),y7=d7(),[BUe,zUe]=LUe(oO),v7=N.forwardRef((t,e)=>{const{__scopeRadioGroup:n,name:r,defaultValue:a,value:s,required:o=!1,disabled:i=!1,orientation:l,dir:u,loop:c=!0,onValueChange:d,...f}=t,h=g7(n),p=aO(u),[g,y]=qp({prop:s,defaultProp:a,onChange:d});return m.jsx(BUe,{scope:n,name:r,required:o,disabled:i,value:g,onValueChange:y,children:m.jsx(u7,{asChild:!0,...h,orientation:l,dir:p,loop:c,children:m.jsx(nn.div,{role:"radiogroup","aria-required":o,"aria-orientation":l,"data-disabled":i?"":void 0,dir:p,...f,ref:e})})})});v7.displayName=oO;var x7="RadioGroupItem",b7=N.forwardRef((t,e)=>{const{__scopeRadioGroup:n,disabled:r,...a}=t,s=zUe(x7,n),o=s.disabled||r,i=g7(n),l=y7(n),u=N.useRef(null),c=Aa(e,u),d=s.value===a.value,f=N.useRef(!1);return N.useEffect(()=>{const h=g=>{FUe.includes(g.key)&&(f.current=!0)},p=()=>f.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",p),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",p)}},[]),m.jsx(c7,{asChild:!0,...i,focusable:!o,active:d,children:m.jsx(f7,{disabled:o,required:s.required,checked:d,...l,...a,name:s.name,ref:c,onCheck:()=>s.onValueChange(a.value),onKeyDown:Ht(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:Ht(a.onFocus,()=>{var h;f.current&&((h=u.current)==null||h.click())})})})});b7.displayName=x7;var UUe="RadioGroupIndicator",w7=N.forwardRef((t,e)=>{const{__scopeRadioGroup:n,...r}=t,a=y7(n);return m.jsx(p7,{...a,...r,ref:e})});w7.displayName=UUe;var S7=v7,C7=b7,VUe=w7;const _7=N.forwardRef(({className:t,...e},n)=>m.jsx(S7,{className:fn("grid gap-2",t),...e,ref:n}));_7.displayName=S7.displayName;const Z0=N.forwardRef(({className:t,...e},n)=>m.jsx(C7,{ref:n,className:fn("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...e,children:m.jsx(VUe,{className:"flex items-center justify-center",children:m.jsx(bre,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Z0.displayName=C7.displayName;const WUe=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(""),[a,s]=N.useState(18),o=zn(),i=()=>{a<120&&s(a+1)},l=()=>{a>1&&s(a-1)},u=c=>{c.preventDefault(),localStorage.setItem("userName",t),localStorage.setItem("userGender",n),localStorage.setItem("userAge",a.toString()),o("/onboarding/availability")};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex items-center justify-center py-8",children:m.jsxs("div",{className:"w-full max-w-md p-6 bg-white rounded-lg shadow-md",children:[m.jsx("div",{className:"mb-4 flex items-center",children:m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>o(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})})}),m.jsx("h1",{className:"formfit-heading text-center mb-6",children:"Sobre você"}),m.jsxs("form",{onSubmit:u,className:"space-y-6",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsx(Hr,{htmlFor:"name",children:"Nome"}),m.jsx("input",{id:"name",type:"text",value:t,onChange:c=>e(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-formfit-blue",placeholder:"Digite seu nome",required:!0})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(Hr,{children:"Gênero"}),m.jsxs(_7,{value:n,onValueChange:r,className:"flex gap-4 justify-center",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Z0,{value:"male",id:"male"}),m.jsx(Hr,{htmlFor:"male",children:"Masculino"})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Z0,{value:"female",id:"female"}),m.jsx(Hr,{htmlFor:"female",children:"Feminino"})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Z0,{value:"other",id:"other"}),m.jsx(Hr,{htmlFor:"other",children:"Outro"})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{children:"Idade"}),m.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:l,className:"h-10 w-10",children:m.jsx(hV,{className:"h-4 w-4"})}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:a}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:i,className:"h-10 w-10",children:m.jsx(mV,{className:"h-4 w-4"})})]})]}),m.jsx(pe,{type:"submit",className:"w-full bg-formfit-blue hover:bg-formfit-blue/90",disabled:!n||!t,children:"Continuar"})]})]})}),m.jsx(rr,{})]})},GUe=()=>{const{muscleGroupId:t}=xE(),[e,n]=N.useState([]),[r,a]=N.useState(null),s=zn(),{toast:o}=Xr();N.useEffect(()=>{const d={legs:[{id:"squat",name:"Agachamento",description:"Trabalha quadríceps, glúteos e core",muscleGroup:"legs",level:"iniciante"},{id:"lunge",name:"Avanço",description:"Trabalha quadríceps, glúteos e equilíbrio",muscleGroup:"legs",level:"intermediario"},{id:"calfRaises",name:"Elevação de Panturrilha",description:"Trabalha a musculatura da panturrilha",muscleGroup:"legs",level:"iniciante"},{id:"jumpSquat",name:"Agachamento com Salto",description:"Trabalha quadríceps, glúteos e potência",muscleGroup:"legs",level:"avancado"}],arms:[{id:"curl",name:"Rosca Bíceps",description:"Trabalha bíceps e antebraços",muscleGroup:"arms",level:"iniciante"}]};n(d[t||"legs"]||d.legs)},[t]);const i=d=>{var f;a(d),localStorage.setItem("selectedExercise",d),o({title:"Exercício selecionado",description:`Você selecionou ${(f=e.find(h=>h.id===d))==null?void 0:f.name}.`,duration:1500})},l=()=>{if(r){const d=e.find(f=>f.id===r);localStorage.setItem("currentExercise",JSON.stringify({id:r,name:(d==null?void 0:d.name)||""})),s(`/workout/exercise/${r}`)}else o({title:"Selecione um exercício",description:"Escolha um exercício para continuar.",variant:"destructive"})},u=()=>{s(-1)},c=()=>({legs:"Pernas",arms:"Braços",chest:"Peito",abs:"Abdômen",back:"Costas",fullbody:"Corpo Todo"})[t||"legs"]||"Exercícios";return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:u,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsxs("h1",{className:"formfit-heading text-center flex-1",children:["Exercícios para ",c()]})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.map(d=>m.jsxs(bn,{className:`cursor-pointer transition-shadow duration-300 ${r===d.id?"ring-2 ring-formfit-blue shadow-lg":"hover:shadow-md"}`,onClick:()=>i(d.id),children:[m.jsx(wn,{children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx(Sn,{children:d.name}),m.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${d.level==="iniciante"?"bg-green-100 text-green-800":d.level==="intermediario"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:d.level==="iniciante"?"Iniciante":d.level==="intermediario"?"Intermediário":"Avançado"})]})}),m.jsx(Cn,{children:m.jsx(xs,{children:d.description})}),m.jsx(yc,{className:"flex justify-end",children:r===d.id&&m.jsx("div",{className:"text-formfit-blue flex items-center",children:m.jsx("span",{children:"Selecionado"})})})]},d.id))}),m.jsx("div",{className:"mt-12 flex justify-center",children:m.jsxs(pe,{onClick:l,className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white font-medium px-8 py-6 rounded-lg text-lg",size:"lg",disabled:!r,children:["Ver Demonstração ",m.jsx(ov,{className:"ml-2"})]})})]})}),m.jsx(rr,{})]})},bg=(t,e,n,r,a,s,o,i,l,u,c,d,f,h,p,g,y,v)=>{var H,te,V,Q,se,le;const x={};t.forEach(ue=>{x[ue.name]=ue});const b=x.left_hip,w=x.left_knee,C=x.left_ankle,_=x.right_hip,$=x.right_knee,k=x.right_ankle;if((b==null?void 0:b.score)>.2&&(w==null?void 0:w.score)>.2&&(C==null?void 0:C.score)>.2&&(_==null?void 0:_.score)>.2&&($==null?void 0:$.score)>.2&&(k==null?void 0:k.score)>.2,b!=null&&b.score&&(w!=null&&w.score)&&(C!=null&&C.score)){const ue=(b.score+w.score+C.score)/3;console.log(`Squat detection scores: Hip=${b.score.toFixed(2)}, Knee=${w.score.toFixed(2)}, Ankle=${C.score.toFixed(2)}, Avg=${ue.toFixed(2)}`),ue<.3?(o("poor"),i.current=0):ue<.5?(o("good"),i.current+=1,i.current>5&&i.current%10===0&&y("Posição melhorando! Continue ajustando para visibilidade ideal.",3e3)):(o("excellent"),i.current+=1,i.current===10&&y("Excelente posição! Suas pernas estão claramente visíveis.",3e3))}const A=300,P=(b==null?void 0:b.score)>.5&&(w==null?void 0:w.score)>.5&&(C==null?void 0:C.score)>.5,O=(_==null?void 0:_.score)>.5&&($==null?void 0:$.score)>.5&&(k==null?void 0:k.score)>.5;let R=null;if(P&&O){const ue=u0(b,w,C),ce=u0(_,$,k);R=(ue+ce)/2}else P?R=u0(b,w,C):O&&(R=u0(_,$,k));const B=120,F=155;bg._repData||(bg._repData={angles:[],timestamps:[],lastDirection:null,lastAngle:null,upStartTime:null,downStartTime:null,upAngles:[],downAngles:[]});const L=bg._repData;if(R!==null){const ue=Date.now();L.angles.push(R),L.timestamps.push(ue);let ce=null;if(L.lastAngle!==null&&(R<L.lastAngle?ce="down":R>L.lastAngle&&(ce="up")),L.lastAngle=R,ce==="down"&&L.lastDirection!=="down"&&(L.downStartTime=ue,L.downAngles=[]),ce==="up"&&L.lastDirection!=="up"&&(L.upStartTime=ue,L.upAngles=[]),ce==="down"&&L.downAngles.push({angle:R,time:ue}),ce==="up"&&L.upAngles.push({angle:R,time:ue}),L.lastDirection=ce,!e&&R<B&&(n(!0),a(!0)),e&&R>F&&ue-d.current>A){n(!1),a(!1);const re=Math.min(...L.angles),ge=Math.max(...L.angles),Se=(L.timestamps[L.timestamps.length-1]-L.timestamps[0])/1e3,Ne=Math.abs(ge-re);let we=0;if(L.downAngles.length>1&&L.downStartTime){const J=(L.downAngles[L.downAngles.length-1].time-L.downStartTime)/1e3;we=Math.abs(L.downAngles[0].angle-L.downAngles[L.downAngles.length-1].angle)/(J||1)}let de=0;if(L.upAngles.length>1&&L.upStartTime){const J=(L.upAngles[L.upAngles.length-1].time-L.upStartTime)/1e3;de=Math.abs(L.upAngles[0].angle-L.upAngles[L.upAngles.length-1].angle)/(J||1)}v&&v({minAngle:re,maxAngle:ge,executionTime:Se,amplitude:Ne,upVelocity:de,downVelocity:we}),L.angles=[],L.timestamps=[],L.upAngles=[],L.downAngles=[],L.upStartTime=null,L.downStartTime=null,L.lastDirection=null,L.lastAngle=null,p("good"),d.current=ue}}else{console.log("⚠️ Insufficient visibility of key points");const ue={leftHip:((H=b==null?void 0:b.score)==null?void 0:H.toFixed(2))||"not detected",leftKnee:((te=w==null?void 0:w.score)==null?void 0:te.toFixed(2))||"not detected",leftAnkle:((V=C==null?void 0:C.score)==null?void 0:V.toFixed(2))||"not detected",rightHip:((Q=_==null?void 0:_.score)==null?void 0:Q.toFixed(2))||"not detected",rightKnee:((se=$==null?void 0:$.score)==null?void 0:se.toFixed(2))||"not detected",rightAnkle:((le=k==null?void 0:k.score)==null?void 0:le.toFixed(2))||"not detected"};console.log("Visibility details:",ue),s==="poor"&&l.current%30===0&&y("Afaste-se um pouco da câmera para que eu possa ver suas pernas completamente.",5e3),l.current+=1}},u0=(t,e,n)=>{if(!t||!e||!n)return 180;const r=Math.atan2(n.y-e.y,n.x-e.x)-Math.atan2(t.y-e.y,t.x-e.x);let a=Math.abs(r*180/Math.PI);return a>180&&(a=360-a),a},HUe=(t,e,n,r,a,s,o,i)=>{const l={};t.forEach(g=>{l[g.name]=g});const u=l.left_hip,c=l.left_knee,d=l.left_ankle,f=l.right_hip,h=l.right_knee,p=l.right_ankle;if((u==null?void 0:u.score)>.3&&(c==null?void 0:c.score)>.3&&(d==null?void 0:d.score)>.3&&(f==null?void 0:f.score)>.3&&(h==null?void 0:h.score)>.3&&(p==null?void 0:p.score)>.3){const g=Er(u,c,d),y=Er(f,h,p);console.log(`LUNGE ANALYSIS - Left angle: ${g.toFixed(1)}°, Right angle: ${y.toFixed(1)}°, isDown: ${e}`);const v=Math.abs(d.x-p.x),x=Math.abs(u.x-f.x),b=v>x*1.5,w=Math.abs(g-y);if(!e&&b&&w>30&&(g<110||y<110)){console.log(`🔍 DETECTED: Lunge position - Knee angle diff: ${w.toFixed(1)}°`),n(!0);const C=Math.min(g,y);C<90?(a("good"),o("Excelente profundidade no avanço!",1e3)):C<110?(a("average"),o("Bom avanço, tente descer um pouco mais.",1e3)):(a("poor"),o("Avanço detectado. Tente dobrar mais o joelho da frente.",1e3))}else if(e&&(!b||g>160&&y>160)){console.log("🟢 LUNGE REP COMPLETED!"),n(!1);const C=Date.now();C-r.current>500&&(r.current=C,s("average"),o("Boa! Repetição contabilizada.",1e3),a(null))}}else Math.random()<.02&&o("Ajuste sua posição para que a câmera possa ver suas pernas.",5e3)},qUe=(t,e,n,r,a,s,o,i,l)=>{const u={};t.forEach(y=>{u[y.name]=y});const c=u.left_shoulder,d=u.left_elbow,f=u.left_wrist,h=u.right_shoulder,p=u.right_elbow,g=u.right_wrist;if((c==null?void 0:c.score)>.5&&(d==null?void 0:d.score)>.5&&(f==null?void 0:f.score)>.5&&(h==null?void 0:h.score)>.5&&(p==null?void 0:p.score)>.5&&(g==null?void 0:g.score)>.5){const y=Er(c,d,f),v=Er(h,p,g),x=(y+v)/2;if(console.log(`PUSHUP ANALYSIS - Elbow angle: ${x.toFixed(1)}°, isDown: ${e}`),x<110&&!e){console.log(`🔍 DETECTED: Push-up down position - Angle: ${x.toFixed(1)}°`),n(!0);const b=xM(u);x<90&&b?(a("good"),o("Excelente posição! Corpo bem alinhado.",1e3)):x<100?(a("average"),o("Boa flexão, mantenha o corpo alinhado.",1e3)):(a("poor"),o("Tente dobrar mais os cotovelos e manter o corpo reto.",1e3))}else if(x>160&&e){console.log(`🟢 PUSHUP REP COMPLETED! Angle: ${x.toFixed(1)}°`),n(!1);const b=Date.now();if(b-r.current>500){r.current=b;let C=xM(u)?"good":"average";s(C),o("Boa! Repetição contabilizada.",1e3),a(null)}}}else Math.random()<.02&&o("Ajuste a câmera para que seus braços e ombros sejam visíveis.",5e3)},xM=t=>{const e=t.nose,n=t.left_shoulder,r=t.right_shoulder,a=t.left_hip,s=t.right_hip;if(!e||!n||!r||!a||!s)return!0;const o={x:(n.x+r.x)/2,y:(n.y+r.y)/2},i={x:(a.x+s.x)/2,y:(a.y+s.y)/2},l=Math.abs(o.y-i.y),u=Math.abs(o.x-i.x);return l/u<.3},ew=(t,e,n,r,a,s,o,i,l,u)=>{const c={};t.forEach(v=>{c[v.name]=v});const d=c.left_shoulder,f=c.left_elbow,h=c.left_wrist,p=c.right_shoulder,g=c.right_elbow,y=c.right_wrist;if((d==null?void 0:d.score)>.5&&(f==null?void 0:f.score)>.5&&(h==null?void 0:h.score)>.5){const v=Er(d,f,h);let x=180;(p==null?void 0:p.score)>.5&&(g==null?void 0:g.score)>.5&&(y==null?void 0:y.score)>.5&&(x=Er(p,g,y));const b=Math.min(v,x);console.log(`BICEPS CURL ANALYSIS - Elbow angle: ${b.toFixed(1)}°, isDown: ${e}`),ew._repData||(ew._repData={angles:[],timestamps:[],lastDirection:null,lastAngle:null,upStartTime:null,downStartTime:null,upAngles:[],downAngles:[]});const w=ew._repData,C=Date.now();w.angles.push(b),w.timestamps.push(C);let _=null;if(w.lastAngle!==null&&(b<w.lastAngle?_="up":b>w.lastAngle&&(_="down")),w.lastAngle=b,_==="up"&&w.lastDirection!=="up"&&(w.upStartTime=C,w.upAngles=[]),_==="down"&&w.lastDirection!=="down"&&(w.downStartTime=C,w.downAngles=[]),_==="up"&&w.upAngles.push({angle:b,time:C}),_==="down"&&w.downAngles.push({angle:b,time:C}),w.lastDirection=_,b<80&&!e){console.log(`🔍 DETECTED: Curl up position - Angle: ${b.toFixed(1)}°`),n(!0);const $=$7([f],c);b<50&&$?(a("good"),o("Excelente contração! Cotovelo estável.",1e3)):b<70?(a("average"),o("Boa rosca, mantenha o cotovelo na mesma posição.",1e3)):(a("poor"),o("Tente dobrar mais o cotovelo e mantê-lo firme.",1e3))}else if(b>160&&e&&(console.log(`🟢 CURL REP COMPLETED! Angle: ${b.toFixed(1)}°`),n(!1),C-r.current>500)){r.current=C;const $=Math.min(...w.angles),k=Math.max(...w.angles),A=(w.timestamps[w.timestamps.length-1]-w.timestamps[0])/1e3,P=Math.abs(k-$);let O=0;if(w.upAngles.length>1&&w.upStartTime){const B=(w.upAngles[w.upAngles.length-1].time-w.upStartTime)/1e3;O=Math.abs(w.upAngles[0].angle-w.upAngles[w.upAngles.length-1].angle)/(B||1)}let R=0;if(w.downAngles.length>1&&w.downStartTime){const B=(w.downAngles[w.downAngles.length-1].time-w.downStartTime)/1e3;R=Math.abs(w.downAngles[0].angle-w.downAngles[w.downAngles.length-1].angle)/(B||1)}u&&u({minAngle:$,maxAngle:k,executionTime:A,amplitude:P,upVelocity:O,downVelocity:R}),w.angles=[],w.timestamps=[],w.upAngles=[],w.downAngles=[],w.upStartTime=null,w.downStartTime=null,w.lastDirection=null,w.lastAngle=null,s("average"),o("Boa! Repetição contabilizada.",1e3),a(null)}}else Math.random()<.02&&o("Ajuste a câmera para que seus braços sejam visíveis.",5e3)},$7=(t,e)=>{if(!t||t.length===0)return!0;const n=e.left_elbow,r=e.right_elbow;if(!n&&!r)return!0;let a=!0;if(n&&t.some(s=>s.name==="left_elbow")){const s=t.find(o=>o.name==="left_elbow");s&&(a=a&&Math.abs(n.x-s.x)<15)}if(r&&t.some(s=>s.name==="right_elbow")){const s=t.find(o=>o.name==="right_elbow");s&&(a=a&&Math.abs(r.x-s.x)<15)}return a},KUe=(t,e,n,r,a,s,o,i)=>{const l={};t.forEach(f=>{l[f.name]=f});const u=l.left_shoulder,c=l.left_hip,d=l.left_knee;if((u==null?void 0:u.score)>.3&&(c==null?void 0:c.score)>.3&&(d==null?void 0:d.score)>.3){const f=Er(d,c,u);console.log(`PLANK ANALYSIS - Hip to shoulder angle: ${f.toFixed(1)}°, isHolding: ${e}`);const h=f>160,p=f>140;if(!e&&(h||p)){console.log(`🔍 DETECTED: Plank position - Alignment angle: ${f.toFixed(1)}°`),n(!0),h?(a("good"),o("Excelente alinhamento na prancha!",2e3)):(a("average"),o("Boa prancha, tente manter o corpo em linha reta.",2e3));const g=Date.now();r.current=g}else if(e)if(p){const g=Date.now()-r.current;if(g>5e3&&g%5e3<100){const y=Math.floor(g/1e3);o(`Continue! ${y} segundos de prancha.`,1e3),y>20&&h?a("good"):y>10&&a("average")}}else{console.log(`🟢 PLANK POSITION ENDED - Held for ${(Date.now()-r.current)/1e3} seconds`),n(!1);const g=Date.now()-r.current;let y="poor";g>2e4?(y="good",o("Excelente! Prancha mantida por tempo ideal.",1e3)):g>1e4?(y="average",o("Bom! Continue aumentando o tempo de prancha.",1e3)):o("Tente manter a prancha por mais tempo.",1e3),s(y),a(null)}}else Math.random()<.02&&o("Posicione a câmera de lado para capturar seu perfil durante a prancha.",5e3)},XUe=({exercise:t,onRepetitionCount:e,onFeedback:n,videoRef:r,onRepIndicatorExtracted:a,stage:s})=>{const o=N.useRef(null),[i,l]=N.useState(!0),[u,c]=N.useState(!0),[d,f]=N.useState(null),{toast:h}=Xr(),[p,g]=N.useState(!1),[y,v]=N.useState(!1),[x,b]=N.useState("poor"),[w,C]=N.useState(0),[_,$]=N.useState(null),k=HP(t),[A,P]=N.useState(0),O=N.useRef(null),R=N.useRef(null),B=N.useRef([]),F=N.useRef([]),L=N.useRef(0),H=N.useRef(Date.now()),te=N.useRef(Date.now()),V=N.useRef(0),Q=N.useRef(null),se=N.useRef({}),le=N.useRef({});N.useEffect(()=>{const J=setInterval(()=>{P(ae=>(ae+.5)%100)},25);return()=>clearInterval(J)},[]);const ue={squat:[{image:"👤 ▲",instruction:"Mantenha os pés na largura dos ombros"},{image:"👤 ↓",instruction:"Dobre os joelhos como se fosse sentar"},{image:"👤 ◯",instruction:"Mantenha as costas retas e o peso nos calcanhares"},{image:"👤 ▲",instruction:"Retorne à posição inicial"}],lunge:[{image:"👤 ▲",instruction:"Fique em pé com os pés juntos"},{image:"👤 ↔",instruction:"Dê um passo à frente com uma perna"},{image:"👤 ↓",instruction:"Dobre ambos os joelhos a 90 graus"},{image:"👤 ▲",instruction:"Empurre de volta para a posição inicial"}],plank:[{image:"👤 ═",instruction:"Apoie-se nos antebraços e pontas dos pés"},{image:"👤 ▬",instruction:"Mantenha o corpo em linha reta"},{image:"👤 ↔",instruction:"Contraia o abdômen e mantenha a posição"},{image:"👤 ═",instruction:"Respire normalmente e sustente"}],pushup:[{image:"👤 ▲",instruction:"Posição de prancha com braços estendidos"},{image:"👤 ↓",instruction:"Dobre os cotovelos, abaixando o corpo"},{image:"👤 ↑",instruction:"Estenda os braços, subindo o corpo"},{image:"👤 ▲",instruction:"Mantenha o corpo alinhado durante todo o movimento"}],curl:[{image:"👤 ▼",instruction:"Fique em pé com os braços estendidos"},{image:"👤 ↑",instruction:"Dobre os cotovelos, elevando os antebraços"},{image:"👤 ⚔️",instruction:"Contraia os bíceps no topo do movimento"},{image:"👤 ▼",instruction:"Retorne à posição inicial lentamente"}]},ce=ue[t]||ue.squat;N.useEffect(()=>{const J=setInterval(()=>{C(ae=>(ae+1)%ce.length)},4e3);return()=>clearInterval(J)},[ce]),N.useEffect(()=>{const J=async()=>{if(r.current)try{console.log("Requesting camera access...");const oe=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:320},height:{ideal:240},frameRate:{ideal:20}},audio:!1});return r.current.srcObject=oe,r.current.setAttribute("playsinline",""),r.current.setAttribute("autoplay",""),new Promise(ye=>{r.current&&(r.current.onloadedmetadata=()=>{var be;console.log("Camera successfully configured"),(be=r.current)==null||be.play().catch(he=>{console.error("Error playing camera stream:",he),f("Error starting camera stream. Please refresh and try again.")}),ye()})})}catch(oe){console.error("Error accessing camera:",oe),f("Error accessing camera. Please check your camera permissions in browser settings."),n("Error accessing camera. Please check your permissions and refresh the page.")}},ae=async()=>{if(i){l(!0);try{console.log("Initializing TensorFlow.js backend...");const oe=await ru(()=>Promise.resolve().then(()=>Ofe),void 0);await ru(()=>import("./index-Qs8fAZRD.js"),[]),await oe.setBackend("webgl"),oe.env().set("WEBGL_CPU_FORWARD",!1),oe.env().set("WEBGL_PACK",!0),oe.env().set("WEBGL_FORCE_F16_TEXTURES",!0),oe.env().set("WEBGL_FLUSH_THRESHOLD",1),await oe.ready(),console.log("TensorFlow.js backend initialized:",oe.getBackend()),console.log("Loading MoveNet model...");const ye=Io.MoveNet,be={modelType:rH.modelType.SINGLEPOSE_LIGHTNING,enableSmoothing:!0};O.current=await nH(ye,be),console.log("MoveNet model loaded successfully"),l(!1)}catch(oe){console.error("Error loading detection model:",oe),f(`Error loading detection model: ${(oe==null?void 0:oe.message)||oe}`),n(`Error loading detection model: ${(oe==null?void 0:oe.message)||oe}`),l(!1)}}};return(async()=>{try{await J(),c(!1),await ae(),r.current&&o.current&&O.current&&(console.log("Starting pose detection"),Se())}catch(oe){console.error("Error during initialization:",oe),f("An error occurred during initialization. Please refresh and try again."),n("An error occurred during initialization. Please refresh and try again.")}})(),()=>{console.log("Cleaning up EnhancedPoseDetection..."),R.current&&(cancelAnimationFrame(R.current),R.current=null),r.current&&r.current.srcObject&&(r.current.srcObject.getTracks().forEach(ye=>{ye.stop(),console.log("Camera track stopped in cleanup:",ye.label)}),r.current.srcObject=null),Q.current&&(clearTimeout(Q.current),Q.current=null)}},[n]);const re=async()=>{if(!(!O.current||!r.current||!o.current))try{const J=await O.current.estimatePoses(r.current);if(J.length>0){const ae=J[0].keypoints;B.current=ae,L.current%5===0&&(F.current=[...ae]),ge(ae),we(ae),Ne(J[0],o.current)}L.current++,R.current=requestAnimationFrame(re)}catch(J){console.error("Erro durante a detecção de pose:",J),n("Erro na detecção. Tente reiniciar o exercício."),setTimeout(()=>{R.current=requestAnimationFrame(re)},2e3)}},ge=J=>{if(L.current<10)return;const ae={};if(J.forEach(U=>{ae[U.name]=U}),L.current%10===0)try{const U=ae.left_shoulder,oe=ae.right_shoulder;if(U&&oe&&U.score&&oe.score&&U.score>.5&&oe.score>.5){const ye=Math.sqrt(Math.pow(oe.x-U.x,2)+Math.pow(oe.y-U.y,2)),be=se.current.shoulderWidth||ye,he=ye-be;se.current.shoulderWidth=ye,le.current.shoulder||(le.current.shoulder=[]),le.current.shoulder.push(he),le.current.shoulder.length>30&&le.current.shoulder.shift()}}catch(U){console.error("Error estimating depth:",U)}},Se=()=>{R.current&&cancelAnimationFrame(R.current),R.current=requestAnimationFrame(re)},Ne=(J,ae)=>{const U=ae.getContext("2d");if(!U||!r.current)return;(ae.width!==r.current.videoWidth||ae.height!==r.current.videoHeight)&&(ae.width=r.current.videoWidth,ae.height=r.current.videoHeight),U.clearRect(0,0,ae.width,ae.height),U.drawImage(r.current,0,0),_&&(U.fillStyle=_==="good"?"rgba(0, 255, 0, 0.2)":_==="average"?"rgba(255, 255, 0, 0.2)":"rgba(255, 0, 0, 0.2)",U.fillRect(0,0,ae.width,ae.height)),U.fillStyle="#fff",U.fillRect(0,0,ae.width,4),U.fillStyle="#1EAEDB",U.fillRect(0,0,ae.width*A/100,4);const oe=J.keypoints;U.strokeStyle="#4361EE",U.lineWidth=4;const ye=[["left_shoulder","right_shoulder"],["left_shoulder","left_hip"],["right_shoulder","right_hip"],["left_hip","right_hip"],["left_shoulder","left_elbow"],["right_shoulder","right_elbow"],["left_elbow","left_wrist"],["right_elbow","right_wrist"],["left_hip","left_knee"],["right_hip","right_knee"],["left_knee","left_ankle"],["right_knee","right_ankle"]],be={};oe.forEach(he=>{be[he.name]=he}),ye.forEach(([he,De])=>{const Ve=be[he],Ye=be[De];if(Ve&&Ye&&Ve.score&&Ye.score&&Ve.score>.2&&Ye.score>.2){const Ze=he.includes("knee")||De.includes("knee")||he.includes("ankle")||De.includes("ankle")||he.includes("hip"),It=he.includes("shoulder")||De.includes("shoulder")||he.includes("elbow")||De.includes("elbow")||he.includes("wrist");(t==="squat"||t==="lunge")&&Ze&&y?(U.strokeStyle="#ea384c",U.lineWidth=6):(t==="pushup"||t==="plank")&&(It||he.includes("hip")&&De.includes("shoulder"))&&y?(U.strokeStyle="#e07c00",U.lineWidth=6):t==="curl"&&It&&y?(U.strokeStyle="#8c00e0",U.lineWidth=6):(t==="squat"||t==="lunge")&&Ze?(U.strokeStyle="#0EA5E9",U.lineWidth=5):(t==="pushup"||t==="plank"||t==="curl")&&It?(U.strokeStyle="#22c55e",U.lineWidth=5):(U.strokeStyle="#4361EE",U.lineWidth=4),U.beginPath(),U.moveTo(Ve.x,Ve.y),U.lineTo(Ye.x,Ye.y),U.stroke()}}),oe.forEach(he=>{var Ve,Ye,Ze,It,rn,an,ar,Nr,Zr,Te,st,pt,$n,Jn;let De=.4;if(t==="squat"||t==="lunge"?De=(Ve=he.name)!=null&&Ve.includes("knee")||(Ye=he.name)!=null&&Ye.includes("ankle")||(Ze=he.name)!=null&&Ze.includes("hip")?.2:.4:(t==="pushup"||t==="curl"||t==="plank")&&(De=(It=he.name)!=null&&It.includes("shoulder")||(rn=he.name)!=null&&rn.includes("elbow")||(an=he.name)!=null&&an.includes("wrist")?.2:.4),he.score&&he.score>De)if((t==="squat"||t==="lunge")&&(((ar=he.name)==null?void 0:ar.includes("knee"))||((Nr=he.name)==null?void 0:Nr.includes("ankle"))||((Zr=he.name)==null?void 0:Zr.includes("hip")))||(t==="pushup"||t==="curl"||t==="plank")&&(((Te=he.name)==null?void 0:Te.includes("shoulder"))||((st=he.name)==null?void 0:st.includes("elbow"))||((pt=he.name)==null?void 0:pt.includes("wrist")))){if(y){const wt=t==="squat"||t==="lunge"?"#ea384c":t==="pushup"||t==="plank"?"#e07c00":"#8c00e0";U.fillStyle=wt,U.beginPath(),U.arc(he.x,he.y,10,0,2*Math.PI),U.fill(),U.strokeStyle="#FFFFFF",U.lineWidth=2,U.stroke()}else{const wt=t==="squat"||t==="lunge"?"#0EA5E9":t==="pushup"||t==="plank"?"#22c55e":"#a855f7";U.fillStyle=wt,U.beginPath(),U.arc(he.x,he.y,8,0,2*Math.PI),U.fill()}if((t==="squat"||t==="lunge")&&(($n=he.name)!=null&&$n.includes("knee"))){const wt=be[he.name.includes("left")?"left_hip":"right_hip"],Vt=he,sn=be[he.name.includes("left")?"left_ankle":"right_ankle"];if(wt&&Vt&&sn&&wt.score&&Vt.score&&sn.score&&wt.score>.2&&Vt.score>.2&&sn.score>.2){const Is=Er(wt,Vt,sn);U.fillStyle="#FFFFFF",U.strokeStyle="#000000",U.lineWidth=3,U.font="bold 16px Arial",U.strokeText(`${Math.round(Is)}°`,Vt.x+15,Vt.y),U.fillText(`${Math.round(Is)}°`,Vt.x+15,Vt.y)}}else if((t==="pushup"||t==="curl")&&((Jn=he.name)!=null&&Jn.includes("elbow"))){const wt=be[he.name.includes("left")?"left_shoulder":"right_shoulder"],Vt=he,sn=be[he.name.includes("left")?"left_wrist":"right_wrist"];if(wt&&Vt&&sn&&wt.score&&Vt.score&&sn.score&&wt.score>.2&&Vt.score>.2&&sn.score>.2){const Is=Er(wt,Vt,sn);U.fillStyle="#FFFFFF",U.strokeStyle="#000000",U.lineWidth=3,U.font="bold 16px Arial",U.strokeText(`${Math.round(Is)}°`,Vt.x+15,Vt.y),U.fillText(`${Math.round(Is)}°`,Vt.x+15,Vt.y)}}}else U.fillStyle="#F72585",U.beginPath(),U.arc(he.x,he.y,6,0,2*Math.PI),U.fill()})},we=J=>{const ae={};switch(J.forEach(oe=>{ae[oe.name]=oe}),vLe(ae,t)?(V.current+=1,V.current>30?b("excellent"):V.current>15&&b("good"),V.current===15?de("Posicionamento bom! Pronto para começar.",2e3):V.current===30&&de("Excelente posicionamento! Continue assim.",2e3)):(V.current=Math.max(0,V.current-1),V.current<5?(b("poor"),L.current%60===0&&de(k.positioningInstructions,3e3)):b("good")),t){case"squat":bg(J,p,g,y,v,x,b,V,L,se,le,te,H,$,e,n,de,a);break;case"lunge":HUe(J,p,g,te,$,e,de);break;case"pushup":qUe(J,p,g,te,$,e,de);break;case"curl":ew(J,p,g,te,$,e,de,n,$7,a);break;case"plank":KUe(J,p,g,te,$,e,de);break;default:bg(J,p,g,y,v,x,b,V,L,se,le,te,H,$,e,n,de,a);break}},de=(J,ae)=>{const U=Date.now();U-H.current>ae&&(H.current=U,n(J),(J.includes("Repetição contabilizada")||J.includes("Excelente")||J.includes("Série completa"))&&h({title:"🏋️ "+J,duration:1e3}),Q.current&&clearTimeout(Q.current))};return m.jsxs("div",{className:"relative min-h-[400px] sm:min-h-[500px] w-full",children:[m.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,style:{position:"absolute",width:"100%",height:"100%",objectFit:"cover",opacity:.01,zIndex:-1}}),m.jsx("canvas",{ref:o,className:"w-full h-full object-cover"}),(i||u)&&m.jsxs("div",{className:"absolute inset-0 bg-black/50 flex flex-col items-center justify-center text-white",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white mb-4"}),m.jsx("p",{className:"text-center",children:u?"Acessando câmera...":"Carregando modelo de IA..."}),m.jsx("p",{className:"text-sm text-gray-300 mt-2",children:"Por favor, permita o acesso à câmera se solicitado"})]}),d&&m.jsx("div",{className:"absolute inset-0 bg-red-500/20 flex flex-col items-center justify-center text-white p-4",children:m.jsxs("div",{className:"bg-red-600 p-4 rounded-lg max-w-md",children:[m.jsx("p",{className:"font-bold text-lg mb-2",children:"Erro"}),m.jsx("p",{children:d}),m.jsx("button",{className:"mt-4 bg-white text-red-600 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors",onClick:()=>{f(null),window.location.reload()},children:"Tentar Novamente"})]})}),y&&m.jsxs("div",{className:"absolute bottom-4 left-4 bg-red-500 px-4 py-2 rounded-full text-white text-base font-bold animate-pulse shadow-lg",children:[k.name," Detectado!"]}),m.jsx("div",{className:`absolute top-4 left-4 px-4 py-2 rounded-full text-white text-base font-bold 
                      ${x==="poor"?"bg-red-500":x==="good"?"bg-yellow-500":"bg-green-500"}`,children:m.jsxs("div",{className:"text-base font-bold max-w-full break-words",children:["Detecção: ",x==="poor"?"Ruim":x==="good"?"Boa":"Excelente"]})}),x==="poor"&&m.jsx("div",{className:"absolute top-4 right-4 bg-blue-500 px-4 py-2 rounded-lg text-white text-sm font-bold animate-bounce",children:m.jsx("div",{className:"text-sm max-w-full break-words",children:k.positioningInstructions})})]})},J_=[{id:"squat",name:"Agachamento"},{id:"agachamento",name:"Agachamento"},{id:"push-up",name:"Flexão de Braço"},{id:"pushup",name:"Flexão de Braço"},{id:"flexao",name:"Flexão de Braço"},{id:"biceps-curl",name:"Rosca Bíceps"},{id:"curl",name:"Rosca Bíceps"},{id:"lunge",name:"Avanço"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"},{id:"calfRaises",name:"Elevação de Panturrilha"},{id:"jumpSquat",name:"Agachamento com Salto"}],YUe=()=>{const{exerciseId:t=""}=xE(),e=zn(),n=Po(),{toast:r}=Xr(),a=N.useRef(null),[s,o]=N.useState(null),[i,l]=N.useState(!1),[u,c]=N.useState("intro"),[d,f]=N.useState(0),[h,p]=N.useState(1),g=3,y=12,[v,x]=N.useState(null),[b,w]=N.useState(0),[C,_]=N.useState(!1),[$,k]=N.useState(60),A=60,[P,O]=N.useState(!1),[R,B]=N.useState({total:0,good:0,average:0,poor:0}),[F,L]=N.useState(null),[H,te]=N.useState(!1),[V,Q]=N.useState(!1),[se,le]=N.useState([]),[ue,ce]=N.useState(!1),[re,ge]=N.useState(!1),Se=d/y*100,Ne=N.useRef(null),we=N.useRef(null);N.useEffect(()=>{const Te=pt=>nO(pt||"").toLowerCase(),st=localStorage.getItem("currentExercise");if(st){const pt=JSON.parse(st);let $n=null;pt.id&&($n=J_.find(Jn=>Te(Jn.id)===Te(pt.id)||Te(Jn.name)===Te(pt.id))),!$n&&pt.name&&($n=J_.find(Jn=>Te(Jn.name)===Te(pt.name))),o({...pt,name:($n==null?void 0:$n.name)||pt.name||"Exercício"})}else{const pt=J_.find($n=>Te($n.id)===Te(t)||Te($n.name)===Te(t));o({id:t,name:(pt==null?void 0:pt.name)||"Exercício",muscles:""})}return()=>{Ne.current&&window.clearInterval(Ne.current),we.current&&window.clearInterval(we.current)}},[t]);const de=()=>{c("setup")};N.useEffect(()=>(i&&u==="active"?Ne.current=window.setInterval(()=>{w(Te=>Te+1)},1e3):(!i||u!=="active")&&Ne.current&&(window.clearInterval(Ne.current),Ne.current=null),()=>{Ne.current&&window.clearInterval(Ne.current)}),[i,u]),N.useEffect(()=>(u==="rest"?we.current=window.setInterval(()=>{k(Te=>Te<=1?(we.current&&(clearInterval(we.current),we.current=null),c("active"),k(60),f(0),0):Te-1)},1e3):we.current&&(clearInterval(we.current),we.current=null),()=>{we.current&&clearInterval(we.current)}),[u]),N.useEffect(()=>{if(P){const Te=setTimeout(()=>{O(!1)},1e3);return()=>clearTimeout(Te)}},[P]),N.useEffect(()=>{if(C&&$>0){const Te=setTimeout(()=>k($-1),1e3);return()=>clearTimeout(Te)}},[C,$]);const J=()=>{l(!0),c("active"),r({title:"Treino iniciado",description:"Posicione-se na frente da câmera.",duration:2e3})},ae=()=>{u==="active"?(c("paused"),r({title:"Treino pausado",description:"Clique em Retomar para continuar.",duration:2e3})):u==="paused"&&(c("active"),r({title:"Treino retomado",description:"Continue seu exercício.",duration:2e3}))},U=()=>{f(0),x(null),L(null),c("active"),l(!0),r({title:"Treino reiniciado",description:"Posicione-se na frente da câmera.",duration:2e3})},oe=()=>{a.current&&a.current.srcObject&&a.current.srcObject.getTracks().forEach(st=>st.stop()),Ne.current&&clearInterval(Ne.current),Q(!0)},ye=Te=>{["squat","agachamento","curl","hammer-curl","rosca-triceps"].includes((s==null?void 0:s.id)||"")||f(st=>st+1>=y?h>=g?(Q(!0),0):(_(!0),c("rest"),k(A),setTimeout(()=>{p(pt=>pt+1),_(!1),c("active"),f(0)},A*1e3),0):st+1)},be=Te=>{["squat","agachamento","curl","hammer-curl","rosca-triceps"].includes((s==null?void 0:s.id)||"")&&u==="active"&&f(st=>(Te&&le(pt=>[...pt,Te]),st+1>=y?h>=g?(Q(!0),0):(_(!0),c("rest"),k(A),setTimeout(()=>{p(pt=>pt+1),_(!1),c("active"),f(0)},A*1e3),0):st+1))},he=Te=>{!Te||typeof Te.minAngle!="number"||be(Te)},De=Te=>{Te!==v&&x(Te)},Ve=Te=>{const st=Math.floor(Te/60),pt=Te%60;return`${st.toString().padStart(2,"0")}:${pt.toString().padStart(2,"0")}`},Ye=()=>{e("/workout/summary",{state:{elapsedTime:b,series:h,repStats:{total:R.total,good:R.good,average:R.average,poor:R.poor}}})},Ze=()=>{e(-1)},It=()=>{e("/dashboard")},rn=()=>{te(Te=>!Te)},an=d===0?h-1:h-(d<y?1:0),ar=an*y,Nr=async()=>{if(!(ue||re)){ge(!0);try{const{data:{user:Te}}=await Pt.auth.getUser();if(!Te){r({title:"Usuário não autenticado",variant:"destructive"}),ge(!1);return}if(["squat","agachamento","curl","hammer-curl","rosca-triceps"].includes((s==null?void 0:s.id)||"")&&se.length<1){r({title:"Nenhuma métrica de repetição para salvar."}),ge(!1);return}const st=[];let pt=0,$n=1;for(;pt+y<=se.length;){const ya=se.slice(pt,pt+y).map((wt,Vt)=>({repetitionNumber:parseFloat((Vt+1).toFixed(2)),quality:"good",duration_seconds:parseFloat(wt.executionTime.toFixed(2)),extra_data:{minAngle:parseFloat(wt.minAngle.toFixed(2)),maxAngle:parseFloat(wt.maxAngle.toFixed(2)),executionTime:parseFloat(wt.executionTime.toFixed(2)),amplitude:parseFloat(wt.amplitude.toFixed(2)),upVelocity:parseFloat(wt.upVelocity.toFixed(2)),downVelocity:parseFloat(wt.downVelocity.toFixed(2)),modelo:(s==null?void 0:s.modelo)||(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").modelo:void 0),carga:(s==null?void 0:s.carga)??(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").carga:void 0)}}));st.push({seriesNumber:$n,repetitions:ya.length,completed:!0,metrics:ya}),pt+=y,$n++}if(se.length%y>0){const ya=se.slice(pt).map((wt,Vt)=>({repetitionNumber:parseFloat((Vt+1).toFixed(2)),quality:"good",duration_seconds:parseFloat(wt.executionTime.toFixed(2)),extra_data:{minAngle:parseFloat(wt.minAngle.toFixed(2)),maxAngle:parseFloat(wt.maxAngle.toFixed(2)),executionTime:parseFloat(wt.executionTime.toFixed(2)),amplitude:parseFloat(wt.amplitude.toFixed(2)),upVelocity:parseFloat(wt.upVelocity.toFixed(2)),downVelocity:parseFloat(wt.downVelocity.toFixed(2)),modelo:(s==null?void 0:s.modelo)||(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").modelo:void 0),carga:(s==null?void 0:s.carga)??(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").carga:void 0)}}));st.push({seriesNumber:$n,repetitions:ya.length,completed:!1,metrics:ya})}await VK({userId:Te.id,totalTime:Math.round(b/60),xp:st.length*10,exercises:[{name:(s==null?void 0:s.name)||"Exercício",modelo:(s==null?void 0:s.modelo)||(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").modelo:void 0),carga:(s==null?void 0:s.carga)??(typeof window<"u"?JSON.parse(localStorage.getItem("currentExercise")||"{}").carga:void 0),sets:st}]}),ce(!0),r({title:"Treino salvo com sucesso!"})}catch(Te){r({title:"Erro ao salvar treino",description:(Te==null?void 0:Te.message)||JSON.stringify(Te),variant:"destructive"})}finally{ge(!1)}}};function Zr(Te){if(!Te)return"squat";const st=ya=>(ya||"").normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase(),pt={agachamento:"squat",squat:"squat","push-up":"pushup",pushup:"pushup",flexao:"pushup",flexão:"pushup","biceps-curl":"curl",curl:"curl","rosca biceps":"curl","rosca bíceps":"curl",lunge:"lunge",afundo:"lunge","leg-press":"leg-press","cadeira-extensora":"cadeira-extensora","hammer-curl":"hammer-curl",triceps:"triceps","rosca-triceps":"rosca-triceps",supino:"supino",crossover:"crossover","crossover-baixo":"crossover-baixo",remada:"remada","lat-push":"lat-push","lat-pull":"lat-pull","seated-row":"seated-row",abdominal:"abdominal","levantamento-lateral":"levantamento-lateral","levantamento-frontal":"levantamento-frontal",desenvolvimento:"desenvolvimento","crucifixo-invertido":"crucifixo-invertido",calfraises:"calfRaises","elevação de panturrilha":"calfRaises",jumpsquat:"jumpSquat","agachamento com salto":"jumpSquat",plank:"plank",prancha:"plank"},$n=st(Te.id);if(pt[$n])return pt[$n];const Jn=st(Te.name);return pt[Jn]?pt[Jn]:$n||"squat"}return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),u==="intro"&&m.jsx(dK,{exerciseId:Zr(s),onComplete:de}),P&&m.jsx("div",{className:"fixed inset-0 bg-green-500 bg-opacity-50 z-40 animate-pulse flex items-center justify-center",children:m.jsx("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:m.jsx("h2",{className:"text-xl font-bold text-center",children:"Série completa!"})})}),F&&m.jsx("div",{className:`fixed inset-0 z-30 ${F==="good"?"bg-green-500":F==="average"?"bg-yellow-500":"bg-red-500"} bg-opacity-30 pointer-events-none`}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-1 px-1",children:[m.jsxs("div",{className:"flex items-center justify-between mb-0 min-h-0 h-12",style:{paddingTop:0,paddingBottom:0},children:[m.jsx("button",{onClick:Ze,className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("div",{className:"flex-1 flex items-center justify-center",children:m.jsxs("h1",{className:"formfit-heading text-center text-xs sm:text-base md:text-lg lg:text-xl m-0",children:["Execução do exercício",s!=null&&s.name?`: ${s.name}`:""]})}),m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{onClick:It,className:"p-1 hover:bg-gray-200 rounded-full transition-colors mr-1",title:"Ir para Dashboard",children:m.jsx(vS,{className:"h-5 w-5"})}),m.jsx("button",{onClick:rn,className:"p-1 hover:bg-gray-200 rounded-full transition-colors",title:"Ver estatísticas",children:m.jsx(Dk,{className:"h-5 w-5"})})]})]}),m.jsx("div",{className:"h-1 bg-gray-200 w-full rounded-full overflow-hidden mb-4",children:m.jsx("div",{className:"h-full bg-formfit-blue transition-all duration-300 ease-out",style:{width:`${Se}%`}})}),H?m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[m.jsx(vK,{elapsedTime:b,repStats:R,series:h}),m.jsx(pe,{onClick:rn,className:"w-full mt-4",variant:"outline",children:"Voltar ao Treino"})]}):m.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-h-[500px]",children:[m.jsxs("div",{className:"relative bg-gray-100",children:[u==="setup"&&!i&&m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800 bg-opacity-50 text-white min-h-[60vh]",children:[m.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Preparado para começar?"}),m.jsxs(pe,{onClick:J,className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white px-8 py-6",size:"lg",children:[m.jsx(ko,{className:"mr-2 h-5 w-5"}),"Iniciar Exercício"]})]}),u==="paused"&&m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800 bg-opacity-70 text-white",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Treino Pausado"}),m.jsxs("div",{className:"flex space-x-4",children:[m.jsxs(pe,{onClick:ae,className:"bg-green-500 hover:bg-green-600",size:"lg",children:[m.jsx(ko,{className:"mr-2 h-5 w-5"})," Retomar"]}),m.jsxs(pe,{onClick:U,className:"bg-blue-500 hover:bg-blue-600",size:"lg",children:[m.jsx(YD,{className:"mr-2 h-5 w-5"})," Reiniciar"]})]})]}),u==="rest"&&m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800 bg-opacity-70 text-white",children:[m.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Descanse"}),m.jsx("div",{className:"text-5xl font-bold mb-4",children:Ve($)}),m.jsx("p",{className:"text-lg",children:"Próxima série em breve"})]}),u==="complete"&&m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800 bg-opacity-70 text-white p-4",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Treino Finalizado!"}),m.jsxs("p",{className:"text-lg mb-2",children:["Séries: ",h,"/",g]}),m.jsxs("p",{className:"text-lg mb-6",children:["Repetições: ",R.total]}),m.jsxs("div",{className:"flex space-x-4",children:[m.jsxs(pe,{onClick:U,className:"bg-blue-500 hover:bg-blue-600",size:"lg",children:[m.jsx(YD,{className:"mr-2 h-5 w-5"})," Novo Treino"]}),m.jsx(pe,{onClick:async()=>{await Nr(),Ye()},className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white",size:"lg",children:"Ver Resumo do Treino"})]})]}),(u==="active"||u==="paused")&&m.jsx("div",{className:"relative",children:m.jsx(XUe,{exercise:(s==null?void 0:s.id)||"",onRepetitionCount:ye,onFeedback:De,videoRef:a,onRepIndicatorExtracted:he,stage:u})})]}),m.jsxs("div",{className:"p-2 mt-0",children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Dk,{className:"h-5 w-5 text-formfit-blue"}),m.jsx("span",{className:"font-medium",children:Ve(b)})]}),m.jsxs("div",{className:"px-4 py-1 bg-formfit-blue rounded-full text-white font-medium",children:["Série ",h,"/",g]}),m.jsxs("div",{className:"text-lg font-bold",children:[d,"/",y," reps"]})]}),(u==="active"||u==="paused")&&m.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[m.jsxs(pe,{variant:"outline",size:"lg",onClick:()=>{console.log("Pause button clicked"),ae()},className:"flex items-center gap-2",children:[u==="active"?m.jsx(pV,{className:"h-5 w-5"}):m.jsx(ko,{className:"h-5 w-5"}),u==="active"?"Pausar":"Retomar"]}),m.jsxs(pe,{variant:"destructive",size:"lg",onClick:()=>{console.log("Stop button clicked"),oe()},className:"flex items-center gap-2",disabled:re||ue,children:[m.jsx(xre,{className:"h-5 w-5"}),"Finalizar"]})]}),m.jsx("div",{className:`p-3 rounded-lg mb-4 ${v!=null&&v.includes("Correto")||v!=null&&v.includes("Boa")||v!=null&&v.includes("Excelente")?"bg-green-100 text-green-800":v!=null&&v.includes("Ajuste")||v!=null&&v.includes("Razoável")?"bg-yellow-100 text-yellow-800":"bg-red-50 text-red-800"}`,children:m.jsx("p",{className:"font-medium",children:v||"Aguardando..."})})]})]})]})}),V&&m.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:m.jsx("div",{className:"bg-white p-8 rounded-lg shadow-lg flex flex-col items-center max-w-md w-full mx-4",children:an<=0?m.jsxs(m.Fragment,{children:[m.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Treino pausado"}),m.jsxs("p",{className:"text-gray-600 mb-6 text-center",children:["Você está na ",h,"ª série com ",d," repetições."]}),m.jsxs("div",{className:"flex flex-col space-y-4 w-full",children:[m.jsx(pe,{onClick:()=>Q(!1),className:"w-full bg-formfit-blue hover:bg-formfit-blue/90 text-white",children:"Retomar Treino"}),m.jsx(pe,{onClick:()=>{var Te;return e(((Te=n.state)==null?void 0:Te.returnTo)||"/treinos")},variant:"outline",className:"w-full",children:"Voltar para Treinos"})]})]}):m.jsxs(m.Fragment,{children:[m.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Você concluiu o treino!"}),m.jsxs("p",{className:"text-gray-600 mb-6 text-center",children:["Você completou ",an," série(s) e ",ar," repetições."]}),m.jsxs("div",{className:"flex flex-col space-y-4 w-full",children:[m.jsx(pe,{onClick:async()=>{await Nr(),Ye()},className:"w-full bg-formfit-blue hover:bg-formfit-blue/90 text-white",children:"Ver Resumo do Treino"}),m.jsx(pe,{onClick:async()=>{var Te;await Nr(),e(((Te=n.state)==null?void 0:Te.returnTo)||"/treinos")},variant:"outline",className:"w-full",children:"Voltar para Treinos"})]})]})})}),C&&m.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-90 z-50",children:m.jsxs("div",{className:"bg-white p-8 rounded shadow-lg flex flex-col items-center",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Modo descanso"}),m.jsxs("p",{className:"text-3xl font-mono",children:[$,"s"]})]})}),se.length>0&&se.every(Te=>Te&&typeof Te.minAngle=="number")?m.jsx("div",{className:"overflow-x-auto mt-6 flex justify-center",children:m.jsxs("table",{className:"min-w-[500px] text-xs text-center bg-white rounded-lg shadow border border-gray-200",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"font-bold py-2 px-4 text-left",children:"Indicador"}),se.map((Te,st)=>m.jsxs("th",{className:"font-bold py-2 px-4 min-w-[70px]",children:["Rep ",st+1]},st))]})}),m.jsxs("tbody",{children:[m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Ângulo Mínimo"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.minAngle.toFixed(1),"º"]},st))]}),m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Ângulo Máximo"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.maxAngle.toFixed(1),"º"]},st))]}),m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Tempo Execução"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.executionTime.toFixed(2),"s"]},st))]}),m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Amplitude"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.amplitude.toFixed(1),"º"]},st))]}),m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Vel. Subida"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.upVelocity.toFixed(2),"º/s"]},st))]}),m.jsxs("tr",{children:[m.jsx("td",{className:"font-bold py-2 px-4 text-left",children:"Vel. Descida"}),se.map((Te,st)=>m.jsxs("td",{className:"py-2 px-4",children:[Te.downVelocity.toFixed(2),"º/s"]},st))]})]})]})}):m.jsx("div",{className:"mt-6 flex justify-center",children:m.jsx("table",{className:"min-w-[350px] text-xs text-left bg-white rounded-lg shadow border border-gray-200",children:m.jsxs("tbody",{children:[m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Ângulo Mínimo"})}),m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Ângulo Máximo"})}),m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Tempo Execução"})}),m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Amplitude"})}),m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Vel. Subida"})}),m.jsx("tr",{children:m.jsx("td",{className:"font-bold py-2 px-4",children:"Vel. Descida"})})]})})})]})};function QUe(t,e=globalThis==null?void 0:globalThis.document){const n=to(t);N.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var JUe="DismissableLayer",VN="dismissableLayer.update",ZUe="dismissableLayer.pointerDownOutside",eVe="dismissableLayer.focusOutside",bM,k7=N.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),iO=N.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:o,onDismiss:i,...l}=t,u=N.useContext(k7),[c,d]=N.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=N.useState({}),p=Aa(e,$=>d($)),g=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(y),x=c?g.indexOf(c):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,w=x>=v,C=nVe($=>{const k=$.target,A=[...u.branches].some(P=>P.contains(k));!w||A||(a==null||a($),o==null||o($),$.defaultPrevented||i==null||i())},f),_=rVe($=>{const k=$.target;[...u.branches].some(P=>P.contains(k))||(s==null||s($),o==null||o($),$.defaultPrevented||i==null||i())},f);return QUe($=>{x===u.layers.size-1&&(r==null||r($),!$.defaultPrevented&&i&&($.preventDefault(),i()))},f),N.useEffect(()=>{if(c)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(bM=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),wM(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=bM)}},[c,f,n,u]),N.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),wM())},[c,u]),N.useEffect(()=>{const $=()=>h({});return document.addEventListener(VN,$),()=>document.removeEventListener(VN,$)},[]),m.jsx(nn.div,{...l,ref:p,style:{pointerEvents:b?w?"auto":"none":void 0,...t.style},onFocusCapture:Ht(t.onFocusCapture,_.onFocusCapture),onBlurCapture:Ht(t.onBlurCapture,_.onBlurCapture),onPointerDownCapture:Ht(t.onPointerDownCapture,C.onPointerDownCapture)})});iO.displayName=JUe;var tVe="DismissableLayerBranch",N7=N.forwardRef((t,e)=>{const n=N.useContext(k7),r=N.useRef(null),a=Aa(e,r);return N.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),m.jsx(nn.div,{...t,ref:a})});N7.displayName=tVe;function nVe(t,e=globalThis==null?void 0:globalThis.document){const n=to(t),r=N.useRef(!1),a=N.useRef(()=>{});return N.useEffect(()=>{const s=i=>{if(i.target&&!r.current){let l=function(){I7(ZUe,n,u,{discrete:!0})};const u={originalEvent:i};i.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=l,e.addEventListener("click",a.current,{once:!0})):l()}else e.removeEventListener("click",a.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",a.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function rVe(t,e=globalThis==null?void 0:globalThis.document){const n=to(t),r=N.useRef(!1);return N.useEffect(()=>{const a=s=>{s.target&&!r.current&&I7(eVe,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function wM(){const t=new CustomEvent(VN);document.dispatchEvent(t)}function I7(t,e,n,{discrete:r}){const a=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?fK(a,s):a.dispatchEvent(s)}var aVe=iO,sVe=N7,Z_="focusScope.autoFocusOnMount",e$="focusScope.autoFocusOnUnmount",SM={bubbles:!1,cancelable:!0},oVe="FocusScope",T7=N.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...o}=t,[i,l]=N.useState(null),u=to(a),c=to(s),d=N.useRef(null),f=Aa(e,g=>l(g)),h=N.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.useEffect(()=>{if(r){let g=function(b){if(h.paused||!i)return;const w=b.target;i.contains(w)?d.current=w:ml(d.current,{select:!0})},y=function(b){if(h.paused||!i)return;const w=b.relatedTarget;w!==null&&(i.contains(w)||ml(d.current,{select:!0}))},v=function(b){if(document.activeElement===document.body)for(const C of b)C.removedNodes.length>0&&ml(i)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const x=new MutationObserver(v);return i&&x.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),x.disconnect()}}},[r,i,h.paused]),N.useEffect(()=>{if(i){_M.add(h);const g=document.activeElement;if(!i.contains(g)){const v=new CustomEvent(Z_,SM);i.addEventListener(Z_,u),i.dispatchEvent(v),v.defaultPrevented||(iVe(fVe(E7(i)),{select:!0}),document.activeElement===g&&ml(i))}return()=>{i.removeEventListener(Z_,u),setTimeout(()=>{const v=new CustomEvent(e$,SM);i.addEventListener(e$,c),i.dispatchEvent(v),v.defaultPrevented||ml(g??document.body,{select:!0}),i.removeEventListener(e$,c),_M.remove(h)},0)}}},[i,u,c,h]);const p=N.useCallback(g=>{if(!n&&!r||h.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(y&&v){const x=g.currentTarget,[b,w]=lVe(x);b&&w?!g.shiftKey&&v===w?(g.preventDefault(),n&&ml(b,{select:!0})):g.shiftKey&&v===b&&(g.preventDefault(),n&&ml(w,{select:!0})):v===x&&g.preventDefault()}},[n,r,h.paused]);return m.jsx(nn.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});T7.displayName=oVe;function iVe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(ml(r,{select:e}),document.activeElement!==n)return}function lVe(t){const e=E7(t),n=CM(e,t),r=CM(e.reverse(),t);return[n,r]}function E7(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function CM(t,e){for(const n of t)if(!uVe(n,{upTo:e}))return n}function uVe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function cVe(t){return t instanceof HTMLInputElement&&"select"in t}function ml(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&cVe(t)&&e&&t.select()}}var _M=dVe();function dVe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=$M(t,e),t.unshift(e)},remove(e){var n;t=$M(t,e),(n=t[0])==null||n.resume()}}}function $M(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function fVe(t){return t.filter(e=>e.tagName!=="A")}var hVe="Portal",lO=N.forwardRef((t,e)=>{var i;const{container:n,...r}=t,[a,s]=N.useState(!1);eh(()=>s(!0),[]);const o=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return o?kte.createPortal(m.jsx(nn.div,{...r,ref:e}),o):null});lO.displayName=hVe;var t$=0;function pVe(){N.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??kM()),document.body.insertAdjacentElement("beforeend",t[1]??kM()),t$++,()=>{t$===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),t$--}},[])}function kM(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var qo=function(){return qo=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},qo.apply(this,arguments)};function A7(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function mVe(t,e,n){if(n||arguments.length===2)for(var r=0,a=e.length,s;r<a;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var tw="right-scroll-bar-position",nw="width-before-scroll-bar",gVe="with-scroll-bars-hidden",yVe="--removed-body-scroll-bar-size";function n$(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function vVe(t,e){var n=N.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=e,n.facade}var xVe=typeof window<"u"?N.useLayoutEffect:N.useEffect,NM=new WeakMap;function bVe(t,e){var n=vVe(null,function(r){return t.forEach(function(a){return n$(a,r)})});return xVe(function(){var r=NM.get(n);if(r){var a=new Set(r),s=new Set(t),o=n.current;a.forEach(function(i){s.has(i)||n$(i,null)}),s.forEach(function(i){a.has(i)||n$(i,o)})}NM.set(n,t)},[t]),n}function wVe(t){return t}function SVe(t,e){e===void 0&&(e=wVe);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(i){return i!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(i){return s(i)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var i=n;n=[],i.forEach(s),o=n}var l=function(){var c=o;o=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),n}}}};return a}function CVe(t){t===void 0&&(t={});var e=SVe(null);return e.options=qo({async:!0,ssr:!1},t),e}var P7=function(t){var e=t.sideCar,n=A7(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return N.createElement(r,qo({},n))};P7.isSideCarExport=!0;function _Ve(t,e){return t.useMedium(e),P7}var O7=CVe(),r$=function(){},U2=N.forwardRef(function(t,e){var n=N.useRef(null),r=N.useState({onScrollCapture:r$,onWheelCapture:r$,onTouchMoveCapture:r$}),a=r[0],s=r[1],o=t.forwardProps,i=t.children,l=t.className,u=t.removeScrollBar,c=t.enabled,d=t.shards,f=t.sideCar,h=t.noIsolation,p=t.inert,g=t.allowPinchZoom,y=t.as,v=y===void 0?"div":y,x=t.gapMode,b=A7(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=f,C=bVe([n,e]),_=qo(qo({},b),a);return N.createElement(N.Fragment,null,c&&N.createElement(w,{sideCar:O7,removeScrollBar:u,shards:d,noIsolation:h,inert:p,setCallbacks:s,allowPinchZoom:!!g,lockRef:n,gapMode:x}),o?N.cloneElement(N.Children.only(i),qo(qo({},_),{ref:C})):N.createElement(v,qo({},_,{className:l,ref:C}),i))});U2.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};U2.classNames={fullWidth:nw,zeroRight:tw};var $Ve=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kVe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=$Ve();return e&&t.setAttribute("nonce",e),t}function NVe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function IVe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var TVe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=kVe())&&(NVe(e,n),IVe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},EVe=function(){var t=TVe();return function(e,n){N.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},R7=function(){var t=EVe(),e=function(n){var r=n.styles,a=n.dynamic;return t(r,a),null};return e},AVe={left:0,top:0,right:0,gap:0},a$=function(t){return parseInt(t||"",10)||0},PVe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[a$(n),a$(r),a$(a)]},OVe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return AVe;var e=PVe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},RVe=R7(),If="data-scroll-locked",DVe=function(t,e,n,r){var a=t.left,s=t.top,o=t.right,i=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(gVe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(i,"px ").concat(r,`;
  }
  body[`).concat(If,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(i,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(tw,` {
    right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(nw,` {
    margin-right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(tw," .").concat(tw,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(nw," .").concat(nw,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(If,`] {
    `).concat(yVe,": ").concat(i,`px;
  }
`)},IM=function(){var t=parseInt(document.body.getAttribute(If)||"0",10);return isFinite(t)?t:0},jVe=function(){N.useEffect(function(){return document.body.setAttribute(If,(IM()+1).toString()),function(){var t=IM()-1;t<=0?document.body.removeAttribute(If):document.body.setAttribute(If,t.toString())}},[])},MVe=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,a=r===void 0?"margin":r;jVe();var s=N.useMemo(function(){return OVe(a)},[a]);return N.createElement(RVe,{styles:DVe(s,!e,a,n?"":"!important")})},WN=!1;if(typeof window<"u")try{var c0=Object.defineProperty({},"passive",{get:function(){return WN=!0,!0}});window.addEventListener("test",c0,c0),window.removeEventListener("test",c0,c0)}catch{WN=!1}var Ld=WN?{passive:!1}:!1,FVe=function(t){return t.tagName==="TEXTAREA"},D7=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!FVe(t)&&n[e]==="visible")},LVe=function(t){return D7(t,"overflowY")},BVe=function(t){return D7(t,"overflowX")},TM=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=j7(t,r);if(a){var s=M7(t,r),o=s[1],i=s[2];if(o>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},zVe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},UVe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},j7=function(t,e){return t==="v"?LVe(e):BVe(e)},M7=function(t,e){return t==="v"?zVe(e):UVe(e)},VVe=function(t,e){return t==="h"&&e==="rtl"?-1:1},WVe=function(t,e,n,r,a){var s=VVe(t,window.getComputedStyle(e).direction),o=s*r,i=n.target,l=e.contains(i),u=!1,c=o>0,d=0,f=0;do{var h=M7(t,i),p=h[0],g=h[1],y=h[2],v=g-y-s*p;(p||v)&&j7(t,i)&&(d+=v,f+=p),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!l&&i!==document.body||l&&(e.contains(i)||e===i));return(c&&(Math.abs(d)<1||!a)||!c&&(Math.abs(f)<1||!a))&&(u=!0),u},d0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},EM=function(t){return[t.deltaX,t.deltaY]},AM=function(t){return t&&"current"in t?t.current:t},GVe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},HVe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},qVe=0,Bd=[];function KVe(t){var e=N.useRef([]),n=N.useRef([0,0]),r=N.useRef(),a=N.useState(qVe++)[0],s=N.useState(R7)[0],o=N.useRef(t);N.useEffect(function(){o.current=t},[t]),N.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var g=mVe([t.lockRef.current],(t.shards||[]).map(AM),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var i=N.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var v=d0(g),x=n.current,b="deltaX"in g?g.deltaX:x[0]-v[0],w="deltaY"in g?g.deltaY:x[1]-v[1],C,_=g.target,$=Math.abs(b)>Math.abs(w)?"h":"v";if("touches"in g&&$==="h"&&_.type==="range")return!1;var k=TM($,_);if(!k)return!0;if(k?C=$:(C=$==="v"?"h":"v",k=TM($,_)),!k)return!1;if(!r.current&&"changedTouches"in g&&(b||w)&&(r.current=C),!C)return!0;var A=r.current||C;return WVe(A,y,g,A==="h"?b:w,!0)},[]),l=N.useCallback(function(g){var y=g;if(!(!Bd.length||Bd[Bd.length-1]!==s)){var v="deltaY"in y?EM(y):d0(y),x=e.current.filter(function(C){return C.name===y.type&&(C.target===y.target||y.target===C.shadowParent)&&GVe(C.delta,v)})[0];if(x&&x.should){y.cancelable&&y.preventDefault();return}if(!x){var b=(o.current.shards||[]).map(AM).filter(Boolean).filter(function(C){return C.contains(y.target)}),w=b.length>0?i(y,b[0]):!o.current.noIsolation;w&&y.cancelable&&y.preventDefault()}}},[]),u=N.useCallback(function(g,y,v,x){var b={name:g,delta:y,target:v,should:x,shadowParent:XVe(v)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(w){return w!==b})},1)},[]),c=N.useCallback(function(g){n.current=d0(g),r.current=void 0},[]),d=N.useCallback(function(g){u(g.type,EM(g),g.target,i(g,t.lockRef.current))},[]),f=N.useCallback(function(g){u(g.type,d0(g),g.target,i(g,t.lockRef.current))},[]);N.useEffect(function(){return Bd.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Ld),document.addEventListener("touchmove",l,Ld),document.addEventListener("touchstart",c,Ld),function(){Bd=Bd.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,Ld),document.removeEventListener("touchmove",l,Ld),document.removeEventListener("touchstart",c,Ld)}},[]);var h=t.removeScrollBar,p=t.inert;return N.createElement(N.Fragment,null,p?N.createElement(s,{styles:HVe(a)}):null,h?N.createElement(MVe,{gapMode:t.gapMode}):null)}function XVe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const YVe=_Ve(O7,KVe);var F7=N.forwardRef(function(t,e){return N.createElement(U2,qo({},t,{ref:e,sideCar:YVe}))});F7.classNames=U2.classNames;var QVe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},zd=new WeakMap,f0=new WeakMap,h0={},s$=0,L7=function(t){return t&&(t.host||L7(t.parentNode))},JVe=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=L7(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},ZVe=function(t,e,n,r){var a=JVe(e,Array.isArray(t)?t:[t]);h0[n]||(h0[n]=new WeakMap);var s=h0[n],o=[],i=new Set,l=new Set(a),u=function(d){!d||i.has(d)||(i.add(d),u(d.parentNode))};a.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(i.has(f))c(f);else try{var h=f.getAttribute(r),p=h!==null&&h!=="false",g=(zd.get(f)||0)+1,y=(s.get(f)||0)+1;zd.set(f,g),s.set(f,y),o.push(f),g===1&&p&&f0.set(f,!0),y===1&&f.setAttribute(n,"true"),p||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return c(e),i.clear(),s$++,function(){o.forEach(function(d){var f=zd.get(d)-1,h=s.get(d)-1;zd.set(d,f),s.set(d,h),f||(f0.has(d)||d.removeAttribute(r),f0.delete(d)),h||d.removeAttribute(n)}),s$--,s$||(zd=new WeakMap,zd=new WeakMap,f0=new WeakMap,h0={})}},eWe=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),a=QVe(t);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),ZVe(r,a,n,"aria-hidden")):function(){return null}},uO="Dialog",[B7,emt]=Hp(uO),[tWe,Mo]=B7(uO),z7=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:a,onOpenChange:s,modal:o=!0}=t,i=N.useRef(null),l=N.useRef(null),[u=!1,c]=qp({prop:r,defaultProp:a,onChange:s});return m.jsx(tWe,{scope:e,triggerRef:i,contentRef:l,contentId:xg(),titleId:xg(),descriptionId:xg(),open:u,onOpenChange:c,onOpenToggle:N.useCallback(()=>c(d=>!d),[c]),modal:o,children:n})};z7.displayName=uO;var U7="DialogTrigger",nWe=N.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Mo(U7,n),s=Aa(e,a.triggerRef);return m.jsx(nn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":fO(a.open),...r,ref:s,onClick:Ht(t.onClick,a.onOpenToggle)})});nWe.displayName=U7;var cO="DialogPortal",[rWe,V7]=B7(cO,{forceMount:void 0}),W7=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:a}=t,s=Mo(cO,e);return m.jsx(rWe,{scope:e,forceMount:n,children:N.Children.map(r,o=>m.jsx(vu,{present:n||s.open,children:m.jsx(lO,{asChild:!0,container:a,children:o})}))})};W7.displayName=cO;var Qw="DialogOverlay",G7=N.forwardRef((t,e)=>{const n=V7(Qw,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,s=Mo(Qw,t.__scopeDialog);return s.modal?m.jsx(vu,{present:r||s.open,children:m.jsx(aWe,{...a,ref:e})}):null});G7.displayName=Qw;var aWe=N.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Mo(Qw,n);return m.jsx(F7,{as:Lf,allowPinchZoom:!0,shards:[a.contentRef],children:m.jsx(nn.div,{"data-state":fO(a.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Wc="DialogContent",H7=N.forwardRef((t,e)=>{const n=V7(Wc,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,s=Mo(Wc,t.__scopeDialog);return m.jsx(vu,{present:r||s.open,children:s.modal?m.jsx(sWe,{...a,ref:e}):m.jsx(oWe,{...a,ref:e})})});H7.displayName=Wc;var sWe=N.forwardRef((t,e)=>{const n=Mo(Wc,t.__scopeDialog),r=N.useRef(null),a=Aa(e,n.contentRef,r);return N.useEffect(()=>{const s=r.current;if(s)return eWe(s)},[]),m.jsx(q7,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ht(t.onCloseAutoFocus,s=>{var o;s.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ht(t.onPointerDownOutside,s=>{const o=s.detail.originalEvent,i=o.button===0&&o.ctrlKey===!0;(o.button===2||i)&&s.preventDefault()}),onFocusOutside:Ht(t.onFocusOutside,s=>s.preventDefault())})}),oWe=N.forwardRef((t,e)=>{const n=Mo(Wc,t.__scopeDialog),r=N.useRef(!1),a=N.useRef(!1);return m.jsx(q7,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,i;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),s.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:s=>{var l,u;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=s.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),q7=N.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:s,...o}=t,i=Mo(Wc,n),l=N.useRef(null),u=Aa(e,l);return pVe(),m.jsxs(m.Fragment,{children:[m.jsx(T7,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:s,children:m.jsx(iO,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":fO(i.open),...o,ref:u,onDismiss:()=>i.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(iWe,{titleId:i.titleId}),m.jsx(uWe,{contentRef:l,descriptionId:i.descriptionId})]})]})}),dO="DialogTitle",K7=N.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Mo(dO,n);return m.jsx(nn.h2,{id:a.titleId,...r,ref:e})});K7.displayName=dO;var X7="DialogDescription",Y7=N.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Mo(X7,n);return m.jsx(nn.p,{id:a.descriptionId,...r,ref:e})});Y7.displayName=X7;var Q7="DialogClose",J7=N.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=Mo(Q7,n);return m.jsx(nn.button,{type:"button",...r,ref:e,onClick:Ht(t.onClick,()=>a.onOpenChange(!1))})});J7.displayName=Q7;function fO(t){return t?"open":"closed"}var Z7="DialogTitleWarning",[tmt,eX]=eUe(Z7,{contentName:Wc,titleName:dO,docsSlug:"dialog"}),iWe=({titleId:t})=>{const e=eX(Z7),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return N.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},lWe="DialogDescriptionWarning",uWe=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${eX(lWe).contentName}}.`;return N.useEffect(()=>{var s;const a=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");e&&a&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},cWe=z7,dWe=W7,tX=G7,nX=H7,rX=K7,aX=Y7,fWe=J7;const hWe=cWe,pWe=dWe,sX=N.forwardRef(({className:t,...e},n)=>m.jsx(tX,{ref:n,className:fn("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));sX.displayName=tX.displayName;const oX=N.forwardRef(({className:t,children:e,...n},r)=>m.jsxs(pWe,{children:[m.jsx(sX,{}),m.jsxs(nX,{ref:r,className:fn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,m.jsxs(fWe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsx(xV,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));oX.displayName=nX.displayName;const iX=({className:t,...e})=>m.jsx("div",{className:fn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});iX.displayName="DialogFooter";const lX=N.forwardRef(({className:t,...e},n)=>m.jsx(rX,{ref:n,className:fn("text-lg font-semibold leading-none tracking-tight",t),...e}));lX.displayName=rX.displayName;const uX=N.forwardRef(({className:t,...e},n)=>m.jsx(aX,{ref:n,className:fn("text-sm text-muted-foreground",t),...e}));uX.displayName=aX.displayName;const mWe=()=>{const[t,e]=N.useState(null),[n,r]=N.useState(!1),a=zn(),s=Po(),{toast:o}=Xr(),i=s.pathname.includes("guided")||localStorage.getItem("experienceMode")==="guided",l=[{id:"legs",name:"Pernas",description:"Exercícios para quádriceps, posteriores e panturrilhas",icon:m.jsx(QD,{className:"h-12 w-12 text-formfit-blue"}),free:!0},{id:"arms",name:"Braços",description:"Exercícios para bíceps, tríceps e antebraços",icon:m.jsx(Sf,{className:"h-12 w-12 text-formfit-purple"}),free:!1},{id:"shoulders",name:"Ombros",description:"Exercícios para deltoides e ombros",icon:m.jsx(Sf,{className:"h-12 w-12 text-yellow-400"}),free:!0},{id:"chest",name:"Peito",description:"Exercícios para peitoral e ombros",icon:m.jsx(Cre,{className:"h-12 w-12 text-formfit-pink"}),free:!1},{id:"abs",name:"Abdômen",description:"Exercícios para região abdominal",icon:m.jsx(Sre,{className:"h-12 w-12 text-formfit-green"}),free:!1},{id:"back",name:"Costas",description:"Exercícios para trapézio e lombar",icon:m.jsx(Sf,{className:"h-12 w-12 text-formfit-orange"}),free:!1},{id:"fullbody",name:"Corpo Todo",description:"Exercícios completos para todos os grupos musculares",icon:m.jsx(QD,{className:"h-12 w-12 text-formfit-blue"}),free:!1}],u=(d,f)=>{var h;if(i&&!f){r(!0);return}e(d),localStorage.setItem("selectedMuscleGroup",d),o({title:"Grupo muscular selecionado",description:`Você selecionou ${(h=l.find(p=>p.id===d))==null?void 0:h.name}.`,duration:1500}),a(`/workout/exercises/${d}`)},c=()=>{a(-1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:c,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Quais áreas você quer treinar?"})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(d=>m.jsxs(bn,{className:`cursor-pointer hover:shadow-lg transition-shadow duration-300 ${i&&!d.free?"relative":""}`,onClick:()=>u(d.id,d.free),children:[i&&!d.free&&m.jsx("div",{className:"absolute top-2 right-2 bg-amber-500 text-white px-2 py-1 rounded text-xs font-bold",children:"Premium"}),m.jsxs(wn,{className:"flex flex-col items-center",children:[d.icon,m.jsx(Sn,{className:"mt-4",children:d.name})]}),m.jsx(Cn,{children:m.jsx(xs,{className:"text-center",children:d.description})})]},d.id))})]})}),m.jsx(rr,{}),m.jsx(hWe,{open:n,onOpenChange:r,children:m.jsxs(oX,{children:[m.jsx(lX,{children:"Conteúdo Premium"}),m.jsx(uX,{children:"Este tipo de treino está disponível apenas para assinantes. Assine agora para acessar todos os nossos treinos personalizados."}),m.jsxs(iX,{children:[m.jsx(pe,{variant:"outline",onClick:()=>r(!1),children:"Fechar"}),m.jsx(pe,{onClick:()=>a("/subscription"),children:"Assinar Já"})]})]})})]})},PM=()=>{var s,o,i,l;const t=Po(),e=zn(),n=t.state,r=u=>{const c=Math.floor(u/60),d=u%60;return`${c.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`},a=()=>{if(!(n!=null&&n.repStats))return 0;const{good:u,total:c}=n.repStats;return c>0?Math.round(u/c*100):0};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-6",children:[m.jsx("button",{onClick:()=>e("/treinos"),className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Resumo do Treino"})]}),m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[m.jsx("div",{className:"flex items-center justify-center mb-6",children:m.jsx(kre,{className:"h-12 w-12 text-yellow-500"})}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx(Dk,{className:"h-6 w-6 text-formfit-blue mr-3"}),m.jsx("span",{className:"font-medium",children:"Tempo Total"})]}),m.jsx("span",{className:"text-xl font-bold",children:r((n==null?void 0:n.elapsedTime)||0)})]}),m.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[m.jsxs("div",{className:"flex items-center",children:[m.jsx(vre,{className:"h-6 w-6 text-green-500 mr-3"}),m.jsx("span",{className:"font-medium",children:"Séries Completadas"})]}),m.jsxs("span",{className:"text-xl font-bold",children:[(n==null?void 0:n.series)||0,"/3"]})]}),m.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[m.jsx("h3",{className:"font-medium mb-3",children:"Repetições"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-gray-600",children:"Total"}),m.jsx("span",{className:"font-bold",children:((s=n==null?void 0:n.repStats)==null?void 0:s.total)||0})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-green-600",children:"Boa execução"}),m.jsx("span",{className:"font-bold",children:((o=n==null?void 0:n.repStats)==null?void 0:o.good)||0})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-yellow-600",children:"Execução média"}),m.jsx("span",{className:"font-bold",children:((i=n==null?void 0:n.repStats)==null?void 0:i.average)||0})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-red-600",children:"Execução ruim"}),m.jsx("span",{className:"font-bold",children:((l=n==null?void 0:n.repStats)==null?void 0:l.poor)||0})]})]})]}),m.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[m.jsx("h3",{className:"font-medium mb-2",children:"Qualidade Geral"}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:m.jsx("div",{className:"bg-formfit-blue h-4 rounded-full transition-all duration-500",style:{width:`${a()}%`}})}),m.jsx("div",{className:"text-right mt-1",children:m.jsxs("span",{className:"text-sm font-medium",children:[a(),"%"]})})]})]})]}),m.jsx(pe,{onClick:()=>e("/treinos"),className:"w-full bg-formfit-blue hover:bg-formfit-blue/90 text-white",children:"Voltar para Treinos"})]})})]})},gWe=()=>{const t=zn(),[e,n]=N.useState(!1);N.useEffect(()=>{const o=localStorage.getItem("isLoggedIn");n(o==="true")},[]);const r=()=>{t(e?"/dashboard":-1)},a=()=>{t("/dashboard")},s=[{id:"pernas",name:"Pernas",color:"bg-gradient-to-r from-blue-400 to-blue-600",available:!0},{id:"braco",name:"Braços",color:"bg-gradient-to-r from-red-400 to-red-600",available:e},{id:"ombros",name:"Ombros",color:"bg-gradient-to-r from-orange-400 to-orange-600",available:e},{id:"peito",name:"Peito",color:"bg-gradient-to-r from-green-400 to-green-600",available:e},{id:"costas",name:"Costas",color:"bg-gradient-to-r from-purple-400 to-purple-600",available:e},{id:"abdomen",name:"Abdômen",color:"bg-gradient-to-r from-yellow-400 to-yellow-600",available:e}];return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:r,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Treinos"}),e&&m.jsx(pe,{variant:"ghost",size:"icon",onClick:a,className:"ml-2",children:m.jsx(vS,{className:"h-5 w-5"})})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-md mx-auto",children:s.map(o=>m.jsx("button",{className:`w-full mb-4 rounded-lg shadow-md font-bold text-white ${o.color} py-4 text-lg transition-all duration-200 ${o.available?"":"opacity-60 cursor-not-allowed"}`,disabled:!o.available,onClick:()=>o.available&&t(`/treinos/exercicios/${o.id}`),children:o.name},o.id))})]})}),m.jsx(rr,{})]})},yWe=["/images/modelo1.png","/images/modelo2.png"],OM=()=>{const{areaId:t}=xE(),e=zn(),n=Po(),[r,a]=N.useState(!1),[s,o]=N.useState(null),[i,l]=N.useState(0);N.useState(!1),N.useState(!1);const[u,c]=N.useState(null),[d,f]=N.useState(Ea[0]),[h,p]=N.useState(0),[g,y]=N.useState(!0);N.useEffect(()=>{const $=localStorage.getItem("isLoggedIn");a($==="true")},[]),N.useEffect(()=>{const $=setInterval(()=>{l(k=>(k+1)%yWe.length)},2e3);return()=>clearInterval($)},[]);const v=()=>{n.pathname.includes("treino-guiado")?e("/treino-guiado"):e("/treinos")},x=()=>{e("/dashboard")},b={pernas:[{id:"agachamento",name:"Agachamento",description:"Exercício básico para quadríceps, glúteos e posterior de coxa",image:"🏋️‍♀️",available:!0},{id:"afundo",name:"Avanço",description:"Fortalece quadríceps, glúteos e isquiotibiais",image:"🏃‍♀️",available:!n.pathname.includes("treino-guiado")},{id:"leg-press",name:"Leg Press",description:"Trabalha quadríceps, glúteos e posterior de coxa",image:"💪",available:!n.pathname.includes("treino-guiado")},{id:"cadeira-extensora",name:"Cadeira Extensora",description:"Isola e fortalece o quadríceps",image:"🦵",available:!n.pathname.includes("treino-guiado")}],braco:[{id:"curl",name:"Rosca Bíceps",description:"Exercício para fortalecer os bíceps",image:"💪",available:r},{id:"hammer-curl",name:"Rosca Hammer",description:"Exercício para bíceps e antebraço",image:"🔨",available:r},{id:"triceps",name:"Extensão de Tríceps",description:"Trabalha o tríceps e estabilizadores",image:"🏋️",available:r},{id:"rosca-triceps",name:"Rosca Tríceps",description:"Exercício para fortalecer o tríceps",image:"💪",available:r}],peito:[{id:"pushup",name:"Flexão de Braço",description:"Exercício completo para peitoral e tríceps",image:"🏋️‍♂️",available:r},{id:"supino",name:"Supino",description:"Exercício clássico para peitoral",image:"🏋️",available:r},{id:"crossover",name:"Crossover",description:"Exercício para peitoral com cabos",image:"🤸",available:r},{id:"crossover-baixo",name:"Crossover Baixo",description:"Variação do crossover para parte inferior do peitoral",image:"🤸‍♂️",available:r}],costas:[{id:"remada",name:"Remada",description:"Exercício para fortalecer as costas",image:"🏊‍♂️",available:r},{id:"lat-push",name:"Lat Push",description:"Exercício para dorsais",image:"🏋️",available:r},{id:"lat-pull",name:"Lat Pull",description:"Exercício para dorsais",image:"🏋️‍♂️",available:r},{id:"seated-row",name:"Seated Row",description:"Remada sentada para costas",image:"🚣",available:r}],abdomen:[{id:"abdominal",name:"Abdominal",description:"Exercício para fortalecer o core",image:"🧘‍♀️",available:r}],ombros:[{id:"levantamento-lateral",name:"Levantamento Lateral",description:"Trabalha o deltoide lateral",image:"🏋️",available:!0},{id:"levantamento-frontal",name:"Levantamento Frontal",description:"Trabalha o deltoide anterior",image:"🏋️",available:!0},{id:"desenvolvimento",name:"Desenvolvimento",description:"Trabalha o deltoide e tríceps",image:"🏋️‍♂️",available:!0},{id:"crucifixo-invertido",name:"Crucifixo Invertido",description:"Exercício para deltoide posterior e parte superior das costas",image:"🦅",available:!0}]},w=t&&t in b?b[t]:[],C=t==="pernas"?"Pernas":t==="braco"?"Braços":t==="peito"?"Peito":t==="costas"?"Costas":t==="abdomen"?"Abdômen":t==="ombros"?"Ombros":"",_=$=>{const k=w.find(A=>A.id===$);c({id:$,name:(k==null?void 0:k.name)||"Exercício"}),f(Ea[0]),p(0),y(!0)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:v,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsxs("h1",{className:"formfit-heading text-center flex-1",children:["Exercícios para ",C]}),r&&m.jsx(pe,{variant:"ghost",size:"icon",onClick:x,className:"ml-2",children:m.jsx(vS,{className:"h-5 w-5"})})]}),m.jsx("div",{className:"space-y-4 max-w-md mx-auto",children:w.map($=>m.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden border-l-4 border-blue-500 flex flex-col justify-between h-full",children:m.jsx("div",{className:"p-4",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{className:"flex items-center space-x-3 w-full",children:[m.jsx("div",{className:"text-2xl",children:$.image}),m.jsxs("div",{className:"flex flex-col w-full",children:[m.jsx("h3",{className:"font-semibold text-lg text-center w-full",children:$.name}),m.jsx("p",{className:"text-gray-600 text-sm text-left w-full",children:$.description})]})]}),$.available?m.jsx("button",{onClick:()=>_($.id),children:"Iniciar"}):m.jsxs("div",{className:"bg-gray-300 px-3 py-2 rounded-lg flex items-center gap-1",children:[m.jsx(_E,{className:"h-4 w-4 text-gray-600"}),m.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Bloqueado"})]})]})})},$.id))})]})}),m.jsx(rr,{}),s&&m.jsx("div",{className:"fixed top-8 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-6 py-3 rounded shadow-lg z-50",children:s}),u&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Configurar Execução"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsx("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:d,onChange:$=>f($.target.value),children:Ea.map($=>m.jsx("option",{value:$,children:$},$))})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{h>0&&p(h-1),y(!1)},disabled:g||h===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:g?"Sem carga":`${h} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{p(h+1),y(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:g?"default":"outline",className:g?"bg-purple-600 text-white":"",onClick:()=>{y(!0),p(0)},children:"Sem carga"})]})]}),m.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[m.jsx(pe,{variant:"outline",onClick:()=>c(null),children:"Cancelar"}),m.jsx(pe,{className:"bg-green-600 hover:bg-green-700 text-white font-bold",onClick:()=>{localStorage.setItem("currentExercise",JSON.stringify({id:u.id,name:u.name,modelo:d,carga:g?null:h,muscles:t||""})),c(null),e("/workout-flow/execution")},children:"Iniciar"})]})]})})]})},vWe=()=>{const t=zn(),[e,n]=N.useState(!1);N.useEffect(()=>{const o=localStorage.getItem("isLoggedIn");n(o==="true")},[]);const r=()=>{t("/")},a=()=>{t("/dashboard")},s=[{id:"pernas",name:"Pernas",color:"bg-gradient-to-r from-blue-400 to-blue-600",available:!0},{id:"braco",name:"Braços",color:"bg-gradient-to-r from-red-400 to-red-600",available:!1},{id:"ombros",name:"Ombros",color:"bg-gradient-to-r from-orange-400 to-orange-600",available:!1},{id:"peito",name:"Peito",color:"bg-gradient-to-r from-green-400 to-green-600",available:!1},{id:"costas",name:"Costas",color:"bg-gradient-to-r from-purple-400 to-purple-600",available:!1},{id:"abdomen",name:"Abdômen",color:"bg-gradient-to-r from-yellow-400 to-yellow-600",available:!1}];return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex items-center mb-8",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:r,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Treino Guiado"}),e&&m.jsx(pe,{variant:"ghost",size:"icon",onClick:a,className:"ml-2",children:m.jsx(vS,{className:"h-5 w-5"})})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-md mx-auto",children:s.map(o=>m.jsx("div",{className:`relative h-24 rounded-xl shadow-md overflow-hidden transition-transform hover:scale-105 ${o.color}`,children:o.available?m.jsx(Ys,{to:`/treino-guiado/exercicios/${o.id}`,className:"absolute inset-0 flex items-center justify-center",children:m.jsx("span",{className:"text-white font-bold text-xl",children:o.name})}):m.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-6",children:[m.jsx("span",{className:"text-white font-bold text-xl",children:o.name}),m.jsx(_E,{className:"h-6 w-6 text-white"})]})},o.id))})]})}),m.jsx(rr,{})]})},xWe=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(""),[a,s]=N.useState(!1),o=zn(),{toast:i}=Xr(),l=async u=>{u.preventDefault(),s(!0);const{error:c}=await Pt.auth.signInWithPassword({email:t,password:n});if(s(!1),c){i({title:"Erro ao fazer login!",description:c.message,variant:"destructive"});return}i({title:"Login bem-sucedido!",description:"Bem-vindo ao AI Trainer"}),o("/dashboard")};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex items-center justify-center",children:m.jsxs("div",{className:"w-full max-w-md p-6 bg-white rounded-lg shadow-md",children:[m.jsx("div",{className:"mb-4 flex items-center",children:m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>o(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Login"}),m.jsxs("form",{onSubmit:l,className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"email",children:"Email"}),m.jsx(So,{id:"email",type:"email",placeholder:"seu@email.com",value:t,onChange:u=>e(u.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"password",children:"Senha"}),m.jsx(So,{id:"password",type:"password",placeholder:"••••••••",value:n,onChange:u=>r(u.target.value),required:!0})]}),m.jsx(pe,{type:"submit",className:"w-full bg-formfit-blue hover:bg-formfit-blue/90",disabled:a,children:a?"Entrando...":"Entrar"})]}),m.jsxs("div",{className:"mt-6 text-center",children:[m.jsxs("p",{className:"text-sm text-gray-600",children:["Ainda não tem uma conta?"," ",m.jsx(Ys,{to:"/primeiro-acesso",className:"text-formfit-blue hover:underline",children:"Criar conta"})]}),m.jsx(Ys,{to:"/",className:"block mt-4 text-sm text-gray-500 hover:underline",children:"Voltar para página inicial"})]})]})}),m.jsx(rr,{})]})},cX={Pernas:[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"}],Braços:[{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"}],Peito:[{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"}],Costas:[{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"}],Abdômen:[{id:"abdominal",name:"Abdominal"}],Ombros:[{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}]};function bWe({open:t,onClose:e,sets:n,history:r}){const[a,s]=N.useState(""),o=zn(),i=typeof window<"u"?JSON.parse(localStorage.getItem("treinosPersonalizados")||"[]"):[],l=i.find(p=>p.nome===a),u={};l&&Array.isArray(l.treinos)&&l.treinos.forEach(p=>{u[p.area]||(u[p.area]=[]),u[p.area].push(p.area)});const c=Object.keys(u).reduce((p,g)=>{var y;return p[g]=(((y=l==null?void 0:l.treinos.find(v=>v.area===g))==null?void 0:y.exercicios)||[]).map(v=>{const x=(cX[g]||[]).find(b=>b.id===v);return x?{...x}:{id:v,name:v}}),p},{}),d=Object.values(c).some(p=>p.length>0);let f={};if(a&&l&&l.dia){const p=r.find(g=>g.date&&g.date.split("T")[0]===l.dia);if(p){const g=p.id;n.filter(y=>y.workout_id===g).forEach(y=>{y.exercise_name&&(f[y.exercise_name]||(f[y.exercise_name]=0),y.completed&&(f[y.exercise_name]+=1))})}}const h=3;return t?m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative",children:[m.jsx("button",{className:"absolute top-2 right-2 text-gray-500",onClick:e,children:"×"}),m.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Iniciar Treino Personalizado"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Selecione o treino:"}),m.jsxs("select",{className:"w-full border rounded px-3 py-2",value:a,onChange:p=>s(p.target.value),children:[m.jsx("option",{value:"",children:"Selecione..."}),i.map(p=>m.jsx("option",{value:p.nome,children:p.nome},p.nome))]})]}),a&&m.jsxs("div",{children:[Object.keys(c).length===0&&m.jsx("div",{className:"text-gray-500 text-center",children:"Nenhum exercício salvo para este treino."}),Object.keys(c).map(p=>m.jsxs("div",{className:"mb-2",children:[m.jsx("div",{className:"font-semibold mb-1",children:p}),m.jsx("ul",{className:"list-disc ml-6",children:c[p].map(g=>{const y=f[g.name]||0,v=y>=h;return m.jsxs("li",{className:`flex justify-between items-center px-2 py-1 rounded ${v?"bg-green-100 text-green-700 font-semibold":""}`,children:[m.jsx("span",{children:g.name}),m.jsxs("span",{className:`ml-2 ${v?"text-green-700 font-bold":"text-gray-600"}`,children:[y,"/",h]})]},g.id)})})]},p)),d&&m.jsx(pe,{className:"w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold",onClick:()=>o(`/treino-personalizado-execucao?treino=${encodeURIComponent((l==null?void 0:l.nome)||"")}`),children:"Iniciar treino"})]})]})}):null}const wWe=()=>{const t=zn(),{toast:e}=Xr(),[n,r]=K.useState(null),[a,s]=K.useState([]),[o,i]=K.useState([]),[l,u]=K.useState(!0);K.useState(""),K.useState(""),K.useState(!1);const[c,d]=N.useState(!1),[f,h]=N.useState("semanal");N.useState(!1),N.useState(Ea[0]),N.useState(0),N.useState(!0);const g=(()=>{const w=new Date;return a.filter(C=>{if(!C.date)return!1;const _=new Date(C.date);if(f==="diario")return _.toDateString()===w.toDateString();if(f==="semanal"){const $=k=>{const A=new Date(Date.UTC(k.getFullYear(),k.getMonth(),k.getDate())),P=A.getUTCDay()||7;A.setUTCDate(A.getUTCDate()+4-P);const O=new Date(Date.UTC(A.getUTCFullYear(),0,1));return Math.ceil(((A-O)/864e5+1)/7)};return _.getUTCFullYear()===w.getUTCFullYear()&&$(_)===$(w)}return f==="mensal"?_.getUTCFullYear()===w.getUTCFullYear()&&_.getUTCMonth()===w.getUTCMonth():f==="anual"?_.getUTCFullYear()===w.getUTCFullYear():!0})})(),y=o.filter(w=>g.some(C=>C.id===w.workout_id));K.useEffect(()=>{(async()=>{u(!0);const{data:{user:C},error:_}=await Pt.auth.getUser();if(!C||_){e({title:"Acesso restrito",description:"Faça login para acessar o dashboard",variant:"destructive"}),t("/login");return}const{data:$}=await Pt.from("user_profiles").select("*").eq("id",C.id).single();r($);const{data:k}=await Pt.from("workout_history").select("*").eq("user_id",C.id).order("date",{ascending:!1});s(k||[]);const{data:A}=await Pt.from("workout_sets").select("*").in("workout_id",(k||[]).map(P=>P.id));i(A||[]),u(!1)})()},[t,e]);const v=async()=>{await Pt.auth.signOut(),e({title:"Logout realizado",description:"Obrigado por usar o AI Trainer"}),t("/")},x=["Pernas","Braços","Ombros","Peito","Costas","Abdômen"],b={Agachamento:"Pernas","Leg Press":"Pernas","Rosca Bíceps":"Braços",Tríceps:"Braços"};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow",children:m.jsxs("div",{className:"formfit-container py-8 px-4",children:[m.jsxs("div",{className:"flex justify-between items-center mb-8",children:[m.jsx("h1",{className:"formfit-heading",children:"Dashboard"}),m.jsxs("div",{className:"flex gap-4",children:[m.jsx(pe,{variant:"outline",onClick:v,children:"Sair"}),m.jsx(Ys,{to:"/parametros-treino",children:m.jsx(pe,{variant:"ghost",size:"icon","aria-label":"Parâmetros de treino",children:m.jsx($re,{className:"h-5 w-5"})})})]})]}),m.jsxs("div",{className:"flex justify-center gap-2 mb-6",children:[m.jsx(pe,{variant:f==="diario"?"default":"outline",onClick:()=>h("diario"),children:"Diário"}),m.jsx(pe,{variant:f==="semanal"?"default":"outline",onClick:()=>h("semanal"),children:"Semanal"}),m.jsx(pe,{variant:f==="mensal"?"default":"outline",onClick:()=>h("mensal"),children:"Mensal"}),m.jsx(pe,{variant:f==="anual"?"default":"outline",onClick:()=>h("anual"),children:"Anual"})]}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-6",children:[m.jsxs(bn,{className:"p-0 h-24 flex items-center justify-center",children:[m.jsx(wn,{className:"pb-1 px-2 pt-2",children:m.jsx(Sn,{className:"text-xs font-medium text-gray-500",children:"Treinos Realizados"})}),m.jsxs(Cn,{className:"py-1 px-2 flex items-center justify-center",children:[m.jsx(fre,{className:"h-4 w-4 text-formfit-blue mr-1"}),m.jsx("span",{className:"text-lg font-bold",children:g.length})]})]}),m.jsxs(bn,{className:"p-0 h-24 flex items-center justify-center",children:[m.jsx(wn,{className:"pb-1 px-2 pt-2",children:m.jsx(Sn,{className:"text-xs font-medium text-gray-500",children:"Séries Completadas"})}),m.jsxs(Cn,{className:"py-1 px-2 flex items-center justify-center",children:[m.jsx(wre,{className:"h-4 w-4 text-green-600 mr-1"}),m.jsx("span",{className:"text-lg font-bold",children:y.length})]})]}),m.jsxs(bn,{className:"p-0 h-24 flex items-center justify-center",children:[m.jsx(wn,{className:"pb-1 px-2 pt-2",children:m.jsx(Sn,{className:"text-xs font-medium text-gray-500",children:"Minutos Ativos"})}),m.jsxs(Cn,{className:"py-1 px-2 flex items-center justify-center",children:[m.jsx(mre,{className:"h-4 w-4 text-amber-500 mr-1"}),m.jsx("span",{className:"text-lg font-bold",children:g.reduce((w,C)=>w+(C.total_time||0),0)})]})]}),m.jsxs(bn,{className:"p-0 h-24 flex items-center justify-center",children:[m.jsx(wn,{className:"pb-1 px-2 pt-2",children:m.jsx(Sn,{className:"text-xs font-medium text-gray-500",children:"Pontos XP"})}),m.jsxs(Cn,{className:"py-1 px-2 flex items-center justify-center",children:[m.jsx(hre,{className:"h-4 w-4 text-purple-600 mr-1"}),m.jsx("span",{className:"text-lg font-bold",children:g.reduce((w,C)=>w+(C.xp||0),0)})]})]})]}),m.jsxs(bn,{className:"mb-8",children:[m.jsxs(wn,{children:[m.jsx(Sn,{children:"Progresso Semanal"}),m.jsx(xs,{children:"Veja seu progresso por área muscular nesta semana"})]}),m.jsx(Cn,{children:m.jsx("div",{className:"space-y-4",children:(()=>{const w=A=>{const P=new Date(Date.UTC(A.getFullYear(),A.getMonth(),A.getDate())),O=P.getUTCDay()||7;P.setUTCDate(P.getUTCDate()+4-O);const R=new Date(Date.UTC(P.getUTCFullYear(),0,1));return Math.ceil(((P-R)/864e5+1)/7)},C=new Date,_=w(C),$=C.getFullYear(),k={};return g.forEach(A=>{const P=new Date(A.date);w(P)===_&&P.getFullYear()===$&&o.filter(R=>R.workout_id===A.id).forEach(R=>{const B=b[R.exercise_name]||"Outros";k[B]||(k[B]={total:0,exercicios:{}}),k[B].exercicios[R.exercise_name]||(k[B].exercicios[R.exercise_name]=0),R.completed&&(k[B].exercicios[R.exercise_name]+=1)})}),x.map(A=>{const P=k[A];if(!P)return m.jsxs("div",{className:"space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:A}),m.jsx("span",{className:"font-medium",children:"0%"})]}),m.jsx(Ol,{value:0,className:"h-2"})]},A);const R=Object.values(cX[A]||{}).map(F=>F.name).map(F=>{const L=P.exercicios[F]||0;return Math.min(100,Math.round(L/3*100))}),B=R.length>0?Math.round(R.reduce((F,L)=>F+L,0)/R.length):0;return m.jsxs("div",{className:"space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:A}),m.jsxs("span",{className:"font-medium",children:[B,"%"]})]}),m.jsx(Ol,{value:B,className:"h-2"})]},A)})})()})})]}),m.jsxs("div",{className:"text-center mb-8",children:[m.jsxs("div",{className:"w-full flex justify-center gap-4 mb-4",children:[m.jsx(Ys,{to:"/treinos",children:m.jsxs(pe,{className:"bg-formfit-blue hover:bg-formfit-blue/90 text-white font-medium px-8 py-6 rounded-lg text-lg flex items-center gap-2",children:[m.jsx(Sf,{className:"h-5 w-5"}),"Iniciar treino livre"]})}),m.jsx(pe,{className:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-8 py-6 rounded-lg text-lg flex items-center gap-2",onClick:()=>t("/treino-personalizado"),children:"Treino Personalizado"}),m.jsx(pe,{className:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-8 py-6 rounded-lg text-lg flex items-center gap-2",onClick:()=>t("/treino-ia"),children:"Treino com IA"})]}),m.jsxs("div",{className:"w-full flex justify-center gap-4",children:[m.jsx(pe,{className:"bg-yellow-600 hover:bg-yellow-700 text-white font-medium px-8 py-6 rounded-lg text-lg flex items-center gap-2",onClick:()=>d(!0),children:"Iniciar treino personalizado"}),m.jsx(Ys,{to:"/meus-treinos",children:m.jsx(pe,{className:"bg-green-600 hover:bg-green-700 text-white font-medium px-8 py-6 rounded-lg text-lg flex items-center gap-2",children:"Minhas métricas"})})]})]}),m.jsxs(bn,{children:[m.jsx(wn,{children:m.jsx(Sn,{children:"Últimas Atividades"})}),m.jsx(Cn,{children:m.jsx("div",{className:"space-y-4",children:(()=>{const w={};return g.forEach(_=>{const $=_.date.split("T")[0];w[$]||(w[$]=[]);const k=o.filter(A=>A.workout_id===_.id);w[$].push(...k.map(A=>({...A,area:b[A.exercise_name]||"Outros"})))}),Object.keys(w).sort((_,$)=>$.localeCompare(_)).map((_,$)=>m.jsxs("div",{className:"border-b pb-2 mb-2 last:border-b-0 last:pb-0 last:mb-0",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[m.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:m.jsx(Sf,{className:"h-4 w-4 text-blue-600"})}),m.jsx("p",{className:"font-medium",children:_})]}),m.jsx("ul",{className:"ml-10",children:["Pernas","Braços","Ombros","Peito","Costas","Abdômen","Outros"].map(k=>{const A=w[_].filter(O=>O.area===k);if(A.length===0)return null;const P={};return A.forEach(O=>{O.exercise_name&&(P[O.exercise_name]||(P[O.exercise_name]=0),O.completed&&(P[O.exercise_name]+=1))}),m.jsxs("li",{className:"mb-1",children:[m.jsxs("span",{className:"font-semibold",children:[k,":"]}),m.jsx("ul",{className:"ml-4",children:Object.entries(P).map(([O,R])=>m.jsxs("li",{className:R>0?"text-green-700 font-semibold":"text-gray-400",children:[O," ",R>0&&m.jsxs("span",{children:["(",R," série",R>1?"s":"",")"]})]},O))})]},k)})})]},$))})()})})]})]})}),m.jsx(rr,{}),m.jsx(bWe,{open:c,onClose:()=>d(!1),sets:o,history:a})]})},SWe=()=>{const[t,e]=N.useState(""),[n,r]=N.useState(""),[a,s]=N.useState(""),[o,i]=N.useState(!1),l=zn(),{toast:u}=Xr(),c=async d=>{if(d.preventDefault(),n!==a){u({title:"Erro!",description:"As senhas não coincidem",variant:"destructive"});return}i(!0);const{error:f}=await Pt.auth.signUp({email:t,password:n});if(i(!1),f){u({title:"Erro ao cadastrar!",description:f.message,variant:"destructive"});return}u({title:"Cadastro realizado!",description:"Agora você pode fazer login."}),l("/login")};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex items-center justify-center py-8",children:m.jsxs("div",{className:"w-full max-w-md p-6 bg-white rounded-lg shadow-md",children:[m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Cadastro de Acesso"}),m.jsxs("form",{onSubmit:c,className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"email",children:"Email"}),m.jsx(So,{id:"email",type:"email",placeholder:"seu@email.com",value:t,onChange:d=>e(d.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"password",children:"Senha"}),m.jsx(So,{id:"password",type:"password",placeholder:"••••••••",value:n,onChange:d=>r(d.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Hr,{htmlFor:"confirmPassword",children:"Confirmar Senha"}),m.jsx(So,{id:"confirmPassword",type:"password",placeholder:"••••••••",value:a,onChange:d=>s(d.target.value),required:!0})]}),m.jsx(pe,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700",disabled:o,children:o?"Cadastrando...":"Cadastrar"})]})]})}),m.jsx(rr,{})]})},CWe=["Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado","Domingo"],_We=["Pernas","Braços","Peito","Costas","Ombros","Abdômen"],Ud={Pernas:[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"}],Braços:[{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"}],Peito:[{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"}],Costas:[{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"}],Abdômen:[{id:"abdominal",name:"Abdominal"}],Ombros:[{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}]},o$="treinosPersonalizados",$We=()=>{const t=zn(),[e,n]=N.useState(""),[r,a]=N.useState([]),[s,o]=N.useState([]),[i,l]=N.useState(null),[u,c]=N.useState(""),[d,f]=N.useState({}),[h,p]=N.useState(null),[g,y]=N.useState(null);N.useEffect(()=>{const $=localStorage.getItem(o$);$&&o(JSON.parse($))},[]);const v=$=>{r.includes($)?(a(r.filter(k=>k!==$)),f(k=>{const A={...k};return delete A[$],A})):(a([...r,$]),f(k=>({...k,[$]:[]})))},x=($,k)=>{f(A=>{const P=A[$]||[];return P.includes(k)?{...A,[$]:P.filter(O=>O!==k)}:{...A,[$]:[...P,k]}})},b=$=>{const k=(Ud[$]||[]).map(A=>A.id);f(A=>(A[$]||[]).length===k.length?{...A,[$]:[]}:{...A,[$]:k})},w=async $=>{$.preventDefault();const k=r.map(P=>({area:P,exercicios:d[P]||[]}));let A;if(i!==null)A=s.map((P,O)=>O===i?{nome:u,dia:e,treinos:k}:P);else{A=[...s,{nome:u,dia:e,treinos:k}];try{const{data:{user:P}}=await Pt.auth.getUser();P&&await Pt.from("treino_personalizado").insert([{user_id:P.id,nome:u,exercicios:k}])}catch(P){console.error("Erro ao salvar treino no Supabase:",P)}}o(A),localStorage.setItem(o$,JSON.stringify(A)),c(""),n(""),a([]),f({}),l(null)},C=$=>{const k=s[$];c(k.nome||""),n(k.dia||""),a(Array.isArray(k.treinos)?k.treinos.map(A=>A.area):[]),f(()=>{const A={};return Array.isArray(k.treinos)&&k.treinos.forEach(P=>{A[P.area]=Array.isArray(P.exercicios)?P.exercicios:[]}),A}),l($)},_=$=>{const k=s.filter((A,P)=>P!==$);o(k),localStorage.setItem(o$,JSON.stringify(k)),i===$&&(l(null),c(""),n(""),a([]),f({}))};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex flex-col items-center justify-center",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 w-full max-w-md",children:[m.jsx("div",{className:"mb-4 flex items-center",children:m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard"),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})})}),m.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Treino Personalizado"}),s.length>0&&m.jsxs("div",{className:"mb-8",children:[m.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Treinos Salvos"}),m.jsx("ul",{className:"space-y-2",children:s.map(($,k)=>m.jsxs("li",{className:"flex flex-col bg-gray-100 rounded px-3 py-2",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{type:"button",onClick:()=>p(h===k?null:k),className:"p-1","aria-label":h===k?"Ocultar detalhes":"Mostrar detalhes",children:h===k?m.jsx(SE,{size:16}):m.jsx(ov,{size:16})}),m.jsx("span",{className:"font-medium",children:$.nome||"Sem nome"})]}),m.jsxs("div",{className:"flex gap-2 items-center",children:[m.jsx(pe,{size:"sm",variant:"outline",onClick:()=>C(k),children:"Editar"}),m.jsx("button",{type:"button",className:"p-1 text-red-600 hover:text-red-800",onClick:()=>y(k),title:"Excluir treino",children:m.jsx(gV,{size:16})})]})]}),h===k&&Array.isArray($.treinos)&&m.jsx("div",{className:"mt-2 text-sm text-gray-700",children:m.jsx("ul",{className:"ml-2 space-y-1",children:$.treinos.map((A,P)=>m.jsxs("li",{children:[m.jsxs("span",{className:"font-semibold",children:[A.area,":"]}),m.jsx("ul",{className:"list-none text-left ml-0",children:(A.exercicios||[]).map((O,R)=>{const B=(Ud[A.area]||[]).find(F=>F.id===O);return m.jsx("li",{children:B?B.name:O},R)})})]},P))})})]},k))})]}),m.jsxs("form",{onSubmit:w,className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Nome do treino:"}),m.jsx("input",{className:"w-full border rounded px-3 py-2",type:"text",value:u,onChange:$=>c($.target.value),required:!0,placeholder:"Ex: Treino de Segunda, Treino A, etc."})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Selecione o dia da semana:"}),m.jsxs("select",{className:"w-full border rounded px-3 py-2",value:e,onChange:$=>n($.target.value),required:!0,children:[m.jsx("option",{value:"",children:"Selecione..."}),CWe.map($=>m.jsx("option",{value:$,children:$},$))]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Opções de treino:"}),m.jsx("div",{className:"flex flex-wrap gap-3",children:_We.map($=>m.jsxs("div",{className:"w-full",children:[m.jsxs("label",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",checked:r.includes($),onChange:()=>v($)}),$]}),r.includes($)&&m.jsxs("div",{className:"ml-6 mt-1",children:[m.jsxs("label",{className:"flex items-center gap-2 text-xs mb-1 cursor-pointer text-blue-600",children:[m.jsx("input",{type:"checkbox",checked:(d[$]||[]).length===(Ud[$]||[]).length&&(Ud[$]||[]).length>0,onChange:()=>b($)}),(d[$]||[]).length===(Ud[$]||[]).length?"Desmarcar todos":"Selecionar todos"]}),m.jsx("ul",{className:"text-sm text-gray-600",children:(Ud[$]||[]).map(k=>m.jsx("li",{children:m.jsxs("label",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",checked:(d[$]||[]).includes(k.id),onChange:()=>x($,k.id)}),k.name]})},k.id))})]})]},$))})]}),m.jsx(pe,{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold",children:i!==null?"Salvar Edição":"Salvar Treino"})]})]})}),m.jsx(rr,{}),g!==null&&m.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-xs text-center",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Excluir treino"}),m.jsx("p",{className:"mb-6",children:"Tem certeza que deseja excluir este treino?"}),m.jsxs("div",{className:"flex justify-center gap-4",children:[m.jsx("button",{className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",onClick:()=>y(null),children:"Cancelar"}),m.jsx("button",{className:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>{_(g),y(null)},children:"Excluir"})]})]})})]})};var kWe=as,NWe=Gp,IWe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,TWe=/^\w*$/;function EWe(t,e){if(kWe(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||NWe(t)?!0:TWe.test(t)||!IWe.test(t)||e!=null&&t in Object(e)}var hO=EWe;function AWe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var xu=AWe;const Kp=Ut(xu);var PWe=rl,OWe=xu,RWe="[object AsyncFunction]",DWe="[object Function]",jWe="[object GeneratorFunction]",MWe="[object Proxy]";function FWe(t){if(!OWe(t))return!1;var e=PWe(t);return e==DWe||e==jWe||e==RWe||e==MWe}var pO=FWe;const vt=Ut(pO);var LWe=gi,BWe=LWe["__core-js_shared__"],zWe=BWe,i$=zWe,RM=function(){var t=/[^.]+$/.exec(i$&&i$.keys&&i$.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function UWe(t){return!!RM&&RM in t}var VWe=UWe,WWe=Function.prototype,GWe=WWe.toString;function HWe(t){if(t!=null){try{return GWe.call(t)}catch{}try{return t+""}catch{}}return""}var dX=HWe,qWe=pO,KWe=VWe,XWe=xu,YWe=dX,QWe=/[\\^$.*+?()[\]{}|]/g,JWe=/^\[object .+?Constructor\]$/,ZWe=Function.prototype,e6e=Object.prototype,t6e=ZWe.toString,n6e=e6e.hasOwnProperty,r6e=RegExp("^"+t6e.call(n6e).replace(QWe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a6e(t){if(!XWe(t)||KWe(t))return!1;var e=qWe(t)?r6e:JWe;return e.test(YWe(t))}var s6e=a6e;function o6e(t,e){return t==null?void 0:t[e]}var i6e=o6e,l6e=s6e,u6e=i6e;function c6e(t,e){var n=u6e(t,e);return l6e(n)?n:void 0}var md=c6e,d6e=md,f6e=d6e(Object,"create"),V2=f6e,DM=V2;function h6e(){this.__data__=DM?DM(null):{},this.size=0}var p6e=h6e;function m6e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var g6e=m6e,y6e=V2,v6e="__lodash_hash_undefined__",x6e=Object.prototype,b6e=x6e.hasOwnProperty;function w6e(t){var e=this.__data__;if(y6e){var n=e[t];return n===v6e?void 0:n}return b6e.call(e,t)?e[t]:void 0}var S6e=w6e,C6e=V2,_6e=Object.prototype,$6e=_6e.hasOwnProperty;function k6e(t){var e=this.__data__;return C6e?e[t]!==void 0:$6e.call(e,t)}var N6e=k6e,I6e=V2,T6e="__lodash_hash_undefined__";function E6e(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=I6e&&e===void 0?T6e:e,this}var A6e=E6e,P6e=p6e,O6e=g6e,R6e=S6e,D6e=N6e,j6e=A6e;function Xp(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Xp.prototype.clear=P6e;Xp.prototype.delete=O6e;Xp.prototype.get=R6e;Xp.prototype.has=D6e;Xp.prototype.set=j6e;var M6e=Xp;function F6e(){this.__data__=[],this.size=0}var L6e=F6e;function B6e(t,e){return t===e||t!==t&&e!==e}var mO=B6e,z6e=mO;function U6e(t,e){for(var n=t.length;n--;)if(z6e(t[n][0],e))return n;return-1}var W2=U6e,V6e=W2,W6e=Array.prototype,G6e=W6e.splice;function H6e(t){var e=this.__data__,n=V6e(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():G6e.call(e,n,1),--this.size,!0}var q6e=H6e,K6e=W2;function X6e(t){var e=this.__data__,n=K6e(e,t);return n<0?void 0:e[n][1]}var Y6e=X6e,Q6e=W2;function J6e(t){return Q6e(this.__data__,t)>-1}var Z6e=J6e,e5e=W2;function t5e(t,e){var n=this.__data__,r=e5e(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var n5e=t5e,r5e=L6e,a5e=q6e,s5e=Y6e,o5e=Z6e,i5e=n5e;function Yp(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Yp.prototype.clear=r5e;Yp.prototype.delete=a5e;Yp.prototype.get=s5e;Yp.prototype.has=o5e;Yp.prototype.set=i5e;var G2=Yp,l5e=md,u5e=gi,c5e=l5e(u5e,"Map"),gO=c5e,jM=M6e,d5e=G2,f5e=gO;function h5e(){this.size=0,this.__data__={hash:new jM,map:new(f5e||d5e),string:new jM}}var p5e=h5e;function m5e(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var g5e=m5e,y5e=g5e;function v5e(t,e){var n=t.__data__;return y5e(e)?n[typeof e=="string"?"string":"hash"]:n.map}var H2=v5e,x5e=H2;function b5e(t){var e=x5e(this,t).delete(t);return this.size-=e?1:0,e}var w5e=b5e,S5e=H2;function C5e(t){return S5e(this,t).get(t)}var _5e=C5e,$5e=H2;function k5e(t){return $5e(this,t).has(t)}var N5e=k5e,I5e=H2;function T5e(t,e){var n=I5e(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var E5e=T5e,A5e=p5e,P5e=w5e,O5e=_5e,R5e=N5e,D5e=E5e;function Qp(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Qp.prototype.clear=A5e;Qp.prototype.delete=P5e;Qp.prototype.get=O5e;Qp.prototype.has=R5e;Qp.prototype.set=D5e;var yO=Qp,fX=yO,j5e="Expected a function";function vO(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(j5e);var n=function(){var r=arguments,a=e?e.apply(this,r):r[0],s=n.cache;if(s.has(a))return s.get(a);var o=t.apply(this,r);return n.cache=s.set(a,o)||s,o};return n.cache=new(vO.Cache||fX),n}vO.Cache=fX;var hX=vO;const M5e=Ut(hX);var F5e=hX,L5e=500;function B5e(t){var e=F5e(t,function(r){return n.size===L5e&&n.clear(),r}),n=e.cache;return e}var z5e=B5e,U5e=z5e,V5e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,W5e=/\\(\\)?/g,G5e=U5e(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(V5e,function(n,r,a,s){e.push(a?s.replace(W5e,"$1"):r||n)}),e}),H5e=G5e,q5e=as,K5e=hO,X5e=H5e,Y5e=tO;function Q5e(t,e){return q5e(t)?t:K5e(t,e)?[t]:X5e(Y5e(t))}var pX=Q5e,J5e=Gp,Z5e=1/0;function eGe(t){if(typeof t=="string"||J5e(t))return t;var e=t+"";return e=="0"&&1/t==-Z5e?"-0":e}var q2=eGe,tGe=pX,nGe=q2;function rGe(t,e){e=tGe(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[nGe(e[n++])];return n&&n==r?t:void 0}var xO=rGe,aGe=xO;function sGe(t,e,n){var r=t==null?void 0:aGe(t,e);return r===void 0?n:r}var mX=sGe;const bs=Ut(mX);function oGe(t){return t==null}var iGe=oGe;const ht=Ut(iGe);var lGe=rl,uGe=as,cGe=al,dGe="[object String]";function fGe(t){return typeof t=="string"||!uGe(t)&&cGe(t)&&lGe(t)==dGe}var hGe=fGe;const ib=Ut(hGe);var gX={exports:{}},pn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bO=Symbol.for("react.element"),wO=Symbol.for("react.portal"),K2=Symbol.for("react.fragment"),X2=Symbol.for("react.strict_mode"),Y2=Symbol.for("react.profiler"),Q2=Symbol.for("react.provider"),J2=Symbol.for("react.context"),pGe=Symbol.for("react.server_context"),Z2=Symbol.for("react.forward_ref"),eC=Symbol.for("react.suspense"),tC=Symbol.for("react.suspense_list"),nC=Symbol.for("react.memo"),rC=Symbol.for("react.lazy"),mGe=Symbol.for("react.offscreen"),yX;yX=Symbol.for("react.module.reference");function so(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case bO:switch(t=t.type,t){case K2:case Y2:case X2:case eC:case tC:return t;default:switch(t=t&&t.$$typeof,t){case pGe:case J2:case Z2:case rC:case nC:case Q2:return t;default:return e}}case wO:return e}}}pn.ContextConsumer=J2;pn.ContextProvider=Q2;pn.Element=bO;pn.ForwardRef=Z2;pn.Fragment=K2;pn.Lazy=rC;pn.Memo=nC;pn.Portal=wO;pn.Profiler=Y2;pn.StrictMode=X2;pn.Suspense=eC;pn.SuspenseList=tC;pn.isAsyncMode=function(){return!1};pn.isConcurrentMode=function(){return!1};pn.isContextConsumer=function(t){return so(t)===J2};pn.isContextProvider=function(t){return so(t)===Q2};pn.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===bO};pn.isForwardRef=function(t){return so(t)===Z2};pn.isFragment=function(t){return so(t)===K2};pn.isLazy=function(t){return so(t)===rC};pn.isMemo=function(t){return so(t)===nC};pn.isPortal=function(t){return so(t)===wO};pn.isProfiler=function(t){return so(t)===Y2};pn.isStrictMode=function(t){return so(t)===X2};pn.isSuspense=function(t){return so(t)===eC};pn.isSuspenseList=function(t){return so(t)===tC};pn.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===K2||t===Y2||t===X2||t===eC||t===tC||t===mGe||typeof t=="object"&&t!==null&&(t.$$typeof===rC||t.$$typeof===nC||t.$$typeof===Q2||t.$$typeof===J2||t.$$typeof===Z2||t.$$typeof===yX||t.getModuleId!==void 0)};pn.typeOf=so;gX.exports=pn;var vX=gX.exports,gGe=rl,yGe=al,vGe="[object Number]";function xGe(t){return typeof t=="number"||yGe(t)&&gGe(t)==vGe}var xX=xGe;const bGe=Ut(xX);var wGe=xX;function SGe(t){return wGe(t)&&t!=+t}var CGe=SGe;const lb=Ut(CGe);var Ca=function(e){return e===0?0:e>0?1:-1},ac=function(e){return ib(e)&&e.indexOf("%")===e.length-1},Le=function(e){return bGe(e)&&!lb(e)},Cr=function(e){return Le(e)||ib(e)},_Ge=0,Jp=function(e){var n=++_Ge;return"".concat(e||"").concat(n)},_a=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Le(e)&&!ib(e))return r;var s;if(ac(e)){var o=e.indexOf("%");s=n*parseFloat(e.slice(0,o))/100}else s=+e;return lb(s)&&(s=r),a&&s>n&&(s=n),s},Yd=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},$Ge=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,r={},a=0;a<n;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1},ds=function(e,n){return Le(e)&&Le(n)?function(r){return e+r*(n-e)}:function(){return n}};function Jw(t,e,n){return!t||!t.length?null:t.find(function(r){return r&&(typeof e=="function"?e(r):bs(r,e))===n})}function Tf(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function GN(t){"@babel/helpers - typeof";return GN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},GN(t)}var kGe=["viewBox","children"],NGe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],MM=["points","pathLength"],l$={svg:kGe,polygon:MM,polyline:MM},SO=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Zw=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(N.isValidElement(e)&&(r=e.props),!Kp(r))return null;var a={};return Object.keys(r).forEach(function(s){SO.includes(s)&&(a[s]=n||function(o){return r[s](r,o)})}),a},IGe=function(e,n,r){return function(a){return e(n,r,a),null}},Gc=function(e,n,r){if(!Kp(e)||GN(e)!=="object")return null;var a=null;return Object.keys(e).forEach(function(s){var o=e[s];SO.includes(s)&&typeof o=="function"&&(a||(a={}),a[s]=IGe(o,n,r))}),a},TGe=["children"],EGe=["children"];function FM(t,e){if(t==null)return{};var n=AGe(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function AGe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function HN(t){"@babel/helpers - typeof";return HN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},HN(t)}var LM={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},Fi=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},BM=null,u$=null,CO=function t(e){if(e===BM&&Array.isArray(u$))return u$;var n=[];return N.Children.forEach(e,function(r){ht(r)||(vX.isFragment(r)?n=n.concat(t(r.props.children)):n.push(r))}),u$=n,BM=e,n};function ws(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(function(a){return Fi(a)}):r=[Fi(e)],CO(t).forEach(function(a){var s=bs(a,"type.displayName")||bs(a,"type.name");r.indexOf(s)!==-1&&n.push(a)}),n}function cs(t,e){var n=ws(t,e);return n&&n[0]}var zM=function(e){if(!e||!e.props)return!1;var n=e.props,r=n.width,a=n.height;return!(!Le(r)||r<=0||!Le(a)||a<=0)},PGe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],OGe=function(e){return e&&e.type&&ib(e.type)&&PGe.indexOf(e.type)>=0},RGe=function(e){return e&&HN(e)==="object"&&"clipDot"in e},DGe=function(e,n,r,a){var s,o=(s=l$==null?void 0:l$[a])!==null&&s!==void 0?s:[];return!vt(e)&&(a&&o.includes(n)||NGe.includes(n))||r&&SO.includes(n)},nt=function(e,n,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(N.isValidElement(e)&&(a=e.props),!Kp(a))return null;var s={};return Object.keys(a).forEach(function(o){var i;DGe((i=a)===null||i===void 0?void 0:i[o],o,n,r)&&(s[o]=a[o])}),s},qN=function t(e,n){if(e===n)return!0;var r=N.Children.count(e);if(r!==N.Children.count(n))return!1;if(r===0)return!0;if(r===1)return UM(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var a=0;a<r;a++){var s=e[a],o=n[a];if(Array.isArray(s)||Array.isArray(o)){if(!t(s,o))return!1}else if(!UM(s,o))return!1}return!0},UM=function(e,n){if(ht(e)&&ht(n))return!0;if(!ht(e)&&!ht(n)){var r=e.props||{},a=r.children,s=FM(r,TGe),o=n.props||{},i=o.children,l=FM(o,EGe);return a&&i?Tf(s,l)&&qN(a,i):!a&&!i?Tf(s,l):!1}return!1},VM=function(e,n){var r=[],a={};return CO(e).forEach(function(s,o){if(OGe(s))r.push(s);else if(s){var i=Fi(s.type),l=n[i]||{},u=l.handler,c=l.once;if(u&&(!c||!a[i])){var d=u(s,i,o);r.push(d),a[i]=!0}}}),r},jGe=function(e){var n=e&&e.type;return n&&LM[n]?LM[n]:null},MGe=function(e,n){return CO(n).indexOf(e)},FGe=["children","width","height","viewBox","className","style","title","desc"];function KN(){return KN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KN.apply(this,arguments)}function LGe(t,e){if(t==null)return{};var n=BGe(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function BGe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function XN(t){var e=t.children,n=t.width,r=t.height,a=t.viewBox,s=t.className,o=t.style,i=t.title,l=t.desc,u=LGe(t,FGe),c=a||{width:n,height:r,x:0,y:0},d=xt("recharts-surface",s);return K.createElement("svg",KN({},nt(u,!0,"svg"),{className:d,width:n,height:r,style:o,viewBox:"".concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height)}),K.createElement("title",null,i),K.createElement("desc",null,l),e)}var zGe=["children","className"];function YN(){return YN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},YN.apply(this,arguments)}function UGe(t,e){if(t==null)return{};var n=VGe(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function VGe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var qt=K.forwardRef(function(t,e){var n=t.children,r=t.className,a=UGe(t,zGe),s=xt("recharts-layer",r);return K.createElement("g",YN({className:s},nt(a,!0),{ref:e}),n)}),Li=function(e,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s]};function WGe(t,e,n){var r=-1,a=t.length;e<0&&(e=-e>a?0:a+e),n=n>a?a:n,n<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(a);++r<a;)s[r]=t[r+e];return s}var GGe=WGe,HGe=GGe;function qGe(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:HGe(t,e,n)}var KGe=qGe,XGe="\\ud800-\\udfff",YGe="\\u0300-\\u036f",QGe="\\ufe20-\\ufe2f",JGe="\\u20d0-\\u20ff",ZGe=YGe+QGe+JGe,eHe="\\ufe0e\\ufe0f",tHe="\\u200d",nHe=RegExp("["+tHe+XGe+ZGe+eHe+"]");function rHe(t){return nHe.test(t)}var bX=rHe;function aHe(t){return t.split("")}var sHe=aHe,wX="\\ud800-\\udfff",oHe="\\u0300-\\u036f",iHe="\\ufe20-\\ufe2f",lHe="\\u20d0-\\u20ff",uHe=oHe+iHe+lHe,cHe="\\ufe0e\\ufe0f",dHe="["+wX+"]",QN="["+uHe+"]",JN="\\ud83c[\\udffb-\\udfff]",fHe="(?:"+QN+"|"+JN+")",SX="[^"+wX+"]",CX="(?:\\ud83c[\\udde6-\\uddff]){2}",_X="[\\ud800-\\udbff][\\udc00-\\udfff]",hHe="\\u200d",$X=fHe+"?",kX="["+cHe+"]?",pHe="(?:"+hHe+"(?:"+[SX,CX,_X].join("|")+")"+kX+$X+")*",mHe=kX+$X+pHe,gHe="(?:"+[SX+QN+"?",QN,CX,_X,dHe].join("|")+")",yHe=RegExp(JN+"(?="+JN+")|"+gHe+mHe,"g");function vHe(t){return t.match(yHe)||[]}var xHe=vHe,bHe=sHe,wHe=bX,SHe=xHe;function CHe(t){return wHe(t)?SHe(t):bHe(t)}var _He=CHe,$He=KGe,kHe=bX,NHe=_He,IHe=tO;function THe(t){return function(e){e=IHe(e);var n=kHe(e)?NHe(e):void 0,r=n?n[0]:e.charAt(0),a=n?$He(n,1).join(""):e.slice(1);return r[t]()+a}}var EHe=THe,AHe=EHe,PHe=AHe("toUpperCase"),OHe=PHe;const aC=Ut(OHe);function Tn(t){return function(){return t}}const NX=Math.cos,e1=Math.sin,Fo=Math.sqrt,t1=Math.PI,sC=2*t1,ZN=Math.PI,eI=2*ZN,Uu=1e-6,RHe=eI-Uu;function IX(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function DHe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return IX;const n=10**e;return function(r){this._+=r[0];for(let a=1,s=r.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class jHe{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?IX:DHe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,a){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(e,n,r,a,s,o){this._append`C${+e},${+n},${+r},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,r,a,s){if(e=+e,n=+n,r=+r,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,i=this._y1,l=r-e,u=a-n,c=o-e,d=i-n,f=c*c+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>Uu)if(!(Math.abs(d*l-u*c)>Uu)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let h=r-o,p=a-i,g=l*l+u*u,y=h*h+p*p,v=Math.sqrt(g),x=Math.sqrt(f),b=s*Math.tan((ZN-Math.acos((g+f-y)/(2*v*x)))/2),w=b/x,C=b/v;Math.abs(w-1)>Uu&&this._append`L${e+w*c},${n+w*d}`,this._append`A${s},${s},0,0,${+(d*h>c*p)},${this._x1=e+C*l},${this._y1=n+C*u}`}}arc(e,n,r,a,s,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let i=r*Math.cos(a),l=r*Math.sin(a),u=e+i,c=n+l,d=1^o,f=o?a-s:s-a;this._x1===null?this._append`M${u},${c}`:(Math.abs(this._x1-u)>Uu||Math.abs(this._y1-c)>Uu)&&this._append`L${u},${c}`,r&&(f<0&&(f=f%eI+eI),f>RHe?this._append`A${r},${r},0,1,${d},${e-i},${n-l}A${r},${r},0,1,${d},${this._x1=u},${this._y1=c}`:f>Uu&&this._append`A${r},${r},0,${+(f>=ZN)},${d},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function _O(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new jHe(e)}function $O(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function TX(t){this._context=t}TX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function oC(t){return new TX(t)}function EX(t){return t[0]}function AX(t){return t[1]}function PX(t,e){var n=Tn(!0),r=null,a=oC,s=null,o=_O(i);t=typeof t=="function"?t:t===void 0?EX:Tn(t),e=typeof e=="function"?e:e===void 0?AX:Tn(e);function i(l){var u,c=(l=$O(l)).length,d,f=!1,h;for(r==null&&(s=a(h=o())),u=0;u<=c;++u)!(u<c&&n(d=l[u],u,l))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+t(d,u,l),+e(d,u,l));if(h)return s=null,h+""||null}return i.x=function(l){return arguments.length?(t=typeof l=="function"?l:Tn(+l),i):t},i.y=function(l){return arguments.length?(e=typeof l=="function"?l:Tn(+l),i):e},i.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Tn(!!l),i):n},i.curve=function(l){return arguments.length?(a=l,r!=null&&(s=a(r)),i):a},i.context=function(l){return arguments.length?(l==null?r=s=null:s=a(r=l),i):r},i}function p0(t,e,n){var r=null,a=Tn(!0),s=null,o=oC,i=null,l=_O(u);t=typeof t=="function"?t:t===void 0?EX:Tn(+t),e=typeof e=="function"?e:Tn(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?AX:Tn(+n);function u(d){var f,h,p,g=(d=$O(d)).length,y,v=!1,x,b=new Array(g),w=new Array(g);for(s==null&&(i=o(x=l())),f=0;f<=g;++f){if(!(f<g&&a(y=d[f],f,d))===v)if(v=!v)h=f,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),p=f-1;p>=h;--p)i.point(b[p],w[p]);i.lineEnd(),i.areaEnd()}v&&(b[f]=+t(y,f,d),w[f]=+e(y,f,d),i.point(r?+r(y,f,d):b[f],n?+n(y,f,d):w[f]))}if(x)return i=null,x+""||null}function c(){return PX().defined(a).curve(o).context(s)}return u.x=function(d){return arguments.length?(t=typeof d=="function"?d:Tn(+d),r=null,u):t},u.x0=function(d){return arguments.length?(t=typeof d=="function"?d:Tn(+d),u):t},u.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Tn(+d),u):r},u.y=function(d){return arguments.length?(e=typeof d=="function"?d:Tn(+d),n=null,u):e},u.y0=function(d){return arguments.length?(e=typeof d=="function"?d:Tn(+d),u):e},u.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Tn(+d),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:Tn(!!d),u):a},u.curve=function(d){return arguments.length?(o=d,s!=null&&(i=o(s)),u):o},u.context=function(d){return arguments.length?(d==null?s=i=null:i=o(s=d),u):s},u}class OX{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function MHe(t){return new OX(t,!0)}function FHe(t){return new OX(t,!1)}const kO={draw(t,e){const n=Fo(e/t1);t.moveTo(n,0),t.arc(0,0,n,0,sC)}},LHe={draw(t,e){const n=Fo(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},RX=Fo(1/3),BHe=RX*2,zHe={draw(t,e){const n=Fo(e/BHe),r=n*RX;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},UHe={draw(t,e){const n=Fo(e),r=-n/2;t.rect(r,r,n,n)}},VHe=.8908130915292852,DX=e1(t1/10)/e1(7*t1/10),WHe=e1(sC/10)*DX,GHe=-NX(sC/10)*DX,HHe={draw(t,e){const n=Fo(e*VHe),r=WHe*n,a=GHe*n;t.moveTo(0,-n),t.lineTo(r,a);for(let s=1;s<5;++s){const o=sC*s/5,i=NX(o),l=e1(o);t.lineTo(l*n,-i*n),t.lineTo(i*r-l*a,l*r+i*a)}t.closePath()}},c$=Fo(3),qHe={draw(t,e){const n=-Fo(e/(c$*3));t.moveTo(0,n*2),t.lineTo(-c$*n,-n),t.lineTo(c$*n,-n),t.closePath()}},js=-.5,Ms=Fo(3)/2,tI=1/Fo(12),KHe=(tI/2+1)*3,XHe={draw(t,e){const n=Fo(e/KHe),r=n/2,a=n*tI,s=r,o=n*tI+n,i=-s,l=o;t.moveTo(r,a),t.lineTo(s,o),t.lineTo(i,l),t.lineTo(js*r-Ms*a,Ms*r+js*a),t.lineTo(js*s-Ms*o,Ms*s+js*o),t.lineTo(js*i-Ms*l,Ms*i+js*l),t.lineTo(js*r+Ms*a,js*a-Ms*r),t.lineTo(js*s+Ms*o,js*o-Ms*s),t.lineTo(js*i+Ms*l,js*l-Ms*i),t.closePath()}};function YHe(t,e){let n=null,r=_O(a);t=typeof t=="function"?t:Tn(t||kO),e=typeof e=="function"?e:Tn(e===void 0?64:+e);function a(){let s;if(n||(n=s=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return a.type=function(s){return arguments.length?(t=typeof s=="function"?s:Tn(s),a):t},a.size=function(s){return arguments.length?(e=typeof s=="function"?s:Tn(+s),a):e},a.context=function(s){return arguments.length?(n=s??null,a):n},a}function n1(){}function r1(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function jX(t){this._context=t}jX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:r1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:r1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function QHe(t){return new jX(t)}function MX(t){this._context=t}MX.prototype={areaStart:n1,areaEnd:n1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:r1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function JHe(t){return new MX(t)}function FX(t){this._context=t}FX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:r1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ZHe(t){return new FX(t)}function LX(t){this._context=t}LX.prototype={areaStart:n1,areaEnd:n1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function e8e(t){return new LX(t)}function WM(t){return t<0?-1:1}function GM(t,e,n){var r=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(r||a<0&&-0),o=(n-t._y1)/(a||r<0&&-0),i=(s*a+o*r)/(r+a);return(WM(s)+WM(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(i))||0}function HM(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function d$(t,e,n){var r=t._x0,a=t._y0,s=t._x1,o=t._y1,i=(s-r)/3;t._context.bezierCurveTo(r+i,a+i*e,s-i,o-i*n,s,o)}function a1(t){this._context=t}a1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:d$(this,this._t0,HM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,d$(this,HM(this,n=GM(this,t,e)),n);break;default:d$(this,this._t0,n=GM(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function BX(t){this._context=new zX(t)}(BX.prototype=Object.create(a1.prototype)).point=function(t,e){a1.prototype.point.call(this,e,t)};function zX(t){this._context=t}zX.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,s){this._context.bezierCurveTo(e,t,r,n,s,a)}};function t8e(t){return new a1(t)}function n8e(t){return new BX(t)}function UX(t){this._context=t}UX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=qM(t),a=qM(e),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],a[0][s],r[1][s],a[1][s],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function qM(t){var e,n=t.length-1,r,a=new Array(n),s=new Array(n),o=new Array(n);for(a[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)a[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[n-1]=2,s[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=a[e]/s[e-1],s[e]-=r,o[e]-=r*o[e-1];for(a[n-1]=o[n-1]/s[n-1],e=n-2;e>=0;--e)a[e]=(o[e]-a[e+1])/s[e];for(s[n-1]=(t[n]+a[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function r8e(t){return new UX(t)}function iC(t,e){this._context=t,this._t=e}iC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function a8e(t){return new iC(t,.5)}function s8e(t){return new iC(t,0)}function o8e(t){return new iC(t,1)}function th(t,e){if((o=t.length)>1)for(var n=1,r,a,s=t[e[0]],o,i=s.length;n<o;++n)for(a=s,s=t[e[n]],r=0;r<i;++r)s[r][1]+=s[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function nI(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function i8e(t,e){return t[e]}function l8e(t){const e=[];return e.key=t,e}function u8e(){var t=Tn([]),e=nI,n=th,r=i8e;function a(s){var o=Array.from(t.apply(this,arguments),l8e),i,l=o.length,u=-1,c;for(const d of s)for(i=0,++u;i<l;++i)(o[i][u]=[0,+r(d,o[i].key,u,s)]).data=d;for(i=0,c=$O(e(o));i<l;++i)o[c[i]].index=i;return n(o,c),o}return a.keys=function(s){return arguments.length?(t=typeof s=="function"?s:Tn(Array.from(s)),a):t},a.value=function(s){return arguments.length?(r=typeof s=="function"?s:Tn(+s),a):r},a.order=function(s){return arguments.length?(e=s==null?nI:typeof s=="function"?s:Tn(Array.from(s)),a):e},a.offset=function(s){return arguments.length?(n=s??th,a):n},a}function c8e(t,e){if((r=t.length)>0){for(var n,r,a=0,s=t[0].length,o;a<s;++a){for(o=n=0;n<r;++n)o+=t[n][a][1]||0;if(o)for(n=0;n<r;++n)t[n][a][1]/=o}th(t,e)}}function d8e(t,e){if((a=t.length)>0){for(var n=0,r=t[e[0]],a,s=r.length;n<s;++n){for(var o=0,i=0;o<a;++o)i+=t[o][n][1]||0;r[n][1]+=r[n][0]=-i/2}th(t,e)}}function f8e(t,e){if(!(!((o=t.length)>0)||!((s=(a=t[e[0]]).length)>0))){for(var n=0,r=1,a,s,o;r<s;++r){for(var i=0,l=0,u=0;i<o;++i){for(var c=t[e[i]],d=c[r][1]||0,f=c[r-1][1]||0,h=(d-f)/2,p=0;p<i;++p){var g=t[e[p]],y=g[r][1]||0,v=g[r-1][1]||0;h+=y-v}l+=d,u+=h*d}a[r-1][1]+=a[r-1][0]=n,l&&(n-=u/l)}a[r-1][1]+=a[r-1][0]=n,th(t,e)}}function xy(t){"@babel/helpers - typeof";return xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xy(t)}var h8e=["type","size","sizeType"];function rI(){return rI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rI.apply(this,arguments)}function KM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function XM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KM(Object(n),!0).forEach(function(r){p8e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function p8e(t,e,n){return e=m8e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m8e(t){var e=g8e(t,"string");return xy(e)=="symbol"?e:e+""}function g8e(t,e){if(xy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y8e(t,e){if(t==null)return{};var n=v8e(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function v8e(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var VX={symbolCircle:kO,symbolCross:LHe,symbolDiamond:zHe,symbolSquare:UHe,symbolStar:HHe,symbolTriangle:qHe,symbolWye:XHe},x8e=Math.PI/180,b8e=function(e){var n="symbol".concat(aC(e));return VX[n]||kO},w8e=function(e,n,r){if(n==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*x8e;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},S8e=function(e,n){VX["symbol".concat(aC(e))]=n},NO=function(e){var n=e.type,r=n===void 0?"circle":n,a=e.size,s=a===void 0?64:a,o=e.sizeType,i=o===void 0?"area":o,l=y8e(e,h8e),u=XM(XM({},l),{},{type:r,size:s,sizeType:i}),c=function(){var y=b8e(r),v=YHe().type(y).size(w8e(s,i,r));return v()},d=u.className,f=u.cx,h=u.cy,p=nt(u,!0);return f===+f&&h===+h&&s===+s?K.createElement("path",rI({},p,{className:xt("recharts-symbols",d),transform:"translate(".concat(f,", ").concat(h,")"),d:c()})):null};NO.registerSymbol=S8e;function nh(t){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nh(t)}function aI(){return aI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},aI.apply(this,arguments)}function YM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function C8e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YM(Object(n),!0).forEach(function(r){by(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YM(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $8e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GX(r.key),r)}}function k8e(t,e,n){return e&&$8e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function N8e(t,e,n){return e=s1(e),I8e(t,WX()?Reflect.construct(e,n||[],s1(t).constructor):e.apply(t,n))}function I8e(t,e){if(e&&(nh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T8e(t)}function T8e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WX(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WX=function(){return!!t})()}function s1(t){return s1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},s1(t)}function E8e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sI(t,e)}function sI(t,e){return sI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},sI(t,e)}function by(t,e,n){return e=GX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=A8e(t,"string");return nh(e)=="symbol"?e:e+""}function A8e(t,e){if(nh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(nh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fs=32,IO=function(t){function e(){return _8e(this,e),N8e(this,e,arguments)}return E8e(e,t),k8e(e,[{key:"renderIcon",value:function(r){var a=this.props.inactiveColor,s=Fs/2,o=Fs/6,i=Fs/3,l=r.inactive?a:r.color;if(r.type==="plainline")return K.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:s,x2:Fs,y2:s,className:"recharts-legend-icon"});if(r.type==="line")return K.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*i,",").concat(s,`
            H`).concat(Fs,"M").concat(2*i,",").concat(s,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(i,",").concat(s),className:"recharts-legend-icon"});if(r.type==="rect")return K.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Fs/8,"h").concat(Fs,"v").concat(Fs*3/4,"h").concat(-Fs,"z"),className:"recharts-legend-icon"});if(K.isValidElement(r.legendIcon)){var u=C8e({},r);return delete u.legendIcon,K.cloneElement(r.legendIcon,u)}return K.createElement(NO,{fill:l,cx:s,cy:s,size:Fs,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,a=this.props,s=a.payload,o=a.iconSize,i=a.layout,l=a.formatter,u=a.inactiveColor,c={x:0,y:0,width:Fs,height:Fs},d={display:i==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(h,p){var g=h.formatter||l,y=xt(by(by({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",h.inactive));if(h.type==="none")return null;var v=vt(h.value)?null:h.value;Li(!vt(h.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var x=h.inactive?u:h.color;return K.createElement("li",aI({className:y,style:d,key:"legend-item-".concat(p)},Gc(r.props,h,p)),K.createElement(XN,{width:o,height:o,viewBox:c,style:f},r.renderIcon(h)),K.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g?g(v,h,p):v))})}},{key:"render",value:function(){var r=this.props,a=r.payload,s=r.layout,o=r.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:s==="horizontal"?o:"left"};return K.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(N.PureComponent);by(IO,"displayName","Legend");by(IO,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var P8e=G2;function O8e(){this.__data__=new P8e,this.size=0}var R8e=O8e;function D8e(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var j8e=D8e;function M8e(t){return this.__data__.get(t)}var F8e=M8e;function L8e(t){return this.__data__.has(t)}var B8e=L8e,z8e=G2,U8e=gO,V8e=yO,W8e=200;function G8e(t,e){var n=this.__data__;if(n instanceof z8e){var r=n.__data__;if(!U8e||r.length<W8e-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new V8e(r)}return n.set(t,e),this.size=n.size,this}var H8e=G8e,q8e=G2,K8e=R8e,X8e=j8e,Y8e=F8e,Q8e=B8e,J8e=H8e;function Zp(t){var e=this.__data__=new q8e(t);this.size=e.size}Zp.prototype.clear=K8e;Zp.prototype.delete=X8e;Zp.prototype.get=Y8e;Zp.prototype.has=Q8e;Zp.prototype.set=J8e;var HX=Zp,Z8e="__lodash_hash_undefined__";function eqe(t){return this.__data__.set(t,Z8e),this}var tqe=eqe;function nqe(t){return this.__data__.has(t)}var rqe=nqe,aqe=yO,sqe=tqe,oqe=rqe;function o1(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new aqe;++e<n;)this.add(t[e])}o1.prototype.add=o1.prototype.push=sqe;o1.prototype.has=oqe;var qX=o1;function iqe(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var KX=iqe;function lqe(t,e){return t.has(e)}var XX=lqe,uqe=qX,cqe=KX,dqe=XX,fqe=1,hqe=2;function pqe(t,e,n,r,a,s){var o=n&fqe,i=t.length,l=e.length;if(i!=l&&!(o&&l>i))return!1;var u=s.get(t),c=s.get(e);if(u&&c)return u==e&&c==t;var d=-1,f=!0,h=n&hqe?new uqe:void 0;for(s.set(t,e),s.set(e,t);++d<i;){var p=t[d],g=e[d];if(r)var y=o?r(g,p,d,e,t,s):r(p,g,d,t,e,s);if(y!==void 0){if(y)continue;f=!1;break}if(h){if(!cqe(e,function(v,x){if(!dqe(h,x)&&(p===v||a(p,v,n,r,s)))return h.push(x)})){f=!1;break}}else if(!(p===g||a(p,g,n,r,s))){f=!1;break}}return s.delete(t),s.delete(e),f}var YX=pqe,mqe=gi,gqe=mqe.Uint8Array,yqe=gqe;function vqe(t){var e=-1,n=Array(t.size);return t.forEach(function(r,a){n[++e]=[a,r]}),n}var xqe=vqe;function bqe(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var TO=bqe,QM=ob,JM=yqe,wqe=mO,Sqe=YX,Cqe=xqe,_qe=TO,$qe=1,kqe=2,Nqe="[object Boolean]",Iqe="[object Date]",Tqe="[object Error]",Eqe="[object Map]",Aqe="[object Number]",Pqe="[object RegExp]",Oqe="[object Set]",Rqe="[object String]",Dqe="[object Symbol]",jqe="[object ArrayBuffer]",Mqe="[object DataView]",ZM=QM?QM.prototype:void 0,f$=ZM?ZM.valueOf:void 0;function Fqe(t,e,n,r,a,s,o){switch(n){case Mqe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case jqe:return!(t.byteLength!=e.byteLength||!s(new JM(t),new JM(e)));case Nqe:case Iqe:case Aqe:return wqe(+t,+e);case Tqe:return t.name==e.name&&t.message==e.message;case Pqe:case Rqe:return t==e+"";case Eqe:var i=Cqe;case Oqe:var l=r&$qe;if(i||(i=_qe),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;r|=kqe,o.set(t,e);var c=Sqe(i(t),i(e),r,a,s,o);return o.delete(t),c;case Dqe:if(f$)return f$.call(t)==f$.call(e)}return!1}var Lqe=Fqe;function Bqe(t,e){for(var n=-1,r=e.length,a=t.length;++n<r;)t[a+n]=e[n];return t}var QX=Bqe,zqe=QX,Uqe=as;function Vqe(t,e,n){var r=e(t);return Uqe(t)?r:zqe(r,n(t))}var Wqe=Vqe;function Gqe(t,e){for(var n=-1,r=t==null?0:t.length,a=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[a++]=o)}return s}var Hqe=Gqe;function qqe(){return[]}var Kqe=qqe,Xqe=Hqe,Yqe=Kqe,Qqe=Object.prototype,Jqe=Qqe.propertyIsEnumerable,eF=Object.getOwnPropertySymbols,Zqe=eF?function(t){return t==null?[]:(t=Object(t),Xqe(eF(t),function(e){return Jqe.call(t,e)}))}:Yqe,eKe=Zqe;function tKe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var nKe=tKe,rKe=rl,aKe=al,sKe="[object Arguments]";function oKe(t){return aKe(t)&&rKe(t)==sKe}var iKe=oKe,tF=iKe,lKe=al,JX=Object.prototype,uKe=JX.hasOwnProperty,cKe=JX.propertyIsEnumerable,dKe=tF(function(){return arguments}())?tF:function(t){return lKe(t)&&uKe.call(t,"callee")&&!cKe.call(t,"callee")},EO=dKe,i1={exports:{}};function fKe(){return!1}var hKe=fKe;i1.exports;(function(t,e){var n=gi,r=hKe,a=e&&!e.nodeType&&e,s=a&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===a,i=o?n.Buffer:void 0,l=i?i.isBuffer:void 0,u=l||r;t.exports=u})(i1,i1.exports);var ZX=i1.exports,pKe=9007199254740991,mKe=/^(?:0|[1-9]\d*)$/;function gKe(t,e){var n=typeof t;return e=e??pKe,!!e&&(n=="number"||n!="symbol"&&mKe.test(t))&&t>-1&&t%1==0&&t<e}var AO=gKe,yKe=9007199254740991;function vKe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=yKe}var PO=vKe,xKe=rl,bKe=PO,wKe=al,SKe="[object Arguments]",CKe="[object Array]",_Ke="[object Boolean]",$Ke="[object Date]",kKe="[object Error]",NKe="[object Function]",IKe="[object Map]",TKe="[object Number]",EKe="[object Object]",AKe="[object RegExp]",PKe="[object Set]",OKe="[object String]",RKe="[object WeakMap]",DKe="[object ArrayBuffer]",jKe="[object DataView]",MKe="[object Float32Array]",FKe="[object Float64Array]",LKe="[object Int8Array]",BKe="[object Int16Array]",zKe="[object Int32Array]",UKe="[object Uint8Array]",VKe="[object Uint8ClampedArray]",WKe="[object Uint16Array]",GKe="[object Uint32Array]",Fn={};Fn[MKe]=Fn[FKe]=Fn[LKe]=Fn[BKe]=Fn[zKe]=Fn[UKe]=Fn[VKe]=Fn[WKe]=Fn[GKe]=!0;Fn[SKe]=Fn[CKe]=Fn[DKe]=Fn[_Ke]=Fn[jKe]=Fn[$Ke]=Fn[kKe]=Fn[NKe]=Fn[IKe]=Fn[TKe]=Fn[EKe]=Fn[AKe]=Fn[PKe]=Fn[OKe]=Fn[RKe]=!1;function HKe(t){return wKe(t)&&bKe(t.length)&&!!Fn[xKe(t)]}var qKe=HKe;function KKe(t){return function(e){return t(e)}}var e9=KKe,l1={exports:{}};l1.exports;(function(t,e){var n=WK,r=e&&!e.nodeType&&e,a=r&&!0&&t&&!t.nodeType&&t,s=a&&a.exports===r,o=s&&n.process,i=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=i})(l1,l1.exports);var XKe=l1.exports,YKe=qKe,QKe=e9,nF=XKe,rF=nF&&nF.isTypedArray,JKe=rF?QKe(rF):YKe,t9=JKe,ZKe=nKe,e7e=EO,t7e=as,n7e=ZX,r7e=AO,a7e=t9,s7e=Object.prototype,o7e=s7e.hasOwnProperty;function i7e(t,e){var n=t7e(t),r=!n&&e7e(t),a=!n&&!r&&n7e(t),s=!n&&!r&&!a&&a7e(t),o=n||r||a||s,i=o?ZKe(t.length,String):[],l=i.length;for(var u in t)(e||o7e.call(t,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||r7e(u,l)))&&i.push(u);return i}var l7e=i7e,u7e=Object.prototype;function c7e(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||u7e;return t===n}var d7e=c7e;function f7e(t,e){return function(n){return t(e(n))}}var n9=f7e,h7e=n9,p7e=h7e(Object.keys,Object),m7e=p7e,g7e=d7e,y7e=m7e,v7e=Object.prototype,x7e=v7e.hasOwnProperty;function b7e(t){if(!g7e(t))return y7e(t);var e=[];for(var n in Object(t))x7e.call(t,n)&&n!="constructor"&&e.push(n);return e}var w7e=b7e,S7e=pO,C7e=PO;function _7e(t){return t!=null&&C7e(t.length)&&!S7e(t)}var lC=_7e,$7e=l7e,k7e=w7e,N7e=lC;function I7e(t){return N7e(t)?$7e(t):k7e(t)}var OO=I7e,T7e=Wqe,E7e=eKe,A7e=OO;function P7e(t){return T7e(t,A7e,E7e)}var O7e=P7e,aF=O7e,R7e=1,D7e=Object.prototype,j7e=D7e.hasOwnProperty;function M7e(t,e,n,r,a,s){var o=n&R7e,i=aF(t),l=i.length,u=aF(e),c=u.length;if(l!=c&&!o)return!1;for(var d=l;d--;){var f=i[d];if(!(o?f in e:j7e.call(e,f)))return!1}var h=s.get(t),p=s.get(e);if(h&&p)return h==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var y=o;++d<l;){f=i[d];var v=t[f],x=e[f];if(r)var b=o?r(x,v,f,e,t,s):r(v,x,f,t,e,s);if(!(b===void 0?v===x||a(v,x,n,r,s):b)){g=!1;break}y||(y=f=="constructor")}if(g&&!y){var w=t.constructor,C=e.constructor;w!=C&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof C=="function"&&C instanceof C)&&(g=!1)}return s.delete(t),s.delete(e),g}var F7e=M7e,L7e=md,B7e=gi,z7e=L7e(B7e,"DataView"),U7e=z7e,V7e=md,W7e=gi,G7e=V7e(W7e,"Promise"),H7e=G7e,q7e=md,K7e=gi,X7e=q7e(K7e,"Set"),r9=X7e,Y7e=md,Q7e=gi,J7e=Y7e(Q7e,"WeakMap"),Z7e=J7e,oI=U7e,iI=gO,lI=H7e,uI=r9,cI=Z7e,a9=rl,em=dX,sF="[object Map]",eXe="[object Object]",oF="[object Promise]",iF="[object Set]",lF="[object WeakMap]",uF="[object DataView]",tXe=em(oI),nXe=em(iI),rXe=em(lI),aXe=em(uI),sXe=em(cI),Vu=a9;(oI&&Vu(new oI(new ArrayBuffer(1)))!=uF||iI&&Vu(new iI)!=sF||lI&&Vu(lI.resolve())!=oF||uI&&Vu(new uI)!=iF||cI&&Vu(new cI)!=lF)&&(Vu=function(t){var e=a9(t),n=e==eXe?t.constructor:void 0,r=n?em(n):"";if(r)switch(r){case tXe:return uF;case nXe:return sF;case rXe:return oF;case aXe:return iF;case sXe:return lF}return e});var oXe=Vu,h$=HX,iXe=YX,lXe=Lqe,uXe=F7e,cF=oXe,dF=as,fF=ZX,cXe=t9,dXe=1,hF="[object Arguments]",pF="[object Array]",m0="[object Object]",fXe=Object.prototype,mF=fXe.hasOwnProperty;function hXe(t,e,n,r,a,s){var o=dF(t),i=dF(e),l=o?pF:cF(t),u=i?pF:cF(e);l=l==hF?m0:l,u=u==hF?m0:u;var c=l==m0,d=u==m0,f=l==u;if(f&&fF(t)){if(!fF(e))return!1;o=!0,c=!1}if(f&&!c)return s||(s=new h$),o||cXe(t)?iXe(t,e,n,r,a,s):lXe(t,e,l,n,r,a,s);if(!(n&dXe)){var h=c&&mF.call(t,"__wrapped__"),p=d&&mF.call(e,"__wrapped__");if(h||p){var g=h?t.value():t,y=p?e.value():e;return s||(s=new h$),a(g,y,n,r,s)}}return f?(s||(s=new h$),uXe(t,e,n,r,a,s)):!1}var pXe=hXe,mXe=pXe,gF=al;function s9(t,e,n,r,a){return t===e?!0:t==null||e==null||!gF(t)&&!gF(e)?t!==t&&e!==e:mXe(t,e,n,r,s9,a)}var RO=s9,gXe=HX,yXe=RO,vXe=1,xXe=2;function bXe(t,e,n,r){var a=n.length,s=a,o=!r;if(t==null)return!s;for(t=Object(t);a--;){var i=n[a];if(o&&i[2]?i[1]!==t[i[0]]:!(i[0]in t))return!1}for(;++a<s;){i=n[a];var l=i[0],u=t[l],c=i[1];if(o&&i[2]){if(u===void 0&&!(l in t))return!1}else{var d=new gXe;if(r)var f=r(u,c,l,t,e,d);if(!(f===void 0?yXe(c,u,vXe|xXe,r,d):f))return!1}}return!0}var wXe=bXe,SXe=xu;function CXe(t){return t===t&&!SXe(t)}var o9=CXe,_Xe=o9,$Xe=OO;function kXe(t){for(var e=$Xe(t),n=e.length;n--;){var r=e[n],a=t[r];e[n]=[r,a,_Xe(a)]}return e}var NXe=kXe;function IXe(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var i9=IXe,TXe=wXe,EXe=NXe,AXe=i9;function PXe(t){var e=EXe(t);return e.length==1&&e[0][2]?AXe(e[0][0],e[0][1]):function(n){return n===t||TXe(n,t,e)}}var OXe=PXe;function RXe(t,e){return t!=null&&e in Object(t)}var DXe=RXe,jXe=pX,MXe=EO,FXe=as,LXe=AO,BXe=PO,zXe=q2;function UXe(t,e,n){e=jXe(e,t);for(var r=-1,a=e.length,s=!1;++r<a;){var o=zXe(e[r]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++r!=a?s:(a=t==null?0:t.length,!!a&&BXe(a)&&LXe(o,a)&&(FXe(t)||MXe(t)))}var VXe=UXe,WXe=DXe,GXe=VXe;function HXe(t,e){return t!=null&&GXe(t,e,WXe)}var qXe=HXe,KXe=RO,XXe=mX,YXe=qXe,QXe=hO,JXe=o9,ZXe=i9,e9e=q2,t9e=1,n9e=2;function r9e(t,e){return QXe(t)&&JXe(e)?ZXe(e9e(t),e):function(n){var r=XXe(n,t);return r===void 0&&r===e?YXe(n,t):KXe(e,r,t9e|n9e)}}var a9e=r9e;function s9e(t){return t}var tm=s9e;function o9e(t){return function(e){return e==null?void 0:e[t]}}var i9e=o9e,l9e=xO;function u9e(t){return function(e){return l9e(e,t)}}var c9e=u9e,d9e=i9e,f9e=c9e,h9e=hO,p9e=q2;function m9e(t){return h9e(t)?d9e(p9e(t)):f9e(t)}var g9e=m9e,y9e=OXe,v9e=a9e,x9e=tm,b9e=as,w9e=g9e;function S9e(t){return typeof t=="function"?t:t==null?x9e:typeof t=="object"?b9e(t)?v9e(t[0],t[1]):y9e(t):w9e(t)}var bu=S9e;function C9e(t,e,n,r){for(var a=t.length,s=n+(r?1:-1);r?s--:++s<a;)if(e(t[s],s,t))return s;return-1}var _9e=C9e;function $9e(t){return t!==t}var k9e=$9e;function N9e(t,e,n){for(var r=n-1,a=t.length;++r<a;)if(t[r]===e)return r;return-1}var I9e=N9e,T9e=_9e,E9e=k9e,A9e=I9e;function P9e(t,e,n){return e===e?A9e(t,e,n):T9e(t,E9e,n)}var O9e=P9e,R9e=O9e;function D9e(t,e){var n=t==null?0:t.length;return!!n&&R9e(t,e,0)>-1}var j9e=D9e;function M9e(t,e,n){for(var r=-1,a=t==null?0:t.length;++r<a;)if(n(e,t[r]))return!0;return!1}var F9e=M9e;function L9e(){}var B9e=L9e,p$=r9,z9e=B9e,U9e=TO,V9e=1/0,W9e=p$&&1/U9e(new p$([,-0]))[1]==V9e?function(t){return new p$(t)}:z9e,G9e=W9e,H9e=qX,q9e=j9e,K9e=F9e,X9e=XX,Y9e=G9e,Q9e=TO,J9e=200;function Z9e(t,e,n){var r=-1,a=q9e,s=t.length,o=!0,i=[],l=i;if(n)o=!1,a=K9e;else if(s>=J9e){var u=e?null:Y9e(t);if(u)return Q9e(u);o=!1,a=X9e,l=new H9e}else l=e?[]:i;e:for(;++r<s;){var c=t[r],d=e?e(c):c;if(c=n||c!==0?c:0,o&&d===d){for(var f=l.length;f--;)if(l[f]===d)continue e;e&&l.push(d),i.push(c)}else a(l,d,n)||(l!==i&&l.push(d),i.push(c))}return i}var eYe=Z9e,tYe=bu,nYe=eYe;function rYe(t,e){return t&&t.length?nYe(t,tYe(e)):[]}var aYe=rYe;const yF=Ut(aYe);function l9(t,e,n){return e===!0?yF(t,n):vt(e)?yF(t,e):t}function rh(t){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rh(t)}var sYe=["ref"];function vF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function wi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vF(Object(n),!0).forEach(function(r){uC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function oYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c9(r.key),r)}}function iYe(t,e,n){return e&&xF(t.prototype,e),n&&xF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function lYe(t,e,n){return e=u1(e),uYe(t,u9()?Reflect.construct(e,n||[],u1(t).constructor):e.apply(t,n))}function uYe(t,e){if(e&&(rh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cYe(t)}function cYe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(u9=function(){return!!t})()}function u1(t){return u1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},u1(t)}function dYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dI(t,e)}function dI(t,e){return dI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},dI(t,e)}function uC(t,e,n){return e=c9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9(t){var e=fYe(t,"string");return rh(e)=="symbol"?e:e+""}function fYe(t,e){if(rh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(rh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hYe(t,e){if(t==null)return{};var n=pYe(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function pYe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function mYe(t){return t.value}function gYe(t,e){if(K.isValidElement(t))return K.cloneElement(t,e);if(typeof t=="function")return K.createElement(t,e);e.ref;var n=hYe(e,sYe);return K.createElement(IO,n)}var bF=1,vc=function(t){function e(){var n;oYe(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=lYe(this,e,[].concat(a)),uC(n,"lastBoundingBox",{width:-1,height:-1}),n}return dYe(e,t),iYe(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>bF||Math.abs(a.height-this.lastBoundingBox.height)>bF)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,r&&r(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?wi({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var a=this.props,s=a.layout,o=a.align,i=a.verticalAlign,l=a.margin,u=a.chartWidth,c=a.chartHeight,d,f;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(o==="center"&&s==="vertical"){var h=this.getBBoxSnapshot();d={left:((u||0)-h.width)/2}}else d=o==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(i==="middle"){var p=this.getBBoxSnapshot();f={top:((c||0)-p.height)/2}}else f=i==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return wi(wi({},d),f)}},{key:"render",value:function(){var r=this,a=this.props,s=a.content,o=a.width,i=a.height,l=a.wrapperStyle,u=a.payloadUniqBy,c=a.payload,d=wi(wi({position:"absolute",width:o||"auto",height:i||"auto"},this.getDefaultPosition(l)),l);return K.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(h){r.wrapperNode=h}},gYe(s,wi(wi({},this.props),{},{payload:l9(c,u,mYe)})))}}],[{key:"getWithHeight",value:function(r,a){var s=wi(wi({},this.defaultProps),r.props),o=s.layout;return o==="vertical"&&Le(r.props.height)?{height:r.props.height}:o==="horizontal"?{width:r.props.width||a}:null}}])}(N.PureComponent);uC(vc,"displayName","Legend");uC(vc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var wF=ob,yYe=EO,vYe=as,SF=wF?wF.isConcatSpreadable:void 0;function xYe(t){return vYe(t)||yYe(t)||!!(SF&&t&&t[SF])}var bYe=xYe,wYe=QX,SYe=bYe;function d9(t,e,n,r,a){var s=-1,o=t.length;for(n||(n=SYe),a||(a=[]);++s<o;){var i=t[s];e>0&&n(i)?e>1?d9(i,e-1,n,r,a):wYe(a,i):r||(a[a.length]=i)}return a}var f9=d9;function CYe(t){return function(e,n,r){for(var a=-1,s=Object(e),o=r(e),i=o.length;i--;){var l=o[t?i:++a];if(n(s[l],l,s)===!1)break}return e}}var _Ye=CYe,$Ye=_Ye,kYe=$Ye(),NYe=kYe,IYe=NYe,TYe=OO;function EYe(t,e){return t&&IYe(t,e,TYe)}var h9=EYe,AYe=lC;function PYe(t,e){return function(n,r){if(n==null)return n;if(!AYe(n))return t(n,r);for(var a=n.length,s=e?a:-1,o=Object(n);(e?s--:++s<a)&&r(o[s],s,o)!==!1;);return n}}var OYe=PYe,RYe=h9,DYe=OYe,jYe=DYe(RYe),DO=jYe,MYe=DO,FYe=lC;function LYe(t,e){var n=-1,r=FYe(t)?Array(t.length):[];return MYe(t,function(a,s,o){r[++n]=e(a,s,o)}),r}var p9=LYe;function BYe(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var zYe=BYe,CF=Gp;function UYe(t,e){if(t!==e){var n=t!==void 0,r=t===null,a=t===t,s=CF(t),o=e!==void 0,i=e===null,l=e===e,u=CF(e);if(!i&&!u&&!s&&t>e||s&&o&&l&&!i&&!u||r&&o&&l||!n&&l||!a)return 1;if(!r&&!s&&!u&&t<e||u&&n&&a&&!r&&!s||i&&n&&a||!o&&a||!l)return-1}return 0}var VYe=UYe,WYe=VYe;function GYe(t,e,n){for(var r=-1,a=t.criteria,s=e.criteria,o=a.length,i=n.length;++r<o;){var l=WYe(a[r],s[r]);if(l){if(r>=i)return l;var u=n[r];return l*(u=="desc"?-1:1)}}return t.index-e.index}var HYe=GYe,m$=eO,qYe=xO,KYe=bu,XYe=p9,YYe=zYe,QYe=e9,JYe=HYe,ZYe=tm,eQe=as;function tQe(t,e,n){e.length?e=m$(e,function(s){return eQe(s)?function(o){return qYe(o,s.length===1?s[0]:s)}:s}):e=[ZYe];var r=-1;e=m$(e,QYe(KYe));var a=XYe(t,function(s,o,i){var l=m$(e,function(u){return u(s)});return{criteria:l,index:++r,value:s}});return YYe(a,function(s,o){return JYe(s,o,n)})}var nQe=tQe;function rQe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var aQe=rQe,sQe=aQe,_F=Math.max;function oQe(t,e,n){return e=_F(e===void 0?t.length-1:e,0),function(){for(var r=arguments,a=-1,s=_F(r.length-e,0),o=Array(s);++a<s;)o[a]=r[e+a];a=-1;for(var i=Array(e+1);++a<e;)i[a]=r[a];return i[e]=n(o),sQe(t,this,i)}}var iQe=oQe;function lQe(t){return function(){return t}}var uQe=lQe,cQe=md,dQe=function(){try{var t=cQe(Object,"defineProperty");return t({},"",{}),t}catch{}}(),m9=dQe,fQe=uQe,$F=m9,hQe=tm,pQe=$F?function(t,e){return $F(t,"toString",{configurable:!0,enumerable:!1,value:fQe(e),writable:!0})}:hQe,mQe=pQe,gQe=800,yQe=16,vQe=Date.now;function xQe(t){var e=0,n=0;return function(){var r=vQe(),a=yQe-(r-n);if(n=r,a>0){if(++e>=gQe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var bQe=xQe,wQe=mQe,SQe=bQe,CQe=SQe(wQe),_Qe=CQe,$Qe=tm,kQe=iQe,NQe=_Qe;function IQe(t,e){return NQe(kQe(t,e,$Qe),t+"")}var TQe=IQe,EQe=mO,AQe=lC,PQe=AO,OQe=xu;function RQe(t,e,n){if(!OQe(n))return!1;var r=typeof e;return(r=="number"?AQe(n)&&PQe(e,n.length):r=="string"&&e in n)?EQe(n[e],t):!1}var cC=RQe,DQe=f9,jQe=nQe,MQe=TQe,kF=cC,FQe=MQe(function(t,e){if(t==null)return[];var n=e.length;return n>1&&kF(t,e[0],e[1])?e=[]:n>2&&kF(e[0],e[1],e[2])&&(e=[e[0]]),jQe(t,DQe(e,1),[])}),LQe=FQe;const jO=Ut(LQe);function wy(t){"@babel/helpers - typeof";return wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wy(t)}function fI(){return fI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fI.apply(this,arguments)}function BQe(t,e){return WQe(t)||VQe(t,e)||UQe(t,e)||zQe()}function zQe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UQe(t,e){if(t){if(typeof t=="string")return NF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NF(t,e)}}function NF(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function VQe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function WQe(t){if(Array.isArray(t))return t}function IF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function g$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IF(Object(n),!0).forEach(function(r){GQe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function GQe(t,e,n){return e=HQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQe(t){var e=qQe(t,"string");return wy(e)=="symbol"?e:e+""}function qQe(t,e){if(wy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(wy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KQe(t){return Array.isArray(t)&&Cr(t[0])&&Cr(t[1])?t.join(" ~ "):t}var XQe=function(e){var n=e.separator,r=n===void 0?" : ":n,a=e.contentStyle,s=a===void 0?{}:a,o=e.itemStyle,i=o===void 0?{}:o,l=e.labelStyle,u=l===void 0?{}:l,c=e.payload,d=e.formatter,f=e.itemSorter,h=e.wrapperClassName,p=e.labelClassName,g=e.label,y=e.labelFormatter,v=e.accessibilityLayer,x=v===void 0?!1:v,b=function(){if(c&&c.length){var R={padding:0,margin:0},B=(f?jO(c,f):c).map(function(F,L){if(F.type==="none")return null;var H=g$({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},i),te=F.formatter||d||KQe,V=F.value,Q=F.name,se=V,le=Q;if(te&&se!=null&&le!=null){var ue=te(V,Q,F,L,c);if(Array.isArray(ue)){var ce=BQe(ue,2);se=ce[0],le=ce[1]}else se=ue}return K.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(L),style:H},Cr(le)?K.createElement("span",{className:"recharts-tooltip-item-name"},le):null,Cr(le)?K.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,K.createElement("span",{className:"recharts-tooltip-item-value"},se),K.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return K.createElement("ul",{className:"recharts-tooltip-item-list",style:R},B)}return null},w=g$({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),C=g$({margin:0},u),_=!ht(g),$=_?g:"",k=xt("recharts-default-tooltip",h),A=xt("recharts-tooltip-label",p);_&&y&&c!==void 0&&c!==null&&($=y(g,c));var P=x?{role:"status","aria-live":"assertive"}:{};return K.createElement("div",fI({className:k,style:w},P),K.createElement("p",{className:A,style:C},K.isValidElement($)?$:"".concat($)),b())};function Sy(t){"@babel/helpers - typeof";return Sy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sy(t)}function g0(t,e,n){return e=YQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQe(t){var e=QQe(t,"string");return Sy(e)=="symbol"?e:e+""}function QQe(t,e){if(Sy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Sy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dm="recharts-tooltip-wrapper",JQe={visibility:"hidden"};function ZQe(t){var e=t.coordinate,n=t.translateX,r=t.translateY;return xt(Dm,g0(g0(g0(g0({},"".concat(Dm,"-right"),Le(n)&&e&&Le(e.x)&&n>=e.x),"".concat(Dm,"-left"),Le(n)&&e&&Le(e.x)&&n<e.x),"".concat(Dm,"-bottom"),Le(r)&&e&&Le(e.y)&&r>=e.y),"".concat(Dm,"-top"),Le(r)&&e&&Le(e.y)&&r<e.y))}function TF(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.key,a=t.offsetTopLeft,s=t.position,o=t.reverseDirection,i=t.tooltipDimension,l=t.viewBox,u=t.viewBoxDimension;if(s&&Le(s[r]))return s[r];var c=n[r]-i-a,d=n[r]+a;if(e[r])return o[r]?c:d;if(o[r]){var f=c,h=l[r];return f<h?Math.max(d,l[r]):Math.max(c,l[r])}var p=d+i,g=l[r]+u;return p>g?Math.max(c,l[r]):Math.max(d,l[r])}function eJe(t){var e=t.translateX,n=t.translateY,r=t.useTranslate3d;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function tJe(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.offsetTopLeft,a=t.position,s=t.reverseDirection,o=t.tooltipBox,i=t.useTranslate3d,l=t.viewBox,u,c,d;return o.height>0&&o.width>0&&n?(c=TF({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),d=TF({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),u=eJe({translateX:c,translateY:d,useTranslate3d:i})):u=JQe,{cssProperties:u,cssClasses:ZQe({translateX:c,translateY:d,coordinate:n})}}function ah(t){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ah(t)}function EF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function AF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EF(Object(n),!0).forEach(function(r){pI(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rJe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y9(r.key),r)}}function aJe(t,e,n){return e&&rJe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function sJe(t,e,n){return e=c1(e),oJe(t,g9()?Reflect.construct(e,n||[],c1(t).constructor):e.apply(t,n))}function oJe(t,e){if(e&&(ah(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iJe(t)}function iJe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g9=function(){return!!t})()}function c1(t){return c1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},c1(t)}function lJe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hI(t,e)}function hI(t,e){return hI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},hI(t,e)}function pI(t,e,n){return e=y9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y9(t){var e=uJe(t,"string");return ah(e)=="symbol"?e:e+""}function uJe(t,e){if(ah(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ah(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PF=1,cJe=function(t){function e(){var n;nJe(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=sJe(this,e,[].concat(a)),pI(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),pI(n,"handleKeyDown",function(o){if(o.key==="Escape"){var i,l,u,c;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&i!==void 0?i:0,y:(u=(c=n.props.coordinate)===null||c===void 0?void 0:c.y)!==null&&u!==void 0?u:0}})}}),n}return lJe(e,t),aJe(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>PF||Math.abs(r.height-this.state.lastBoundingBox.height)>PF)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,a=this.props,s=a.active,o=a.allowEscapeViewBox,i=a.animationDuration,l=a.animationEasing,u=a.children,c=a.coordinate,d=a.hasPayload,f=a.isAnimationActive,h=a.offset,p=a.position,g=a.reverseDirection,y=a.useTranslate3d,v=a.viewBox,x=a.wrapperStyle,b=tJe({allowEscapeViewBox:o,coordinate:c,offsetTopLeft:h,position:p,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:v}),w=b.cssClasses,C=b.cssProperties,_=AF(AF({transition:f&&s?"transform ".concat(i,"ms ").concat(l):void 0},C),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&d?"visible":"hidden",position:"absolute",top:0,left:0},x);return K.createElement("div",{tabIndex:-1,className:w,style:_,ref:function(k){r.wrapperNode=k}},u)}}])}(N.PureComponent),dJe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},ti={isSsr:dJe(),get:function(e){return ti[e]},set:function(e,n){if(typeof e=="string")ti[e]=n;else{var r=Object.keys(e);r&&r.length&&r.forEach(function(a){ti[a]=e[a]})}}};function sh(t){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sh(t)}function OF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function RF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?OF(Object(n),!0).forEach(function(r){MO(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):OF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function fJe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hJe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,x9(r.key),r)}}function pJe(t,e,n){return e&&hJe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function mJe(t,e,n){return e=d1(e),gJe(t,v9()?Reflect.construct(e,n||[],d1(t).constructor):e.apply(t,n))}function gJe(t,e){if(e&&(sh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yJe(t)}function yJe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v9(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v9=function(){return!!t})()}function d1(t){return d1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},d1(t)}function vJe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mI(t,e)}function mI(t,e){return mI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},mI(t,e)}function MO(t,e,n){return e=x9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=xJe(t,"string");return sh(e)=="symbol"?e:e+""}function xJe(t,e){if(sh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(sh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bJe(t){return t.dataKey}function wJe(t,e){return K.isValidElement(t)?K.cloneElement(t,e):typeof t=="function"?K.createElement(t,e):K.createElement(XQe,e)}var Go=function(t){function e(){return fJe(this,e),mJe(this,e,arguments)}return vJe(e,t),pJe(e,[{key:"render",value:function(){var r=this,a=this.props,s=a.active,o=a.allowEscapeViewBox,i=a.animationDuration,l=a.animationEasing,u=a.content,c=a.coordinate,d=a.filterNull,f=a.isAnimationActive,h=a.offset,p=a.payload,g=a.payloadUniqBy,y=a.position,v=a.reverseDirection,x=a.useTranslate3d,b=a.viewBox,w=a.wrapperStyle,C=p??[];d&&C.length&&(C=l9(p.filter(function($){return $.value!=null&&($.hide!==!0||r.props.includeHidden)}),g,bJe));var _=C.length>0;return K.createElement(cJe,{allowEscapeViewBox:o,animationDuration:i,animationEasing:l,isAnimationActive:f,active:s,coordinate:c,hasPayload:_,offset:h,position:y,reverseDirection:v,useTranslate3d:x,viewBox:b,wrapperStyle:w},wJe(u,RF(RF({},this.props),{},{payload:C})))}}])}(N.PureComponent);MO(Go,"displayName","Tooltip");MO(Go,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!ti.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var SJe=gi,CJe=function(){return SJe.Date.now()},_Je=CJe,$Je=/\s/;function kJe(t){for(var e=t.length;e--&&$Je.test(t.charAt(e)););return e}var NJe=kJe,IJe=NJe,TJe=/^\s+/;function EJe(t){return t&&t.slice(0,IJe(t)+1).replace(TJe,"")}var AJe=EJe,PJe=AJe,DF=xu,OJe=Gp,jF=NaN,RJe=/^[-+]0x[0-9a-f]+$/i,DJe=/^0b[01]+$/i,jJe=/^0o[0-7]+$/i,MJe=parseInt;function FJe(t){if(typeof t=="number")return t;if(OJe(t))return jF;if(DF(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=DF(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=PJe(t);var n=DJe.test(t);return n||jJe.test(t)?MJe(t.slice(2),n?2:8):RJe.test(t)?jF:+t}var b9=FJe,LJe=xu,y$=_Je,MF=b9,BJe="Expected a function",zJe=Math.max,UJe=Math.min;function VJe(t,e,n){var r,a,s,o,i,l,u=0,c=!1,d=!1,f=!0;if(typeof t!="function")throw new TypeError(BJe);e=MF(e)||0,LJe(n)&&(c=!!n.leading,d="maxWait"in n,s=d?zJe(MF(n.maxWait)||0,e):s,f="trailing"in n?!!n.trailing:f);function h(_){var $=r,k=a;return r=a=void 0,u=_,o=t.apply(k,$),o}function p(_){return u=_,i=setTimeout(v,e),c?h(_):o}function g(_){var $=_-l,k=_-u,A=e-$;return d?UJe(A,s-k):A}function y(_){var $=_-l,k=_-u;return l===void 0||$>=e||$<0||d&&k>=s}function v(){var _=y$();if(y(_))return x(_);i=setTimeout(v,g(_))}function x(_){return i=void 0,f&&r?h(_):(r=a=void 0,o)}function b(){i!==void 0&&clearTimeout(i),u=0,r=l=a=i=void 0}function w(){return i===void 0?o:x(y$())}function C(){var _=y$(),$=y(_);if(r=arguments,a=this,l=_,$){if(i===void 0)return p(l);if(d)return clearTimeout(i),i=setTimeout(v,e),h(l)}return i===void 0&&(i=setTimeout(v,e)),o}return C.cancel=b,C.flush=w,C}var WJe=VJe,GJe=WJe,HJe=xu,qJe="Expected a function";function KJe(t,e,n){var r=!0,a=!0;if(typeof t!="function")throw new TypeError(qJe);return HJe(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),GJe(t,e,{leading:r,maxWait:e,trailing:a})}var XJe=KJe;const w9=Ut(XJe);function Cy(t){"@babel/helpers - typeof";return Cy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cy(t)}function FF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function y0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FF(Object(n),!0).forEach(function(r){YJe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function YJe(t,e,n){return e=QJe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJe(t){var e=JJe(t,"string");return Cy(e)=="symbol"?e:e+""}function JJe(t,e){if(Cy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Cy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZJe(t,e){return rZe(t)||nZe(t,e)||tZe(t,e)||eZe()}function eZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tZe(t,e){if(t){if(typeof t=="string")return LF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LF(t,e)}}function LF(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nZe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function rZe(t){if(Array.isArray(t))return t}var aZe=N.forwardRef(function(t,e){var n=t.aspect,r=t.initialDimension,a=r===void 0?{width:-1,height:-1}:r,s=t.width,o=s===void 0?"100%":s,i=t.height,l=i===void 0?"100%":i,u=t.minWidth,c=u===void 0?0:u,d=t.minHeight,f=t.maxHeight,h=t.children,p=t.debounce,g=p===void 0?0:p,y=t.id,v=t.className,x=t.onResize,b=t.style,w=b===void 0?{}:b,C=N.useRef(null),_=N.useRef();_.current=x,N.useImperativeHandle(e,function(){return Object.defineProperty(C.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),C.current},configurable:!0})});var $=N.useState({containerWidth:a.width,containerHeight:a.height}),k=ZJe($,2),A=k[0],P=k[1],O=N.useCallback(function(B,F){P(function(L){var H=Math.round(B),te=Math.round(F);return L.containerWidth===H&&L.containerHeight===te?L:{containerWidth:H,containerHeight:te}})},[]);N.useEffect(function(){var B=function(Q){var se,le=Q[0].contentRect,ue=le.width,ce=le.height;O(ue,ce),(se=_.current)===null||se===void 0||se.call(_,ue,ce)};g>0&&(B=w9(B,g,{trailing:!0,leading:!1}));var F=new ResizeObserver(B),L=C.current.getBoundingClientRect(),H=L.width,te=L.height;return O(H,te),F.observe(C.current),function(){F.disconnect()}},[O,g]);var R=N.useMemo(function(){var B=A.containerWidth,F=A.containerHeight;if(B<0||F<0)return null;Li(ac(o)||ac(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,l),Li(!n||n>0,"The aspect(%s) must be greater than zero.",n);var L=ac(o)?B:o,H=ac(l)?F:l;n&&n>0&&(L?H=L/n:H&&(L=H*n),f&&H>f&&(H=f)),Li(L>0||H>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,L,H,o,l,c,d,n);var te=!Array.isArray(h)&&Fi(h.type).endsWith("Chart");return K.Children.map(h,function(V){return vX.isElement(V)?N.cloneElement(V,y0({width:L,height:H},te?{style:y0({height:"100%",width:"100%",maxHeight:H,maxWidth:L},V.props.style)}:{})):V})},[n,h,l,f,d,c,A,o]);return K.createElement("div",{id:y?"".concat(y):void 0,className:xt("recharts-responsive-container",v),style:y0(y0({},w),{},{width:o,height:l,minWidth:c,minHeight:d,maxHeight:f}),ref:C},R)}),dC=function(e){return null};dC.displayName="Cell";function _y(t){"@babel/helpers - typeof";return _y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_y(t)}function BF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function gI(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BF(Object(n),!0).forEach(function(r){sZe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BF(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function sZe(t,e,n){return e=oZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oZe(t){var e=iZe(t,"string");return _y(e)=="symbol"?e:e+""}function iZe(t,e){if(_y(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vd={widthCache:{},cacheCount:0},lZe=2e3,uZe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},zF="recharts_measurement_span";function cZe(t){var e=gI({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var wg=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||ti.isSsr)return{width:0,height:0};var r=cZe(n),a=JSON.stringify({text:e,copyStyle:r});if(Vd.widthCache[a])return Vd.widthCache[a];try{var s=document.getElementById(zF);s||(s=document.createElement("span"),s.setAttribute("id",zF),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var o=gI(gI({},uZe),r);Object.assign(s.style,o),s.textContent="".concat(e);var i=s.getBoundingClientRect(),l={width:i.width,height:i.height};return Vd.widthCache[a]=l,++Vd.cacheCount>lZe&&(Vd.cacheCount=0,Vd.widthCache={}),l}catch{return{width:0,height:0}}},dZe=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function $y(t){"@babel/helpers - typeof";return $y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$y(t)}function f1(t,e){return mZe(t)||pZe(t,e)||hZe(t,e)||fZe()}function fZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hZe(t,e){if(t){if(typeof t=="string")return UF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UF(t,e)}}function UF(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pZe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function mZe(t){if(Array.isArray(t))return t}function gZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VF(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vZe(r.key),r)}}function yZe(t,e,n){return e&&VF(t.prototype,e),n&&VF(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vZe(t){var e=xZe(t,"string");return $y(e)=="symbol"?e:e+""}function xZe(t,e){if($y(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if($y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var WF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,GF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,bZe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,wZe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,S9={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},SZe=Object.keys(S9),df="NaN";function CZe(t,e){return t*S9[e]}var v0=function(){function t(e,n){gZe(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!bZe.test(n)&&(this.num=NaN,this.unit=""),SZe.includes(n)&&(this.num=CZe(e,n),this.unit="px")}return yZe(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,a=(r=wZe.exec(n))!==null&&r!==void 0?r:[],s=f1(a,3),o=s[1],i=s[2];return new t(parseFloat(o),i??"")}}])}();function C9(t){if(t.includes(df))return df;for(var e=t;e.includes("*")||e.includes("/");){var n,r=(n=WF.exec(e))!==null&&n!==void 0?n:[],a=f1(r,4),s=a[1],o=a[2],i=a[3],l=v0.parse(s??""),u=v0.parse(i??""),c=o==="*"?l.multiply(u):l.divide(u);if(c.isNaN())return df;e=e.replace(WF,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,f=(d=GF.exec(e))!==null&&d!==void 0?d:[],h=f1(f,4),p=h[1],g=h[2],y=h[3],v=v0.parse(p??""),x=v0.parse(y??""),b=g==="+"?v.add(x):v.subtract(x);if(b.isNaN())return df;e=e.replace(GF,b.toString())}return e}var HF=/\(([^()]*)\)/;function _Ze(t){for(var e=t;e.includes("(");){var n=HF.exec(e),r=f1(n,2),a=r[1];e=e.replace(HF,C9(a))}return e}function $Ze(t){var e=t.replace(/\s+/g,"");return e=_Ze(e),e=C9(e),e}function kZe(t){try{return $Ze(t)}catch{return df}}function v$(t){var e=kZe(t.slice(5,-1));return e===df?"":e}var NZe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],IZe=["dx","dy","angle","className","breakAll"];function yI(){return yI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yI.apply(this,arguments)}function qF(t,e){if(t==null)return{};var n=TZe(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function TZe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function KF(t,e){return OZe(t)||PZe(t,e)||AZe(t,e)||EZe()}function EZe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AZe(t,e){if(t){if(typeof t=="string")return XF(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return XF(t,e)}}function XF(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function PZe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function OZe(t){if(Array.isArray(t))return t}var _9=/[ \f\n\r\t\v\u2028\u2029]+/,$9=function(e){var n=e.children,r=e.breakAll,a=e.style;try{var s=[];ht(n)||(r?s=n.toString().split(""):s=n.toString().split(_9));var o=s.map(function(l){return{word:l,width:wg(l,a).width}}),i=r?0:wg(" ",a).width;return{wordsWithComputedWidth:o,spaceWidth:i}}catch{return null}},RZe=function(e,n,r,a,s){var o=e.maxLines,i=e.children,l=e.style,u=e.breakAll,c=Le(o),d=i,f=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L.reduce(function(H,te){var V=te.word,Q=te.width,se=H[H.length-1];if(se&&(a==null||s||se.width+Q+r<Number(a)))se.words.push(V),se.width+=Q+r;else{var le={words:[V],width:Q};H.push(le)}return H},[])},h=f(n),p=function(L){return L.reduce(function(H,te){return H.width>te.width?H:te})};if(!c)return h;for(var g="…",y=function(L){var H=d.slice(0,L),te=$9({breakAll:u,style:l,children:H+g}).wordsWithComputedWidth,V=f(te),Q=V.length>o||p(V).width>Number(a);return[Q,V]},v=0,x=d.length-1,b=0,w;v<=x&&b<=d.length-1;){var C=Math.floor((v+x)/2),_=C-1,$=y(_),k=KF($,2),A=k[0],P=k[1],O=y(C),R=KF(O,1),B=R[0];if(!A&&!B&&(v=C+1),A&&B&&(x=C-1),!A&&B){w=P;break}b++}return w||h},YF=function(e){var n=ht(e)?[]:e.toString().split(_9);return[{words:n}]},DZe=function(e){var n=e.width,r=e.scaleToFit,a=e.children,s=e.style,o=e.breakAll,i=e.maxLines;if((n||r)&&!ti.isSsr){var l,u,c=$9({breakAll:o,children:a,style:s});if(c){var d=c.wordsWithComputedWidth,f=c.spaceWidth;l=d,u=f}else return YF(a);return RZe({breakAll:o,children:a,maxLines:i,style:s},l,u,n,r)}return YF(a)},QF="#808080",Hc=function(e){var n=e.x,r=n===void 0?0:n,a=e.y,s=a===void 0?0:a,o=e.lineHeight,i=o===void 0?"1em":o,l=e.capHeight,u=l===void 0?"0.71em":l,c=e.scaleToFit,d=c===void 0?!1:c,f=e.textAnchor,h=f===void 0?"start":f,p=e.verticalAnchor,g=p===void 0?"end":p,y=e.fill,v=y===void 0?QF:y,x=qF(e,NZe),b=N.useMemo(function(){return DZe({breakAll:x.breakAll,children:x.children,maxLines:x.maxLines,scaleToFit:d,style:x.style,width:x.width})},[x.breakAll,x.children,x.maxLines,d,x.style,x.width]),w=x.dx,C=x.dy,_=x.angle,$=x.className,k=x.breakAll,A=qF(x,IZe);if(!Cr(r)||!Cr(s))return null;var P=r+(Le(w)?w:0),O=s+(Le(C)?C:0),R;switch(g){case"start":R=v$("calc(".concat(u,")"));break;case"middle":R=v$("calc(".concat((b.length-1)/2," * -").concat(i," + (").concat(u," / 2))"));break;default:R=v$("calc(".concat(b.length-1," * -").concat(i,")"));break}var B=[];if(d){var F=b[0].width,L=x.width;B.push("scale(".concat((Le(L)?L/F:1)/F,")"))}return _&&B.push("rotate(".concat(_,", ").concat(P,", ").concat(O,")")),B.length&&(A.transform=B.join(" ")),K.createElement("text",yI({},nt(A,!0),{x:P,y:O,className:xt("recharts-text",$),textAnchor:h,fill:v.includes("url")?QF:v}),b.map(function(H,te){var V=H.words.join(k?"":" ");return K.createElement("tspan",{x:P,dy:te===0?R:i,key:"".concat(V,"-").concat(te)},V)}))};function Kl(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function jZe(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function FO(t){let e,n,r;t.length!==2?(e=Kl,n=(i,l)=>Kl(t(i),l),r=(i,l)=>t(i)-l):(e=t===Kl||t===jZe?t:MZe,n=t,r=t);function a(i,l,u=0,c=i.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;n(i[d],l)<0?u=d+1:c=d}while(u<c)}return u}function s(i,l,u=0,c=i.length){if(u<c){if(e(l,l)!==0)return c;do{const d=u+c>>>1;n(i[d],l)<=0?u=d+1:c=d}while(u<c)}return u}function o(i,l,u=0,c=i.length){const d=a(i,l,u,c-1);return d>u&&r(i[d-1],l)>-r(i[d],l)?d-1:d}return{left:a,center:o,right:s}}function MZe(){return 0}function k9(t){return t===null?NaN:+t}function*FZe(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const LZe=FO(Kl),ub=LZe.right;FO(k9).center;class JF extends Map{constructor(e,n=UZe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,a]of e)this.set(r,a)}get(e){return super.get(ZF(this,e))}has(e){return super.has(ZF(this,e))}set(e,n){return super.set(BZe(this,e),n)}delete(e){return super.delete(zZe(this,e))}}function ZF({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function BZe({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function zZe({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function UZe(t){return t!==null&&typeof t=="object"?t.valueOf():t}function VZe(t=Kl){if(t===Kl)return N9;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function N9(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const WZe=Math.sqrt(50),GZe=Math.sqrt(10),HZe=Math.sqrt(2);function h1(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),s=r/Math.pow(10,a),o=s>=WZe?10:s>=GZe?5:s>=HZe?2:1;let i,l,u;return a<0?(u=Math.pow(10,-a)/o,i=Math.round(t*u),l=Math.round(e*u),i/u<t&&++i,l/u>e&&--l,u=-u):(u=Math.pow(10,a)*o,i=Math.round(t/u),l=Math.round(e/u),i*u<t&&++i,l*u>e&&--l),l<i&&.5<=n&&n<2?h1(t,e,n*2):[i,l,u]}function vI(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[a,s,o]=r?h1(e,t,n):h1(t,e,n);if(!(s>=a))return[];const i=s-a+1,l=new Array(i);if(r)if(o<0)for(let u=0;u<i;++u)l[u]=(s-u)/-o;else for(let u=0;u<i;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<i;++u)l[u]=(a+u)/-o;else for(let u=0;u<i;++u)l[u]=(a+u)*o;return l}function xI(t,e,n){return e=+e,t=+t,n=+n,h1(t,e,n)[2]}function bI(t,e,n){e=+e,t=+t,n=+n;const r=e<t,a=r?xI(e,t,n):xI(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function eL(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function tL(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function I9(t,e,n=0,r=1/0,a){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(a=a===void 0?N9:VZe(a);r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,c=Math.log(l),d=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*d*(l-d)/l)*(u-l/2<0?-1:1),h=Math.max(n,Math.floor(e-u*d/l+f)),p=Math.min(r,Math.floor(e+(l-u)*d/l+f));I9(t,e,h,p,a)}const s=t[e];let o=n,i=r;for(jm(t,n,e),a(t[r],s)>0&&jm(t,n,r);o<i;){for(jm(t,o,i),++o,--i;a(t[o],s)<0;)++o;for(;a(t[i],s)>0;)--i}a(t[n],s)===0?jm(t,n,i):(++i,jm(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}return t}function jm(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function qZe(t,e,n){if(t=Float64Array.from(FZe(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return tL(t);if(e>=1)return eL(t);var r,a=(r-1)*e,s=Math.floor(a),o=eL(I9(t,s).subarray(0,s+1)),i=tL(t.subarray(s+1));return o+(i-o)*(a-s)}}function KZe(t,e,n=k9){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,s=Math.floor(a),o=+n(t[s],s,t),i=+n(t[s+1],s+1,t);return o+(i-o)*(a-s)}}function XZe(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(a);++r<a;)s[r]=t+r*n;return s}function oo(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function sl(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const wI=Symbol("implicit");function LO(){var t=new JF,e=[],n=[],r=wI;function a(s){let o=t.get(s);if(o===void 0){if(r!==wI)return r;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return a.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new JF;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return LO(e,n).unknown(r)},oo.apply(a,arguments),a}function ky(){var t=LO().unknown(void 0),e=t.domain,n=t.range,r=0,a=1,s,o,i=!1,l=0,u=0,c=.5;delete t.unknown;function d(){var f=e().length,h=a<r,p=h?a:r,g=h?r:a;s=(g-p)/Math.max(1,f-l+u*2),i&&(s=Math.floor(s)),p+=(g-p-s*(f-l))*c,o=s*(1-l),i&&(p=Math.round(p),o=Math.round(o));var y=XZe(f).map(function(v){return p+s*v});return n(h?y.reverse():y)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([r,a]=f,r=+r,a=+a,d()):[r,a]},t.rangeRound=function(f){return[r,a]=f,r=+r,a=+a,i=!0,d()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(f){return arguments.length?(i=!!f,d()):i},t.padding=function(f){return arguments.length?(l=Math.min(1,u=+f),d()):l},t.paddingInner=function(f){return arguments.length?(l=Math.min(1,f),d()):l},t.paddingOuter=function(f){return arguments.length?(u=+f,d()):u},t.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),d()):c},t.copy=function(){return ky(e(),[r,a]).round(i).paddingInner(l).paddingOuter(u).align(c)},oo.apply(d(),arguments)}function T9(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return T9(e())},t}function Sg(){return T9(ky.apply(null,arguments).paddingInner(1))}function BO(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function E9(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function cb(){}var Ny=.7,p1=1/Ny,Ef="\\s*([+-]?\\d+)\\s*",Iy="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ni="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",YZe=/^#([0-9a-f]{3,8})$/,QZe=new RegExp(`^rgb\\(${Ef},${Ef},${Ef}\\)$`),JZe=new RegExp(`^rgb\\(${ni},${ni},${ni}\\)$`),ZZe=new RegExp(`^rgba\\(${Ef},${Ef},${Ef},${Iy}\\)$`),eet=new RegExp(`^rgba\\(${ni},${ni},${ni},${Iy}\\)$`),tet=new RegExp(`^hsl\\(${Iy},${ni},${ni}\\)$`),net=new RegExp(`^hsla\\(${Iy},${ni},${ni},${Iy}\\)$`),nL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};BO(cb,Ty,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:rL,formatHex:rL,formatHex8:ret,formatHsl:aet,formatRgb:aL,toString:aL});function rL(){return this.rgb().formatHex()}function ret(){return this.rgb().formatHex8()}function aet(){return A9(this).formatHsl()}function aL(){return this.rgb().formatRgb()}function Ty(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=YZe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?sL(e):n===3?new Xa(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?x0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?x0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=QZe.exec(t))?new Xa(e[1],e[2],e[3],1):(e=JZe.exec(t))?new Xa(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=ZZe.exec(t))?x0(e[1],e[2],e[3],e[4]):(e=eet.exec(t))?x0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=tet.exec(t))?lL(e[1],e[2]/100,e[3]/100,1):(e=net.exec(t))?lL(e[1],e[2]/100,e[3]/100,e[4]):nL.hasOwnProperty(t)?sL(nL[t]):t==="transparent"?new Xa(NaN,NaN,NaN,0):null}function sL(t){return new Xa(t>>16&255,t>>8&255,t&255,1)}function x0(t,e,n,r){return r<=0&&(t=e=n=NaN),new Xa(t,e,n,r)}function set(t){return t instanceof cb||(t=Ty(t)),t?(t=t.rgb(),new Xa(t.r,t.g,t.b,t.opacity)):new Xa}function SI(t,e,n,r){return arguments.length===1?set(t):new Xa(t,e,n,r??1)}function Xa(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}BO(Xa,SI,E9(cb,{brighter(t){return t=t==null?p1:Math.pow(p1,t),new Xa(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ny:Math.pow(Ny,t),new Xa(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Xa(xc(this.r),xc(this.g),xc(this.b),m1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oL,formatHex:oL,formatHex8:oet,formatRgb:iL,toString:iL}));function oL(){return`#${sc(this.r)}${sc(this.g)}${sc(this.b)}`}function oet(){return`#${sc(this.r)}${sc(this.g)}${sc(this.b)}${sc((isNaN(this.opacity)?1:this.opacity)*255)}`}function iL(){const t=m1(this.opacity);return`${t===1?"rgb(":"rgba("}${xc(this.r)}, ${xc(this.g)}, ${xc(this.b)}${t===1?")":`, ${t})`}`}function m1(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function xc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function sc(t){return t=xc(t),(t<16?"0":"")+t.toString(16)}function lL(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new wo(t,e,n,r)}function A9(t){if(t instanceof wo)return new wo(t.h,t.s,t.l,t.opacity);if(t instanceof cb||(t=Ty(t)),!t)return new wo;if(t instanceof wo)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,i=s-a,l=(s+a)/2;return i?(e===s?o=(n-r)/i+(n<r)*6:n===s?o=(r-e)/i+2:o=(e-n)/i+4,i/=l<.5?s+a:2-s-a,o*=60):i=l>0&&l<1?0:o,new wo(o,i,l,t.opacity)}function iet(t,e,n,r){return arguments.length===1?A9(t):new wo(t,e,n,r??1)}function wo(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}BO(wo,iet,E9(cb,{brighter(t){return t=t==null?p1:Math.pow(p1,t),new wo(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ny:Math.pow(Ny,t),new wo(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new Xa(x$(t>=240?t-240:t+120,a,r),x$(t,a,r),x$(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new wo(uL(this.h),b0(this.s),b0(this.l),m1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=m1(this.opacity);return`${t===1?"hsl(":"hsla("}${uL(this.h)}, ${b0(this.s)*100}%, ${b0(this.l)*100}%${t===1?")":`, ${t})`}`}}));function uL(t){return t=(t||0)%360,t<0?t+360:t}function b0(t){return Math.max(0,Math.min(1,t||0))}function x$(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const zO=t=>()=>t;function uet(t,e){return function(n){return t+n*e}}function cet(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function det(t){return(t=+t)==1?P9:function(e,n){return n-e?cet(e,n,t):zO(isNaN(e)?n:e)}}function P9(t,e){var n=e-t;return n?uet(t,n):zO(isNaN(t)?e:t)}const cL=function t(e){var n=det(e);function r(a,s){var o=n((a=SI(a)).r,(s=SI(s)).r),i=n(a.g,s.g),l=n(a.b,s.b),u=P9(a.opacity,s.opacity);return function(c){return a.r=o(c),a.g=i(c),a.b=l(c),a.opacity=u(c),a+""}}return r.gamma=t,r}(1);function fet(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),a;return function(s){for(a=0;a<n;++a)r[a]=t[a]*(1-s)+e[a]*s;return r}}function het(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pet(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,a=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)a[o]=nm(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(i){for(o=0;o<r;++o)s[o]=a[o](i);return s}}function met(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function g1(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function get(t,e){var n={},r={},a;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in t?n[a]=nm(t[a],e[a]):r[a]=e[a];return function(s){for(a in n)r[a]=n[a](s);return r}}var CI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b$=new RegExp(CI.source,"g");function yet(t){return function(){return t}}function vet(t){return function(e){return t(e)+""}}function xet(t,e){var n=CI.lastIndex=b$.lastIndex=0,r,a,s,o=-1,i=[],l=[];for(t=t+"",e=e+"";(r=CI.exec(t))&&(a=b$.exec(e));)(s=a.index)>n&&(s=e.slice(n,s),i[o]?i[o]+=s:i[++o]=s),(r=r[0])===(a=a[0])?i[o]?i[o]+=a:i[++o]=a:(i[++o]=null,l.push({i:o,x:g1(r,a)})),n=b$.lastIndex;return n<e.length&&(s=e.slice(n),i[o]?i[o]+=s:i[++o]=s),i.length<2?l[0]?vet(l[0].x):yet(e):(e=l.length,function(u){for(var c=0,d;c<e;++c)i[(d=l[c]).i]=d.x(u);return i.join("")})}function nm(t,e){var n=typeof e,r;return e==null||n==="boolean"?zO(e):(n==="number"?g1:n==="string"?(r=Ty(e))?(e=r,cL):xet:e instanceof Ty?cL:e instanceof Date?met:het(e)?fet:Array.isArray(e)?pet:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?get:g1)(t,e)}function UO(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function bet(t,e){e===void 0&&(e=t,t=nm);for(var n=0,r=e.length-1,a=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(a,a=e[++n]);return function(o){var i=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[i](o-i)}}function wet(t){return function(){return t}}function y1(t){return+t}var dL=[0,1];function $a(t){return t}function _I(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:wet(isNaN(e)?NaN:.5)}function Cet(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function _et(t,e,n){var r=t[0],a=t[1],s=e[0],o=e[1];return a<r?(r=_I(a,r),s=n(o,s)):(r=_I(r,a),s=n(s,o)),function(i){return s(r(i))}}function $et(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)a[o]=_I(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(i){var l=ub(t,i,1,r)-1;return s[l](a[l](i))}}function db(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function fC(){var t=dL,e=dL,n=nm,r,a,s,o=$a,i,l,u;function c(){var f=Math.min(t.length,e.length);return o!==$a&&(o=Cet(t[0],t[f-1])),i=f>2?$et:_et,l=u=null,d}function d(f){return f==null||isNaN(f=+f)?s:(l||(l=i(t.map(r),e,n)))(r(o(f)))}return d.invert=function(f){return o(a((u||(u=i(e,t.map(r),g1)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,y1),c()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),c()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=UO,c()},d.clamp=function(f){return arguments.length?(o=f?!0:$a,c()):o!==$a},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(s=f,d):s},function(f,h){return r=f,a=h,c()}}function VO(){return fC()($a,$a)}function ket(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function v1(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function oh(t){return t=v1(Math.abs(t)),t?t[1]:NaN}function Net(t,e){return function(n,r){for(var a=n.length,s=[],o=0,i=t[0],l=0;a>0&&i>0&&(l+i+1>r&&(i=Math.max(1,r-l)),s.push(n.substring(a-=i,a+i)),!((l+=i+1)>r));)i=t[o=(o+1)%t.length];return s.reverse().join(e)}}function Iet(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Tet=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ey(t){if(!(e=Tet.exec(t)))throw new Error("invalid format: "+t);var e;return new WO({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Ey.prototype=WO.prototype;function WO(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}WO.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Eet(t){e:for(var e=t.length,n=1,r=-1,a;n<e;++n)switch(t[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(a+1):t}var O9;function Aet(t,e){var n=v1(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(O9=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+v1(t,Math.max(0,e+s-1))[0]}function fL(t,e){var n=v1(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const hL={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:ket,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fL(t*100,e),r:fL,s:Aet,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function pL(t){return t}var mL=Array.prototype.map,gL=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Pet(t){var e=t.grouping===void 0||t.thousands===void 0?pL:Net(mL.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?pL:Iet(mL.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",i=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(d){d=Ey(d);var f=d.fill,h=d.align,p=d.sign,g=d.symbol,y=d.zero,v=d.width,x=d.comma,b=d.precision,w=d.trim,C=d.type;C==="n"?(x=!0,C="g"):hL[C]||(b===void 0&&(b=12),w=!0,C="g"),(y||f==="0"&&h==="=")&&(y=!0,f="0",h="=");var _=g==="$"?n:g==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",$=g==="$"?r:/[%p]/.test(C)?o:"",k=hL[C],A=/[defgprs%]/.test(C);b=b===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function P(O){var R=_,B=$,F,L,H;if(C==="c")B=k(O)+B,O="";else{O=+O;var te=O<0||1/O<0;if(O=isNaN(O)?l:k(Math.abs(O),b),w&&(O=Eet(O)),te&&+O==0&&p!=="+"&&(te=!1),R=(te?p==="("?p:i:p==="-"||p==="("?"":p)+R,B=(C==="s"?gL[8+O9/3]:"")+B+(te&&p==="("?")":""),A){for(F=-1,L=O.length;++F<L;)if(H=O.charCodeAt(F),48>H||H>57){B=(H===46?a+O.slice(F+1):O.slice(F))+B,O=O.slice(0,F);break}}}x&&!y&&(O=e(O,1/0));var V=R.length+O.length+B.length,Q=V<v?new Array(v-V+1).join(f):"";switch(x&&y&&(O=e(Q+O,Q.length?v-B.length:1/0),Q=""),h){case"<":O=R+O+B+Q;break;case"=":O=R+Q+O+B;break;case"^":O=Q.slice(0,V=Q.length>>1)+R+O+B+Q.slice(V);break;default:O=Q+R+O+B;break}return s(O)}return P.toString=function(){return d+""},P}function c(d,f){var h=u((d=Ey(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(oh(f)/3)))*3,g=Math.pow(10,-p),y=gL[8+p/3];return function(v){return h(g*v)+y}}return{format:u,formatPrefix:c}}var w0,GO,R9;Oet({thousands:",",grouping:[3],currency:["$",""]});function Oet(t){return w0=Pet(t),GO=w0.format,R9=w0.formatPrefix,w0}function Ret(t){return Math.max(0,-oh(Math.abs(t)))}function Det(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(oh(e)/3)))*3-oh(Math.abs(t)))}function jet(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,oh(e)-oh(t))+1}function D9(t,e,n,r){var a=bI(t,e,n),s;switch(r=Ey(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Det(a,o))&&(r.precision=s),R9(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=jet(a,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Ret(a))&&(r.precision=s-(r.type==="%")*2);break}}return GO(r)}function wu(t){var e=t.domain;return t.ticks=function(n){var r=e();return vI(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var a=e();return D9(a[0],a[a.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),a=0,s=r.length-1,o=r[a],i=r[s],l,u,c=10;for(i<o&&(u=o,o=i,i=u,u=a,a=s,s=u);c-- >0;){if(u=xI(o,i,n),u===l)return r[a]=o,r[s]=i,e(r);if(u>0)o=Math.floor(o/u)*u,i=Math.ceil(i/u)*u;else if(u<0)o=Math.ceil(o*u)/u,i=Math.floor(i*u)/u;else break;l=u}return t},t}function x1(){var t=VO();return t.copy=function(){return db(t,x1())},oo.apply(t,arguments),wu(t)}function j9(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,y1),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return j9(t).unknown(e)},t=arguments.length?Array.from(t,y1):[0,1],wu(n)}function M9(t,e){t=t.slice();var n=0,r=t.length-1,a=t[n],s=t[r],o;return s<a&&(o=n,n=r,r=o,o=a,a=s,s=o),t[n]=e.floor(a),t[r]=e.ceil(s),t}function yL(t){return Math.log(t)}function vL(t){return Math.exp(t)}function Met(t){return-Math.log(-t)}function Fet(t){return-Math.exp(-t)}function Let(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Bet(t){return t===10?Let:t===Math.E?Math.exp:e=>Math.pow(t,e)}function zet(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function xL(t){return(e,n)=>-t(-e,n)}function HO(t){const e=t(yL,vL),n=e.domain;let r=10,a,s;function o(){return a=zet(r),s=Bet(r),n()[0]<0?(a=xL(a),s=xL(s),t(Met,Fet)):t(yL,vL),e}return e.base=function(i){return arguments.length?(r=+i,o()):r},e.domain=function(i){return arguments.length?(n(i),o()):n()},e.ticks=i=>{const l=n();let u=l[0],c=l[l.length-1];const d=c<u;d&&([u,c]=[c,u]);let f=a(u),h=a(c),p,g;const y=i==null?10:+i;let v=[];if(!(r%1)&&h-f<y){if(f=Math.floor(f),h=Math.ceil(h),u>0){for(;f<=h;++f)for(p=1;p<r;++p)if(g=f<0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;v.push(g)}}else for(;f<=h;++f)for(p=r-1;p>=1;--p)if(g=f>0?p/s(-f):p*s(f),!(g<u)){if(g>c)break;v.push(g)}v.length*2<y&&(v=vI(u,c,y))}else v=vI(f,h,Math.min(h-f,y)).map(s);return d?v.reverse():v},e.tickFormat=(i,l)=>{if(i==null&&(i=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=Ey(l)).precision==null&&(l.trim=!0),l=GO(l)),i===1/0)return l;const u=Math.max(1,r*i/e.ticks().length);return c=>{let d=c/s(Math.round(a(c)));return d*r<r-.5&&(d*=r),d<=u?l(c):""}},e.nice=()=>n(M9(n(),{floor:i=>s(Math.floor(a(i))),ceil:i=>s(Math.ceil(a(i)))})),e}function F9(){const t=HO(fC()).domain([1,10]);return t.copy=()=>db(t,F9()).base(t.base()),oo.apply(t,arguments),t}function bL(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function wL(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function qO(t){var e=1,n=t(bL(e),wL(e));return n.constant=function(r){return arguments.length?t(bL(e=+r),wL(e)):e},wu(n)}function L9(){var t=qO(fC());return t.copy=function(){return db(t,L9()).constant(t.constant())},oo.apply(t,arguments)}function SL(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Uet(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Vet(t){return t<0?-t*t:t*t}function KO(t){var e=t($a,$a),n=1;function r(){return n===1?t($a,$a):n===.5?t(Uet,Vet):t(SL(n),SL(1/n))}return e.exponent=function(a){return arguments.length?(n=+a,r()):n},wu(e)}function XO(){var t=KO(fC());return t.copy=function(){return db(t,XO()).exponent(t.exponent())},oo.apply(t,arguments),t}function Wet(){return XO.apply(null,arguments).exponent(.5)}function CL(t){return Math.sign(t)*t*t}function Get(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function B9(){var t=VO(),e=[0,1],n=!1,r;function a(s){var o=Get(t(s));return isNaN(o)?r:n?Math.round(o):o}return a.invert=function(s){return t.invert(CL(s))},a.domain=function(s){return arguments.length?(t.domain(s),a):t.domain()},a.range=function(s){return arguments.length?(t.range((e=Array.from(s,y1)).map(CL)),a):e.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(n=!!s,a):n},a.clamp=function(s){return arguments.length?(t.clamp(s),a):t.clamp()},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return B9(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},oo.apply(a,arguments),wu(a)}function z9(){var t=[],e=[],n=[],r;function a(){var o=0,i=Math.max(1,e.length);for(n=new Array(i-1);++o<i;)n[o-1]=KZe(t,o/i);return s}function s(o){return o==null||isNaN(o=+o)?r:e[ub(n,o)]}return s.invertExtent=function(o){var i=e.indexOf(o);return i<0?[NaN,NaN]:[i>0?n[i-1]:t[0],i<n.length?n[i]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let i of o)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Kl),a()},s.range=function(o){return arguments.length?(e=Array.from(o),a()):e.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return z9().domain(t).range(e).unknown(r)},oo.apply(s,arguments)}function U9(){var t=0,e=1,n=1,r=[.5],a=[0,1],s;function o(l){return l!=null&&l<=l?a[ub(r,l,0,n)]:s}function i(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return o}return o.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,i()):[t,e]},o.range=function(l){return arguments.length?(n=(a=Array.from(l)).length-1,i()):a.slice()},o.invertExtent=function(l){var u=a.indexOf(l);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},o.unknown=function(l){return arguments.length&&(s=l),o},o.thresholds=function(){return r.slice()},o.copy=function(){return U9().domain([t,e]).range(a).unknown(s)},oo.apply(wu(o),arguments)}function V9(){var t=[.5],e=[0,1],n,r=1;function a(s){return s!=null&&s<=s?e[ub(t,s,0,r)]:n}return a.domain=function(s){return arguments.length?(t=Array.from(s),r=Math.min(t.length,e.length-1),a):t.slice()},a.range=function(s){return arguments.length?(e=Array.from(s),r=Math.min(t.length,e.length-1),a):e.slice()},a.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return V9().domain(t).range(e).unknown(n)},oo.apply(a,arguments)}const w$=new Date,S$=new Date;function kr(t,e,n,r){function a(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(t(s=new Date(+s)),s),a.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),a.round=s=>{const o=a(s),i=a.ceil(s);return s-o<i-s?o:i},a.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,i)=>{const l=[];if(s=a.ceil(s),i=i==null?1:Math.floor(i),!(s<o)||!(i>0))return l;let u;do l.push(u=new Date(+s)),e(s,i),t(s);while(u<s&&s<o);return l},a.filter=s=>kr(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,i)=>{if(o>=o)if(i<0)for(;++i<=0;)for(;e(o,-1),!s(o););else for(;--i>=0;)for(;e(o,1),!s(o););}),n&&(a.count=(s,o)=>(w$.setTime(+s),S$.setTime(+o),t(w$),t(S$),Math.floor(n(w$,S$))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(r?o=>r(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const b1=kr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);b1.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?kr(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):b1);b1.range;const Pi=1e3,Ks=Pi*60,Oi=Ks*60,Ki=Oi*24,YO=Ki*7,_L=Ki*30,C$=Ki*365,oc=kr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Pi)},(t,e)=>(e-t)/Pi,t=>t.getUTCSeconds());oc.range;const QO=kr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pi)},(t,e)=>{t.setTime(+t+e*Ks)},(t,e)=>(e-t)/Ks,t=>t.getMinutes());QO.range;const JO=kr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ks)},(t,e)=>(e-t)/Ks,t=>t.getUTCMinutes());JO.range;const ZO=kr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Pi-t.getMinutes()*Ks)},(t,e)=>{t.setTime(+t+e*Oi)},(t,e)=>(e-t)/Oi,t=>t.getHours());ZO.range;const eR=kr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Oi)},(t,e)=>(e-t)/Oi,t=>t.getUTCHours());eR.range;const fb=kr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ks)/Ki,t=>t.getDate()-1);fb.range;const hC=kr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ki,t=>t.getUTCDate()-1);hC.range;const W9=kr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ki,t=>Math.floor(t/Ki));W9.range;function gd(t){return kr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ks)/YO)}const pC=gd(0),w1=gd(1),Het=gd(2),qet=gd(3),ih=gd(4),Ket=gd(5),Xet=gd(6);pC.range;w1.range;Het.range;qet.range;ih.range;Ket.range;Xet.range;function yd(t){return kr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/YO)}const mC=yd(0),S1=yd(1),Yet=yd(2),Qet=yd(3),lh=yd(4),Jet=yd(5),Zet=yd(6);mC.range;S1.range;Yet.range;Qet.range;lh.range;Jet.range;Zet.range;const tR=kr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());tR.range;const nR=kr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());nR.range;const Xi=kr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Xi.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:kr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Xi.range;const Yi=kr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Yi.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:kr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Yi.range;function G9(t,e,n,r,a,s){const o=[[oc,1,Pi],[oc,5,5*Pi],[oc,15,15*Pi],[oc,30,30*Pi],[s,1,Ks],[s,5,5*Ks],[s,15,15*Ks],[s,30,30*Ks],[a,1,Oi],[a,3,3*Oi],[a,6,6*Oi],[a,12,12*Oi],[r,1,Ki],[r,2,2*Ki],[n,1,YO],[e,1,_L],[e,3,3*_L],[t,1,C$]];function i(u,c,d){const f=c<u;f&&([u,c]=[c,u]);const h=d&&typeof d.range=="function"?d:l(u,c,d),p=h?h.range(u,+c+1):[];return f?p.reverse():p}function l(u,c,d){const f=Math.abs(c-u)/d,h=FO(([,,y])=>y).right(o,f);if(h===o.length)return t.every(bI(u/C$,c/C$,d));if(h===0)return b1.every(Math.max(bI(u,c,d),1));const[p,g]=o[f/o[h-1][2]<o[h][2]/f?h-1:h];return p.every(g)}return[i,l]}const[ett,ttt]=G9(Yi,nR,mC,W9,eR,JO),[ntt,rtt]=G9(Xi,tR,pC,fb,ZO,QO);function _$(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function $$(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Mm(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function att(t){var e=t.dateTime,n=t.date,r=t.time,a=t.periods,s=t.days,o=t.shortDays,i=t.months,l=t.shortMonths,u=Fm(a),c=Lm(a),d=Fm(s),f=Lm(s),h=Fm(o),p=Lm(o),g=Fm(i),y=Lm(i),v=Fm(l),x=Lm(l),b={a:te,A:V,b:Q,B:se,c:null,d:EL,e:EL,f:Ntt,g:Mtt,G:Ltt,H:_tt,I:$tt,j:ktt,L:H9,m:Itt,M:Ttt,p:le,q:ue,Q:OL,s:RL,S:Ett,u:Att,U:Ptt,V:Ott,w:Rtt,W:Dtt,x:null,X:null,y:jtt,Y:Ftt,Z:Btt,"%":PL},w={a:ce,A:re,b:ge,B:Se,c:null,d:AL,e:AL,f:Wtt,g:ent,G:nnt,H:ztt,I:Utt,j:Vtt,L:K9,m:Gtt,M:Htt,p:Ne,q:we,Q:OL,s:RL,S:qtt,u:Ktt,U:Xtt,V:Ytt,w:Qtt,W:Jtt,x:null,X:null,y:Ztt,Y:tnt,Z:rnt,"%":PL},C={a:P,A:O,b:R,B,c:F,d:IL,e:IL,f:btt,g:NL,G:kL,H:TL,I:TL,j:gtt,L:xtt,m:mtt,M:ytt,p:A,q:ptt,Q:Stt,s:Ctt,S:vtt,u:utt,U:ctt,V:dtt,w:ltt,W:ftt,x:L,X:H,y:NL,Y:kL,Z:htt,"%":wtt};b.x=_(n,b),b.X=_(r,b),b.c=_(e,b),w.x=_(n,w),w.X=_(r,w),w.c=_(e,w);function _(de,J){return function(ae){var U=[],oe=-1,ye=0,be=de.length,he,De,Ve;for(ae instanceof Date||(ae=new Date(+ae));++oe<be;)de.charCodeAt(oe)===37&&(U.push(de.slice(ye,oe)),(De=$L[he=de.charAt(++oe)])!=null?he=de.charAt(++oe):De=he==="e"?" ":"0",(Ve=J[he])&&(he=Ve(ae,De)),U.push(he),ye=oe+1);return U.push(de.slice(ye,oe)),U.join("")}}function $(de,J){return function(ae){var U=Mm(1900,void 0,1),oe=k(U,de,ae+="",0),ye,be;if(oe!=ae.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(J&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(ye=$$(Mm(U.y,0,1)),be=ye.getUTCDay(),ye=be>4||be===0?S1.ceil(ye):S1(ye),ye=hC.offset(ye,(U.V-1)*7),U.y=ye.getUTCFullYear(),U.m=ye.getUTCMonth(),U.d=ye.getUTCDate()+(U.w+6)%7):(ye=_$(Mm(U.y,0,1)),be=ye.getDay(),ye=be>4||be===0?w1.ceil(ye):w1(ye),ye=fb.offset(ye,(U.V-1)*7),U.y=ye.getFullYear(),U.m=ye.getMonth(),U.d=ye.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),be="Z"in U?$$(Mm(U.y,0,1)).getUTCDay():_$(Mm(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(be+5)%7:U.w+U.U*7-(be+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,$$(U)):_$(U)}}function k(de,J,ae,U){for(var oe=0,ye=J.length,be=ae.length,he,De;oe<ye;){if(U>=be)return-1;if(he=J.charCodeAt(oe++),he===37){if(he=J.charAt(oe++),De=C[he in $L?J.charAt(oe++):he],!De||(U=De(de,ae,U))<0)return-1}else if(he!=ae.charCodeAt(U++))return-1}return U}function A(de,J,ae){var U=u.exec(J.slice(ae));return U?(de.p=c.get(U[0].toLowerCase()),ae+U[0].length):-1}function P(de,J,ae){var U=h.exec(J.slice(ae));return U?(de.w=p.get(U[0].toLowerCase()),ae+U[0].length):-1}function O(de,J,ae){var U=d.exec(J.slice(ae));return U?(de.w=f.get(U[0].toLowerCase()),ae+U[0].length):-1}function R(de,J,ae){var U=v.exec(J.slice(ae));return U?(de.m=x.get(U[0].toLowerCase()),ae+U[0].length):-1}function B(de,J,ae){var U=g.exec(J.slice(ae));return U?(de.m=y.get(U[0].toLowerCase()),ae+U[0].length):-1}function F(de,J,ae){return k(de,e,J,ae)}function L(de,J,ae){return k(de,n,J,ae)}function H(de,J,ae){return k(de,r,J,ae)}function te(de){return o[de.getDay()]}function V(de){return s[de.getDay()]}function Q(de){return l[de.getMonth()]}function se(de){return i[de.getMonth()]}function le(de){return a[+(de.getHours()>=12)]}function ue(de){return 1+~~(de.getMonth()/3)}function ce(de){return o[de.getUTCDay()]}function re(de){return s[de.getUTCDay()]}function ge(de){return l[de.getUTCMonth()]}function Se(de){return i[de.getUTCMonth()]}function Ne(de){return a[+(de.getUTCHours()>=12)]}function we(de){return 1+~~(de.getUTCMonth()/3)}return{format:function(de){var J=_(de+="",b);return J.toString=function(){return de},J},parse:function(de){var J=$(de+="",!1);return J.toString=function(){return de},J},utcFormat:function(de){var J=_(de+="",w);return J.toString=function(){return de},J},utcParse:function(de){var J=$(de+="",!0);return J.toString=function(){return de},J}}}var $L={"-":"",_:" ",0:"0"},Br=/^\s*\d+/,stt=/^%/,ott=/[\\^$*+?|[\]().{}]/g;function Xt(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",s=a.length;return r+(s<n?new Array(n-s+1).join(e)+a:a)}function itt(t){return t.replace(ott,"\\$&")}function Fm(t){return new RegExp("^(?:"+t.map(itt).join("|")+")","i")}function Lm(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function ltt(t,e,n){var r=Br.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function utt(t,e,n){var r=Br.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function ctt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function dtt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function ftt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function kL(t,e,n){var r=Br.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function NL(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function htt(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function ptt(t,e,n){var r=Br.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function mtt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function IL(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function gtt(t,e,n){var r=Br.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function TL(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function ytt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function vtt(t,e,n){var r=Br.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function xtt(t,e,n){var r=Br.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function btt(t,e,n){var r=Br.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function wtt(t,e,n){var r=stt.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Stt(t,e,n){var r=Br.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Ctt(t,e,n){var r=Br.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function EL(t,e){return Xt(t.getDate(),e,2)}function _tt(t,e){return Xt(t.getHours(),e,2)}function $tt(t,e){return Xt(t.getHours()%12||12,e,2)}function ktt(t,e){return Xt(1+fb.count(Xi(t),t),e,3)}function H9(t,e){return Xt(t.getMilliseconds(),e,3)}function Ntt(t,e){return H9(t,e)+"000"}function Itt(t,e){return Xt(t.getMonth()+1,e,2)}function Ttt(t,e){return Xt(t.getMinutes(),e,2)}function Ett(t,e){return Xt(t.getSeconds(),e,2)}function Att(t){var e=t.getDay();return e===0?7:e}function Ptt(t,e){return Xt(pC.count(Xi(t)-1,t),e,2)}function q9(t){var e=t.getDay();return e>=4||e===0?ih(t):ih.ceil(t)}function Ott(t,e){return t=q9(t),Xt(ih.count(Xi(t),t)+(Xi(t).getDay()===4),e,2)}function Rtt(t){return t.getDay()}function Dtt(t,e){return Xt(w1.count(Xi(t)-1,t),e,2)}function jtt(t,e){return Xt(t.getFullYear()%100,e,2)}function Mtt(t,e){return t=q9(t),Xt(t.getFullYear()%100,e,2)}function Ftt(t,e){return Xt(t.getFullYear()%1e4,e,4)}function Ltt(t,e){var n=t.getDay();return t=n>=4||n===0?ih(t):ih.ceil(t),Xt(t.getFullYear()%1e4,e,4)}function Btt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Xt(e/60|0,"0",2)+Xt(e%60,"0",2)}function AL(t,e){return Xt(t.getUTCDate(),e,2)}function ztt(t,e){return Xt(t.getUTCHours(),e,2)}function Utt(t,e){return Xt(t.getUTCHours()%12||12,e,2)}function Vtt(t,e){return Xt(1+hC.count(Yi(t),t),e,3)}function K9(t,e){return Xt(t.getUTCMilliseconds(),e,3)}function Wtt(t,e){return K9(t,e)+"000"}function Gtt(t,e){return Xt(t.getUTCMonth()+1,e,2)}function Htt(t,e){return Xt(t.getUTCMinutes(),e,2)}function qtt(t,e){return Xt(t.getUTCSeconds(),e,2)}function Ktt(t){var e=t.getUTCDay();return e===0?7:e}function Xtt(t,e){return Xt(mC.count(Yi(t)-1,t),e,2)}function X9(t){var e=t.getUTCDay();return e>=4||e===0?lh(t):lh.ceil(t)}function Ytt(t,e){return t=X9(t),Xt(lh.count(Yi(t),t)+(Yi(t).getUTCDay()===4),e,2)}function Qtt(t){return t.getUTCDay()}function Jtt(t,e){return Xt(S1.count(Yi(t)-1,t),e,2)}function Ztt(t,e){return Xt(t.getUTCFullYear()%100,e,2)}function ent(t,e){return t=X9(t),Xt(t.getUTCFullYear()%100,e,2)}function tnt(t,e){return Xt(t.getUTCFullYear()%1e4,e,4)}function nnt(t,e){var n=t.getUTCDay();return t=n>=4||n===0?lh(t):lh.ceil(t),Xt(t.getUTCFullYear()%1e4,e,4)}function rnt(){return"+0000"}function PL(){return"%"}function OL(t){return+t}function RL(t){return Math.floor(+t/1e3)}var Wd,Y9,Q9;ant({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function ant(t){return Wd=att(t),Y9=Wd.format,Wd.parse,Q9=Wd.utcFormat,Wd.utcParse,Wd}function snt(t){return new Date(t)}function ont(t){return t instanceof Date?+t:+new Date(+t)}function rR(t,e,n,r,a,s,o,i,l,u){var c=VO(),d=c.invert,f=c.domain,h=u(".%L"),p=u(":%S"),g=u("%I:%M"),y=u("%I %p"),v=u("%a %d"),x=u("%b %d"),b=u("%B"),w=u("%Y");function C(_){return(l(_)<_?h:i(_)<_?p:o(_)<_?g:s(_)<_?y:r(_)<_?a(_)<_?v:x:n(_)<_?b:w)(_)}return c.invert=function(_){return new Date(d(_))},c.domain=function(_){return arguments.length?f(Array.from(_,ont)):f().map(snt)},c.ticks=function(_){var $=f();return t($[0],$[$.length-1],_??10)},c.tickFormat=function(_,$){return $==null?C:u($)},c.nice=function(_){var $=f();return(!_||typeof _.range!="function")&&(_=e($[0],$[$.length-1],_??10)),_?f(M9($,_)):c},c.copy=function(){return db(c,rR(t,e,n,r,a,s,o,i,l,u))},c}function int(){return oo.apply(rR(ntt,rtt,Xi,tR,pC,fb,ZO,QO,oc,Y9).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lnt(){return oo.apply(rR(ett,ttt,Yi,nR,mC,hC,eR,JO,oc,Q9).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function gC(){var t=0,e=1,n,r,a,s,o=$a,i=!1,l;function u(d){return d==null||isNaN(d=+d)?l:o(a===0?.5:(d=(s(d)-n)*a,i?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([t,e]=d,n=s(t=+t),r=s(e=+e),a=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(d){return arguments.length?(i=!!d,u):i},u.interpolator=function(d){return arguments.length?(o=d,u):o};function c(d){return function(f){var h,p;return arguments.length?([h,p]=f,o=d(h,p),u):[o(0),o(1)]}}return u.range=c(nm),u.rangeRound=c(UO),u.unknown=function(d){return arguments.length?(l=d,u):l},function(d){return s=d,n=d(t),r=d(e),a=n===r?0:1/(r-n),u}}function Su(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function J9(){var t=wu(gC()($a));return t.copy=function(){return Su(t,J9())},sl.apply(t,arguments)}function Z9(){var t=HO(gC()).domain([1,10]);return t.copy=function(){return Su(t,Z9()).base(t.base())},sl.apply(t,arguments)}function eY(){var t=qO(gC());return t.copy=function(){return Su(t,eY()).constant(t.constant())},sl.apply(t,arguments)}function aR(){var t=KO(gC());return t.copy=function(){return Su(t,aR()).exponent(t.exponent())},sl.apply(t,arguments)}function unt(){return aR.apply(null,arguments).exponent(.5)}function tY(){var t=[],e=$a;function n(r){if(r!=null&&!isNaN(r=+r))return e((ub(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let a of r)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Kl),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,a)=>e(a/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,s)=>qZe(t,s/r))},n.copy=function(){return tY(e).domain(t)},sl.apply(n,arguments)}function yC(){var t=0,e=.5,n=1,r=1,a,s,o,i,l,u=$a,c,d=!1,f;function h(g){return isNaN(g=+g)?f:(g=.5+((g=+c(g))-s)*(r*g<r*s?i:l),u(d?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([t,e,n]=g,a=c(t=+t),s=c(e=+e),o=c(n=+n),i=a===s?0:.5/(s-a),l=s===o?0:.5/(o-s),r=s<a?-1:1,h):[t,e,n]},h.clamp=function(g){return arguments.length?(d=!!g,h):d},h.interpolator=function(g){return arguments.length?(u=g,h):u};function p(g){return function(y){var v,x,b;return arguments.length?([v,x,b]=y,u=bet(g,[v,x,b]),h):[u(0),u(.5),u(1)]}}return h.range=p(nm),h.rangeRound=p(UO),h.unknown=function(g){return arguments.length?(f=g,h):f},function(g){return c=g,a=g(t),s=g(e),o=g(n),i=a===s?0:.5/(s-a),l=s===o?0:.5/(o-s),r=s<a?-1:1,h}}function nY(){var t=wu(yC()($a));return t.copy=function(){return Su(t,nY())},sl.apply(t,arguments)}function rY(){var t=HO(yC()).domain([.1,1,10]);return t.copy=function(){return Su(t,rY()).base(t.base())},sl.apply(t,arguments)}function aY(){var t=qO(yC());return t.copy=function(){return Su(t,aY()).constant(t.constant())},sl.apply(t,arguments)}function sR(){var t=KO(yC());return t.copy=function(){return Su(t,sR()).exponent(t.exponent())},sl.apply(t,arguments)}function cnt(){return sR.apply(null,arguments).exponent(.5)}const DL=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ky,scaleDiverging:nY,scaleDivergingLog:rY,scaleDivergingPow:sR,scaleDivergingSqrt:cnt,scaleDivergingSymlog:aY,scaleIdentity:j9,scaleImplicit:wI,scaleLinear:x1,scaleLog:F9,scaleOrdinal:LO,scalePoint:Sg,scalePow:XO,scaleQuantile:z9,scaleQuantize:U9,scaleRadial:B9,scaleSequential:J9,scaleSequentialLog:Z9,scaleSequentialPow:aR,scaleSequentialQuantile:tY,scaleSequentialSqrt:unt,scaleSequentialSymlog:eY,scaleSqrt:Wet,scaleSymlog:L9,scaleThreshold:V9,scaleTime:int,scaleUtc:lnt,tickFormat:D9},Symbol.toStringTag,{value:"Module"}));var dnt=Gp;function fnt(t,e,n){for(var r=-1,a=t.length;++r<a;){var s=t[r],o=e(s);if(o!=null&&(i===void 0?o===o&&!dnt(o):n(o,i)))var i=o,l=s}return l}var vC=fnt;function hnt(t,e){return t>e}var sY=hnt,pnt=vC,mnt=sY,gnt=tm;function ynt(t){return t&&t.length?pnt(t,gnt,mnt):void 0}var vnt=ynt;const xC=Ut(vnt);function xnt(t,e){return t<e}var oY=xnt,bnt=vC,wnt=oY,Snt=tm;function Cnt(t){return t&&t.length?bnt(t,Snt,wnt):void 0}var _nt=Cnt;const bC=Ut(_nt);var $nt=eO,knt=bu,Nnt=p9,Int=as;function Tnt(t,e){var n=Int(t)?$nt:Nnt;return n(t,knt(e))}var Ent=Tnt,Ant=f9,Pnt=Ent;function Ont(t,e){return Ant(Pnt(t,e),1)}var Rnt=Ont;const Dnt=Ut(Rnt);var jnt=RO;function Mnt(t,e){return jnt(t,e)}var Fnt=Mnt;const hb=Ut(Fnt);var rm=1e9,Lnt={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},iR,Gn=!0,no="[DecimalError] ",bc=no+"Invalid argument: ",oR=no+"Exponent out of range: ",am=Math.floor,Wu=Math.pow,Bnt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fs,Ar=1e7,Ln=7,iY=9007199254740991,C1=am(iY/Ln),Ge={};Ge.absoluteValue=Ge.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Ge.comparedTo=Ge.cmp=function(t){var e,n,r,a,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,a=t.d.length,e=0,n=r<a?r:a;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===a?0:r>a^s.s<0?1:-1};Ge.decimalPlaces=Ge.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Ln;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};Ge.dividedBy=Ge.div=function(t){return Bi(this,new this.constructor(t))};Ge.dividedToIntegerBy=Ge.idiv=function(t){var e=this,n=e.constructor;return _n(Bi(e,new n(t),0,1),n.precision)};Ge.equals=Ge.eq=function(t){return!this.cmp(t)};Ge.exponent=function(){return hr(this)};Ge.greaterThan=Ge.gt=function(t){return this.cmp(t)>0};Ge.greaterThanOrEqualTo=Ge.gte=function(t){return this.cmp(t)>=0};Ge.isInteger=Ge.isint=function(){return this.e>this.d.length-2};Ge.isNegative=Ge.isneg=function(){return this.s<0};Ge.isPositive=Ge.ispos=function(){return this.s>0};Ge.isZero=function(){return this.s===0};Ge.lessThan=Ge.lt=function(t){return this.cmp(t)<0};Ge.lessThanOrEqualTo=Ge.lte=function(t){return this.cmp(t)<1};Ge.logarithm=Ge.log=function(t){var e,n=this,r=n.constructor,a=r.precision,s=a+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(fs))throw Error(no+"NaN");if(n.s<1)throw Error(no+(n.s?"NaN":"-Infinity"));return n.eq(fs)?new r(0):(Gn=!1,e=Bi(Ay(n,s),Ay(t,s),s),Gn=!0,_n(e,a))};Ge.minus=Ge.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?cY(e,t):lY(e,(t.s=-t.s,t))};Ge.modulo=Ge.mod=function(t){var e,n=this,r=n.constructor,a=r.precision;if(t=new r(t),!t.s)throw Error(no+"NaN");return n.s?(Gn=!1,e=Bi(n,t,0,1).times(t),Gn=!0,n.minus(e)):_n(new r(n),a)};Ge.naturalExponential=Ge.exp=function(){return uY(this)};Ge.naturalLogarithm=Ge.ln=function(){return Ay(this)};Ge.negated=Ge.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Ge.plus=Ge.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?lY(e,t):cY(e,(t.s=-t.s,t))};Ge.precision=Ge.sd=function(t){var e,n,r,a=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(bc+t);if(e=hr(a)+1,r=a.d.length-1,n=r*Ln+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};Ge.squareRoot=Ge.sqrt=function(){var t,e,n,r,a,s,o,i=this,l=i.constructor;if(i.s<1){if(!i.s)return new l(0);throw Error(no+"NaN")}for(t=hr(i),Gn=!1,a=Math.sqrt(+i),a==0||a==1/0?(e=Yo(i.d),(e.length+t)%2==0&&(e+="0"),a=Math.sqrt(e),t=am((t+1)/2)-(t<0||t%2),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(a.toString()),n=l.precision,a=o=n+3;;)if(s=r,r=s.plus(Bi(i,s,o+2)).times(.5),Yo(s.d).slice(0,o)===(e=Yo(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),a==o&&e=="4999"){if(_n(s,n+1,0),s.times(s).eq(i)){r=s;break}}else if(e!="9999")break;o+=4}return Gn=!0,_n(r,n)};Ge.times=Ge.mul=function(t){var e,n,r,a,s,o,i,l,u,c=this,d=c.constructor,f=c.d,h=(t=new d(t)).d;if(!c.s||!t.s)return new d(0);for(t.s*=c.s,n=c.e+t.e,l=f.length,u=h.length,l<u&&(s=f,f=h,h=s,o=l,l=u,u=o),s=[],o=l+u,r=o;r--;)s.push(0);for(r=u;--r>=0;){for(e=0,a=l+r;a>r;)i=s[a]+h[r]*f[a-r-1]+e,s[a--]=i%Ar|0,e=i/Ar|0;s[a]=(s[a]+e)%Ar|0}for(;!s[--o];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,Gn?_n(t,d.precision):t};Ge.toDecimalPlaces=Ge.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(pi(t,0,rm),e===void 0?e=r.rounding:pi(e,0,8),_n(n,t+hr(n)+1,e))};Ge.toExponential=function(t,e){var n,r=this,a=r.constructor;return t===void 0?n=qc(r,!0):(pi(t,0,rm),e===void 0?e=a.rounding:pi(e,0,8),r=_n(new a(r),t+1,e),n=qc(r,!0,t+1)),n};Ge.toFixed=function(t,e){var n,r,a=this,s=a.constructor;return t===void 0?qc(a):(pi(t,0,rm),e===void 0?e=s.rounding:pi(e,0,8),r=_n(new s(a),t+hr(a)+1,e),n=qc(r.abs(),!1,t+hr(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)};Ge.toInteger=Ge.toint=function(){var t=this,e=t.constructor;return _n(new e(t),hr(t)+1,e.rounding)};Ge.toNumber=function(){return+this};Ge.toPower=Ge.pow=function(t){var e,n,r,a,s,o,i=this,l=i.constructor,u=12,c=+(t=new l(t));if(!t.s)return new l(fs);if(i=new l(i),!i.s){if(t.s<1)throw Error(no+"Infinity");return i}if(i.eq(fs))return i;if(r=l.precision,t.eq(fs))return _n(i,r);if(e=t.e,n=t.d.length-1,o=e>=n,s=i.s,o){if((n=c<0?-c:c)<=iY){for(a=new l(fs),e=Math.ceil(r/Ln+4),Gn=!1;n%2&&(a=a.times(i),ML(a.d,e)),n=am(n/2),n!==0;)i=i.times(i),ML(i.d,e);return Gn=!0,t.s<0?new l(fs).div(a):_n(a,r)}}else if(s<0)throw Error(no+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,i.s=1,Gn=!1,a=t.times(Ay(i,r+u)),Gn=!0,a=uY(a),a.s=s,a};Ge.toPrecision=function(t,e){var n,r,a=this,s=a.constructor;return t===void 0?(n=hr(a),r=qc(a,n<=s.toExpNeg||n>=s.toExpPos)):(pi(t,1,rm),e===void 0?e=s.rounding:pi(e,0,8),a=_n(new s(a),t,e),n=hr(a),r=qc(a,t<=n||n<=s.toExpNeg,t)),r};Ge.toSignificantDigits=Ge.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(pi(t,1,rm),e===void 0?e=r.rounding:pi(e,0,8)),_n(new r(n),t,e)};Ge.toString=Ge.valueOf=Ge.val=Ge.toJSON=Ge[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=hr(t),n=t.constructor;return qc(t,e<=n.toExpNeg||e>=n.toExpPos)};function lY(t,e){var n,r,a,s,o,i,l,u,c=t.constructor,d=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),Gn?_n(e,d):e;if(l=t.d,u=e.d,o=t.e,a=e.e,l=l.slice(),s=o-a,s){for(s<0?(r=l,s=-s,i=u.length):(r=u,a=o,i=l.length),o=Math.ceil(d/Ln),i=o>i?o+1:i+1,s>i&&(s=i,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(i=l.length,s=u.length,i-s<0&&(s=i,r=u,u=l,l=r),n=0;s;)n=(l[--s]=l[s]+u[s]+n)/Ar|0,l[s]%=Ar;for(n&&(l.unshift(n),++a),i=l.length;l[--i]==0;)l.pop();return e.d=l,e.e=a,Gn?_n(e,d):e}function pi(t,e,n){if(t!==~~t||t<e||t>n)throw Error(bc+t)}function Yo(t){var e,n,r,a=t.length-1,s="",o=t[0];if(a>0){for(s+=o,e=1;e<a;e++)r=t[e]+"",n=Ln-r.length,n&&(s+=bl(n)),s+=r;o=t[e],r=o+"",n=Ln-r.length,n&&(s+=bl(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Bi=function(){function t(r,a){var s,o=0,i=r.length;for(r=r.slice();i--;)s=r[i]*a+o,r[i]=s%Ar|0,o=s/Ar|0;return o&&r.unshift(o),r}function e(r,a,s,o){var i,l;if(s!=o)l=s>o?1:-1;else for(i=l=0;i<s;i++)if(r[i]!=a[i]){l=r[i]>a[i]?1:-1;break}return l}function n(r,a,s){for(var o=0;s--;)r[s]-=o,o=r[s]<a[s]?1:0,r[s]=o*Ar+r[s]-a[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,s,o){var i,l,u,c,d,f,h,p,g,y,v,x,b,w,C,_,$,k,A=r.constructor,P=r.s==a.s?1:-1,O=r.d,R=a.d;if(!r.s)return new A(r);if(!a.s)throw Error(no+"Division by zero");for(l=r.e-a.e,$=R.length,C=O.length,h=new A(P),p=h.d=[],u=0;R[u]==(O[u]||0);)++u;if(R[u]>(O[u]||0)&&--l,s==null?x=s=A.precision:o?x=s+(hr(r)-hr(a))+1:x=s,x<0)return new A(0);if(x=x/Ln+2|0,u=0,$==1)for(c=0,R=R[0],x++;(u<C||c)&&x--;u++)b=c*Ar+(O[u]||0),p[u]=b/R|0,c=b%R|0;else{for(c=Ar/(R[0]+1)|0,c>1&&(R=t(R,c),O=t(O,c),$=R.length,C=O.length),w=$,g=O.slice(0,$),y=g.length;y<$;)g[y++]=0;k=R.slice(),k.unshift(0),_=R[0],R[1]>=Ar/2&&++_;do c=0,i=e(R,g,$,y),i<0?(v=g[0],$!=y&&(v=v*Ar+(g[1]||0)),c=v/_|0,c>1?(c>=Ar&&(c=Ar-1),d=t(R,c),f=d.length,y=g.length,i=e(d,g,f,y),i==1&&(c--,n(d,$<f?k:R,f))):(c==0&&(i=c=1),d=R.slice()),f=d.length,f<y&&d.unshift(0),n(g,d,y),i==-1&&(y=g.length,i=e(R,g,$,y),i<1&&(c++,n(g,$<y?k:R,y))),y=g.length):i===0&&(c++,g=[0]),p[u++]=c,i&&g[0]?g[y++]=O[w]||0:(g=[O[w]],y=1);while((w++<C||g[0]!==void 0)&&x--)}return p[0]||p.shift(),h.e=l,_n(h,o?s+hr(h)+1:s)}}();function uY(t,e){var n,r,a,s,o,i,l=0,u=0,c=t.constructor,d=c.precision;if(hr(t)>16)throw Error(oR+hr(t));if(!t.s)return new c(fs);for(e==null?(Gn=!1,i=d):i=e,o=new c(.03125);t.abs().gte(.1);)t=t.times(o),u+=5;for(r=Math.log(Wu(2,u))/Math.LN10*2+5|0,i+=r,n=a=s=new c(fs),c.precision=i;;){if(a=_n(a.times(t),i),n=n.times(++l),o=s.plus(Bi(a,n,i)),Yo(o.d).slice(0,i)===Yo(s.d).slice(0,i)){for(;u--;)s=_n(s.times(s),i);return c.precision=d,e==null?(Gn=!0,_n(s,d)):s}s=o}}function hr(t){for(var e=t.e*Ln,n=t.d[0];n>=10;n/=10)e++;return e}function k$(t,e,n){if(e>t.LN10.sd())throw Gn=!0,n&&(t.precision=n),Error(no+"LN10 precision limit exceeded");return _n(new t(t.LN10),e)}function bl(t){for(var e="";t--;)e+="0";return e}function Ay(t,e){var n,r,a,s,o,i,l,u,c,d=1,f=10,h=t,p=h.d,g=h.constructor,y=g.precision;if(h.s<1)throw Error(no+(h.s?"NaN":"-Infinity"));if(h.eq(fs))return new g(0);if(e==null?(Gn=!1,u=y):u=e,h.eq(10))return e==null&&(Gn=!0),k$(g,u);if(u+=f,g.precision=u,n=Yo(p),r=n.charAt(0),s=hr(h),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(t),n=Yo(h.d),r=n.charAt(0),d++;s=hr(h),r>1?(h=new g("0."+n),s++):h=new g(r+"."+n.slice(1))}else return l=k$(g,u+2,y).times(s+""),h=Ay(new g(r+"."+n.slice(1)),u-f).plus(l),g.precision=y,e==null?(Gn=!0,_n(h,y)):h;for(i=o=h=Bi(h.minus(fs),h.plus(fs),u),c=_n(h.times(h),u),a=3;;){if(o=_n(o.times(c),u),l=i.plus(Bi(o,new g(a),u)),Yo(l.d).slice(0,u)===Yo(i.d).slice(0,u))return i=i.times(2),s!==0&&(i=i.plus(k$(g,u+2,y).times(s+""))),i=Bi(i,new g(d),u),g.precision=y,e==null?(Gn=!0,_n(i,y)):i;i=l,a+=2}}function jL(t,e){var n,r,a;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(a=e.length;e.charCodeAt(a-1)===48;)--a;if(e=e.slice(r,a),e){if(a-=r,n=n-r-1,t.e=am(n/Ln),t.d=[],r=(n+1)%Ln,n<0&&(r+=Ln),r<a){for(r&&t.d.push(+e.slice(0,r)),a-=Ln;r<a;)t.d.push(+e.slice(r,r+=Ln));e=e.slice(r),r=Ln-e.length}else r-=a;for(;r--;)e+="0";if(t.d.push(+e),Gn&&(t.e>C1||t.e<-C1))throw Error(oR+n)}else t.s=0,t.e=0,t.d=[0];return t}function _n(t,e,n){var r,a,s,o,i,l,u,c,d=t.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=e-o,r<0)r+=Ln,a=e,u=d[c=0];else{if(c=Math.ceil((r+1)/Ln),s=d.length,c>=s)return t;for(u=s=d[c],o=1;s>=10;s/=10)o++;r%=Ln,a=r-Ln+o}if(n!==void 0&&(s=Wu(10,o-a-1),i=u/s%10|0,l=e<0||d[c+1]!==void 0||u%s,l=n<4?(i||l)&&(n==0||n==(t.s<0?3:2)):i>5||i==5&&(n==4||l||n==6&&(r>0?a>0?u/Wu(10,o-a):0:d[c-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return l?(s=hr(t),d.length=1,e=e-s-1,d[0]=Wu(10,(Ln-e%Ln)%Ln),t.e=am(-e/Ln)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=c,s=1,c--):(d.length=c+1,s=Wu(10,Ln-r),d[c]=a>0?(u/Wu(10,o-a)%Wu(10,a)|0)*s:0),l)for(;;)if(c==0){(d[0]+=s)==Ar&&(d[0]=1,++t.e);break}else{if(d[c]+=s,d[c]!=Ar)break;d[c--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(Gn&&(t.e>C1||t.e<-C1))throw Error(oR+hr(t));return t}function cY(t,e){var n,r,a,s,o,i,l,u,c,d,f=t.constructor,h=f.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new f(t),Gn?_n(e,h):e;if(l=t.d,d=e.d,r=e.e,u=t.e,l=l.slice(),o=u-r,o){for(c=o<0,c?(n=l,o=-o,i=d.length):(n=d,r=u,i=l.length),a=Math.max(Math.ceil(h/Ln),i)+2,o>a&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for(a=l.length,i=d.length,c=a<i,c&&(i=a),a=0;a<i;a++)if(l[a]!=d[a]){c=l[a]<d[a];break}o=0}for(c&&(n=l,l=d,d=n,e.s=-e.s),i=l.length,a=d.length-i;a>0;--a)l[i++]=0;for(a=d.length;a>o;){if(l[--a]<d[a]){for(s=a;s&&l[--s]===0;)l[s]=Ar-1;--l[s],l[a]+=Ar}l[a]-=d[a]}for(;l[--i]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,Gn?_n(e,h):e):new f(0)}function qc(t,e,n){var r,a=hr(t),s=Yo(t.d),o=s.length;return e?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+bl(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+bl(-a-1)+s,n&&(r=n-o)>0&&(s+=bl(r))):a>=o?(s+=bl(a+1-o),n&&(r=n-a-1)>0&&(s=s+"."+bl(r))):((r=a+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(a+1===o&&(s+="."),s+=bl(r))),t.s<0?"-"+s:s}function ML(t,e){if(t.length>e)return t.length=e,!0}function dY(t){var e,n,r;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(bc+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return jL(o,s.toString())}else if(typeof s!="string")throw Error(bc+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,Bnt.test(s))jL(o,s);else throw Error(bc+s)}if(a.prototype=Ge,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=dY,a.config=a.set=znt,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return a.config(t),a}function znt(t){if(!t||typeof t!="object")throw Error(no+"Object expected");var e,n,r,a=["precision",1,rm,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<a.length;e+=3)if((r=t[n=a[e]])!==void 0)if(am(r)===r&&r>=a[e+1]&&r<=a[e+2])this[n]=r;else throw Error(bc+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(bc+n+": "+r);return this}var iR=dY(Lnt);fs=new iR(1);const mn=iR;function Unt(t){return Hnt(t)||Gnt(t)||Wnt(t)||Vnt()}function Vnt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wnt(t,e){if(t){if(typeof t=="string")return $I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $I(t,e)}}function Gnt(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Hnt(t){if(Array.isArray(t))return $I(t)}function $I(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var qnt=function(e){return e},fY={"@@functional/placeholder":!0},hY=function(e){return e===fY},FL=function(e){return function n(){return arguments.length===0||arguments.length===1&&hY(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},Knt=function t(e,n){return e===1?n:FL(function(){for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];var o=a.filter(function(i){return i!==fY}).length;return o>=e?n.apply(void 0,a):t(e-o,FL(function(){for(var i=arguments.length,l=new Array(i),u=0;u<i;u++)l[u]=arguments[u];var c=a.map(function(d){return hY(d)?l.shift():d});return n.apply(void 0,Unt(c).concat(l))}))})},wC=function(e){return Knt(e.length,e)},kI=function(e,n){for(var r=[],a=e;a<n;++a)r[a-e]=a;return r},Xnt=wC(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),Ynt=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return qnt;var a=n.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce(function(i,l){return l(i)},s.apply(void 0,arguments))}},NI=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},pY=function(e){var n=null,r=null;return function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return n&&s.every(function(i,l){return i===n[l]})||(n=s,r=e.apply(void 0,s)),r}};function Qnt(t){var e;return t===0?e=1:e=Math.floor(new mn(t).abs().log(10).toNumber())+1,e}function Jnt(t,e,n){for(var r=new mn(t),a=0,s=[];r.lt(e)&&a<1e5;)s.push(r.toNumber()),r=r.add(n),a++;return s}var Znt=wC(function(t,e,n){var r=+t,a=+e;return r+n*(a-r)}),ert=wC(function(t,e,n){var r=e-+t;return r=r||1/0,(n-t)/r}),trt=wC(function(t,e,n){var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});const SC={rangeStep:Jnt,getDigitCount:Qnt,interpolateNumber:Znt,uninterpolateNumber:ert,uninterpolateTruncation:trt};function II(t){return art(t)||rrt(t)||mY(t)||nrt()}function nrt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rrt(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function art(t){if(Array.isArray(t))return TI(t)}function Py(t,e){return irt(t)||ort(t,e)||mY(t,e)||srt()}function srt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mY(t,e){if(t){if(typeof t=="string")return TI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TI(t,e)}}function TI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ort(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,a=!1,s=void 0;try{for(var o=t[Symbol.iterator](),i;!(r=(i=o.next()).done)&&(n.push(i.value),!(e&&n.length===e));r=!0);}catch(l){a=!0,s=l}finally{try{!r&&o.return!=null&&o.return()}finally{if(a)throw s}}return n}}function irt(t){if(Array.isArray(t))return t}function gY(t){var e=Py(t,2),n=e[0],r=e[1],a=n,s=r;return n>r&&(a=r,s=n),[a,s]}function yY(t,e,n){if(t.lte(0))return new mn(0);var r=SC.getDigitCount(t.toNumber()),a=new mn(10).pow(r),s=t.div(a),o=r!==1?.05:.1,i=new mn(Math.ceil(s.div(o).toNumber())).add(n).mul(o),l=i.mul(a);return e?l:new mn(Math.ceil(l))}function lrt(t,e,n){var r=1,a=new mn(t);if(!a.isint()&&n){var s=Math.abs(t);s<1?(r=new mn(10).pow(SC.getDigitCount(t)-1),a=new mn(Math.floor(a.div(r).toNumber())).mul(r)):s>1&&(a=new mn(Math.floor(t)))}else t===0?a=new mn(Math.floor((e-1)/2)):n||(a=new mn(Math.floor(t)));var o=Math.floor((e-1)/2),i=Ynt(Xnt(function(l){return a.add(new mn(l-o).mul(r)).toNumber()}),kI);return i(0,e)}function vY(t,e,n,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new mn(0),tickMin:new mn(0),tickMax:new mn(0)};var s=yY(new mn(e).sub(t).div(n-1),r,a),o;t<=0&&e>=0?o=new mn(0):(o=new mn(t).add(e).div(2),o=o.sub(new mn(o).mod(s)));var i=Math.ceil(o.sub(t).div(s).toNumber()),l=Math.ceil(new mn(e).sub(o).div(s).toNumber()),u=i+l+1;return u>n?vY(t,e,n,r,a+1):(u<n&&(l=e>0?l+(n-u):l,i=e>0?i:i+(n-u)),{step:s,tickMin:o.sub(new mn(i).mul(s)),tickMax:o.add(new mn(l).mul(s))})}function urt(t){var e=Py(t,2),n=e[0],r=e[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),i=gY([n,r]),l=Py(i,2),u=l[0],c=l[1];if(u===-1/0||c===1/0){var d=c===1/0?[u].concat(II(kI(0,a-1).map(function(){return 1/0}))):[].concat(II(kI(0,a-1).map(function(){return-1/0})),[c]);return n>r?NI(d):d}if(u===c)return lrt(u,a,s);var f=vY(u,c,o,s),h=f.step,p=f.tickMin,g=f.tickMax,y=SC.rangeStep(p,g.add(new mn(.1).mul(h)),h);return n>r?NI(y):y}function crt(t,e){var n=Py(t,2),r=n[0],a=n[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=gY([r,a]),i=Py(o,2),l=i[0],u=i[1];if(l===-1/0||u===1/0)return[r,a];if(l===u)return[l];var c=Math.max(e,2),d=yY(new mn(u).sub(l).div(c-1),s,0),f=[].concat(II(SC.rangeStep(new mn(l),new mn(u).sub(new mn(.99).mul(d)),d)),[u]);return r>a?NI(f):f}var drt=pY(urt),frt=pY(crt),hrt="Invariant failed";function Kc(t,e){throw new Error(hrt)}var prt=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function uh(t){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uh(t)}function _1(){return _1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_1.apply(this,arguments)}function mrt(t,e){return xrt(t)||vrt(t,e)||yrt(t,e)||grt()}function grt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yrt(t,e){if(t){if(typeof t=="string")return LL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LL(t,e)}}function LL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vrt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function xrt(t){if(Array.isArray(t))return t}function brt(t,e){if(t==null)return{};var n=wrt(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function wrt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Srt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Crt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wY(r.key),r)}}function _rt(t,e,n){return e&&Crt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function $rt(t,e,n){return e=$1(e),krt(t,xY()?Reflect.construct(e,n||[],$1(t).constructor):e.apply(t,n))}function krt(t,e){if(e&&(uh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nrt(t)}function Nrt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xY=function(){return!!t})()}function $1(t){return $1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$1(t)}function Irt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EI(t,e)}function EI(t,e){return EI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},EI(t,e)}function bY(t,e,n){return e=wY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wY(t){var e=Trt(t,"string");return uh(e)=="symbol"?e:e+""}function Trt(t,e){if(uh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(uh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pb=function(t){function e(){return Srt(this,e),$rt(this,e,arguments)}return Irt(e,t),_rt(e,[{key:"render",value:function(){var r=this.props,a=r.offset,s=r.layout,o=r.width,i=r.dataKey,l=r.data,u=r.dataPointFormatter,c=r.xAxis,d=r.yAxis,f=brt(r,prt),h=nt(f,!1);this.props.direction==="x"&&c.type!=="number"&&Kc();var p=l.map(function(g){var y=u(g,i),v=y.x,x=y.y,b=y.value,w=y.errorVal;if(!w)return null;var C=[],_,$;if(Array.isArray(w)){var k=mrt(w,2);_=k[0],$=k[1]}else _=$=w;if(s==="vertical"){var A=c.scale,P=x+a,O=P+o,R=P-o,B=A(b-_),F=A(b+$);C.push({x1:F,y1:O,x2:F,y2:R}),C.push({x1:B,y1:P,x2:F,y2:P}),C.push({x1:B,y1:O,x2:B,y2:R})}else if(s==="horizontal"){var L=d.scale,H=v+a,te=H-o,V=H+o,Q=L(b-_),se=L(b+$);C.push({x1:te,y1:se,x2:V,y2:se}),C.push({x1:H,y1:Q,x2:H,y2:se}),C.push({x1:te,y1:Q,x2:V,y2:Q})}return K.createElement(qt,_1({className:"recharts-errorBar",key:"bar-".concat(C.map(function(le){return"".concat(le.x1,"-").concat(le.x2,"-").concat(le.y1,"-").concat(le.y2)}))},h),C.map(function(le){return K.createElement("line",_1({},le,{key:"line-".concat(le.x1,"-").concat(le.x2,"-").concat(le.y1,"-").concat(le.y2)}))}))});return K.createElement(qt,{className:"recharts-errorBars"},p)}}])}(K.Component);bY(pb,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});bY(pb,"displayName","ErrorBar");function Oy(t){"@babel/helpers - typeof";return Oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oy(t)}function BL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Ru(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BL(Object(n),!0).forEach(function(r){Ert(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ert(t,e,n){return e=Art(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Art(t){var e=Prt(t,"string");return Oy(e)=="symbol"?e:e+""}function Prt(t,e){if(Oy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Oy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var SY=function(e){var n=e.children,r=e.formattedGraphicalItems,a=e.legendWidth,s=e.legendContent,o=cs(n,vc);if(!o)return null;var i=vc.defaultProps,l=i!==void 0?Ru(Ru({},i),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:s==="children"?u=(r||[]).reduce(function(c,d){var f=d.item,h=d.props,p=h.sectors||h.data||[];return c.concat(p.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):u=(r||[]).map(function(c){var d=c.item,f=d.type.defaultProps,h=f!==void 0?Ru(Ru({},f),d.props):{},p=h.dataKey,g=h.name,y=h.legendType,v=h.hide;return{inactive:v,dataKey:p,type:l.iconType||y||"square",color:lR(d),value:g||p,payload:h}}),Ru(Ru(Ru({},l),vc.getWithHeight(o,a)),{},{payload:u,item:o})};function Ry(t){"@babel/helpers - typeof";return Ry=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ry(t)}function zL(t){return jrt(t)||Drt(t)||Rrt(t)||Ort()}function Ort(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rrt(t,e){if(t){if(typeof t=="string")return AI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AI(t,e)}}function Drt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jrt(t){if(Array.isArray(t))return AI(t)}function AI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function UL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function tr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UL(Object(n),!0).forEach(function(r){Af(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Af(t,e,n){return e=Mrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mrt(t){var e=Frt(t,"string");return Ry(e)=="symbol"?e:e+""}function Frt(t,e){if(Ry(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ry(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wr(t,e,n){return ht(t)||ht(e)?n:Cr(e)?bs(t,e,n):vt(e)?e(t):n}function Cg(t,e,n,r){var a=Dnt(t,function(i){return wr(i,e)});if(n==="number"){var s=a.filter(function(i){return Le(i)||parseFloat(i)});return s.length?[bC(s),xC(s)]:[1/0,-1/0]}var o=r?a.filter(function(i){return!ht(i)}):a;return o.map(function(i){return Cr(i)||i instanceof Date?i:""})}var Lrt=function(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,o=-1,i=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(i<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,u=0;u<i;u++){var c=u>0?a[u-1].coordinate:a[i-1].coordinate,d=a[u].coordinate,f=u>=i-1?a[0].coordinate:a[u+1].coordinate,h=void 0;if(Ca(d-c)!==Ca(f-d)){var p=[];if(Ca(f-d)===Ca(l[1]-l[0])){h=f;var g=d+l[1]-l[0];p[0]=Math.min(g,(g+c)/2),p[1]=Math.max(g,(g+c)/2)}else{h=c;var y=f+l[1]-l[0];p[0]=Math.min(d,(y+d)/2),p[1]=Math.max(d,(y+d)/2)}var v=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>v[0]&&e<=v[1]||e>=p[0]&&e<=p[1]){o=a[u].index;break}}else{var x=Math.min(c,f),b=Math.max(c,f);if(e>(x+d)/2&&e<=(b+d)/2){o=a[u].index;break}}}else for(var w=0;w<i;w++)if(w===0&&e<=(r[w].coordinate+r[w+1].coordinate)/2||w>0&&w<i-1&&e>(r[w].coordinate+r[w-1].coordinate)/2&&e<=(r[w].coordinate+r[w+1].coordinate)/2||w===i-1&&e>(r[w].coordinate+r[w-1].coordinate)/2){o=r[w].index;break}return o},lR=function(e){var n,r=e,a=r.type.displayName,s=(n=e.type)!==null&&n!==void 0&&n.defaultProps?tr(tr({},e.type.defaultProps),e.props):e.props,o=s.stroke,i=s.fill,l;switch(a){case"Line":l=o;break;case"Area":case"Radar":l=o&&o!=="none"?o:i;break;default:l=i;break}return l},Brt=function(e){var n=e.barSize,r=e.totalSize,a=e.stackGroups,s=a===void 0?{}:a;if(!s)return{};for(var o={},i=Object.keys(s),l=0,u=i.length;l<u;l++)for(var c=s[i[l]].stackGroups,d=Object.keys(c),f=0,h=d.length;f<h;f++){var p=c[d[f]],g=p.items,y=p.cateAxisId,v=g.filter(function($){return Fi($.type).indexOf("Bar")>=0});if(v&&v.length){var x=v[0].type.defaultProps,b=x!==void 0?tr(tr({},x),v[0].props):v[0].props,w=b.barSize,C=b[y];o[C]||(o[C]=[]);var _=ht(w)?n:w;o[C].push({item:v[0],stackList:v.slice(1),barSize:ht(_)?void 0:_a(_,r,0)})}}return o},zrt=function(e){var n=e.barGap,r=e.barCategoryGap,a=e.bandSize,s=e.sizeList,o=s===void 0?[]:s,i=e.maxBarSize,l=o.length;if(l<1)return null;var u=_a(n,a,0,!0),c,d=[];if(o[0].barSize===+o[0].barSize){var f=!1,h=a/l,p=o.reduce(function(w,C){return w+C.barSize||0},0);p+=(l-1)*u,p>=a&&(p-=(l-1)*u,u=0),p>=a&&h>0&&(f=!0,h*=.9,p=l*h);var g=(a-p)/2>>0,y={offset:g-u,size:0};c=o.reduce(function(w,C){var _={item:C.item,position:{offset:y.offset+y.size+u,size:f?h:C.barSize}},$=[].concat(zL(w),[_]);return y=$[$.length-1].position,C.stackList&&C.stackList.length&&C.stackList.forEach(function(k){$.push({item:k,position:y})}),$},d)}else{var v=_a(r,a,0,!0);a-2*v-(l-1)*u<=0&&(u=0);var x=(a-2*v-(l-1)*u)/l;x>1&&(x>>=0);var b=i===+i?Math.min(x,i):x;c=o.reduce(function(w,C,_){var $=[].concat(zL(w),[{item:C.item,position:{offset:v+(x+u)*_+(x-b)/2,size:b}}]);return C.stackList&&C.stackList.length&&C.stackList.forEach(function(k){$.push({item:k,position:$[$.length-1].position})}),$},d)}return c},Urt=function(e,n,r,a){var s=r.children,o=r.width,i=r.margin,l=o-(i.left||0)-(i.right||0),u=SY({children:s,legendWidth:l});if(u){var c=a||{},d=c.width,f=c.height,h=u.align,p=u.verticalAlign,g=u.layout;if((g==="vertical"||g==="horizontal"&&p==="middle")&&h!=="center"&&Le(e[h]))return tr(tr({},e),{},Af({},h,e[h]+(d||0)));if((g==="horizontal"||g==="vertical"&&h==="center")&&p!=="middle"&&Le(e[p]))return tr(tr({},e),{},Af({},p,e[p]+(f||0)))}return e},Vrt=function(e,n,r){return ht(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},CY=function(e,n,r,a,s){var o=n.props.children,i=ws(o,pb).filter(function(u){return Vrt(a,s,u.props.direction)});if(i&&i.length){var l=i.map(function(u){return u.props.dataKey});return e.reduce(function(u,c){var d=wr(c,r);if(ht(d))return u;var f=Array.isArray(d)?[bC(d),xC(d)]:[d,d],h=l.reduce(function(p,g){var y=wr(c,g,0),v=f[0]-Math.abs(Array.isArray(y)?y[0]:y),x=f[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(v,p[0]),Math.max(x,p[1])]},[1/0,-1/0]);return[Math.min(h[0],u[0]),Math.max(h[1],u[1])]},[1/0,-1/0])}return null},Wrt=function(e,n,r,a,s){var o=n.map(function(i){return CY(e,i,r,s,a)}).filter(function(i){return!ht(i)});return o&&o.length?o.reduce(function(i,l){return[Math.min(i[0],l[0]),Math.max(i[1],l[1])]},[1/0,-1/0]):null},_Y=function(e,n,r,a,s){var o=n.map(function(l){var u=l.props.dataKey;return r==="number"&&u&&CY(e,l,u,a)||Cg(e,u,r,s)});if(r==="number")return o.reduce(function(l,u){return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);var i={};return o.reduce(function(l,u){for(var c=0,d=u.length;c<d;c++)i[u[c]]||(i[u[c]]=!0,l.push(u[c]));return l},[])},$Y=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},ic=function(e,n,r){if(!e)return null;var a=e.scale,s=e.duplicateDomain,o=e.type,i=e.range,l=e.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(n||r)&&o==="category"&&a.bandwidth?a.bandwidth()/l:0;if(u=e.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?Ca(i[0]-i[1])*2*u:u,n&&(e.ticks||e.niceTicks)){var c=(e.ticks||e.niceTicks).map(function(d){var f=s?s.indexOf(d):d;return{coordinate:a(f)+u,value:d,offset:u}});return c.filter(function(d){return!lb(d.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(d,f){return{coordinate:a(d)+u,value:d,index:f,offset:u}}):a.ticks&&!r?a.ticks(e.tickCount).map(function(d){return{coordinate:a(d)+u,value:d,offset:u}}):a.domain().map(function(d,f){return{coordinate:a(d)+u,value:s?s[d]:d,index:f,offset:u}})},N$=new WeakMap,S0=function(e,n){if(typeof n!="function")return e;N$.has(e)||N$.set(e,new WeakMap);var r=N$.get(e);if(r.has(n))return r.get(n);var a=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,a),a},kY=function(e,n,r){var a=e.scale,s=e.type,o=e.layout,i=e.axisType;if(a==="auto")return o==="radial"&&i==="radiusAxis"?{scale:ky(),realScaleType:"band"}:o==="radial"&&i==="angleAxis"?{scale:x1(),realScaleType:"linear"}:s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:Sg(),realScaleType:"point"}:s==="category"?{scale:ky(),realScaleType:"band"}:{scale:x1(),realScaleType:"linear"};if(ib(a)){var l="scale".concat(aC(a));return{scale:(DL[l]||Sg)(),realScaleType:DL[l]?l:"point"}}return vt(a)?{scale:a}:{scale:Sg(),realScaleType:"point"}},VL=1e-4,NY=function(e){var n=e.domain();if(!(!n||n.length<=2)){var r=n.length,a=e.range(),s=Math.min(a[0],a[1])-VL,o=Math.max(a[0],a[1])+VL,i=e(n[0]),l=e(n[r-1]);(i<s||i>o||l<s||l>o)&&e.domain([n[0],n[r-1]])}},Grt=function(e,n){if(!e)return null;for(var r=0,a=e.length;r<a;r++)if(e[r].item===n)return e[r].position;return null},Hrt=function(e,n){if(!n||n.length!==2||!Le(n[0])||!Le(n[1]))return e;var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]),s=[e[0],e[1]];return(!Le(e[0])||e[0]<r)&&(s[0]=r),(!Le(e[1])||e[1]>a)&&(s[1]=a),s[0]>a&&(s[0]=a),s[1]<r&&(s[1]=r),s},qrt=function(e){var n=e.length;if(!(n<=0))for(var r=0,a=e[0].length;r<a;++r)for(var s=0,o=0,i=0;i<n;++i){var l=lb(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=s,e[i][r][1]=s+l,s=e[i][r][1]):(e[i][r][0]=o,e[i][r][1]=o+l,o=e[i][r][1])}},Krt=function(e){var n=e.length;if(!(n<=0))for(var r=0,a=e[0].length;r<a;++r)for(var s=0,o=0;o<n;++o){var i=lb(e[o][r][1])?e[o][r][0]:e[o][r][1];i>=0?(e[o][r][0]=s,e[o][r][1]=s+i,s=e[o][r][1]):(e[o][r][0]=0,e[o][r][1]=0)}},Xrt={sign:qrt,expand:c8e,none:th,silhouette:d8e,wiggle:f8e,positive:Krt},Yrt=function(e,n,r){var a=n.map(function(i){return i.props.dataKey}),s=Xrt[r],o=u8e().keys(a).value(function(i,l){return+wr(i,l,0)}).order(nI).offset(s);return o(e)},Qrt=function(e,n,r,a,s,o){if(!e)return null;var i=o?n.reverse():n,l={},u=i.reduce(function(d,f){var h,p=(h=f.type)!==null&&h!==void 0&&h.defaultProps?tr(tr({},f.type.defaultProps),f.props):f.props,g=p.stackId,y=p.hide;if(y)return d;var v=p[r],x=d[v]||{hasStack:!1,stackGroups:{}};if(Cr(g)){var b=x.stackGroups[g]||{numericAxisId:r,cateAxisId:a,items:[]};b.items.push(f),x.hasStack=!0,x.stackGroups[g]=b}else x.stackGroups[Jp("_stackId_")]={numericAxisId:r,cateAxisId:a,items:[f]};return tr(tr({},d),{},Af({},v,x))},l),c={};return Object.keys(u).reduce(function(d,f){var h=u[f];if(h.hasStack){var p={};h.stackGroups=Object.keys(h.stackGroups).reduce(function(g,y){var v=h.stackGroups[y];return tr(tr({},g),{},Af({},y,{numericAxisId:r,cateAxisId:a,items:v.items,stackedData:Yrt(e,v.items,s)}))},p)}return tr(tr({},d),{},Af({},f,h))},c)},IY=function(e,n){var r=n.realScaleType,a=n.type,s=n.tickCount,o=n.originalDomain,i=n.allowDecimals,l=r||n.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=e.domain();if(!u.length)return null;var c=drt(u,s,i);return e.domain([bC(c),xC(c)]),{niceTicks:c}}if(s&&a==="number"){var d=e.domain(),f=frt(d,s,i);return{niceTicks:f}}return null};function WL(t){var e=t.axis,n=t.ticks,r=t.bandSize,a=t.entry,s=t.index,o=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!ht(a[e.dataKey])){var i=Jw(n,"value",a[e.dataKey]);if(i)return i.coordinate+r/2}return n[s]?n[s].coordinate+r/2:null}var l=wr(a,ht(o)?e.dataKey:o);return ht(l)?null:e.scale(l)}var GL=function(e){var n=e.axis,r=e.ticks,a=e.offset,s=e.bandSize,o=e.entry,i=e.index;if(n.type==="category")return r[i]?r[i].coordinate+a:null;var l=wr(o,n.dataKey,n.domain[i]);return ht(l)?null:n.scale(l)-s/2+a},Jrt=function(e){var n=e.numericAxis,r=n.scale.domain();if(n.type==="number"){var a=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]);return a<=0&&s>=0?0:s<0?s:a}return r[0]},Zrt=function(e,n){var r,a=(r=e.type)!==null&&r!==void 0&&r.defaultProps?tr(tr({},e.type.defaultProps),e.props):e.props,s=a.stackId;if(Cr(s)){var o=n[s];if(o){var i=o.items.indexOf(e);return i>=0?o.stackedData[i]:null}}return null},eat=function(e){return e.reduce(function(n,r){return[bC(r.concat([n[0]]).filter(Le)),xC(r.concat([n[1]]).filter(Le))]},[1/0,-1/0])},TY=function(e,n,r){return Object.keys(e).reduce(function(a,s){var o=e[s],i=o.stackedData,l=i.reduce(function(u,c){var d=eat(c.slice(n,r+1));return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},HL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,qL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,PI=function(e,n,r){if(vt(e))return e(n,r);if(!Array.isArray(e))return n;var a=[];if(Le(e[0]))a[0]=r?e[0]:Math.min(e[0],n[0]);else if(HL.test(e[0])){var s=+HL.exec(e[0])[1];a[0]=n[0]-s}else vt(e[0])?a[0]=e[0](n[0]):a[0]=n[0];if(Le(e[1]))a[1]=r?e[1]:Math.max(e[1],n[1]);else if(qL.test(e[1])){var o=+qL.exec(e[1])[1];a[1]=n[1]+o}else vt(e[1])?a[1]=e[1](n[1]):a[1]=n[1];return a},k1=function(e,n,r){if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&n&&n.length>=2){for(var s=jO(n,function(d){return d.coordinate}),o=1/0,i=1,l=s.length;i<l;i++){var u=s[i],c=s[i-1];o=Math.min((u.coordinate||0)-(c.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0},KL=function(e,n,r){return!e||!e.length||hb(e,bs(r,"type.defaultProps.domain"))?n:e},EY=function(e,n){var r=e.type.defaultProps?tr(tr({},e.type.defaultProps),e.props):e.props,a=r.dataKey,s=r.name,o=r.unit,i=r.formatter,l=r.tooltipType,u=r.chartType,c=r.hide;return tr(tr({},nt(e,!1)),{},{dataKey:a,unit:o,formatter:i,name:s||a,color:lR(e),value:wr(n,a),type:l,payload:n,chartType:u,hide:c})};function Dy(t){"@babel/helpers - typeof";return Dy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dy(t)}function XL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function _i(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XL(Object(n),!0).forEach(function(r){AY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function AY(t,e,n){return e=tat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tat(t){var e=nat(t,"string");return Dy(e)=="symbol"?e:e+""}function nat(t,e){if(Dy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Dy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rat(t,e){return iat(t)||oat(t,e)||sat(t,e)||aat()}function aat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sat(t,e){if(t){if(typeof t=="string")return YL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YL(t,e)}}function YL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function oat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function iat(t){if(Array.isArray(t))return t}var N1=Math.PI/180,lat=function(e){return e*180/Math.PI},An=function(e,n,r,a){return{x:e+Math.cos(-N1*a)*r,y:n+Math.sin(-N1*a)*r}},PY=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},uat=function(e,n,r,a,s){var o=e.width,i=e.height,l=e.startAngle,u=e.endAngle,c=_a(e.cx,o,o/2),d=_a(e.cy,i,i/2),f=PY(o,i,r),h=_a(e.innerRadius,f,0),p=_a(e.outerRadius,f,f*.8),g=Object.keys(n);return g.reduce(function(y,v){var x=n[v],b=x.domain,w=x.reversed,C;if(ht(x.range))a==="angleAxis"?C=[l,u]:a==="radiusAxis"&&(C=[h,p]),w&&(C=[C[1],C[0]]);else{C=x.range;var _=C,$=rat(_,2);l=$[0],u=$[1]}var k=kY(x,s),A=k.realScaleType,P=k.scale;P.domain(b).range(C),NY(P);var O=IY(P,_i(_i({},x),{},{realScaleType:A})),R=_i(_i(_i({},x),O),{},{range:C,radius:p,realScaleType:A,scale:P,cx:c,cy:d,innerRadius:h,outerRadius:p,startAngle:l,endAngle:u});return _i(_i({},y),{},AY({},v,R))},{})},cat=function(e,n){var r=e.x,a=e.y,s=n.x,o=n.y;return Math.sqrt(Math.pow(r-s,2)+Math.pow(a-o,2))},dat=function(e,n){var r=e.x,a=e.y,s=n.cx,o=n.cy,i=cat({x:r,y:a},{x:s,y:o});if(i<=0)return{radius:i};var l=(r-s)/i,u=Math.acos(l);return a>o&&(u=2*Math.PI-u),{radius:i,angle:lat(u),angleInRadian:u}},fat=function(e){var n=e.startAngle,r=e.endAngle,a=Math.floor(n/360),s=Math.floor(r/360),o=Math.min(a,s);return{startAngle:n-o*360,endAngle:r-o*360}},hat=function(e,n){var r=n.startAngle,a=n.endAngle,s=Math.floor(r/360),o=Math.floor(a/360),i=Math.min(s,o);return e+i*360},QL=function(e,n){var r=e.x,a=e.y,s=dat({x:r,y:a},n),o=s.radius,i=s.angle,l=n.innerRadius,u=n.outerRadius;if(o<l||o>u)return!1;if(o===0)return!0;var c=fat(n),d=c.startAngle,f=c.endAngle,h=i,p;if(d<=f){for(;h>f;)h-=360;for(;h<d;)h+=360;p=h>=d&&h<=f}else{for(;h>d;)h-=360;for(;h<f;)h+=360;p=h>=f&&h<=d}return p?_i(_i({},n),{},{radius:o,angle:hat(h,n)}):null},OY=function(e){return!N.isValidElement(e)&&!vt(e)&&typeof e!="boolean"?e.className:""};function jy(t){"@babel/helpers - typeof";return jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jy(t)}var pat=["offset"];function mat(t){return xat(t)||vat(t)||yat(t)||gat()}function gat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yat(t,e){if(t){if(typeof t=="string")return OI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return OI(t,e)}}function vat(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xat(t){if(Array.isArray(t))return OI(t)}function OI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bat(t,e){if(t==null)return{};var n=wat(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function wat(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function JL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function yr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JL(Object(n),!0).forEach(function(r){Sat(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Sat(t,e,n){return e=Cat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cat(t){var e=_at(t,"string");return jy(e)=="symbol"?e:e+""}function _at(t,e){if(jy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(jy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function My(){return My=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},My.apply(this,arguments)}var $at=function(e){var n=e.value,r=e.formatter,a=ht(e.children)?n:e.children;return vt(r)?r(a):a},kat=function(e,n){var r=Ca(n-e),a=Math.min(Math.abs(n-e),360);return r*a},Nat=function(e,n,r){var a=e.position,s=e.viewBox,o=e.offset,i=e.className,l=s,u=l.cx,c=l.cy,d=l.innerRadius,f=l.outerRadius,h=l.startAngle,p=l.endAngle,g=l.clockWise,y=(d+f)/2,v=kat(h,p),x=v>=0?1:-1,b,w;a==="insideStart"?(b=h+x*o,w=g):a==="insideEnd"?(b=p-x*o,w=!g):a==="end"&&(b=p+x*o,w=g),w=v<=0?w:!w;var C=An(u,c,y,b),_=An(u,c,y,b+(w?1:-1)*359),$="M".concat(C.x,",").concat(C.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(w?0:1,`,
    `).concat(_.x,",").concat(_.y),k=ht(e.id)?Jp("recharts-radial-line-"):e.id;return K.createElement("text",My({},r,{dominantBaseline:"central",className:xt("recharts-radial-bar-label",i)}),K.createElement("defs",null,K.createElement("path",{id:k,d:$})),K.createElement("textPath",{xlinkHref:"#".concat(k)},n))},Iat=function(e){var n=e.viewBox,r=e.offset,a=e.position,s=n,o=s.cx,i=s.cy,l=s.innerRadius,u=s.outerRadius,c=s.startAngle,d=s.endAngle,f=(c+d)/2;if(a==="outside"){var h=An(o,i,u+r,f),p=h.x,g=h.y;return{x:p,y:g,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:i,textAnchor:"middle",verticalAnchor:"end"};var y=(l+u)/2,v=An(o,i,y,f),x=v.x,b=v.y;return{x,y:b,textAnchor:"middle",verticalAnchor:"middle"}},Tat=function(e){var n=e.viewBox,r=e.parentViewBox,a=e.offset,s=e.position,o=n,i=o.x,l=o.y,u=o.width,c=o.height,d=c>=0?1:-1,f=d*a,h=d>0?"end":"start",p=d>0?"start":"end",g=u>=0?1:-1,y=g*a,v=g>0?"end":"start",x=g>0?"start":"end";if(s==="top"){var b={x:i+u/2,y:l-d*a,textAnchor:"middle",verticalAnchor:h};return yr(yr({},b),r?{height:Math.max(l-r.y,0),width:u}:{})}if(s==="bottom"){var w={x:i+u/2,y:l+c+f,textAnchor:"middle",verticalAnchor:p};return yr(yr({},w),r?{height:Math.max(r.y+r.height-(l+c),0),width:u}:{})}if(s==="left"){var C={x:i-y,y:l+c/2,textAnchor:v,verticalAnchor:"middle"};return yr(yr({},C),r?{width:Math.max(C.x-r.x,0),height:c}:{})}if(s==="right"){var _={x:i+u+y,y:l+c/2,textAnchor:x,verticalAnchor:"middle"};return yr(yr({},_),r?{width:Math.max(r.x+r.width-_.x,0),height:c}:{})}var $=r?{width:u,height:c}:{};return s==="insideLeft"?yr({x:i+y,y:l+c/2,textAnchor:x,verticalAnchor:"middle"},$):s==="insideRight"?yr({x:i+u-y,y:l+c/2,textAnchor:v,verticalAnchor:"middle"},$):s==="insideTop"?yr({x:i+u/2,y:l+f,textAnchor:"middle",verticalAnchor:p},$):s==="insideBottom"?yr({x:i+u/2,y:l+c-f,textAnchor:"middle",verticalAnchor:h},$):s==="insideTopLeft"?yr({x:i+y,y:l+f,textAnchor:x,verticalAnchor:p},$):s==="insideTopRight"?yr({x:i+u-y,y:l+f,textAnchor:v,verticalAnchor:p},$):s==="insideBottomLeft"?yr({x:i+y,y:l+c-f,textAnchor:x,verticalAnchor:h},$):s==="insideBottomRight"?yr({x:i+u-y,y:l+c-f,textAnchor:v,verticalAnchor:h},$):Kp(s)&&(Le(s.x)||ac(s.x))&&(Le(s.y)||ac(s.y))?yr({x:i+_a(s.x,u),y:l+_a(s.y,c),textAnchor:"end",verticalAnchor:"end"},$):yr({x:i+u/2,y:l+c/2,textAnchor:"middle",verticalAnchor:"middle"},$)},Eat=function(e){return"cx"in e&&Le(e.cx)};function Or(t){var e=t.offset,n=e===void 0?5:e,r=bat(t,pat),a=yr({offset:n},r),s=a.viewBox,o=a.position,i=a.value,l=a.children,u=a.content,c=a.className,d=c===void 0?"":c,f=a.textBreakAll;if(!s||ht(i)&&ht(l)&&!N.isValidElement(u)&&!vt(u))return null;if(N.isValidElement(u))return N.cloneElement(u,a);var h;if(vt(u)){if(h=N.createElement(u,a),N.isValidElement(h))return h}else h=$at(a);var p=Eat(s),g=nt(a,!0);if(p&&(o==="insideStart"||o==="insideEnd"||o==="end"))return Nat(a,h,g);var y=p?Iat(a):Tat(a);return K.createElement(Hc,My({className:xt("recharts-label",d)},g,y,{breakAll:f}),h)}Or.displayName="Label";var RY=function(e){var n=e.cx,r=e.cy,a=e.angle,s=e.startAngle,o=e.endAngle,i=e.r,l=e.radius,u=e.innerRadius,c=e.outerRadius,d=e.x,f=e.y,h=e.top,p=e.left,g=e.width,y=e.height,v=e.clockWise,x=e.labelViewBox;if(x)return x;if(Le(g)&&Le(y)){if(Le(d)&&Le(f))return{x:d,y:f,width:g,height:y};if(Le(h)&&Le(p))return{x:h,y:p,width:g,height:y}}return Le(d)&&Le(f)?{x:d,y:f,width:0,height:0}:Le(n)&&Le(r)?{cx:n,cy:r,startAngle:s||a||0,endAngle:o||a||0,innerRadius:u||0,outerRadius:c||l||i||0,clockWise:v}:e.viewBox?e.viewBox:{}},Aat=function(e,n){return e?e===!0?K.createElement(Or,{key:"label-implicit",viewBox:n}):Cr(e)?K.createElement(Or,{key:"label-implicit",viewBox:n,value:e}):N.isValidElement(e)?e.type===Or?N.cloneElement(e,{key:"label-implicit",viewBox:n}):K.createElement(Or,{key:"label-implicit",content:e,viewBox:n}):vt(e)?K.createElement(Or,{key:"label-implicit",content:e,viewBox:n}):Kp(e)?K.createElement(Or,My({viewBox:n},e,{key:"label-implicit"})):null:null},Pat=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var a=e.children,s=RY(e),o=ws(a,Or).map(function(l,u){return N.cloneElement(l,{viewBox:n||s,key:"label-".concat(u)})});if(!r)return o;var i=Aat(e.label,n||s);return[i].concat(mat(o))};Or.parseViewBox=RY;Or.renderCallByParent=Pat;function Oat(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var Rat=Oat;const Dat=Ut(Rat);function Fy(t){"@babel/helpers - typeof";return Fy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fy(t)}var jat=["valueAccessor"],Mat=["data","dataKey","clockWise","id","textBreakAll"];function Fat(t){return Uat(t)||zat(t)||Bat(t)||Lat()}function Lat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bat(t,e){if(t){if(typeof t=="string")return RI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return RI(t,e)}}function zat(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Uat(t){if(Array.isArray(t))return RI(t)}function RI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function I1(){return I1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},I1.apply(this,arguments)}function ZL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function eB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZL(Object(n),!0).forEach(function(r){Vat(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZL(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vat(t,e,n){return e=Wat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wat(t){var e=Gat(t,"string");return Fy(e)=="symbol"?e:e+""}function Gat(t,e){if(Fy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Fy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tB(t,e){if(t==null)return{};var n=Hat(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Hat(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var qat=function(e){return Array.isArray(e.value)?Dat(e.value):e.value};function zi(t){var e=t.valueAccessor,n=e===void 0?qat:e,r=tB(t,jat),a=r.data,s=r.dataKey,o=r.clockWise,i=r.id,l=r.textBreakAll,u=tB(r,Mat);return!a||!a.length?null:K.createElement(qt,{className:"recharts-label-list"},a.map(function(c,d){var f=ht(s)?n(c,d):wr(c&&c.payload,s),h=ht(i)?{}:{id:"".concat(i,"-").concat(d)};return K.createElement(Or,I1({},nt(c,!0),u,h,{parentViewBox:c.parentViewBox,value:f,textBreakAll:l,viewBox:Or.parseViewBox(ht(o)?c:eB(eB({},c),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}zi.displayName="LabelList";function Kat(t,e){return t?t===!0?K.createElement(zi,{key:"labelList-implicit",data:e}):K.isValidElement(t)||vt(t)?K.createElement(zi,{key:"labelList-implicit",data:e,content:t}):Kp(t)?K.createElement(zi,I1({data:e},t,{key:"labelList-implicit"})):null:null}function Xat(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var r=t.children,a=ws(r,zi).map(function(o,i){return N.cloneElement(o,{data:e,key:"labelList-".concat(i)})});if(!n)return a;var s=Kat(t.label,e);return[s].concat(Fat(a))}zi.renderCallByParent=Xat;function Ly(t){"@babel/helpers - typeof";return Ly=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ly(t)}function DI(){return DI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},DI.apply(this,arguments)}function nB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function rB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nB(Object(n),!0).forEach(function(r){Yat(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Yat(t,e,n){return e=Qat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qat(t){var e=Jat(t,"string");return Ly(e)=="symbol"?e:e+""}function Jat(t,e){if(Ly(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ly(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Zat=function(e,n){var r=Ca(n-e),a=Math.min(Math.abs(n-e),359.999);return r*a},C0=function(e){var n=e.cx,r=e.cy,a=e.radius,s=e.angle,o=e.sign,i=e.isExternal,l=e.cornerRadius,u=e.cornerIsExternal,c=l*(i?1:-1)+a,d=Math.asin(l/c)/N1,f=u?s:s+o*d,h=An(n,r,c,f),p=An(n,r,a,f),g=u?s-o*d:s,y=An(n,r,c*Math.cos(d*N1),g);return{center:h,circleTangency:p,lineTangency:y,theta:d}},DY=function(e){var n=e.cx,r=e.cy,a=e.innerRadius,s=e.outerRadius,o=e.startAngle,i=e.endAngle,l=Zat(o,i),u=o+l,c=An(n,r,s,o),d=An(n,r,s,u),f="M ".concat(c.x,",").concat(c.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(o>u),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var h=An(n,r,a,o),p=An(n,r,a,u);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(o<=u),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(n,",").concat(r," Z");return f},est=function(e){var n=e.cx,r=e.cy,a=e.innerRadius,s=e.outerRadius,o=e.cornerRadius,i=e.forceCornerRadius,l=e.cornerIsExternal,u=e.startAngle,c=e.endAngle,d=Ca(c-u),f=C0({cx:n,cy:r,radius:s,angle:u,sign:d,cornerRadius:o,cornerIsExternal:l}),h=f.circleTangency,p=f.lineTangency,g=f.theta,y=C0({cx:n,cy:r,radius:s,angle:c,sign:-d,cornerRadius:o,cornerIsExternal:l}),v=y.circleTangency,x=y.lineTangency,b=y.theta,w=l?Math.abs(u-c):Math.abs(u-c)-g-b;if(w<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):DY({cx:n,cy:r,innerRadius:a,outerRadius:s,startAngle:u,endAngle:c});var C="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(w>180),",").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
  `);if(a>0){var _=C0({cx:n,cy:r,radius:a,angle:u,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),$=_.circleTangency,k=_.lineTangency,A=_.theta,P=C0({cx:n,cy:r,radius:a,angle:c,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:l}),O=P.circleTangency,R=P.lineTangency,B=P.theta,F=l?Math.abs(u-c):Math.abs(u-c)-A-B;if(F<0&&o===0)return"".concat(C,"L").concat(n,",").concat(r,"Z");C+="L".concat(R.x,",").concat(R.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(F>180),",").concat(+(d>0),",").concat($.x,",").concat($.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,"Z")}else C+="L".concat(n,",").concat(r,"Z");return C},tst={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},jY=function(e){var n=rB(rB({},tst),e),r=n.cx,a=n.cy,s=n.innerRadius,o=n.outerRadius,i=n.cornerRadius,l=n.forceCornerRadius,u=n.cornerIsExternal,c=n.startAngle,d=n.endAngle,f=n.className;if(o<s||c===d)return null;var h=xt("recharts-sector",f),p=o-s,g=_a(i,p,0,!0),y;return g>0&&Math.abs(c-d)<360?y=est({cx:r,cy:a,innerRadius:s,outerRadius:o,cornerRadius:Math.min(g,p/2),forceCornerRadius:l,cornerIsExternal:u,startAngle:c,endAngle:d}):y=DY({cx:r,cy:a,innerRadius:s,outerRadius:o,startAngle:c,endAngle:d}),K.createElement("path",DI({},nt(n,!0),{className:h,d:y,role:"img"}))};function By(t){"@babel/helpers - typeof";return By=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},By(t)}function jI(){return jI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jI.apply(this,arguments)}function aB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function sB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?aB(Object(n),!0).forEach(function(r){nst(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nst(t,e,n){return e=rst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rst(t){var e=ast(t,"string");return By(e)=="symbol"?e:e+""}function ast(t,e){if(By(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(By(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oB={curveBasisClosed:JHe,curveBasisOpen:ZHe,curveBasis:QHe,curveBumpX:MHe,curveBumpY:FHe,curveLinearClosed:e8e,curveLinear:oC,curveMonotoneX:t8e,curveMonotoneY:n8e,curveNatural:r8e,curveStep:a8e,curveStepAfter:o8e,curveStepBefore:s8e},_0=function(e){return e.x===+e.x&&e.y===+e.y},Bm=function(e){return e.x},zm=function(e){return e.y},sst=function(e,n){if(vt(e))return e;var r="curve".concat(aC(e));return(r==="curveMonotone"||r==="curveBump")&&n?oB["".concat(r).concat(n==="vertical"?"Y":"X")]:oB[r]||oC},ost=function(e){var n=e.type,r=n===void 0?"linear":n,a=e.points,s=a===void 0?[]:a,o=e.baseLine,i=e.layout,l=e.connectNulls,u=l===void 0?!1:l,c=sst(r,i),d=u?s.filter(function(g){return _0(g)}):s,f;if(Array.isArray(o)){var h=u?o.filter(function(g){return _0(g)}):o,p=d.map(function(g,y){return sB(sB({},g),{},{base:h[y]})});return i==="vertical"?f=p0().y(zm).x1(Bm).x0(function(g){return g.base.x}):f=p0().x(Bm).y1(zm).y0(function(g){return g.base.y}),f.defined(_0).curve(c),f(p)}return i==="vertical"&&Le(o)?f=p0().y(zm).x1(Bm).x0(o):Le(o)?f=p0().x(Bm).y1(zm).y0(o):f=PX().x(Bm).y(zm),f.defined(_0).curve(c),f(d)},T1=function(e){var n=e.className,r=e.points,a=e.path,s=e.pathRef;if((!r||!r.length)&&!a)return null;var o=r&&r.length?ost(e):a;return K.createElement("path",jI({},nt(e,!1),Zw(e),{className:xt("recharts-curve",n),d:o,ref:s}))},MY={exports:{}},ist="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",lst=ist,ust=lst;function FY(){}function LY(){}LY.resetWarningCache=FY;var cst=function(){function t(r,a,s,o,i,l){if(l!==ust){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:LY,resetWarningCache:FY};return n.PropTypes=n,n};MY.exports=cst();var dst=MY.exports;const Ct=Ut(dst);var fst=Object.getOwnPropertyNames,hst=Object.getOwnPropertySymbols,pst=Object.prototype.hasOwnProperty;function iB(t,e){return function(r,a,s){return t(r,a,s)&&e(r,a,s)}}function $0(t){return function(n,r,a){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,a);var s=a.cache,o=s.get(n),i=s.get(r);if(o&&i)return o===r&&i===n;s.set(n,r),s.set(r,n);var l=t(n,r,a);return s.delete(n),s.delete(r),l}}function lB(t){return fst(t).concat(hst(t))}var BY=Object.hasOwn||function(t,e){return pst.call(t,e)};function sm(t,e){return t||e?t===e:t===e||t!==t&&e!==e}var zY="_owner",uB=Object.getOwnPropertyDescriptor,cB=Object.keys;function mst(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function gst(t,e){return sm(t.getTime(),e.getTime())}function dB(t,e,n){if(t.size!==e.size)return!1;for(var r={},a=t.entries(),s=0,o,i;(o=a.next())&&!o.done;){for(var l=e.entries(),u=!1,c=0;(i=l.next())&&!i.done;){var d=o.value,f=d[0],h=d[1],p=i.value,g=p[0],y=p[1];!u&&!r[c]&&(u=n.equals(f,g,s,c,t,e,n)&&n.equals(h,y,f,g,t,e,n))&&(r[c]=!0),c++}if(!u)return!1;s++}return!0}function yst(t,e,n){var r=cB(t),a=r.length;if(cB(e).length!==a)return!1;for(var s;a-- >0;)if(s=r[a],s===zY&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!BY(e,s)||!n.equals(t[s],e[s],s,s,t,e,n))return!1;return!0}function Um(t,e,n){var r=lB(t),a=r.length;if(lB(e).length!==a)return!1;for(var s,o,i;a-- >0;)if(s=r[a],s===zY&&(t.$$typeof||e.$$typeof)&&t.$$typeof!==e.$$typeof||!BY(e,s)||!n.equals(t[s],e[s],s,s,t,e,n)||(o=uB(t,s),i=uB(e,s),(o||i)&&(!o||!i||o.configurable!==i.configurable||o.enumerable!==i.enumerable||o.writable!==i.writable)))return!1;return!0}function vst(t,e){return sm(t.valueOf(),e.valueOf())}function xst(t,e){return t.source===e.source&&t.flags===e.flags}function fB(t,e,n){if(t.size!==e.size)return!1;for(var r={},a=t.values(),s,o;(s=a.next())&&!s.done;){for(var i=e.values(),l=!1,u=0;(o=i.next())&&!o.done;)!l&&!r[u]&&(l=n.equals(s.value,o.value,s.value,o.value,t,e,n))&&(r[u]=!0),u++;if(!l)return!1}return!0}function bst(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}var wst="[object Arguments]",Sst="[object Boolean]",Cst="[object Date]",_st="[object Map]",$st="[object Number]",kst="[object Object]",Nst="[object RegExp]",Ist="[object Set]",Tst="[object String]",Est=Array.isArray,hB=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,pB=Object.assign,Ast=Object.prototype.toString.call.bind(Object.prototype.toString);function Pst(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areMapsEqual,a=t.areObjectsEqual,s=t.arePrimitiveWrappersEqual,o=t.areRegExpsEqual,i=t.areSetsEqual,l=t.areTypedArraysEqual;return function(c,d,f){if(c===d)return!0;if(c==null||d==null||typeof c!="object"||typeof d!="object")return c!==c&&d!==d;var h=c.constructor;if(h!==d.constructor)return!1;if(h===Object)return a(c,d,f);if(Est(c))return e(c,d,f);if(hB!=null&&hB(c))return l(c,d,f);if(h===Date)return n(c,d,f);if(h===RegExp)return o(c,d,f);if(h===Map)return r(c,d,f);if(h===Set)return i(c,d,f);var p=Ast(c);return p===Cst?n(c,d,f):p===Nst?o(c,d,f):p===_st?r(c,d,f):p===Ist?i(c,d,f):p===kst?typeof c.then!="function"&&typeof d.then!="function"&&a(c,d,f):p===wst?a(c,d,f):p===Sst||p===$st||p===Tst?s(c,d,f):!1}}function Ost(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,a={areArraysEqual:r?Um:mst,areDatesEqual:gst,areMapsEqual:r?iB(dB,Um):dB,areObjectsEqual:r?Um:yst,arePrimitiveWrappersEqual:vst,areRegExpsEqual:xst,areSetsEqual:r?iB(fB,Um):fB,areTypedArraysEqual:r?Um:bst};if(n&&(a=pB({},a,n(a))),e){var s=$0(a.areArraysEqual),o=$0(a.areMapsEqual),i=$0(a.areObjectsEqual),l=$0(a.areSetsEqual);a=pB({},a,{areArraysEqual:s,areMapsEqual:o,areObjectsEqual:i,areSetsEqual:l})}return a}function Rst(t){return function(e,n,r,a,s,o,i){return t(e,n,i)}}function Dst(t){var e=t.circular,n=t.comparator,r=t.createState,a=t.equals,s=t.strict;if(r)return function(l,u){var c=r(),d=c.cache,f=d===void 0?e?new WeakMap:void 0:d,h=c.meta;return n(l,u,{cache:f,equals:a,meta:h,strict:s})};if(e)return function(l,u){return n(l,u,{cache:new WeakMap,equals:a,meta:void 0,strict:s})};var o={cache:void 0,equals:a,meta:void 0,strict:s};return function(l,u){return n(l,u,o)}}var jst=Cu();Cu({strict:!0});Cu({circular:!0});Cu({circular:!0,strict:!0});Cu({createInternalComparator:function(){return sm}});Cu({strict:!0,createInternalComparator:function(){return sm}});Cu({circular:!0,createInternalComparator:function(){return sm}});Cu({circular:!0,createInternalComparator:function(){return sm},strict:!0});function Cu(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,a=t.createState,s=t.strict,o=s===void 0?!1:s,i=Ost(t),l=Pst(i),u=r?r(l):Rst(l);return Dst({circular:n,comparator:l,createState:a,equals:u,strict:o})}function Mst(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function mB(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function a(s){n<0&&(n=s),s-n>e?(t(s),n=-1):Mst(a)};requestAnimationFrame(r)}function MI(t){"@babel/helpers - typeof";return MI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MI(t)}function Fst(t){return Ust(t)||zst(t)||Bst(t)||Lst()}function Lst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bst(t,e){if(t){if(typeof t=="string")return gB(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gB(t,e)}}function gB(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function zst(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ust(t){if(Array.isArray(t))return t}function Vst(){var t={},e=function(){return null},n=!1,r=function a(s){if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,i=Fst(o),l=i[0],u=i.slice(1);if(typeof l=="number"){mB(a.bind(null,u),l);return}a(l),mB(a.bind(null,u));return}MI(s)==="object"&&(t=s,e(t)),typeof s=="function"&&s()}};return{stop:function(){n=!0},start:function(s){n=!1,r(s)},subscribe:function(s){return e=s,function(){e=function(){return null}}}}}function zy(t){"@babel/helpers - typeof";return zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zy(t)}function yB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function vB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yB(Object(n),!0).forEach(function(r){UY(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function UY(t,e,n){return e=Wst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wst(t){var e=Gst(t,"string");return zy(e)==="symbol"?e:String(e)}function Gst(t,e){if(zy(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(zy(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hst=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(r,a){return r.filter(function(s){return a.includes(s)})})},qst=function(e){return e},Kst=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},_g=function(e,n){return Object.keys(n).reduce(function(r,a){return vB(vB({},r),{},UY({},a,e(a,n[a])))},{})},xB=function(e,n,r){return e.map(function(a){return"".concat(Kst(a)," ").concat(n,"ms ").concat(r)}).join(",")};function Xst(t,e){return Jst(t)||Qst(t,e)||VY(t,e)||Yst()}function Yst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qst(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function Jst(t){if(Array.isArray(t))return t}function Zst(t){return not(t)||tot(t)||VY(t)||eot()}function eot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VY(t,e){if(t){if(typeof t=="string")return FI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FI(t,e)}}function tot(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function not(t){if(Array.isArray(t))return FI(t)}function FI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var E1=1e-4,WY=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},GY=function(e,n){return e.map(function(r,a){return r*Math.pow(n,a)}).reduce(function(r,a){return r+a})},bB=function(e,n){return function(r){var a=WY(e,n);return GY(a,r)}},rot=function(e,n){return function(r){var a=WY(e,n),s=[].concat(Zst(a.map(function(o,i){return o*i}).slice(1)),[0]);return GY(s,r)}},wB=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],s=n[1],o=n[2],i=n[3];if(n.length===1)switch(n[0]){case"linear":a=0,s=0,o=1,i=1;break;case"ease":a=.25,s=.1,o=.25,i=1;break;case"ease-in":a=.42,s=0,o=1,i=1;break;case"ease-out":a=.42,s=0,o=.58,i=1;break;case"ease-in-out":a=0,s=0,o=.58,i=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var u=l[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),c=Xst(u,4);a=c[0],s=c[1],o=c[2],i=c[3]}}}var d=bB(a,o),f=bB(s,i),h=rot(a,o),p=function(v){return v>1?1:v<0?0:v},g=function(v){for(var x=v>1?1:v,b=x,w=0;w<8;++w){var C=d(b)-x,_=h(b);if(Math.abs(C-x)<E1||_<E1)return f(b);b=p(b-C/_)}return f(b)};return g.isStepper=!1,g},aot=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,r=n===void 0?100:n,a=e.damping,s=a===void 0?8:a,o=e.dt,i=o===void 0?17:o,l=function(c,d,f){var h=-(c-d)*r,p=f*s,g=f+(h-p)*i/1e3,y=f*i/1e3+c;return Math.abs(y-d)<E1&&Math.abs(g)<E1?[d,0]:[y,g]};return l.isStepper=!0,l.dt=i,l},sot=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return wB(a);case"spring":return aot();default:if(a.split("(")[0]==="cubic-bezier")return wB(a)}return typeof a=="function"?a:null};function Uy(t){"@babel/helpers - typeof";return Uy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uy(t)}function SB(t){return lot(t)||iot(t)||HY(t)||oot()}function oot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iot(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lot(t){if(Array.isArray(t))return BI(t)}function CB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Wr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CB(Object(n),!0).forEach(function(r){LI(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function LI(t,e,n){return e=uot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uot(t){var e=cot(t,"string");return Uy(e)==="symbol"?e:String(e)}function cot(t,e){if(Uy(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Uy(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dot(t,e){return pot(t)||hot(t,e)||HY(t,e)||fot()}function fot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HY(t,e){if(t){if(typeof t=="string")return BI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BI(t,e)}}function BI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hot(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function pot(t){if(Array.isArray(t))return t}var A1=function(e,n,r){return e+(n-e)*r},zI=function(e){var n=e.from,r=e.to;return n!==r},mot=function t(e,n,r){var a=_g(function(s,o){if(zI(o)){var i=e(o.from,o.to,o.velocity),l=dot(i,2),u=l[0],c=l[1];return Wr(Wr({},o),{},{from:u,velocity:c})}return o},n);return r<1?_g(function(s,o){return zI(o)?Wr(Wr({},o),{},{velocity:A1(o.velocity,a[s].velocity,r),from:A1(o.from,a[s].from,r)}):o},n):t(e,a,r-1)};const got=function(t,e,n,r,a){var s=Hst(t,e),o=s.reduce(function(y,v){return Wr(Wr({},y),{},LI({},v,[t[v],e[v]]))},{}),i=s.reduce(function(y,v){return Wr(Wr({},y),{},LI({},v,{from:t[v],velocity:0,to:e[v]}))},{}),l=-1,u,c,d=function(){return null},f=function(){return _g(function(v,x){return x.from},i)},h=function(){return!Object.values(i).filter(zI).length},p=function(v){u||(u=v);var x=v-u,b=x/n.dt;i=mot(n,i,b),a(Wr(Wr(Wr({},t),e),f())),u=v,h()||(l=requestAnimationFrame(d))},g=function(v){c||(c=v);var x=(v-c)/r,b=_g(function(C,_){return A1.apply(void 0,SB(_).concat([n(x)]))},o);if(a(Wr(Wr(Wr({},t),e),b)),x<1)l=requestAnimationFrame(d);else{var w=_g(function(C,_){return A1.apply(void 0,SB(_).concat([n(1)]))},o);a(Wr(Wr(Wr({},t),e),w))}};return d=n.isStepper?p:g,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(l)}}};function ch(t){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(t)}var yot=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function vot(t,e){if(t==null)return{};var n=xot(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function xot(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,s;for(s=0;s<r.length;s++)a=r[s],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function I$(t){return Cot(t)||Sot(t)||wot(t)||bot()}function bot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wot(t,e){if(t){if(typeof t=="string")return UI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UI(t,e)}}function Sot(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Cot(t){if(Array.isArray(t))return UI(t)}function UI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function fo(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_B(Object(n),!0).forEach(function(r){ag(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_B(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ag(t,e,n){return e=qY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ot(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qY(r.key),r)}}function kot(t,e,n){return e&&$ot(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function qY(t){var e=Not(t,"string");return ch(e)==="symbol"?e:String(e)}function Not(t,e){if(ch(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ch(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iot(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VI(t,e)}function VI(t,e){return VI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},VI(t,e)}function Tot(t){var e=Eot();return function(){var r=P1(t),a;if(e){var s=P1(this).constructor;a=Reflect.construct(r,arguments,s)}else a=r.apply(this,arguments);return WI(this,a)}}function WI(t,e){if(e&&(ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GI(t)}function GI(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Eot(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P1(t){return P1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},P1(t)}var mi=function(t){Iot(n,t);var e=Tot(n);function n(r,a){var s;_ot(this,n),s=e.call(this,r,a);var o=s.props,i=o.isActive,l=o.attributeName,u=o.from,c=o.to,d=o.steps,f=o.children,h=o.duration;if(s.handleStyleChange=s.handleStyleChange.bind(GI(s)),s.changeStyle=s.changeStyle.bind(GI(s)),!i||h<=0)return s.state={style:{}},typeof f=="function"&&(s.state={style:c}),WI(s);if(d&&d.length)s.state={style:d[0].style};else if(u){if(typeof f=="function")return s.state={style:u},WI(s);s.state={style:l?ag({},l,u):u}}else s.state={style:{}};return s}return kot(n,[{key:"componentDidMount",value:function(){var a=this.props,s=a.isActive,o=a.canBegin;this.mounted=!0,!(!s||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var s=this.props,o=s.isActive,i=s.canBegin,l=s.attributeName,u=s.shouldReAnimate,c=s.to,d=s.from,f=this.state.style;if(i){if(!o){var h={style:l?ag({},l,c):c};this.state&&f&&(l&&f[l]!==c||!l&&f!==c)&&this.setState(h);return}if(!(jst(a.to,c)&&a.canBegin&&a.isActive)){var p=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=p||u?d:a.to;if(this.state&&f){var y={style:l?ag({},l,g):g};(l&&f[l]!==g||!l&&f!==g)&&this.setState(y)}this.runAnimation(fo(fo({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var s=this,o=a.from,i=a.to,l=a.duration,u=a.easing,c=a.begin,d=a.onAnimationEnd,f=a.onAnimationStart,h=got(o,i,sot(u),l,this.changeStyle),p=function(){s.stopJSAnimation=h()};this.manager.start([f,c,p,l,d])}},{key:"runStepAnimation",value:function(a){var s=this,o=a.steps,i=a.begin,l=a.onAnimationStart,u=o[0],c=u.style,d=u.duration,f=d===void 0?0:d,h=function(g,y,v){if(v===0)return g;var x=y.duration,b=y.easing,w=b===void 0?"ease":b,C=y.style,_=y.properties,$=y.onAnimationEnd,k=v>0?o[v-1]:y,A=_||Object.keys(C);if(typeof w=="function"||w==="spring")return[].concat(I$(g),[s.runJSAnimation.bind(s,{from:k.style,to:C,duration:x,easing:w}),x]);var P=xB(A,x,w),O=fo(fo(fo({},k.style),C),{},{transition:P});return[].concat(I$(g),[O,x,$]).filter(qst)};return this.manager.start([l].concat(I$(o.reduce(h,[c,Math.max(f,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Vst());var s=a.begin,o=a.duration,i=a.attributeName,l=a.to,u=a.easing,c=a.onAnimationStart,d=a.onAnimationEnd,f=a.steps,h=a.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof u=="function"||typeof h=="function"||u==="spring"){this.runJSAnimation(a);return}if(f.length>1){this.runStepAnimation(a);return}var g=i?ag({},i,l):l,y=xB(Object.keys(g),o,u);p.start([c,s,fo(fo({},g),{},{transition:y}),o,d])}},{key:"render",value:function(){var a=this.props,s=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var l=vot(a,yot),u=N.Children.count(s),c=this.state.style;if(typeof s=="function")return s(c);if(!i||u===0||o<=0)return s;var d=function(h){var p=h.props,g=p.style,y=g===void 0?{}:g,v=p.className,x=N.cloneElement(h,fo(fo({},l),{},{style:fo(fo({},y),c),className:v}));return x};return u===1?d(N.Children.only(s)):K.createElement("div",null,N.Children.map(s,function(f){return d(f)}))}}]),n}(N.PureComponent);mi.displayName="Animate";mi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};mi.propTypes={from:Ct.oneOfType([Ct.object,Ct.string]),to:Ct.oneOfType([Ct.object,Ct.string]),attributeName:Ct.string,duration:Ct.number,begin:Ct.number,easing:Ct.oneOfType([Ct.string,Ct.func]),steps:Ct.arrayOf(Ct.shape({duration:Ct.number.isRequired,style:Ct.object.isRequired,easing:Ct.oneOfType([Ct.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Ct.func]),properties:Ct.arrayOf("string"),onAnimationEnd:Ct.func})),children:Ct.oneOfType([Ct.node,Ct.func]),isActive:Ct.bool,canBegin:Ct.bool,onAnimationEnd:Ct.func,shouldReAnimate:Ct.bool,onAnimationStart:Ct.func,onAnimationReStart:Ct.func};Ct.object,Ct.object,Ct.object,Ct.element;Ct.object,Ct.object,Ct.object,Ct.oneOfType([Ct.array,Ct.element]),Ct.any;function Vy(t){"@babel/helpers - typeof";return Vy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vy(t)}function O1(){return O1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O1.apply(this,arguments)}function Aot(t,e){return Dot(t)||Rot(t,e)||Oot(t,e)||Pot()}function Pot(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oot(t,e){if(t){if(typeof t=="string")return $B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $B(t,e)}}function $B(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rot(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function Dot(t){if(Array.isArray(t))return t}function kB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function NB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kB(Object(n),!0).forEach(function(r){jot(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jot(t,e,n){return e=Mot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mot(t){var e=Fot(t,"string");return Vy(e)=="symbol"?e:e+""}function Fot(t,e){if(Vy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Vy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IB=function(e,n,r,a,s){var o=Math.min(Math.abs(r)/2,Math.abs(a)/2),i=a>=0?1:-1,l=r>=0?1:-1,u=a>=0&&r>=0||a<0&&r<0?1:0,c;if(o>0&&s instanceof Array){for(var d=[0,0,0,0],f=0,h=4;f<h;f++)d[f]=s[f]>o?o:s[f];c="M".concat(e,",").concat(n+i*d[0]),d[0]>0&&(c+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(u,",").concat(e+l*d[0],",").concat(n)),c+="L ".concat(e+r-l*d[1],",").concat(n),d[1]>0&&(c+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(u,`,
        `).concat(e+r,",").concat(n+i*d[1])),c+="L ".concat(e+r,",").concat(n+a-i*d[2]),d[2]>0&&(c+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(u,`,
        `).concat(e+r-l*d[2],",").concat(n+a)),c+="L ".concat(e+l*d[3],",").concat(n+a),d[3]>0&&(c+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(u,`,
        `).concat(e,",").concat(n+a-i*d[3])),c+="Z"}else if(o>0&&s===+s&&s>0){var p=Math.min(o,s);c="M ".concat(e,",").concat(n+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+l*p,",").concat(n,`
            L `).concat(e+r-l*p,",").concat(n,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+r,",").concat(n+i*p,`
            L `).concat(e+r,",").concat(n+a-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e+r-l*p,",").concat(n+a,`
            L `).concat(e+l*p,",").concat(n+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(u,",").concat(e,",").concat(n+a-i*p," Z")}else c="M ".concat(e,",").concat(n," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return c},Lot=function(e,n){if(!e||!n)return!1;var r=e.x,a=e.y,s=n.x,o=n.y,i=n.width,l=n.height;if(Math.abs(i)>0&&Math.abs(l)>0){var u=Math.min(s,s+i),c=Math.max(s,s+i),d=Math.min(o,o+l),f=Math.max(o,o+l);return r>=u&&r<=c&&a>=d&&a<=f}return!1},Bot={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},uR=function(e){var n=NB(NB({},Bot),e),r=N.useRef(),a=N.useState(-1),s=Aot(a,2),o=s[0],i=s[1];N.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var w=r.current.getTotalLength();w&&i(w)}catch{}},[]);var l=n.x,u=n.y,c=n.width,d=n.height,f=n.radius,h=n.className,p=n.animationEasing,g=n.animationDuration,y=n.animationBegin,v=n.isAnimationActive,x=n.isUpdateAnimationActive;if(l!==+l||u!==+u||c!==+c||d!==+d||c===0||d===0)return null;var b=xt("recharts-rectangle",h);return x?K.createElement(mi,{canBegin:o>0,from:{width:c,height:d,x:l,y:u},to:{width:c,height:d,x:l,y:u},duration:g,animationEasing:p,isActive:x},function(w){var C=w.width,_=w.height,$=w.x,k=w.y;return K.createElement(mi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:v,easing:p},K.createElement("path",O1({},nt(n,!0),{className:b,d:IB($,k,C,_,f),ref:r})))}):K.createElement("path",O1({},nt(n,!0),{className:b,d:IB(l,u,c,d,f)}))},zot=["points","className","baseLinePoints","connectNulls"];function ff(){return ff=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ff.apply(this,arguments)}function Uot(t,e){if(t==null)return{};var n=Vot(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Vot(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function TB(t){return qot(t)||Hot(t)||Got(t)||Wot()}function Wot(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Got(t,e){if(t){if(typeof t=="string")return HI(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HI(t,e)}}function Hot(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qot(t){if(Array.isArray(t))return HI(t)}function HI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var EB=function(e){return e&&e.x===+e.x&&e.y===+e.y},Kot=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return e.forEach(function(r){EB(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),EB(e[0])&&n[n.length-1].push(e[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},$g=function(e,n){var r=Kot(e);n&&(r=[r.reduce(function(s,o){return[].concat(TB(s),TB(o))},[])]);var a=r.map(function(s){return s.reduce(function(o,i,l){return"".concat(o).concat(l===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return r.length===1?"".concat(a,"Z"):a},Xot=function(e,n,r){var a=$g(e,r);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat($g(n.reverse(),r).slice(1))},Yot=function(e){var n=e.points,r=e.className,a=e.baseLinePoints,s=e.connectNulls,o=Uot(e,zot);if(!n||!n.length)return null;var i=xt("recharts-polygon",r);if(a&&a.length){var l=o.stroke&&o.stroke!=="none",u=Xot(n,a,s);return K.createElement("g",{className:i},K.createElement("path",ff({},nt(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:u})),l?K.createElement("path",ff({},nt(o,!0),{fill:"none",d:$g(n,s)})):null,l?K.createElement("path",ff({},nt(o,!0),{fill:"none",d:$g(a,s)})):null)}var c=$g(n,s);return K.createElement("path",ff({},nt(o,!0),{fill:c.slice(-1)==="Z"?o.fill:"none",className:i,d:c}))};function qI(){return qI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qI.apply(this,arguments)}var CC=function(e){var n=e.cx,r=e.cy,a=e.r,s=e.className,o=xt("recharts-dot",s);return n===+n&&r===+r&&a===+a?K.createElement("circle",qI({},nt(e,!1),Zw(e),{className:o,cx:n,cy:r,r:a})):null};function Wy(t){"@babel/helpers - typeof";return Wy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wy(t)}var Qot=["x","y","top","left","width","height","className"];function KI(){return KI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KI.apply(this,arguments)}function AB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Jot(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AB(Object(n),!0).forEach(function(r){Zot(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Zot(t,e,n){return e=eit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eit(t){var e=tit(t,"string");return Wy(e)=="symbol"?e:e+""}function tit(t,e){if(Wy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Wy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nit(t,e){if(t==null)return{};var n=rit(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function rit(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var ait=function(e,n,r,a,s,o){return"M".concat(e,",").concat(s,"v").concat(a,"M").concat(o,",").concat(n,"h").concat(r)},sit=function(e){var n=e.x,r=n===void 0?0:n,a=e.y,s=a===void 0?0:a,o=e.top,i=o===void 0?0:o,l=e.left,u=l===void 0?0:l,c=e.width,d=c===void 0?0:c,f=e.height,h=f===void 0?0:f,p=e.className,g=nit(e,Qot),y=Jot({x:r,y:s,top:i,left:u,width:d,height:h},g);return!Le(r)||!Le(s)||!Le(d)||!Le(h)||!Le(i)||!Le(u)?null:K.createElement("path",KI({},nt(y,!0),{className:xt("recharts-cross",p),d:ait(r,s,d,h,i,u)}))},oit=vC,iit=sY,lit=bu;function uit(t,e){return t&&t.length?oit(t,lit(e),iit):void 0}var cit=uit;const dit=Ut(cit);var fit=vC,hit=bu,pit=oY;function mit(t,e){return t&&t.length?fit(t,hit(e),pit):void 0}var git=mit;const yit=Ut(git);var vit=["cx","cy","angle","ticks","axisLine"],xit=["ticks","tick","angle","tickFormatter","stroke"];function dh(t){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dh(t)}function kg(){return kg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kg.apply(this,arguments)}function PB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Du(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PB(Object(n),!0).forEach(function(r){_C(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function OB(t,e){if(t==null)return{};var n=bit(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function bit(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function wit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function RB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XY(r.key),r)}}function Sit(t,e,n){return e&&RB(t.prototype,e),n&&RB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cit(t,e,n){return e=R1(e),_it(t,KY()?Reflect.construct(e,n||[],R1(t).constructor):e.apply(t,n))}function _it(t,e){if(e&&(dh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $it(t)}function $it(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KY=function(){return!!t})()}function R1(t){return R1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},R1(t)}function kit(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XI(t,e)}function XI(t,e){return XI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},XI(t,e)}function _C(t,e,n){return e=XY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XY(t){var e=Nit(t,"string");return dh(e)=="symbol"?e:e+""}function Nit(t,e){if(dh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(dh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $C=function(t){function e(){return wit(this,e),Cit(this,e,arguments)}return kit(e,t),Sit(e,[{key:"getTickValueCoord",value:function(r){var a=r.coordinate,s=this.props,o=s.angle,i=s.cx,l=s.cy;return An(i,l,a,o)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,a;switch(r){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var r=this.props,a=r.cx,s=r.cy,o=r.angle,i=r.ticks,l=dit(i,function(c){return c.coordinate||0}),u=yit(i,function(c){return c.coordinate||0});return{cx:a,cy:s,startAngle:o,endAngle:o,innerRadius:u.coordinate||0,outerRadius:l.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,s=r.cy,o=r.angle,i=r.ticks,l=r.axisLine,u=OB(r,vit),c=i.reduce(function(p,g){return[Math.min(p[0],g.coordinate),Math.max(p[1],g.coordinate)]},[1/0,-1/0]),d=An(a,s,c[0],o),f=An(a,s,c[1],o),h=Du(Du(Du({},nt(u,!1)),{},{fill:"none"},nt(l,!1)),{},{x1:d.x,y1:d.y,x2:f.x,y2:f.y});return K.createElement("line",kg({className:"recharts-polar-radius-axis-line"},h))}},{key:"renderTicks",value:function(){var r=this,a=this.props,s=a.ticks,o=a.tick,i=a.angle,l=a.tickFormatter,u=a.stroke,c=OB(a,xit),d=this.getTickTextAnchor(),f=nt(c,!1),h=nt(o,!1),p=s.map(function(g,y){var v=r.getTickValueCoord(g),x=Du(Du(Du(Du({textAnchor:d,transform:"rotate(".concat(90-i,", ").concat(v.x,", ").concat(v.y,")")},f),{},{stroke:"none",fill:u},h),{},{index:y},v),{},{payload:g});return K.createElement(qt,kg({className:xt("recharts-polar-radius-axis-tick",OY(o)),key:"tick-".concat(g.coordinate)},Gc(r.props,g,y)),e.renderTickItem(o,x,l?l(g.value,y):g.value))});return K.createElement(qt,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var r=this.props,a=r.ticks,s=r.axisLine,o=r.tick;return!a||!a.length?null:K.createElement(qt,{className:xt("recharts-polar-radius-axis",this.props.className)},s&&this.renderAxisLine(),o&&this.renderTicks(),Or.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,a,s){var o;return K.isValidElement(r)?o=K.cloneElement(r,a):vt(r)?o=r(a):o=K.createElement(Hc,kg({},a,{className:"recharts-polar-radius-axis-tick-value"}),s),o}}])}(N.PureComponent);_C($C,"displayName","PolarRadiusAxis");_C($C,"axisType","radiusAxis");_C($C,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function fh(t){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fh(t)}function Qu(){return Qu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qu.apply(this,arguments)}function DB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ju(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?DB(Object(n),!0).forEach(function(r){kC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):DB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Iit(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,QY(r.key),r)}}function Tit(t,e,n){return e&&jB(t.prototype,e),n&&jB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Eit(t,e,n){return e=D1(e),Ait(t,YY()?Reflect.construct(e,n||[],D1(t).constructor):e.apply(t,n))}function Ait(t,e){if(e&&(fh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pit(t)}function Pit(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YY(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YY=function(){return!!t})()}function D1(t){return D1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},D1(t)}function Oit(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&YI(t,e)}function YI(t,e){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},YI(t,e)}function kC(t,e,n){return e=QY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QY(t){var e=Rit(t,"string");return fh(e)=="symbol"?e:e+""}function Rit(t,e){if(fh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(fh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Dit=Math.PI/180,MB=1e-5,NC=function(t){function e(){return Iit(this,e),Eit(this,e,arguments)}return Oit(e,t),Tit(e,[{key:"getTickLineCoord",value:function(r){var a=this.props,s=a.cx,o=a.cy,i=a.radius,l=a.orientation,u=a.tickSize,c=u||8,d=An(s,o,i,r.coordinate),f=An(s,o,i+(l==="inner"?-1:1)*c,r.coordinate);return{x1:d.x,y1:d.y,x2:f.x,y2:f.y}}},{key:"getTickTextAnchor",value:function(r){var a=this.props.orientation,s=Math.cos(-r.coordinate*Dit),o;return s>MB?o=a==="outer"?"start":"end":s<-MB?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.cx,s=r.cy,o=r.radius,i=r.axisLine,l=r.axisLineType,u=ju(ju({},nt(this.props,!1)),{},{fill:"none"},nt(i,!1));if(l==="circle")return K.createElement(CC,Qu({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:s,r:o}));var c=this.props.ticks,d=c.map(function(f){return An(a,s,o,f.coordinate)});return K.createElement(Yot,Qu({className:"recharts-polar-angle-axis-line"},u,{points:d}))}},{key:"renderTicks",value:function(){var r=this,a=this.props,s=a.ticks,o=a.tick,i=a.tickLine,l=a.tickFormatter,u=a.stroke,c=nt(this.props,!1),d=nt(o,!1),f=ju(ju({},c),{},{fill:"none"},nt(i,!1)),h=s.map(function(p,g){var y=r.getTickLineCoord(p),v=r.getTickTextAnchor(p),x=ju(ju(ju({textAnchor:v},c),{},{stroke:"none",fill:u},d),{},{index:g,payload:p,x:y.x2,y:y.y2});return K.createElement(qt,Qu({className:xt("recharts-polar-angle-axis-tick",OY(o)),key:"tick-".concat(p.coordinate)},Gc(r.props,p,g)),i&&K.createElement("line",Qu({className:"recharts-polar-angle-axis-tick-line"},f,y)),o&&e.renderTickItem(o,x,l?l(p.value,g):p.value))});return K.createElement(qt,{className:"recharts-polar-angle-axis-ticks"},h)}},{key:"render",value:function(){var r=this.props,a=r.ticks,s=r.radius,o=r.axisLine;return s<=0||!a||!a.length?null:K.createElement(qt,{className:xt("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,a,s){var o;return K.isValidElement(r)?o=K.cloneElement(r,a):vt(r)?o=r(a):o=K.createElement(Hc,Qu({},a,{className:"recharts-polar-angle-axis-tick-value"}),s),o}}])}(N.PureComponent);kC(NC,"displayName","PolarAngleAxis");kC(NC,"axisType","angleAxis");kC(NC,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var jit=n9,Mit=jit(Object.getPrototypeOf,Object),Fit=Mit,Lit=rl,Bit=Fit,zit=al,Uit="[object Object]",Vit=Function.prototype,Wit=Object.prototype,JY=Vit.toString,Git=Wit.hasOwnProperty,Hit=JY.call(Object);function qit(t){if(!zit(t)||Lit(t)!=Uit)return!1;var e=Bit(t);if(e===null)return!0;var n=Git.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&JY.call(n)==Hit}var Kit=qit;const Xit=Ut(Kit);var Yit=rl,Qit=al,Jit="[object Boolean]";function Zit(t){return t===!0||t===!1||Qit(t)&&Yit(t)==Jit}var elt=Zit;const tlt=Ut(elt);function Gy(t){"@babel/helpers - typeof";return Gy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gy(t)}function j1(){return j1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},j1.apply(this,arguments)}function nlt(t,e){return olt(t)||slt(t,e)||alt(t,e)||rlt()}function rlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function alt(t,e){if(t){if(typeof t=="string")return FB(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return FB(t,e)}}function FB(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function slt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function olt(t){if(Array.isArray(t))return t}function LB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function BB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LB(Object(n),!0).forEach(function(r){ilt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ilt(t,e,n){return e=llt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function llt(t){var e=ult(t,"string");return Gy(e)=="symbol"?e:e+""}function ult(t,e){if(Gy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Gy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zB=function(e,n,r,a,s){var o=r-a,i;return i="M ".concat(e,",").concat(n),i+="L ".concat(e+r,",").concat(n),i+="L ".concat(e+r-o/2,",").concat(n+s),i+="L ".concat(e+r-o/2-a,",").concat(n+s),i+="L ".concat(e,",").concat(n," Z"),i},clt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dlt=function(e){var n=BB(BB({},clt),e),r=N.useRef(),a=N.useState(-1),s=nlt(a,2),o=s[0],i=s[1];N.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&i(b)}catch{}},[]);var l=n.x,u=n.y,c=n.upperWidth,d=n.lowerWidth,f=n.height,h=n.className,p=n.animationEasing,g=n.animationDuration,y=n.animationBegin,v=n.isUpdateAnimationActive;if(l!==+l||u!==+u||c!==+c||d!==+d||f!==+f||c===0&&d===0||f===0)return null;var x=xt("recharts-trapezoid",h);return v?K.createElement(mi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:l,y:u},to:{upperWidth:c,lowerWidth:d,height:f,x:l,y:u},duration:g,animationEasing:p,isActive:v},function(b){var w=b.upperWidth,C=b.lowerWidth,_=b.height,$=b.x,k=b.y;return K.createElement(mi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:p},K.createElement("path",j1({},nt(n,!0),{className:x,d:zB($,k,w,C,_),ref:r})))}):K.createElement("g",null,K.createElement("path",j1({},nt(n,!0),{className:x,d:zB(l,u,c,d,f)})))},flt=["option","shapeType","propTransformer","activeClassName","isActive"];function Hy(t){"@babel/helpers - typeof";return Hy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hy(t)}function hlt(t,e){if(t==null)return{};var n=plt(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function plt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function UB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function M1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UB(Object(n),!0).forEach(function(r){mlt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function mlt(t,e,n){return e=glt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function glt(t){var e=ylt(t,"string");return Hy(e)=="symbol"?e:e+""}function ylt(t,e){if(Hy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Hy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vlt(t,e){return M1(M1({},e),t)}function xlt(t,e){return t==="symbols"}function VB(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return K.createElement(uR,n);case"trapezoid":return K.createElement(dlt,n);case"sector":return K.createElement(jY,n);case"symbols":if(xlt(e))return K.createElement(NO,n);break;default:return null}}function blt(t){return N.isValidElement(t)?t.props:t}function ZY(t){var e=t.option,n=t.shapeType,r=t.propTransformer,a=r===void 0?vlt:r,s=t.activeClassName,o=s===void 0?"recharts-active-shape":s,i=t.isActive,l=hlt(t,flt),u;if(N.isValidElement(e))u=N.cloneElement(e,M1(M1({},l),blt(e)));else if(vt(e))u=e(l);else if(Xit(e)&&!tlt(e)){var c=a(e,l);u=K.createElement(VB,{shapeType:n,elementProps:c})}else{var d=l;u=K.createElement(VB,{shapeType:n,elementProps:d})}return i?K.createElement(qt,{className:o},u):u}function IC(t,e){return e!=null&&"trapezoids"in t.props}function TC(t,e){return e!=null&&"sectors"in t.props}function qy(t,e){return e!=null&&"points"in t.props}function wlt(t,e){var n,r,a=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,s=t.y===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.y)||t.y===e.y;return a&&s}function Slt(t,e){var n=t.endAngle===e.endAngle,r=t.startAngle===e.startAngle;return n&&r}function Clt(t,e){var n=t.x===e.x,r=t.y===e.y,a=t.z===e.z;return n&&r&&a}function _lt(t,e){var n;return IC(t,e)?n=wlt:TC(t,e)?n=Slt:qy(t,e)&&(n=Clt),n}function $lt(t,e){var n;return IC(t,e)?n="trapezoids":TC(t,e)?n="sectors":qy(t,e)&&(n="points"),n}function klt(t,e){if(IC(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(TC(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return qy(t,e)?e.payload:{}}function Nlt(t){var e=t.activeTooltipItem,n=t.graphicalItem,r=t.itemData,a=$lt(n,e),s=klt(n,e),o=r.filter(function(l,u){var c=hb(s,l),d=n.props[a].filter(function(p){var g=_lt(n,e);return g(p,e)}),f=n.props[a].indexOf(d[d.length-1]),h=u===f;return c&&h}),i=r.indexOf(o[o.length-1]);return i}var rw;function hh(t){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hh(t)}function hf(){return hf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hf.apply(this,arguments)}function WB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function In(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WB(Object(n),!0).forEach(function(r){Vs(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ilt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tQ(r.key),r)}}function Tlt(t,e,n){return e&&GB(t.prototype,e),n&&GB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Elt(t,e,n){return e=F1(e),Alt(t,eQ()?Reflect.construct(e,n||[],F1(t).constructor):e.apply(t,n))}function Alt(t,e){if(e&&(hh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Plt(t)}function Plt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function eQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eQ=function(){return!!t})()}function F1(t){return F1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},F1(t)}function Olt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QI(t,e)}function QI(t,e){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},QI(t,e)}function Vs(t,e,n){return e=tQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tQ(t){var e=Rlt(t,"string");return hh(e)=="symbol"?e:e+""}function Rlt(t,e){if(hh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(hh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ol=function(t){function e(n){var r;return Ilt(this,e),r=Elt(this,e,[n]),Vs(r,"pieRef",null),Vs(r,"sectorRefs",[]),Vs(r,"id",Jp("recharts-pie-")),Vs(r,"handleAnimationEnd",function(){var a=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),vt(a)&&a()}),Vs(r,"handleAnimationStart",function(){var a=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),vt(a)&&a()}),r.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},r}return Olt(e,t),Tlt(e,[{key:"isActiveIndex",value:function(r){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(r)!==-1:r===a}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.label,i=s.labelLine,l=s.dataKey,u=s.valueKey,c=nt(this.props,!1),d=nt(o,!1),f=nt(i,!1),h=o&&o.offsetRadius||20,p=r.map(function(g,y){var v=(g.startAngle+g.endAngle)/2,x=An(g.cx,g.cy,g.outerRadius+h,v),b=In(In(In(In({},c),g),{},{stroke:"none"},d),{},{index:y,textAnchor:e.getTextAnchor(x.x,g.cx)},x),w=In(In(In(In({},c),g),{},{fill:"none",stroke:g.fill},f),{},{index:y,points:[An(g.cx,g.cy,g.outerRadius,v),x]}),C=l;return ht(l)&&ht(u)?C="value":ht(l)&&(C=u),K.createElement(qt,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},i&&e.renderLabelLineItem(i,w,"line"),e.renderLabelItem(o,b,wr(g,C)))});return K.createElement(qt,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(r){var a=this,s=this.props,o=s.activeShape,i=s.blendStroke,l=s.inactiveShape;return r.map(function(u,c){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&r.length!==1)return null;var d=a.isActiveIndex(c),f=l&&a.hasActiveIndex()?l:null,h=d?o:f,p=In(In({},u),{},{stroke:i?u.fill:u.stroke,tabIndex:-1});return K.createElement(qt,hf({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},Gc(a.props,u,c),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(c)}),K.createElement(ZY,hf({option:h,isActive:d,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,a=this.props,s=a.sectors,o=a.isAnimationActive,i=a.animationBegin,l=a.animationDuration,u=a.animationEasing,c=a.animationId,d=this.state,f=d.prevSectors,h=d.prevIsAnimationActive;return K.createElement(mi,{begin:i,duration:l,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(c,"-").concat(h),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var g=p.t,y=[],v=s&&s[0],x=v.startAngle;return s.forEach(function(b,w){var C=f&&f[w],_=w>0?bs(b,"paddingAngle",0):0;if(C){var $=ds(C.endAngle-C.startAngle,b.endAngle-b.startAngle),k=In(In({},b),{},{startAngle:x+_,endAngle:x+$(g)+_});y.push(k),x=k.endAngle}else{var A=b.endAngle,P=b.startAngle,O=ds(0,A-P),R=O(g),B=In(In({},b),{},{startAngle:x+_,endAngle:x+R+_});y.push(B),x=B.endAngle}}),K.createElement(qt,null,r.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(r){var a=this;r.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,a=r.sectors,s=r.isAnimationActive,o=this.state.prevSectors;return s&&a&&a.length&&(!o||!hb(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,a=this.props,s=a.hide,o=a.sectors,i=a.className,l=a.label,u=a.cx,c=a.cy,d=a.innerRadius,f=a.outerRadius,h=a.isAnimationActive,p=this.state.isAnimationFinished;if(s||!o||!o.length||!Le(u)||!Le(c)||!Le(d)||!Le(f))return null;var g=xt("recharts-pie",i);return K.createElement(qt,{tabIndex:this.props.rootTabIndex,className:g,ref:function(v){r.pieRef=v}},this.renderSectors(),l&&this.renderLabels(o),Or.renderCallByParent(this.props,null,!1),(!h||p)&&zi.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return a.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:r.sectors!==a.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,a){return r>a?"start":r<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,a,s){if(K.isValidElement(r))return K.cloneElement(r,a);if(vt(r))return r(a);var o=xt("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return K.createElement(T1,hf({},a,{key:s,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(r,a,s){if(K.isValidElement(r))return K.cloneElement(r,a);var o=s;if(vt(r)&&(o=r(a),K.isValidElement(o)))return o;var i=xt("recharts-pie-label-text",typeof r!="boolean"&&!vt(r)?r.className:"");return K.createElement(Hc,hf({},a,{alignmentBaseline:"middle",className:i}),o)}}])}(N.PureComponent);rw=ol;Vs(ol,"displayName","Pie");Vs(ol,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!ti.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Vs(ol,"parseDeltaAngle",function(t,e){var n=Ca(e-t),r=Math.min(Math.abs(e-t),360);return n*r});Vs(ol,"getRealPieData",function(t){var e=t.data,n=t.children,r=nt(t,!1),a=ws(n,dC);return e&&e.length?e.map(function(s,o){return In(In(In({payload:s},r),s),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(s){return In(In({},r),s.props)}):[]});Vs(ol,"parseCoordinateOfPie",function(t,e){var n=e.top,r=e.left,a=e.width,s=e.height,o=PY(a,s),i=r+_a(t.cx,a,a/2),l=n+_a(t.cy,s,s/2),u=_a(t.innerRadius,o,0),c=_a(t.outerRadius,o,o*.8),d=t.maxRadius||Math.sqrt(a*a+s*s)/2;return{cx:i,cy:l,innerRadius:u,outerRadius:c,maxRadius:d}});Vs(ol,"getComposedData",function(t){var e=t.item,n=t.offset,r=e.type.defaultProps!==void 0?In(In({},e.type.defaultProps),e.props):e.props,a=rw.getRealPieData(r);if(!a||!a.length)return null;var s=r.cornerRadius,o=r.startAngle,i=r.endAngle,l=r.paddingAngle,u=r.dataKey,c=r.nameKey,d=r.valueKey,f=r.tooltipType,h=Math.abs(r.minAngle),p=rw.parseCoordinateOfPie(r,n),g=rw.parseDeltaAngle(o,i),y=Math.abs(g),v=u;ht(u)&&ht(d)?(Li(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):ht(u)&&(Li(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=d);var x=a.filter(function(k){return wr(k,v,0)!==0}).length,b=(y>=360?x:x-1)*l,w=y-x*h-b,C=a.reduce(function(k,A){var P=wr(A,v,0);return k+(Le(P)?P:0)},0),_;if(C>0){var $;_=a.map(function(k,A){var P=wr(k,v,0),O=wr(k,c,A),R=(Le(P)?P:0)/C,B;A?B=$.endAngle+Ca(g)*l*(P!==0?1:0):B=o;var F=B+Ca(g)*((P!==0?h:0)+R*w),L=(B+F)/2,H=(p.innerRadius+p.outerRadius)/2,te=[{name:O,value:P,payload:k,dataKey:v,type:f}],V=An(p.cx,p.cy,H,L);return $=In(In(In({percent:R,cornerRadius:s,name:O,tooltipPayload:te,midAngle:L,middleRadius:H,tooltipPosition:V},k),p),{},{value:wr(k,v),startAngle:B,endAngle:F,payload:k,paddingAngle:Ca(g)*l}),$})}return In(In({},p),{},{sectors:_,data:a})});var Dlt=Math.ceil,jlt=Math.max;function Mlt(t,e,n,r){for(var a=-1,s=jlt(Dlt((e-t)/(n||1)),0),o=Array(s);s--;)o[r?s:++a]=t,t+=n;return o}var Flt=Mlt,Llt=b9,HB=1/0,Blt=17976931348623157e292;function zlt(t){if(!t)return t===0?t:0;if(t=Llt(t),t===HB||t===-HB){var e=t<0?-1:1;return e*Blt}return t===t?t:0}var Ult=zlt,Vlt=Flt,Wlt=cC,T$=Ult;function Glt(t){return function(e,n,r){return r&&typeof r!="number"&&Wlt(e,n,r)&&(n=r=void 0),e=T$(e),n===void 0?(n=e,e=0):n=T$(n),r=r===void 0?e<n?1:-1:T$(r),Vlt(e,n,r,t)}}var Hlt=Glt,qlt=Hlt,Klt=qlt(),Xlt=Klt;const L1=Ut(Xlt);function Ky(t){"@babel/helpers - typeof";return Ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ky(t)}function qB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function KB(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qB(Object(n),!0).forEach(function(r){nQ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function nQ(t,e,n){return e=Ylt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ylt(t){var e=Qlt(t,"string");return Ky(e)=="symbol"?e:e+""}function Qlt(t,e){if(Ky(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ky(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jlt=["Webkit","Moz","O","ms"],Zlt=function(e,n){var r=e.replace(/(\w)/,function(s){return s.toUpperCase()}),a=Jlt.reduce(function(s,o){return KB(KB({},s),{},nQ({},o+r,n))},{});return a[e]=n,a};function ph(t){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ph(t)}function B1(){return B1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},B1.apply(this,arguments)}function XB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function E$(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XB(Object(n),!0).forEach(function(r){ls(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function eut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YB(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,aQ(r.key),r)}}function tut(t,e,n){return e&&YB(t.prototype,e),n&&YB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function nut(t,e,n){return e=z1(e),rut(t,rQ()?Reflect.construct(e,n||[],z1(t).constructor):e.apply(t,n))}function rut(t,e){if(e&&(ph(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aut(t)}function aut(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rQ=function(){return!!t})()}function z1(t){return z1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},z1(t)}function sut(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JI(t,e)}function JI(t,e){return JI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},JI(t,e)}function ls(t,e,n){return e=aQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aQ(t){var e=out(t,"string");return ph(e)=="symbol"?e:e+""}function out(t,e){if(ph(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ph(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var iut=function(e){var n=e.data,r=e.startIndex,a=e.endIndex,s=e.x,o=e.width,i=e.travellerWidth;if(!n||!n.length)return{};var l=n.length,u=Sg().domain(L1(0,l)).range([s,s+o-i]),c=u.domain().map(function(d){return u(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(r),endX:u(a),scale:u,scaleValues:c}},QB=function(e){return e.changedTouches&&!!e.changedTouches.length},mh=function(t){function e(n){var r;return eut(this,e),r=nut(this,e,[n]),ls(r,"handleDrag",function(a){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(a):r.state.isSlideMoving&&r.handleSlideDrag(a)}),ls(r,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&r.handleDrag(a.changedTouches[0])}),ls(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=r.props,s=a.endIndex,o=a.onDragEnd,i=a.startIndex;o==null||o({endIndex:s,startIndex:i})}),r.detachDragEndListener()}),ls(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),ls(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),ls(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),ls(r,"handleSlideDragStart",function(a){var s=QB(a)?a.changedTouches[0]:a;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return sut(e,t),tut(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var a=r.startX,s=r.endX,o=this.state.scaleValues,i=this.props,l=i.gap,u=i.data,c=u.length-1,d=Math.min(a,s),f=Math.max(a,s),h=e.getIndexInRange(o,d),p=e.getIndexInRange(o,f);return{startIndex:h-h%l,endIndex:p===c?c:p-p%l}}},{key:"getTextOfTick",value:function(r){var a=this.props,s=a.data,o=a.tickFormatter,i=a.dataKey,l=wr(s[r],i,r);return vt(o)?o(l,r):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var a=this.state,s=a.slideMoveStartX,o=a.startX,i=a.endX,l=this.props,u=l.x,c=l.width,d=l.travellerWidth,f=l.startIndex,h=l.endIndex,p=l.onChange,g=r.pageX-s;g>0?g=Math.min(g,u+c-d-i,u+c-d-o):g<0&&(g=Math.max(g,u-o,u-i));var y=this.getIndex({startX:o+g,endX:i+g});(y.startIndex!==f||y.endIndex!==h)&&p&&p(y),this.setState({startX:o+g,endX:i+g,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,a){var s=QB(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var a=this.state,s=a.brushMoveStartX,o=a.movingTravellerId,i=a.endX,l=a.startX,u=this.state[o],c=this.props,d=c.x,f=c.width,h=c.travellerWidth,p=c.onChange,g=c.gap,y=c.data,v={startX:this.state.startX,endX:this.state.endX},x=r.pageX-s;x>0?x=Math.min(x,d+f-h-u):x<0&&(x=Math.max(x,d-u)),v[o]=u+x;var b=this.getIndex(v),w=b.startIndex,C=b.endIndex,_=function(){var k=y.length-1;return o==="startX"&&(i>l?w%g===0:C%g===0)||i<l&&C===k||o==="endX"&&(i>l?C%g===0:w%g===0)||i>l&&C===k};this.setState(ls(ls({},o,u+x),"brushMoveStartX",r.pageX),function(){p&&_()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(r,a){var s=this,o=this.state,i=o.scaleValues,l=o.startX,u=o.endX,c=this.state[a],d=i.indexOf(c);if(d!==-1){var f=d+r;if(!(f===-1||f>=i.length)){var h=i[f];a==="startX"&&h>=u||a==="endX"&&h<=l||this.setState(ls({},a,h),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,a=r.x,s=r.y,o=r.width,i=r.height,l=r.fill,u=r.stroke;return K.createElement("rect",{stroke:u,fill:l,x:a,y:s,width:o,height:i})}},{key:"renderPanorama",value:function(){var r=this.props,a=r.x,s=r.y,o=r.width,i=r.height,l=r.data,u=r.children,c=r.padding,d=N.Children.only(u);return d?K.cloneElement(d,{x:a,y:s,width:o,height:i,margin:c,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(r,a){var s,o,i=this,l=this.props,u=l.y,c=l.travellerWidth,d=l.height,f=l.traveller,h=l.ariaLabel,p=l.data,g=l.startIndex,y=l.endIndex,v=Math.max(r,this.props.x),x=E$(E$({},nt(this.props,!1)),{},{x:v,y:u,width:c,height:d}),b=h||"Min value: ".concat((s=p[g])===null||s===void 0?void 0:s.name,", Max value: ").concat((o=p[y])===null||o===void 0?void 0:o.name);return K.createElement(qt,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(C){["ArrowLeft","ArrowRight"].includes(C.key)&&(C.preventDefault(),C.stopPropagation(),i.handleTravellerMoveKeyboard(C.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(f,x))}},{key:"renderSlide",value:function(r,a){var s=this.props,o=s.y,i=s.height,l=s.stroke,u=s.travellerWidth,c=Math.min(r,a)+u,d=Math.max(Math.abs(a-r)-u,0);return K.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:c,y:o,width:d,height:i})}},{key:"renderText",value:function(){var r=this.props,a=r.startIndex,s=r.endIndex,o=r.y,i=r.height,l=r.travellerWidth,u=r.stroke,c=this.state,d=c.startX,f=c.endX,h=5,p={pointerEvents:"none",fill:u};return K.createElement(qt,{className:"recharts-brush-texts"},K.createElement(Hc,B1({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,f)-h,y:o+i/2},p),this.getTextOfTick(a)),K.createElement(Hc,B1({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,f)+l+h,y:o+i/2},p),this.getTextOfTick(s)))}},{key:"render",value:function(){var r=this.props,a=r.data,s=r.className,o=r.children,i=r.x,l=r.y,u=r.width,c=r.height,d=r.alwaysShowText,f=this.state,h=f.startX,p=f.endX,g=f.isTextActive,y=f.isSlideMoving,v=f.isTravellerMoving,x=f.isTravellerFocused;if(!a||!a.length||!Le(i)||!Le(l)||!Le(u)||!Le(c)||u<=0||c<=0)return null;var b=xt("recharts-brush",s),w=K.Children.count(o)===1,C=Zlt("userSelect","none");return K.createElement(qt,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:C},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(h,p),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(p,"endX"),(g||y||v||x||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var a=r.x,s=r.y,o=r.width,i=r.height,l=r.stroke,u=Math.floor(s+i/2)-1;return K.createElement(K.Fragment,null,K.createElement("rect",{x:a,y:s,width:o,height:i,fill:l,stroke:"none"}),K.createElement("line",{x1:a+1,y1:u,x2:a+o-1,y2:u,fill:"none",stroke:"#fff"}),K.createElement("line",{x1:a+1,y1:u+2,x2:a+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,a){var s;return K.isValidElement(r)?s=K.cloneElement(r,a):vt(r)?s=r(a):s=e.renderDefaultTraveller(a),s}},{key:"getDerivedStateFromProps",value:function(r,a){var s=r.data,o=r.width,i=r.x,l=r.travellerWidth,u=r.updateId,c=r.startIndex,d=r.endIndex;if(s!==a.prevData||u!==a.prevUpdateId)return E$({prevData:s,prevTravellerWidth:l,prevUpdateId:u,prevX:i,prevWidth:o},s&&s.length?iut({data:s,width:o,x:i,travellerWidth:l,startIndex:c,endIndex:d}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||i!==a.prevX||l!==a.prevTravellerWidth)){a.scale.range([i,i+o-l]);var f=a.scale.domain().map(function(h){return a.scale(h)});return{prevData:s,prevTravellerWidth:l,prevUpdateId:u,prevX:i,prevWidth:o,startX:a.scale(r.startIndex),endX:a.scale(r.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(r,a){for(var s=r.length,o=0,i=s-1;i-o>1;){var l=Math.floor((o+i)/2);r[l]>a?i=l:o=l}return a>=r[i]?i:o}}])}(N.PureComponent);ls(mh,"displayName","Brush");ls(mh,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var lut=DO;function uut(t,e){var n;return lut(t,function(r,a,s){return n=e(r,a,s),!n}),!!n}var cut=uut,dut=KX,fut=bu,hut=cut,put=as,mut=cC;function gut(t,e,n){var r=put(t)?dut:hut;return n&&mut(t,e,n)&&(e=void 0),r(t,fut(e))}var yut=gut;const vut=Ut(yut);var ri=function(e,n){var r=e.alwaysShow,a=e.ifOverflow;return r&&(a="extendDomain"),a===n},JB=m9;function xut(t,e,n){e=="__proto__"&&JB?JB(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var but=xut,wut=but,Sut=h9,Cut=bu;function _ut(t,e){var n={};return e=Cut(e),Sut(t,function(r,a,s){wut(n,a,e(r,a,s))}),n}var $ut=_ut;const kut=Ut($ut);function Nut(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}var Iut=Nut,Tut=DO;function Eut(t,e){var n=!0;return Tut(t,function(r,a,s){return n=!!e(r,a,s),n}),n}var Aut=Eut,Put=Iut,Out=Aut,Rut=bu,Dut=as,jut=cC;function Mut(t,e,n){var r=Dut(t)?Put:Out;return n&&jut(t,e,n)&&(e=void 0),r(t,Rut(e))}var Fut=Mut;const Lut=Ut(Fut);var But=["x","y"];function Xy(t){"@babel/helpers - typeof";return Xy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xy(t)}function ZI(){return ZI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ZI.apply(this,arguments)}function ZB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function Vm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZB(Object(n),!0).forEach(function(r){zut(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZB(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function zut(t,e,n){return e=Uut(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uut(t){var e=Vut(t,"string");return Xy(e)=="symbol"?e:e+""}function Vut(t,e){if(Xy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Xy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wut(t,e){if(t==null)return{};var n=Gut(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Gut(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Hut(t,e){var n=t.x,r=t.y,a=Wut(t,But),s="".concat(n),o=parseInt(s,10),i="".concat(r),l=parseInt(i,10),u="".concat(e.height||a.height),c=parseInt(u,10),d="".concat(e.width||a.width),f=parseInt(d,10);return Vm(Vm(Vm(Vm(Vm({},e),a),o?{x:o}:{}),l?{y:l}:{}),{},{height:c,width:f,name:e.name,radius:e.radius})}function e4(t){return K.createElement(ZY,ZI({shapeType:"rectangle",propTransformer:Hut,activeClassName:"recharts-active-bar"},t))}var qut=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,a){if(typeof e=="number")return e;var s=typeof r=="number";return s?e(r,a):(s||Kc(),n)}},Kut=["value","background"],sQ;function gh(t){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gh(t)}function Xut(t,e){if(t==null)return{};var n=Yut(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Yut(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function U1(){return U1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},U1.apply(this,arguments)}function t4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ur(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?t4(Object(n),!0).forEach(function(r){Rl(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):t4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Qut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,iQ(r.key),r)}}function Jut(t,e,n){return e&&n4(t.prototype,e),n&&n4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zut(t,e,n){return e=V1(e),ect(t,oQ()?Reflect.construct(e,n||[],V1(t).constructor):e.apply(t,n))}function ect(t,e){if(e&&(gh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tct(t)}function tct(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oQ=function(){return!!t})()}function V1(t){return V1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},V1(t)}function nct(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eT(t,e)}function eT(t,e){return eT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},eT(t,e)}function Rl(t,e,n){return e=iQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iQ(t){var e=rct(t,"string");return gh(e)=="symbol"?e:e+""}function rct(t,e){if(gh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(gh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mb=function(t){function e(){var n;Qut(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=Zut(this,e,[].concat(a)),Rl(n,"state",{isAnimationFinished:!1}),Rl(n,"id",Jp("recharts-bar-")),Rl(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),o&&o()}),Rl(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),o&&o()}),n}return nct(e,t),Jut(e,[{key:"renderRectanglesStatically",value:function(r){var a=this,s=this.props,o=s.shape,i=s.dataKey,l=s.activeIndex,u=s.activeBar,c=nt(this.props,!1);return r&&r.map(function(d,f){var h=f===l,p=h?u:o,g=ur(ur(ur({},c),d),{},{isActive:h,option:p,index:f,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return K.createElement(qt,U1({className:"recharts-bar-rectangle"},Gc(a.props,d,f),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value)}),K.createElement(e4,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,a=this.props,s=a.data,o=a.layout,i=a.isAnimationActive,l=a.animationBegin,u=a.animationDuration,c=a.animationEasing,d=a.animationId,f=this.state.prevData;return K.createElement(mi,{begin:l,duration:u,isActive:i,easing:c,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var p=h.t,g=s.map(function(y,v){var x=f&&f[v];if(x){var b=ds(x.x,y.x),w=ds(x.y,y.y),C=ds(x.width,y.width),_=ds(x.height,y.height);return ur(ur({},y),{},{x:b(p),y:w(p),width:C(p),height:_(p)})}if(o==="horizontal"){var $=ds(0,y.height),k=$(p);return ur(ur({},y),{},{y:y.y+y.height-k,height:k})}var A=ds(0,y.width),P=A(p);return ur(ur({},y),{},{width:P})});return K.createElement(qt,null,r.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var r=this.props,a=r.data,s=r.isAnimationActive,o=this.state.prevData;return s&&a&&a.length&&(!o||!hb(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var r=this,a=this.props,s=a.data,o=a.dataKey,i=a.activeIndex,l=nt(this.props.background,!1);return s.map(function(u,c){u.value;var d=u.background,f=Xut(u,Kut);if(!d)return null;var h=ur(ur(ur(ur(ur({},f),{},{fill:"#eee"},d),l),Gc(r.props,u,c)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:o,index:c,className:"recharts-bar-background-rectangle"});return K.createElement(e4,U1({key:"background-bar-".concat(c),option:r.props.background,isActive:c===i},h))})}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.data,i=s.xAxis,l=s.yAxis,u=s.layout,c=s.children,d=ws(c,pb);if(!d)return null;var f=u==="vertical"?o[0].height/2:o[0].width/2,h=function(y,v){var x=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:x,errorVal:wr(y,v)}},p={clipPath:r?"url(#clipPath-".concat(a,")"):null};return K.createElement(qt,p,d.map(function(g){return K.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:i,yAxis:l,layout:u,offset:f,dataPointFormatter:h})}))}},{key:"render",value:function(){var r=this.props,a=r.hide,s=r.data,o=r.className,i=r.xAxis,l=r.yAxis,u=r.left,c=r.top,d=r.width,f=r.height,h=r.isAnimationActive,p=r.background,g=r.id;if(a||!s||!s.length)return null;var y=this.state.isAnimationFinished,v=xt("recharts-bar",o),x=i&&i.allowDataOverflow,b=l&&l.allowDataOverflow,w=x||b,C=ht(g)?this.id:g;return K.createElement(qt,{className:v},x||b?K.createElement("defs",null,K.createElement("clipPath",{id:"clipPath-".concat(C)},K.createElement("rect",{x:x?u:u-d/2,y:b?c:c-f/2,width:x?d:d*2,height:b?f:f*2}))):null,K.createElement(qt,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(C,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,C),(!h||y)&&zi.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:a.curData}:r.data!==a.curData?{curData:r.data}:null}}])}(N.PureComponent);sQ=mb;Rl(mb,"displayName","Bar");Rl(mb,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!ti.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Rl(mb,"getComposedData",function(t){var e=t.props,n=t.item,r=t.barPosition,a=t.bandSize,s=t.xAxis,o=t.yAxis,i=t.xAxisTicks,l=t.yAxisTicks,u=t.stackedData,c=t.dataStartIndex,d=t.displayedData,f=t.offset,h=Grt(r,n);if(!h)return null;var p=e.layout,g=n.type.defaultProps,y=g!==void 0?ur(ur({},g),n.props):n.props,v=y.dataKey,x=y.children,b=y.minPointSize,w=p==="horizontal"?o:s,C=u?w.scale.domain():null,_=Jrt({numericAxis:w}),$=ws(x,dC),k=d.map(function(A,P){var O,R,B,F,L,H;u?O=Hrt(u[c+P],C):(O=wr(A,v),Array.isArray(O)||(O=[_,O]));var te=qut(b,sQ.defaultProps.minPointSize)(O[1],P);if(p==="horizontal"){var V,Q=[o.scale(O[0]),o.scale(O[1])],se=Q[0],le=Q[1];R=GL({axis:s,ticks:i,bandSize:a,offset:h.offset,entry:A,index:P}),B=(V=le??se)!==null&&V!==void 0?V:void 0,F=h.size;var ue=se-le;if(L=Number.isNaN(ue)?0:ue,H={x:R,y:o.y,width:F,height:o.height},Math.abs(te)>0&&Math.abs(L)<Math.abs(te)){var ce=Ca(L||te)*(Math.abs(te)-Math.abs(L));B-=ce,L+=ce}}else{var re=[s.scale(O[0]),s.scale(O[1])],ge=re[0],Se=re[1];if(R=ge,B=GL({axis:o,ticks:l,bandSize:a,offset:h.offset,entry:A,index:P}),F=Se-ge,L=h.size,H={x:s.x,y:B,width:s.width,height:L},Math.abs(te)>0&&Math.abs(F)<Math.abs(te)){var Ne=Ca(F||te)*(Math.abs(te)-Math.abs(F));F+=Ne}}return ur(ur(ur({},A),{},{x:R,y:B,width:F,height:L,value:u?O:O[1],payload:A,background:H},$&&$[P]&&$[P].props),{},{tooltipPayload:[EY(n,A)],tooltipPosition:{x:R+F/2,y:B+L/2}})});return ur({data:k,layout:p},f)});function Yy(t){"@babel/helpers - typeof";return Yy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yy(t)}function act(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lQ(r.key),r)}}function sct(t,e,n){return e&&r4(t.prototype,e),n&&r4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function a4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function go(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?a4(Object(n),!0).forEach(function(r){EC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function EC(t,e,n){return e=lQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lQ(t){var e=oct(t,"string");return Yy(e)=="symbol"?e:e+""}function oct(t,e){if(Yy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Yy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ict=function(e,n,r,a,s){var o=e.width,i=e.height,l=e.layout,u=e.children,c=Object.keys(n),d={left:r.left,leftMirror:r.left,right:o-r.right,rightMirror:o-r.right,top:r.top,topMirror:r.top,bottom:i-r.bottom,bottomMirror:i-r.bottom},f=!!cs(u,mb);return c.reduce(function(h,p){var g=n[p],y=g.orientation,v=g.domain,x=g.padding,b=x===void 0?{}:x,w=g.mirror,C=g.reversed,_="".concat(y).concat(w?"Mirror":""),$,k,A,P,O;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var R=v[1]-v[0],B=1/0,F=g.categoricalDomain.sort();if(F.forEach(function(re,ge){ge>0&&(B=Math.min((re||0)-(F[ge-1]||0),B))}),Number.isFinite(B)){var L=B/R,H=g.layout==="vertical"?r.height:r.width;if(g.padding==="gap"&&($=L*H/2),g.padding==="no-gap"){var te=_a(e.barCategoryGap,L*H),V=L*H/2;$=V-te-(V-te)/H*te}}}a==="xAxis"?k=[r.left+(b.left||0)+($||0),r.left+r.width-(b.right||0)-($||0)]:a==="yAxis"?k=l==="horizontal"?[r.top+r.height-(b.bottom||0),r.top+(b.top||0)]:[r.top+(b.top||0)+($||0),r.top+r.height-(b.bottom||0)-($||0)]:k=g.range,C&&(k=[k[1],k[0]]);var Q=kY(g,s,f),se=Q.scale,le=Q.realScaleType;se.domain(v).range(k),NY(se);var ue=IY(se,go(go({},g),{},{realScaleType:le}));a==="xAxis"?(O=y==="top"&&!w||y==="bottom"&&w,A=r.left,P=d[_]-O*g.height):a==="yAxis"&&(O=y==="left"&&!w||y==="right"&&w,A=d[_]-O*g.width,P=r.top);var ce=go(go(go({},g),ue),{},{realScaleType:le,x:A,y:P,scale:se,width:a==="xAxis"?r.width:g.width,height:a==="yAxis"?r.height:g.height});return ce.bandSize=k1(ce,ue),!g.hide&&a==="xAxis"?d[_]+=(O?-1:1)*ce.height:g.hide||(d[_]+=(O?-1:1)*ce.width),go(go({},h),{},EC({},p,ce))},{})},uQ=function(e,n){var r=e.x,a=e.y,s=n.x,o=n.y;return{x:Math.min(r,s),y:Math.min(a,o),width:Math.abs(s-r),height:Math.abs(o-a)}},lct=function(e){var n=e.x1,r=e.y1,a=e.x2,s=e.y2;return uQ({x:n,y:r},{x:a,y:s})},cQ=function(){function t(e){act(this,t),this.scale=e}return sct(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.bandAware,s=r.position;if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+o}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(n)+i}default:return this.scale(n)}if(a){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),a=r[0],s=r[r.length-1];return a<=s?n>=a&&n<=s:n>=s&&n<=a}}],[{key:"create",value:function(n){return new t(n)}}])}();EC(cQ,"EPS",1e-4);var cR=function(e){var n=Object.keys(e).reduce(function(r,a){return go(go({},r),{},EC({},a,cQ.create(e[a])))},{});return go(go({},n),{},{apply:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.bandAware,i=s.position;return kut(a,function(l,u){return n[u].apply(l,{bandAware:o,position:i})})},isInRange:function(a){return Lut(a,function(s,o){return n[o].isInRange(s)})}})};function uct(t){return(t%180+180)%180}var cct=function(e){var n=e.width,r=e.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=uct(a),o=s*Math.PI/180,i=Math.atan(r/n),l=o>i&&o<Math.PI-i?r/Math.sin(o):n/Math.cos(o);return Math.abs(l)},dct=M5e(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),dQ=N.createContext(void 0),fQ=N.createContext(void 0),hQ=N.createContext(void 0),fct=N.createContext({}),pQ=N.createContext(void 0),mQ=N.createContext(0),gQ=N.createContext(0),s4=function(e){var n=e.state,r=n.xAxisMap,a=n.yAxisMap,s=n.offset,o=e.clipPathId,i=e.children,l=e.width,u=e.height,c=dct(s);return K.createElement(dQ.Provider,{value:r},K.createElement(fQ.Provider,{value:a},K.createElement(fct.Provider,{value:s},K.createElement(hQ.Provider,{value:c},K.createElement(pQ.Provider,{value:o},K.createElement(mQ.Provider,{value:u},K.createElement(gQ.Provider,{value:l},i)))))))},hct=function(){return N.useContext(pQ)},yQ=function(e){var n=N.useContext(dQ);n==null&&Kc();var r=n[e];return r==null&&Kc(),r},vQ=function(e){var n=N.useContext(fQ);n==null&&Kc();var r=n[e];return r==null&&Kc(),r},pct=function(){var e=N.useContext(hQ);return e},xQ=function(){return N.useContext(gQ)},bQ=function(){return N.useContext(mQ)};function yh(t){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}function mct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,SQ(r.key),r)}}function yct(t,e,n){return e&&gct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vct(t,e,n){return e=W1(e),xct(t,wQ()?Reflect.construct(e,n||[],W1(t).constructor):e.apply(t,n))}function xct(t,e){if(e&&(yh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bct(t)}function bct(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wQ=function(){return!!t})()}function W1(t){return W1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},W1(t)}function wct(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tT(t,e)}function tT(t,e){return tT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},tT(t,e)}function o4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function i4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o4(Object(n),!0).forEach(function(r){dR(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function dR(t,e,n){return e=SQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SQ(t){var e=Sct(t,"string");return yh(e)=="symbol"?e:e+""}function Sct(t,e){if(yh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(yh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cct(t,e){return Nct(t)||kct(t,e)||$ct(t,e)||_ct()}function _ct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ct(t,e){if(t){if(typeof t=="string")return l4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l4(t,e)}}function l4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kct(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function Nct(t){if(Array.isArray(t))return t}function nT(){return nT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nT.apply(this,arguments)}var Ict=function(e,n){var r;return K.isValidElement(e)?r=K.cloneElement(e,n):vt(e)?r=e(n):r=K.createElement("line",nT({},n,{className:"recharts-reference-line-line"})),r},Tct=function(e,n,r,a,s,o,i,l,u){var c=s.x,d=s.y,f=s.width,h=s.height;if(r){var p=u.y,g=e.y.apply(p,{position:o});if(ri(u,"discard")&&!e.y.isInRange(g))return null;var y=[{x:c+f,y:g},{x:c,y:g}];return l==="left"?y.reverse():y}if(n){var v=u.x,x=e.x.apply(v,{position:o});if(ri(u,"discard")&&!e.x.isInRange(x))return null;var b=[{x,y:d+h},{x,y:d}];return i==="top"?b.reverse():b}if(a){var w=u.segment,C=w.map(function(_){return e.apply(_,{position:o})});return ri(u,"discard")&&vut(C,function(_){return!e.isInRange(_)})?null:C}return null};function Ect(t){var e=t.x,n=t.y,r=t.segment,a=t.xAxisId,s=t.yAxisId,o=t.shape,i=t.className,l=t.alwaysShow,u=hct(),c=yQ(a),d=vQ(s),f=pct();if(!u||!f)return null;Li(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=cR({x:c.scale,y:d.scale}),p=Cr(e),g=Cr(n),y=r&&r.length===2,v=Tct(h,p,g,y,f,t.position,c.orientation,d.orientation,t);if(!v)return null;var x=Cct(v,2),b=x[0],w=b.x,C=b.y,_=x[1],$=_.x,k=_.y,A=ri(t,"hidden")?"url(#".concat(u,")"):void 0,P=i4(i4({clipPath:A},nt(t,!0)),{},{x1:w,y1:C,x2:$,y2:k});return K.createElement(qt,{className:xt("recharts-reference-line",i)},Ict(o,P),Or.renderCallByParent(t,lct({x1:w,y1:C,x2:$,y2:k})))}var fR=function(t){function e(){return mct(this,e),vct(this,e,arguments)}return wct(e,t),yct(e,[{key:"render",value:function(){return K.createElement(Ect,this.props)}}])}(K.Component);dR(fR,"displayName","ReferenceLine");dR(fR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function rT(){return rT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rT.apply(this,arguments)}function vh(t){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}function u4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function c4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u4(Object(n),!0).forEach(function(r){AC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Act(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_Q(r.key),r)}}function Oct(t,e,n){return e&&Pct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rct(t,e,n){return e=G1(e),Dct(t,CQ()?Reflect.construct(e,n||[],G1(t).constructor):e.apply(t,n))}function Dct(t,e){if(e&&(vh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jct(t)}function jct(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CQ=function(){return!!t})()}function G1(t){return G1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},G1(t)}function Mct(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aT(t,e)}function aT(t,e){return aT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},aT(t,e)}function AC(t,e,n){return e=_Q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Q(t){var e=Fct(t,"string");return vh(e)=="symbol"?e:e+""}function Fct(t,e){if(vh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(vh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lct=function(e){var n=e.x,r=e.y,a=e.xAxis,s=e.yAxis,o=cR({x:a.scale,y:s.scale}),i=o.apply({x:n,y:r},{bandAware:!0});return ri(e,"discard")&&!o.isInRange(i)?null:i},PC=function(t){function e(){return Act(this,e),Rct(this,e,arguments)}return Mct(e,t),Oct(e,[{key:"render",value:function(){var r=this.props,a=r.x,s=r.y,o=r.r,i=r.alwaysShow,l=r.clipPathId,u=Cr(a),c=Cr(s);if(Li(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!c)return null;var d=Lct(this.props);if(!d)return null;var f=d.x,h=d.y,p=this.props,g=p.shape,y=p.className,v=ri(this.props,"hidden")?"url(#".concat(l,")"):void 0,x=c4(c4({clipPath:v},nt(this.props,!0)),{},{cx:f,cy:h});return K.createElement(qt,{className:xt("recharts-reference-dot",y)},e.renderDot(g,x),Or.renderCallByParent(this.props,{x:f-o,y:h-o,width:2*o,height:2*o}))}}])}(K.Component);AC(PC,"displayName","ReferenceDot");AC(PC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});AC(PC,"renderDot",function(t,e){var n;return K.isValidElement(t)?n=K.cloneElement(t,e):vt(t)?n=t(e):n=K.createElement(CC,rT({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function sT(){return sT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sT.apply(this,arguments)}function xh(t){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(t)}function d4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function f4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?d4(Object(n),!0).forEach(function(r){OC(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Bct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kQ(r.key),r)}}function Uct(t,e,n){return e&&zct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vct(t,e,n){return e=H1(e),Wct(t,$Q()?Reflect.construct(e,n||[],H1(t).constructor):e.apply(t,n))}function Wct(t,e){if(e&&(xh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gct(t)}function Gct(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $Q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($Q=function(){return!!t})()}function H1(t){return H1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},H1(t)}function Hct(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oT(t,e)}function oT(t,e){return oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},oT(t,e)}function OC(t,e,n){return e=kQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=qct(t,"string");return xh(e)=="symbol"?e:e+""}function qct(t,e){if(xh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(xh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Kct=function(e,n,r,a,s){var o=s.x1,i=s.x2,l=s.y1,u=s.y2,c=s.xAxis,d=s.yAxis;if(!c||!d)return null;var f=cR({x:c.scale,y:d.scale}),h={x:e?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:r?f.y.apply(l,{position:"start"}):f.y.rangeMin},p={x:n?f.x.apply(i,{position:"end"}):f.x.rangeMax,y:a?f.y.apply(u,{position:"end"}):f.y.rangeMax};return ri(s,"discard")&&(!f.isInRange(h)||!f.isInRange(p))?null:uQ(h,p)},RC=function(t){function e(){return Bct(this,e),Vct(this,e,arguments)}return Hct(e,t),Uct(e,[{key:"render",value:function(){var r=this.props,a=r.x1,s=r.x2,o=r.y1,i=r.y2,l=r.className,u=r.alwaysShow,c=r.clipPathId;Li(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=Cr(a),f=Cr(s),h=Cr(o),p=Cr(i),g=this.props.shape;if(!d&&!f&&!h&&!p&&!g)return null;var y=Kct(d,f,h,p,this.props);if(!y&&!g)return null;var v=ri(this.props,"hidden")?"url(#".concat(c,")"):void 0;return K.createElement(qt,{className:xt("recharts-reference-area",l)},e.renderRect(g,f4(f4({clipPath:v},nt(this.props,!0)),y)),Or.renderCallByParent(this.props,y))}}])}(K.Component);OC(RC,"displayName","ReferenceArea");OC(RC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});OC(RC,"renderRect",function(t,e){var n;return K.isValidElement(t)?n=K.cloneElement(t,e):vt(t)?n=t(e):n=K.createElement(uR,sT({},e,{className:"recharts-reference-area-rect"})),n});function NQ(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],a=0;a<t.length;a+=e)r.push(t[a]);return r}function Xct(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return cct(r,n)}function Yct(t,e,n){var r=n==="width",a=t.x,s=t.y,o=t.width,i=t.height;return e===1?{start:r?a:s,end:r?a+o:s+i}:{start:r?a+o:s+i,end:r?a:s}}function q1(t,e,n,r,a){if(t*e<t*r||t*e>t*a)return!1;var s=n();return t*(e-t*s/2-r)>=0&&t*(e+t*s/2-a)<=0}function Qct(t,e){return NQ(t,e+1)}function Jct(t,e,n,r,a){for(var s=(r||[]).slice(),o=e.start,i=e.end,l=0,u=1,c=o,d=function(){var p=r==null?void 0:r[l];if(p===void 0)return{v:NQ(r,u)};var g=l,y,v=function(){return y===void 0&&(y=n(p,g)),y},x=p.coordinate,b=l===0||q1(t,x,v,c,i);b||(l=0,c=o,u+=1),b&&(c=x+t*(v()/2+a),l+=u)},f;u<=s.length;)if(f=d(),f)return f.v;return[]}function Qy(t){"@babel/helpers - typeof";return Qy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qy(t)}function h4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function oa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?h4(Object(n),!0).forEach(function(r){Zct(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Zct(t,e,n){return e=edt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function edt(t){var e=tdt(t,"string");return Qy(e)=="symbol"?e:e+""}function tdt(t,e){if(Qy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Qy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ndt(t,e,n,r,a){for(var s=(r||[]).slice(),o=s.length,i=e.start,l=e.end,u=function(f){var h=s[f],p,g=function(){return p===void 0&&(p=n(h,f)),p};if(f===o-1){var y=t*(h.coordinate+t*g()/2-l);s[f]=h=oa(oa({},h),{},{tickCoord:y>0?h.coordinate-y*t:h.coordinate})}else s[f]=h=oa(oa({},h),{},{tickCoord:h.coordinate});var v=q1(t,h.tickCoord,g,i,l);v&&(l=h.tickCoord-t*(g()/2+a),s[f]=oa(oa({},h),{},{isShow:!0}))},c=o-1;c>=0;c--)u(c);return s}function rdt(t,e,n,r,a,s){var o=(r||[]).slice(),i=o.length,l=e.start,u=e.end;if(s){var c=r[i-1],d=n(c,i-1),f=t*(c.coordinate+t*d/2-u);o[i-1]=c=oa(oa({},c),{},{tickCoord:f>0?c.coordinate-f*t:c.coordinate});var h=q1(t,c.tickCoord,function(){return d},l,u);h&&(u=c.tickCoord-t*(d/2+a),o[i-1]=oa(oa({},c),{},{isShow:!0}))}for(var p=s?i-1:i,g=function(x){var b=o[x],w,C=function(){return w===void 0&&(w=n(b,x)),w};if(x===0){var _=t*(b.coordinate-t*C()/2-l);o[x]=b=oa(oa({},b),{},{tickCoord:_<0?b.coordinate-_*t:b.coordinate})}else o[x]=b=oa(oa({},b),{},{tickCoord:b.coordinate});var $=q1(t,b.tickCoord,C,l,u);$&&(l=b.tickCoord+t*(C()/2+a),o[x]=oa(oa({},b),{},{isShow:!0}))},y=0;y<p;y++)g(y);return o}function adt(t,e,n){var r=t.tick,a=t.ticks,s=t.viewBox,o=t.minTickGap,i=t.orientation,l=t.interval,u=t.tickFormatter,c=t.unit,d=t.angle;if(!a||!a.length||!r)return[];if(Le(l)||ti.isSsr)return Qct(a,typeof l=="number"&&Le(l)?l:0);var f=[],h=i==="top"||i==="bottom"?"width":"height",p=c&&h==="width"?wg(c,{fontSize:e,letterSpacing:n}):{width:0,height:0},g=function(b,w){var C=vt(u)?u(b.value,w):b.value;return h==="width"?Xct(wg(C,{fontSize:e,letterSpacing:n}),p,d):wg(C,{fontSize:e,letterSpacing:n})[h]},y=a.length>=2?Ca(a[1].coordinate-a[0].coordinate):1,v=Yct(s,y,h);return l==="equidistantPreserveStart"?Jct(y,v,g,a,o):(l==="preserveStart"||l==="preserveStartEnd"?f=rdt(y,v,g,a,o,l==="preserveStartEnd"):f=ndt(y,v,g,a,o),f.filter(function(x){return x.isShow}))}var sdt=["viewBox"],odt=["viewBox"],idt=["ticks"];function bh(t){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}function pf(){return pf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pf.apply(this,arguments)}function p4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function wa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p4(Object(n),!0).forEach(function(r){hR(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function A$(t,e){if(t==null)return{};var n=ldt(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ldt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function udt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,TQ(r.key),r)}}function cdt(t,e,n){return e&&m4(t.prototype,e),n&&m4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ddt(t,e,n){return e=K1(e),fdt(t,IQ()?Reflect.construct(e,n||[],K1(t).constructor):e.apply(t,n))}function fdt(t,e){if(e&&(bh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hdt(t)}function hdt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IQ=function(){return!!t})()}function K1(t){return K1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},K1(t)}function pdt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iT(t,e)}function iT(t,e){return iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},iT(t,e)}function hR(t,e,n){return e=TQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TQ(t){var e=mdt(t,"string");return bh(e)=="symbol"?e:e+""}function mdt(t,e){if(bh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(bh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DC=function(t){function e(n){var r;return udt(this,e),r=ddt(this,e,[n]),r.state={fontSize:"",letterSpacing:""},r}return pdt(e,t),cdt(e,[{key:"shouldComponentUpdate",value:function(r,a){var s=r.viewBox,o=A$(r,sdt),i=this.props,l=i.viewBox,u=A$(i,odt);return!Tf(s,l)||!Tf(o,u)||!Tf(a,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var a=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var a=this.props,s=a.x,o=a.y,i=a.width,l=a.height,u=a.orientation,c=a.tickSize,d=a.mirror,f=a.tickMargin,h,p,g,y,v,x,b=d?-1:1,w=r.tickSize||c,C=Le(r.tickCoord)?r.tickCoord:r.coordinate;switch(u){case"top":h=p=r.coordinate,y=o+ +!d*l,g=y-b*w,x=g-b*f,v=C;break;case"left":g=y=r.coordinate,p=s+ +!d*i,h=p-b*w,v=h-b*f,x=C;break;case"right":g=y=r.coordinate,p=s+ +d*i,h=p+b*w,v=h+b*f,x=C;break;default:h=p=r.coordinate,y=o+ +d*l,g=y+b*w,x=g+b*f,v=C;break}return{line:{x1:h,y1:g,x2:p,y2:y},tick:{x:v,y:x}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,a=r.orientation,s=r.mirror,o;switch(a){case"left":o=s?"start":"end";break;case"right":o=s?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,a=r.orientation,s=r.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=s?"start":"end";break;default:o=s?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var r=this.props,a=r.x,s=r.y,o=r.width,i=r.height,l=r.orientation,u=r.mirror,c=r.axisLine,d=wa(wa(wa({},nt(this.props,!1)),nt(c,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var f=+(l==="top"&&!u||l==="bottom"&&u);d=wa(wa({},d),{},{x1:a,y1:s+f*i,x2:a+o,y2:s+f*i})}else{var h=+(l==="left"&&!u||l==="right"&&u);d=wa(wa({},d),{},{x1:a+h*o,y1:s,x2:a+h*o,y2:s+i})}return K.createElement("line",pf({},d,{className:xt("recharts-cartesian-axis-line",bs(c,"className"))}))}},{key:"renderTicks",value:function(r,a,s){var o=this,i=this.props,l=i.tickLine,u=i.stroke,c=i.tick,d=i.tickFormatter,f=i.unit,h=adt(wa(wa({},this.props),{},{ticks:r}),a,s),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=nt(this.props,!1),v=nt(c,!1),x=wa(wa({},y),{},{fill:"none"},nt(l,!1)),b=h.map(function(w,C){var _=o.getTickLineCoord(w),$=_.line,k=_.tick,A=wa(wa(wa(wa({textAnchor:p,verticalAnchor:g},y),{},{stroke:"none",fill:u},v),k),{},{index:C,payload:w,visibleTicksCount:h.length,tickFormatter:d});return K.createElement(qt,pf({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},Gc(o.props,w,C)),l&&K.createElement("line",pf({},x,$,{className:xt("recharts-cartesian-axis-tick-line",bs(l,"className"))})),c&&e.renderTickItem(c,A,"".concat(vt(d)?d(w.value,C):w.value).concat(f||"")))});return K.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var r=this,a=this.props,s=a.axisLine,o=a.width,i=a.height,l=a.ticksGenerator,u=a.className,c=a.hide;if(c)return null;var d=this.props,f=d.ticks,h=A$(d,idt),p=f;return vt(l)&&(p=f&&f.length>0?l(this.props):l(h)),o<=0||i<=0||!p||!p.length?null:K.createElement(qt,{className:xt("recharts-cartesian-axis",u),ref:function(y){r.layerReference=y}},s&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Or.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,a,s){var o;return K.isValidElement(r)?o=K.cloneElement(r,a):vt(r)?o=r(a):o=K.createElement(Hc,pf({},a,{className:"recharts-cartesian-axis-tick-value"}),s),o}}])}(N.Component);hR(DC,"displayName","CartesianAxis");hR(DC,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var gdt=["type","layout","connectNulls","ref"],ydt=["key"];function wh(t){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}function g4(t,e){if(t==null)return{};var n=vdt(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function vdt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Ng(){return Ng=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ng.apply(this,arguments)}function y4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function os(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y4(Object(n),!0).forEach(function(r){yo(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Gd(t){return Sdt(t)||wdt(t)||bdt(t)||xdt()}function xdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bdt(t,e){if(t){if(typeof t=="string")return lT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lT(t,e)}}function wdt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Sdt(t){if(Array.isArray(t))return lT(t)}function lT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Cdt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v4(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,AQ(r.key),r)}}function _dt(t,e,n){return e&&v4(t.prototype,e),n&&v4(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $dt(t,e,n){return e=X1(e),kdt(t,EQ()?Reflect.construct(e,n||[],X1(t).constructor):e.apply(t,n))}function kdt(t,e){if(e&&(wh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ndt(t)}function Ndt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EQ=function(){return!!t})()}function X1(t){return X1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},X1(t)}function Idt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uT(t,e)}function uT(t,e){return uT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},uT(t,e)}function yo(t,e,n){return e=AQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=Tdt(t,"string");return wh(e)=="symbol"?e:e+""}function Tdt(t,e){if(wh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(wh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gb=function(t){function e(){var n;Cdt(this,e);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=$dt(this,e,[].concat(a)),yo(n,"state",{isAnimationFinished:!0,totalLength:0}),yo(n,"generateSimpleStrokeDasharray",function(o,i){return"".concat(i,"px ").concat(o-i,"px")}),yo(n,"getStrokeDasharray",function(o,i,l){var u=l.reduce(function(v,x){return v+x});if(!u)return n.generateSimpleStrokeDasharray(i,o);for(var c=Math.floor(o/u),d=o%u,f=i-o,h=[],p=0,g=0;p<l.length;g+=l[p],++p)if(g+l[p]>d){h=[].concat(Gd(l.slice(0,p)),[d-g]);break}var y=h.length%2===0?[0,f]:[f];return[].concat(Gd(e.repeat(l,c)),Gd(h),y).map(function(v){return"".concat(v,"px")}).join(", ")}),yo(n,"id",Jp("recharts-line-")),yo(n,"pathRef",function(o){n.mainCurve=o}),yo(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0}),n.props.onAnimationEnd&&n.props.onAnimationEnd()}),yo(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1}),n.props.onAnimationStart&&n.props.onAnimationStart()}),n}return Idt(e,t),_dt(e,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();this.setState({totalLength:r})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var r=this.getTotalLength();r!==this.state.totalLength&&this.setState({totalLength:r})}}},{key:"getTotalLength",value:function(){var r=this.mainCurve;try{return r&&r.getTotalLength&&r.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(r,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,o=s.points,i=s.xAxis,l=s.yAxis,u=s.layout,c=s.children,d=ws(c,pb);if(!d)return null;var f=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:wr(g.payload,y)}},h={clipPath:r?"url(#clipPath-".concat(a,")"):null};return K.createElement(qt,h,d.map(function(p){return K.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:i,yAxis:l,layout:u,dataPointFormatter:f})}))}},{key:"renderDots",value:function(r,a,s){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var i=this.props,l=i.dot,u=i.points,c=i.dataKey,d=nt(this.props,!1),f=nt(l,!0),h=u.map(function(g,y){var v=os(os(os({key:"dot-".concat(y),r:3},d),f),{},{value:g.value,dataKey:c,cx:g.x,cy:g.y,index:y,payload:g.payload});return e.renderDotItem(l,v)}),p={clipPath:r?"url(#clipPath-".concat(a?"":"dots-").concat(s,")"):null};return K.createElement(qt,Ng({className:"recharts-line-dots",key:"dots"},p),h)}},{key:"renderCurveStatically",value:function(r,a,s,o){var i=this.props,l=i.type,u=i.layout,c=i.connectNulls;i.ref;var d=g4(i,gdt),f=os(os(os({},nt(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(s,")"):null,points:r},o),{},{type:l,layout:u,connectNulls:c});return K.createElement(T1,Ng({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(r,a){var s=this,o=this.props,i=o.points,l=o.strokeDasharray,u=o.isAnimationActive,c=o.animationBegin,d=o.animationDuration,f=o.animationEasing,h=o.animationId,p=o.animateNewValues,g=o.width,y=o.height,v=this.state,x=v.prevPoints,b=v.totalLength;return K.createElement(mi,{begin:c,duration:d,isActive:u,easing:f,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var C=w.t;if(x){var _=x.length/i.length,$=i.map(function(R,B){var F=Math.floor(B*_);if(x[F]){var L=x[F],H=ds(L.x,R.x),te=ds(L.y,R.y);return os(os({},R),{},{x:H(C),y:te(C)})}if(p){var V=ds(g*2,R.x),Q=ds(y/2,R.y);return os(os({},R),{},{x:V(C),y:Q(C)})}return os(os({},R),{},{x:R.x,y:R.y})});return s.renderCurveStatically($,r,a)}var k=ds(0,b),A=k(C),P;if(l){var O="".concat(l).split(/[,\s]+/gim).map(function(R){return parseFloat(R)});P=s.getStrokeDasharray(A,b,O)}else P=s.generateSimpleStrokeDasharray(b,A);return s.renderCurveStatically(i,r,a,{strokeDasharray:P})})}},{key:"renderCurve",value:function(r,a){var s=this.props,o=s.points,i=s.isAnimationActive,l=this.state,u=l.prevPoints,c=l.totalLength;return i&&o&&o.length&&(!u&&c>0||!hb(u,o))?this.renderCurveWithAnimation(r,a):this.renderCurveStatically(o,r,a)}},{key:"render",value:function(){var r,a=this.props,s=a.hide,o=a.dot,i=a.points,l=a.className,u=a.xAxis,c=a.yAxis,d=a.top,f=a.left,h=a.width,p=a.height,g=a.isAnimationActive,y=a.id;if(s||!i||!i.length)return null;var v=this.state.isAnimationFinished,x=i.length===1,b=xt("recharts-line",l),w=u&&u.allowDataOverflow,C=c&&c.allowDataOverflow,_=w||C,$=ht(y)?this.id:y,k=(r=nt(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},A=k.r,P=A===void 0?3:A,O=k.strokeWidth,R=O===void 0?2:O,B=RGe(o)?o:{},F=B.clipDot,L=F===void 0?!0:F,H=P*2+R;return K.createElement(qt,{className:b},w||C?K.createElement("defs",null,K.createElement("clipPath",{id:"clipPath-".concat($)},K.createElement("rect",{x:w?f:f-h/2,y:C?d:d-p/2,width:w?h:h*2,height:C?p:p*2})),!L&&K.createElement("clipPath",{id:"clipPath-dots-".concat($)},K.createElement("rect",{x:f-H/2,y:d-H/2,width:h+H,height:p+H}))):null,!x&&this.renderCurve(_,$),this.renderErrorBar(_,$),(x||o)&&this.renderDots(_,L,$),(!g||v)&&zi.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,a){return r.animationId!==a.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:a.curPoints}:r.points!==a.curPoints?{curPoints:r.points}:null}},{key:"repeat",value:function(r,a){for(var s=r.length%2!==0?[].concat(Gd(r),[0]):r,o=[],i=0;i<a;++i)o=[].concat(Gd(o),Gd(s));return o}},{key:"renderDotItem",value:function(r,a){var s;if(K.isValidElement(r))s=K.cloneElement(r,a);else if(vt(r))s=r(a);else{var o=a.key,i=g4(a,ydt),l=xt("recharts-line-dot",typeof r!="boolean"?r.className:"");s=K.createElement(CC,Ng({key:o},i,{className:l}))}return s}}])}(N.PureComponent);yo(gb,"displayName","Line");yo(gb,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!ti.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});yo(gb,"getComposedData",function(t){var e=t.props,n=t.xAxis,r=t.yAxis,a=t.xAxisTicks,s=t.yAxisTicks,o=t.dataKey,i=t.bandSize,l=t.displayedData,u=t.offset,c=e.layout,d=l.map(function(f,h){var p=wr(f,o);return c==="horizontal"?{x:WL({axis:n,ticks:a,bandSize:i,entry:f,index:h}),y:ht(p)?null:r.scale(p),value:p,payload:f}:{x:ht(p)?null:n.scale(p),y:WL({axis:r,ticks:s,bandSize:i,entry:f,index:h}),value:p,payload:f}});return os({points:d,layout:c},u)});function Sh(t){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sh(t)}function Edt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Adt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,RQ(r.key),r)}}function Pdt(t,e,n){return e&&Adt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Odt(t,e,n){return e=Y1(e),Rdt(t,PQ()?Reflect.construct(e,n||[],Y1(t).constructor):e.apply(t,n))}function Rdt(t,e){if(e&&(Sh(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ddt(t)}function Ddt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PQ=function(){return!!t})()}function Y1(t){return Y1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Y1(t)}function jdt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cT(t,e)}function cT(t,e){return cT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},cT(t,e)}function OQ(t,e,n){return e=RQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RQ(t){var e=Mdt(t,"string");return Sh(e)=="symbol"?e:e+""}function Mdt(t,e){if(Sh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Sh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dT(){return dT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dT.apply(this,arguments)}function Fdt(t){var e=t.xAxisId,n=xQ(),r=bQ(),a=yQ(e);return a==null?null:K.createElement(DC,dT({},a,{className:xt("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return ic(o,!0)}}))}var jC=function(t){function e(){return Edt(this,e),Odt(this,e,arguments)}return jdt(e,t),Pdt(e,[{key:"render",value:function(){return K.createElement(Fdt,this.props)}}])}(K.Component);OQ(jC,"displayName","XAxis");OQ(jC,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Ch(t){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(t)}function Ldt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bdt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,MQ(r.key),r)}}function zdt(t,e,n){return e&&Bdt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Udt(t,e,n){return e=Q1(e),Vdt(t,DQ()?Reflect.construct(e,n||[],Q1(t).constructor):e.apply(t,n))}function Vdt(t,e){if(e&&(Ch(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wdt(t)}function Wdt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DQ=function(){return!!t})()}function Q1(t){return Q1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Q1(t)}function Gdt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fT(t,e)}function fT(t,e){return fT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},fT(t,e)}function jQ(t,e,n){return e=MQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MQ(t){var e=Hdt(t,"string");return Ch(e)=="symbol"?e:e+""}function Hdt(t,e){if(Ch(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ch(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hT(){return hT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hT.apply(this,arguments)}var qdt=function(e){var n=e.yAxisId,r=xQ(),a=bQ(),s=vQ(n);return s==null?null:K.createElement(DC,hT({},s,{className:xt("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:a},ticksGenerator:function(i){return ic(i,!0)}}))},MC=function(t){function e(){return Ldt(this,e),Udt(this,e,arguments)}return Gdt(e,t),zdt(e,[{key:"render",value:function(){return K.createElement(qdt,this.props)}}])}(K.Component);jQ(MC,"displayName","YAxis");jQ(MC,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function x4(t){return Qdt(t)||Ydt(t)||Xdt(t)||Kdt()}function Kdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xdt(t,e){if(t){if(typeof t=="string")return pT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pT(t,e)}}function Ydt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Qdt(t){if(Array.isArray(t))return pT(t)}function pT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var mT=function(e,n,r,a,s){var o=ws(e,fR),i=ws(e,PC),l=[].concat(x4(o),x4(i)),u=ws(e,RC),c="".concat(a,"Id"),d=a[0],f=n;if(l.length&&(f=l.reduce(function(g,y){if(y.props[c]===r&&ri(y.props,"extendDomain")&&Le(y.props[d])){var v=y.props[d];return[Math.min(g[0],v),Math.max(g[1],v)]}return g},f)),u.length){var h="".concat(d,"1"),p="".concat(d,"2");f=u.reduce(function(g,y){if(y.props[c]===r&&ri(y.props,"extendDomain")&&Le(y.props[h])&&Le(y.props[p])){var v=y.props[h],x=y.props[p];return[Math.min(g[0],v,x),Math.max(g[1],v,x)]}return g},f)}return s&&s.length&&(f=s.reduce(function(g,y){return Le(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},f)),f},FQ={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new a(c,d||l,f),p=n?n+u:u;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],h]:l._events[p].push(h):(l._events[p]=h,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new r:delete l._events[u]}function i(){this._events=new r,this._eventsCount=0}i.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},i.prototype.listeners=function(u){var c=n?n+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,p=new Array(h);f<h;f++)p[f]=d[f].fn;return p},i.prototype.listenerCount=function(u){var c=n?n+u:u,d=this._events[c];return d?d.fn?1:d.length:0},i.prototype.emit=function(u,c,d,f,h,p){var g=n?n+u:u;if(!this._events[g])return!1;var y=this._events[g],v=arguments.length,x,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,c),!0;case 3:return y.fn.call(y.context,c,d),!0;case 4:return y.fn.call(y.context,c,d,f),!0;case 5:return y.fn.call(y.context,c,d,f,h),!0;case 6:return y.fn.call(y.context,c,d,f,h,p),!0}for(b=1,x=new Array(v-1);b<v;b++)x[b-1]=arguments[b];y.fn.apply(y.context,x)}else{var w=y.length,C;for(b=0;b<w;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),v){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,c);break;case 3:y[b].fn.call(y[b].context,c,d);break;case 4:y[b].fn.call(y[b].context,c,d,f);break;default:if(!x)for(C=1,x=new Array(v-1);C<v;C++)x[C-1]=arguments[C];y[b].fn.apply(y[b].context,x)}}return!0},i.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},i.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},i.prototype.removeListener=function(u,c,d,f){var h=n?n+u:u;if(!this._events[h])return this;if(!c)return o(this,h),this;var p=this._events[h];if(p.fn)p.fn===c&&(!f||p.once)&&(!d||p.context===d)&&o(this,h);else{for(var g=0,y=[],v=p.length;g<v;g++)(p[g].fn!==c||f&&!p[g].once||d&&p[g].context!==d)&&y.push(p[g]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},i.prototype.removeAllListeners=function(u){var c;return u?(c=n?n+u:u,this._events[c]&&o(this,c)):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,t.exports=i})(FQ);var Jdt=FQ.exports;const Zdt=Ut(Jdt);var P$=new Zdt,O$="recharts.syncMouseEvents";function Jy(t){"@babel/helpers - typeof";return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jy(t)}function eft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,LQ(r.key),r)}}function nft(t,e,n){return e&&tft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function R$(t,e,n){return e=LQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LQ(t){var e=rft(t,"string");return Jy(e)=="symbol"?e:e+""}function rft(t,e){if(Jy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Jy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var aft=function(){function t(){eft(this,t),R$(this,"activeIndex",0),R$(this,"coordinateList",[]),R$(this,"layout","horizontal")}return nft(t,[{key:"setDetails",value:function(n){var r,a=n.coordinateList,s=a===void 0?null:a,o=n.container,i=o===void 0?null:o,l=n.layout,u=l===void 0?null:l,c=n.offset,d=c===void 0?null:c,f=n.mouseHandlerCallback,h=f===void 0?null:f;this.coordinateList=(r=s??this.coordinateList)!==null&&r!==void 0?r:[],this.container=i??this.container,this.layout=u??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),s=a.x,o=a.y,i=a.height,l=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,c=((r=window)===null||r===void 0?void 0:r.scrollY)||0,d=s+l+u,f=o+this.offset.top+i/2+c;this.mouseHandlerCallback({pageX:d,pageY:f})}}}])}();function sft(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var r=t==null?void 0:t[0],a=t==null?void 0:t[1];if(r&&a&&Le(r)&&Le(a))return!0}return!1}function oft(t,e,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-a:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-a,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function BQ(t){var e=t.cx,n=t.cy,r=t.radius,a=t.startAngle,s=t.endAngle,o=An(e,n,r,a),i=An(e,n,r,s);return{points:[o,i],cx:e,cy:n,radius:r,startAngle:a,endAngle:s}}function ift(t,e,n){var r,a,s,o;if(t==="horizontal")r=e.x,s=r,a=n.top,o=n.top+n.height;else if(t==="vertical")a=e.y,o=a,r=n.left,s=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var i=e.cx,l=e.cy,u=e.innerRadius,c=e.outerRadius,d=e.angle,f=An(i,l,u,d),h=An(i,l,c,d);r=f.x,a=f.y,s=h.x,o=h.y}else return BQ(e);return[{x:r,y:a},{x:s,y:o}]}function Zy(t){"@babel/helpers - typeof";return Zy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zy(t)}function b4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function k0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b4(Object(n),!0).forEach(function(r){lft(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lft(t,e,n){return e=uft(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uft(t){var e=cft(t,"string");return Zy(e)=="symbol"?e:e+""}function cft(t,e){if(Zy(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Zy(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dft(t){var e,n,r=t.element,a=t.tooltipEventType,s=t.isActive,o=t.activeCoordinate,i=t.activePayload,l=t.offset,u=t.activeTooltipIndex,c=t.tooltipAxisBandSize,d=t.layout,f=t.chartName,h=(e=r.props.cursor)!==null&&e!==void 0?e:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!h||!s||!o||f!=="ScatterChart"&&a!=="axis")return null;var p,g=T1;if(f==="ScatterChart")p=o,g=sit;else if(f==="BarChart")p=oft(d,o,l,c),g=uR;else if(d==="radial"){var y=BQ(o),v=y.cx,x=y.cy,b=y.radius,w=y.startAngle,C=y.endAngle;p={cx:v,cy:x,startAngle:w,endAngle:C,innerRadius:b,outerRadius:b},g=jY}else p={points:ift(d,o,l)},g=T1;var _=k0(k0(k0(k0({stroke:"#ccc",pointerEvents:"none"},l),p),nt(h,!1)),{},{payload:i,payloadIndex:u,className:xt("recharts-tooltip-cursor",h.className)});return N.isValidElement(h)?N.cloneElement(h,_):N.createElement(g,_)}var fft=["item"],hft=["children","className","width","height","style","compact","title","desc"];function _h(t){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(t)}function Ig(){return Ig=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ig.apply(this,arguments)}function w4(t,e){return gft(t)||mft(t,e)||UQ(t,e)||pft()}function pft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mft(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==e);l=!0);}catch(c){u=!0,a=c}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}function gft(t){if(Array.isArray(t))return t}function S4(t,e){if(t==null)return{};var n=yft(t,e),r,a;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function yft(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function vft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,VQ(r.key),r)}}function bft(t,e,n){return e&&xft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wft(t,e,n){return e=J1(e),Sft(t,zQ()?Reflect.construct(e,n||[],J1(t).constructor):e.apply(t,n))}function Sft(t,e){if(e&&(_h(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cft(t)}function Cft(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zQ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zQ=function(){return!!t})()}function J1(t){return J1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},J1(t)}function _ft(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gT(t,e)}function gT(t,e){return gT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},gT(t,e)}function $h(t){return Nft(t)||kft(t)||UQ(t)||$ft()}function $ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UQ(t,e){if(t){if(typeof t=="string")return yT(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yT(t,e)}}function kft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nft(t){if(Array.isArray(t))return yT(t)}function yT(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function C4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?C4(Object(n),!0).forEach(function(r){ut(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C4(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ut(t,e,n){return e=VQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VQ(t){var e=Ift(t,"string");return _h(e)=="symbol"?e:e+""}function Ift(t,e){if(_h(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(_h(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tft={xAxis:["bottom","top"],yAxis:["left","right"]},Eft={width:"100%",height:"100%"},WQ={x:0,y:0};function N0(t){return t}var Aft=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},Pft=function(e,n,r,a){var s=n.find(function(c){return c&&c.index===r});if(s){if(e==="horizontal")return{x:s.coordinate,y:a.y};if(e==="vertical")return{x:a.x,y:s.coordinate};if(e==="centric"){var o=s.coordinate,i=a.radius;return ve(ve(ve({},a),An(a.cx,a.cy,i,o)),{},{angle:o,radius:i})}var l=s.coordinate,u=a.angle;return ve(ve(ve({},a),An(a.cx,a.cy,l,u)),{},{angle:u,radius:l})}return WQ},FC=function(e,n){var r=n.graphicalItems,a=n.dataStartIndex,s=n.dataEndIndex,o=(r??[]).reduce(function(i,l){var u=l.props.data;return u&&u.length?[].concat($h(i),$h(u)):i},[]);return o.length>0?o:e&&e.length&&Le(a)&&Le(s)?e.slice(a,s+1):[]};function GQ(t){return t==="number"?[0,"auto"]:void 0}var vT=function(e,n,r,a){var s=e.graphicalItems,o=e.tooltipAxis,i=FC(n,e);return r<0||!s||!s.length||r>=i.length?null:s.reduce(function(l,u){var c,d=(c=u.props.data)!==null&&c!==void 0?c:n;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var h=d===void 0?i:d;f=Jw(h,o.dataKey,a)}else f=d&&d[r]||i[r];return f?[].concat($h(l),[EY(u,f)]):l},[])},_4=function(e,n,r,a){var s=a||{x:e.chartX,y:e.chartY},o=Aft(s,r),i=e.orderedTooltipTicks,l=e.tooltipAxis,u=e.tooltipTicks,c=Lrt(o,i,u,l);if(c>=0&&u){var d=u[c]&&u[c].value,f=vT(e,n,c,d),h=Pft(r,i,c,s);return{activeTooltipIndex:c,activeLabel:d,activePayload:f,activeCoordinate:h}}return null},Oft=function(e,n){var r=n.axes,a=n.graphicalItems,s=n.axisType,o=n.axisIdKey,i=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.layout,d=e.children,f=e.stackOffset,h=$Y(c,s);return r.reduce(function(p,g){var y,v=g.type.defaultProps!==void 0?ve(ve({},g.type.defaultProps),g.props):g.props,x=v.type,b=v.dataKey,w=v.allowDataOverflow,C=v.allowDuplicatedCategory,_=v.scale,$=v.ticks,k=v.includeHidden,A=v[o];if(p[A])return p;var P=FC(e.data,{graphicalItems:a.filter(function(ue){var ce,re=o in ue.props?ue.props[o]:(ce=ue.type.defaultProps)===null||ce===void 0?void 0:ce[o];return re===A}),dataStartIndex:l,dataEndIndex:u}),O=P.length,R,B,F;sft(v.domain,w,x)&&(R=PI(v.domain,null,w),h&&(x==="number"||_!=="auto")&&(F=Cg(P,b,"category")));var L=GQ(x);if(!R||R.length===0){var H,te=(H=v.domain)!==null&&H!==void 0?H:L;if(b){if(R=Cg(P,b,x),x==="category"&&h){var V=$Ge(R);C&&V?(B=R,R=L1(0,O)):C||(R=KL(te,R,g).reduce(function(ue,ce){return ue.indexOf(ce)>=0?ue:[].concat($h(ue),[ce])},[]))}else if(x==="category")C?R=R.filter(function(ue){return ue!==""&&!ht(ue)}):R=KL(te,R,g).reduce(function(ue,ce){return ue.indexOf(ce)>=0||ce===""||ht(ce)?ue:[].concat($h(ue),[ce])},[]);else if(x==="number"){var Q=Wrt(P,a.filter(function(ue){var ce,re,ge=o in ue.props?ue.props[o]:(ce=ue.type.defaultProps)===null||ce===void 0?void 0:ce[o],Se="hide"in ue.props?ue.props.hide:(re=ue.type.defaultProps)===null||re===void 0?void 0:re.hide;return ge===A&&(k||!Se)}),b,s,c);Q&&(R=Q)}h&&(x==="number"||_!=="auto")&&(F=Cg(P,b,"category"))}else h?R=L1(0,O):i&&i[A]&&i[A].hasStack&&x==="number"?R=f==="expand"?[0,1]:TY(i[A].stackGroups,l,u):R=_Y(P,a.filter(function(ue){var ce=o in ue.props?ue.props[o]:ue.type.defaultProps[o],re="hide"in ue.props?ue.props.hide:ue.type.defaultProps.hide;return ce===A&&(k||!re)}),x,c,!0);if(x==="number")R=mT(d,R,A,s,$),te&&(R=PI(te,R,w));else if(x==="category"&&te){var se=te,le=R.every(function(ue){return se.indexOf(ue)>=0});le&&(R=se)}}return ve(ve({},p),{},ut({},A,ve(ve({},v),{},{axisType:s,domain:R,categoricalDomain:F,duplicateDomain:B,originalDomain:(y=v.domain)!==null&&y!==void 0?y:L,isCategorical:h,layout:c})))},{})},Rft=function(e,n){var r=n.graphicalItems,a=n.Axis,s=n.axisType,o=n.axisIdKey,i=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.layout,d=e.children,f=FC(e.data,{graphicalItems:r,dataStartIndex:l,dataEndIndex:u}),h=f.length,p=$Y(c,s),g=-1;return r.reduce(function(y,v){var x=v.type.defaultProps!==void 0?ve(ve({},v.type.defaultProps),v.props):v.props,b=x[o],w=GQ("number");if(!y[b]){g++;var C;return p?C=L1(0,h):i&&i[b]&&i[b].hasStack?(C=TY(i[b].stackGroups,l,u),C=mT(d,C,b,s)):(C=PI(w,_Y(f,r.filter(function(_){var $,k,A=o in _.props?_.props[o]:($=_.type.defaultProps)===null||$===void 0?void 0:$[o],P="hide"in _.props?_.props.hide:(k=_.type.defaultProps)===null||k===void 0?void 0:k.hide;return A===b&&!P}),"number",c),a.defaultProps.allowDataOverflow),C=mT(d,C,b,s)),ve(ve({},y),{},ut({},b,ve(ve({axisType:s},a.defaultProps),{},{hide:!0,orientation:bs(Tft,"".concat(s,".").concat(g%2),null),domain:C,originalDomain:w,isCategorical:p,layout:c})))}return y},{})},Dft=function(e,n){var r=n.axisType,a=r===void 0?"xAxis":r,s=n.AxisComp,o=n.graphicalItems,i=n.stackGroups,l=n.dataStartIndex,u=n.dataEndIndex,c=e.children,d="".concat(a,"Id"),f=ws(c,s),h={};return f&&f.length?h=Oft(e,{axes:f,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:i,dataStartIndex:l,dataEndIndex:u}):o&&o.length&&(h=Rft(e,{Axis:s,graphicalItems:o,axisType:a,axisIdKey:d,stackGroups:i,dataStartIndex:l,dataEndIndex:u})),h},jft=function(e){var n=Yd(e),r=ic(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:jO(r,function(a){return a.coordinate}),tooltipAxis:n,tooltipAxisBandSize:k1(n,r)}},$4=function(e){var n=e.children,r=e.defaultShowTooltip,a=cs(n,mh),s=0,o=0;return e.data&&e.data.length!==0&&(o=e.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(s=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!r}},Mft=function(e){return!e||!e.length?!1:e.some(function(n){var r=Fi(n&&n.type);return r&&r.indexOf("Bar")>=0})},k4=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Fft=function(e,n){var r=e.props,a=e.graphicalItems,s=e.xAxisMap,o=s===void 0?{}:s,i=e.yAxisMap,l=i===void 0?{}:i,u=r.width,c=r.height,d=r.children,f=r.margin||{},h=cs(d,mh),p=cs(d,vc),g=Object.keys(l).reduce(function(C,_){var $=l[_],k=$.orientation;return!$.mirror&&!$.hide?ve(ve({},C),{},ut({},k,C[k]+$.width)):C},{left:f.left||0,right:f.right||0}),y=Object.keys(o).reduce(function(C,_){var $=o[_],k=$.orientation;return!$.mirror&&!$.hide?ve(ve({},C),{},ut({},k,bs(C,"".concat(k))+$.height)):C},{top:f.top||0,bottom:f.bottom||0}),v=ve(ve({},y),g),x=v.bottom;h&&(v.bottom+=h.props.height||mh.defaultProps.height),p&&n&&(v=Urt(v,a,r,n));var b=u-v.left-v.right,w=c-v.top-v.bottom;return ve(ve({brushBottom:x},v),{},{width:Math.max(b,0),height:Math.max(w,0)})},Lft=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},HQ=function(e){var n=e.chartName,r=e.GraphicalChild,a=e.defaultTooltipEventType,s=a===void 0?"axis":a,o=e.validateTooltipEventTypes,i=o===void 0?["axis"]:o,l=e.axisComponents,u=e.legendContent,c=e.formatAxisMap,d=e.defaultProps,f=function(y,v){var x=v.graphicalItems,b=v.stackGroups,w=v.offset,C=v.updateId,_=v.dataStartIndex,$=v.dataEndIndex,k=y.barSize,A=y.layout,P=y.barGap,O=y.barCategoryGap,R=y.maxBarSize,B=k4(A),F=B.numericAxisName,L=B.cateAxisName,H=Mft(x),te=[];return x.forEach(function(V,Q){var se=FC(y.data,{graphicalItems:[V],dataStartIndex:_,dataEndIndex:$}),le=V.type.defaultProps!==void 0?ve(ve({},V.type.defaultProps),V.props):V.props,ue=le.dataKey,ce=le.maxBarSize,re=le["".concat(F,"Id")],ge=le["".concat(L,"Id")],Se={},Ne=l.reduce(function(Ze,It){var rn=v["".concat(It.axisType,"Map")],an=le["".concat(It.axisType,"Id")];rn&&rn[an]||It.axisType==="zAxis"||Kc();var ar=rn[an];return ve(ve({},Ze),{},ut(ut({},It.axisType,ar),"".concat(It.axisType,"Ticks"),ic(ar)))},Se),we=Ne[L],de=Ne["".concat(L,"Ticks")],J=b&&b[re]&&b[re].hasStack&&Zrt(V,b[re].stackGroups),ae=Fi(V.type).indexOf("Bar")>=0,U=k1(we,de),oe=[],ye=H&&Brt({barSize:k,stackGroups:b,totalSize:Lft(Ne,L)});if(ae){var be,he,De=ht(ce)?R:ce,Ve=(be=(he=k1(we,de,!0))!==null&&he!==void 0?he:De)!==null&&be!==void 0?be:0;oe=zrt({barGap:P,barCategoryGap:O,bandSize:Ve!==U?Ve:U,sizeList:ye[ge],maxBarSize:De}),Ve!==U&&(oe=oe.map(function(Ze){return ve(ve({},Ze),{},{position:ve(ve({},Ze.position),{},{offset:Ze.position.offset-Ve/2})})}))}var Ye=V&&V.type&&V.type.getComposedData;Ye&&te.push({props:ve(ve({},Ye(ve(ve({},Ne),{},{displayedData:se,props:y,dataKey:ue,item:V,bandSize:U,barPosition:oe,offset:w,stackedData:J,layout:A,dataStartIndex:_,dataEndIndex:$}))),{},ut(ut(ut({key:V.key||"item-".concat(Q)},F,Ne[F]),L,Ne[L]),"animationId",C)),childIndex:MGe(V,y.children),item:V})}),te},h=function(y,v){var x=y.props,b=y.dataStartIndex,w=y.dataEndIndex,C=y.updateId;if(!zM({props:x}))return null;var _=x.children,$=x.layout,k=x.stackOffset,A=x.data,P=x.reverseStackOrder,O=k4($),R=O.numericAxisName,B=O.cateAxisName,F=ws(_,r),L=Qrt(A,F,"".concat(R,"Id"),"".concat(B,"Id"),k,P),H=l.reduce(function(le,ue){var ce="".concat(ue.axisType,"Map");return ve(ve({},le),{},ut({},ce,Dft(x,ve(ve({},ue),{},{graphicalItems:F,stackGroups:ue.axisType===R&&L,dataStartIndex:b,dataEndIndex:w}))))},{}),te=Fft(ve(ve({},H),{},{props:x,graphicalItems:F}),v==null?void 0:v.legendBBox);Object.keys(H).forEach(function(le){H[le]=c(x,H[le],te,le.replace("Map",""),n)});var V=H["".concat(B,"Map")],Q=jft(V),se=f(x,ve(ve({},H),{},{dataStartIndex:b,dataEndIndex:w,updateId:C,graphicalItems:F,stackGroups:L,offset:te}));return ve(ve({formattedGraphicalItems:se,graphicalItems:F,offset:te,stackGroups:L},Q),H)},p=function(g){function y(v){var x,b,w;return vft(this,y),w=wft(this,y,[v]),ut(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ut(w,"accessibilityManager",new aft),ut(w,"handleLegendBBoxUpdate",function(C){if(C){var _=w.state,$=_.dataStartIndex,k=_.dataEndIndex,A=_.updateId;w.setState(ve({legendBBox:C},h({props:w.props,dataStartIndex:$,dataEndIndex:k,updateId:A},ve(ve({},w.state),{},{legendBBox:C}))))}}),ut(w,"handleReceiveSyncEvent",function(C,_,$){if(w.props.syncId===C){if($===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(_)}}),ut(w,"handleBrushChange",function(C){var _=C.startIndex,$=C.endIndex;if(_!==w.state.dataStartIndex||$!==w.state.dataEndIndex){var k=w.state.updateId;w.setState(function(){return ve({dataStartIndex:_,dataEndIndex:$},h({props:w.props,dataStartIndex:_,dataEndIndex:$,updateId:k},w.state))}),w.triggerSyncEvent({dataStartIndex:_,dataEndIndex:$})}}),ut(w,"handleMouseEnter",function(C){var _=w.getMouseInfo(C);if(_){var $=ve(ve({},_),{},{isTooltipActive:!0});w.setState($),w.triggerSyncEvent($);var k=w.props.onMouseEnter;vt(k)&&k($,C)}}),ut(w,"triggeredAfterMouseMove",function(C){var _=w.getMouseInfo(C),$=_?ve(ve({},_),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState($),w.triggerSyncEvent($);var k=w.props.onMouseMove;vt(k)&&k($,C)}),ut(w,"handleItemMouseEnter",function(C){w.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),ut(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),ut(w,"handleMouseMove",function(C){C.persist(),w.throttleTriggeredAfterMouseMove(C)}),ut(w,"handleMouseLeave",function(C){w.throttleTriggeredAfterMouseMove.cancel();var _={isTooltipActive:!1};w.setState(_),w.triggerSyncEvent(_);var $=w.props.onMouseLeave;vt($)&&$(_,C)}),ut(w,"handleOuterEvent",function(C){var _=jGe(C),$=bs(w.props,"".concat(_));if(_&&vt($)){var k,A;/.*touch.*/i.test(_)?A=w.getMouseInfo(C.changedTouches[0]):A=w.getMouseInfo(C),$((k=A)!==null&&k!==void 0?k:{},C)}}),ut(w,"handleClick",function(C){var _=w.getMouseInfo(C);if(_){var $=ve(ve({},_),{},{isTooltipActive:!0});w.setState($),w.triggerSyncEvent($);var k=w.props.onClick;vt(k)&&k($,C)}}),ut(w,"handleMouseDown",function(C){var _=w.props.onMouseDown;if(vt(_)){var $=w.getMouseInfo(C);_($,C)}}),ut(w,"handleMouseUp",function(C){var _=w.props.onMouseUp;if(vt(_)){var $=w.getMouseInfo(C);_($,C)}}),ut(w,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),ut(w,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&w.handleMouseDown(C.changedTouches[0])}),ut(w,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&w.handleMouseUp(C.changedTouches[0])}),ut(w,"triggerSyncEvent",function(C){w.props.syncId!==void 0&&P$.emit(O$,w.props.syncId,C,w.eventEmitterSymbol)}),ut(w,"applySyncEvent",function(C){var _=w.props,$=_.layout,k=_.syncMethod,A=w.state.updateId,P=C.dataStartIndex,O=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)w.setState(ve({dataStartIndex:P,dataEndIndex:O},h({props:w.props,dataStartIndex:P,dataEndIndex:O,updateId:A},w.state)));else if(C.activeTooltipIndex!==void 0){var R=C.chartX,B=C.chartY,F=C.activeTooltipIndex,L=w.state,H=L.offset,te=L.tooltipTicks;if(!H)return;if(typeof k=="function")F=k(te,C);else if(k==="value"){F=-1;for(var V=0;V<te.length;V++)if(te[V].value===C.activeLabel){F=V;break}}var Q=ve(ve({},H),{},{x:H.left,y:H.top}),se=Math.min(R,Q.x+Q.width),le=Math.min(B,Q.y+Q.height),ue=te[F]&&te[F].value,ce=vT(w.state,w.props.data,F),re=te[F]?{x:$==="horizontal"?te[F].coordinate:se,y:$==="horizontal"?le:te[F].coordinate}:WQ;w.setState(ve(ve({},C),{},{activeLabel:ue,activeCoordinate:re,activePayload:ce,activeTooltipIndex:F}))}else w.setState(C)}),ut(w,"renderCursor",function(C){var _,$=w.state,k=$.isTooltipActive,A=$.activeCoordinate,P=$.activePayload,O=$.offset,R=$.activeTooltipIndex,B=$.tooltipAxisBandSize,F=w.getTooltipEventType(),L=(_=C.props.active)!==null&&_!==void 0?_:k,H=w.props.layout,te=C.key||"_recharts-cursor";return K.createElement(dft,{key:te,activeCoordinate:A,activePayload:P,activeTooltipIndex:R,chartName:n,element:C,isActive:L,layout:H,offset:O,tooltipAxisBandSize:B,tooltipEventType:F})}),ut(w,"renderPolarAxis",function(C,_,$){var k=bs(C,"type.axisType"),A=bs(w.state,"".concat(k,"Map")),P=C.type.defaultProps,O=P!==void 0?ve(ve({},P),C.props):C.props,R=A&&A[O["".concat(k,"Id")]];return N.cloneElement(C,ve(ve({},R),{},{className:xt(k,R.className),key:C.key||"".concat(_,"-").concat($),ticks:ic(R,!0)}))}),ut(w,"renderPolarGrid",function(C){var _=C.props,$=_.radialLines,k=_.polarAngles,A=_.polarRadius,P=w.state,O=P.radiusAxisMap,R=P.angleAxisMap,B=Yd(O),F=Yd(R),L=F.cx,H=F.cy,te=F.innerRadius,V=F.outerRadius;return N.cloneElement(C,{polarAngles:Array.isArray(k)?k:ic(F,!0).map(function(Q){return Q.coordinate}),polarRadius:Array.isArray(A)?A:ic(B,!0).map(function(Q){return Q.coordinate}),cx:L,cy:H,innerRadius:te,outerRadius:V,key:C.key||"polar-grid",radialLines:$})}),ut(w,"renderLegend",function(){var C=w.state.formattedGraphicalItems,_=w.props,$=_.children,k=_.width,A=_.height,P=w.props.margin||{},O=k-(P.left||0)-(P.right||0),R=SY({children:$,formattedGraphicalItems:C,legendWidth:O,legendContent:u});if(!R)return null;var B=R.item,F=S4(R,fft);return N.cloneElement(B,ve(ve({},F),{},{chartWidth:k,chartHeight:A,margin:P,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),ut(w,"renderTooltip",function(){var C,_=w.props,$=_.children,k=_.accessibilityLayer,A=cs($,Go);if(!A)return null;var P=w.state,O=P.isTooltipActive,R=P.activeCoordinate,B=P.activePayload,F=P.activeLabel,L=P.offset,H=(C=A.props.active)!==null&&C!==void 0?C:O;return N.cloneElement(A,{viewBox:ve(ve({},L),{},{x:L.left,y:L.top}),active:H,label:F,payload:H?B:[],coordinate:R,accessibilityLayer:k})}),ut(w,"renderBrush",function(C){var _=w.props,$=_.margin,k=_.data,A=w.state,P=A.offset,O=A.dataStartIndex,R=A.dataEndIndex,B=A.updateId;return N.cloneElement(C,{key:C.key||"_recharts-brush",onChange:S0(w.handleBrushChange,C.props.onChange),data:k,x:Le(C.props.x)?C.props.x:P.left,y:Le(C.props.y)?C.props.y:P.top+P.height+P.brushBottom-($.bottom||0),width:Le(C.props.width)?C.props.width:P.width,startIndex:O,endIndex:R,updateId:"brush-".concat(B)})}),ut(w,"renderReferenceElement",function(C,_,$){if(!C)return null;var k=w,A=k.clipPathId,P=w.state,O=P.xAxisMap,R=P.yAxisMap,B=P.offset,F=C.type.defaultProps||{},L=C.props,H=L.xAxisId,te=H===void 0?F.xAxisId:H,V=L.yAxisId,Q=V===void 0?F.yAxisId:V;return N.cloneElement(C,{key:C.key||"".concat(_,"-").concat($),xAxis:O[te],yAxis:R[Q],viewBox:{x:B.left,y:B.top,width:B.width,height:B.height},clipPathId:A})}),ut(w,"renderActivePoints",function(C){var _=C.item,$=C.activePoint,k=C.basePoint,A=C.childIndex,P=C.isRange,O=[],R=_.props.key,B=_.item.type.defaultProps!==void 0?ve(ve({},_.item.type.defaultProps),_.item.props):_.item.props,F=B.activeDot,L=B.dataKey,H=ve(ve({index:A,dataKey:L,cx:$.x,cy:$.y,r:4,fill:lR(_.item),strokeWidth:2,stroke:"#fff",payload:$.payload,value:$.value},nt(F,!1)),Zw(F));return O.push(y.renderActiveDot(F,H,"".concat(R,"-activePoint-").concat(A))),k?O.push(y.renderActiveDot(F,ve(ve({},H),{},{cx:k.x,cy:k.y}),"".concat(R,"-basePoint-").concat(A))):P&&O.push(null),O}),ut(w,"renderGraphicChild",function(C,_,$){var k=w.filterFormatItem(C,_,$);if(!k)return null;var A=w.getTooltipEventType(),P=w.state,O=P.isTooltipActive,R=P.tooltipAxis,B=P.activeTooltipIndex,F=P.activeLabel,L=w.props.children,H=cs(L,Go),te=k.props,V=te.points,Q=te.isRange,se=te.baseLine,le=k.item.type.defaultProps!==void 0?ve(ve({},k.item.type.defaultProps),k.item.props):k.item.props,ue=le.activeDot,ce=le.hide,re=le.activeBar,ge=le.activeShape,Se=!!(!ce&&O&&H&&(ue||re||ge)),Ne={};A!=="axis"&&H&&H.props.trigger==="click"?Ne={onClick:S0(w.handleItemMouseEnter,C.props.onClick)}:A!=="axis"&&(Ne={onMouseLeave:S0(w.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:S0(w.handleItemMouseEnter,C.props.onMouseEnter)});var we=N.cloneElement(C,ve(ve({},k.props),Ne));function de(It){return typeof R.dataKey=="function"?R.dataKey(It.payload):null}if(Se)if(B>=0){var J,ae;if(R.dataKey&&!R.allowDuplicatedCategory){var U=typeof R.dataKey=="function"?de:"payload.".concat(R.dataKey.toString());J=Jw(V,U,F),ae=Q&&se&&Jw(se,U,F)}else J=V==null?void 0:V[B],ae=Q&&se&&se[B];if(ge||re){var oe=C.props.activeIndex!==void 0?C.props.activeIndex:B;return[N.cloneElement(C,ve(ve(ve({},k.props),Ne),{},{activeIndex:oe})),null,null]}if(!ht(J))return[we].concat($h(w.renderActivePoints({item:k,activePoint:J,basePoint:ae,childIndex:B,isRange:Q})))}else{var ye,be=(ye=w.getItemByXY(w.state.activeCoordinate))!==null&&ye!==void 0?ye:{graphicalItem:we},he=be.graphicalItem,De=he.item,Ve=De===void 0?C:De,Ye=he.childIndex,Ze=ve(ve(ve({},k.props),Ne),{},{activeIndex:Ye});return[N.cloneElement(Ve,Ze),null,null]}return Q?[we,null,null]:[we,null]}),ut(w,"renderCustomized",function(C,_,$){return N.cloneElement(C,ve(ve({key:"recharts-customized-".concat($)},w.props),w.state))}),ut(w,"renderMap",{CartesianGrid:{handler:N0,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:N0},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:N0},YAxis:{handler:N0},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((x=v.id)!==null&&x!==void 0?x:Jp("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=w9(w.triggeredAfterMouseMove,(b=v.throttleDelay)!==null&&b!==void 0?b:1e3/60),w.state={},w}return _ft(y,g),bft(y,[{key:"componentDidMount",value:function(){var x,b;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(x=this.props.margin.left)!==null&&x!==void 0?x:0,top:(b=this.props.margin.top)!==null&&b!==void 0?b:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var x=this.props,b=x.children,w=x.data,C=x.height,_=x.layout,$=cs(b,Go);if($){var k=$.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var A=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,P=vT(this.state,w,k,A),O=this.state.tooltipTicks[k].coordinate,R=(this.state.offset.top+C)/2,B=_==="horizontal",F=B?{x:O,y:R}:{y:O,x:R},L=this.state.formattedGraphicalItems.find(function(te){var V=te.item;return V.type.name==="Scatter"});L&&(F=ve(ve({},F),L.props.points[k].tooltipPosition),P=L.props.points[k].tooltipPayload);var H={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:A,activePayload:P,activeCoordinate:F};this.setState(H),this.renderCursor($),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(x,b){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==b.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==x.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==x.margin){var w,C;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(x){qN([cs(x.children,Go)],[cs(this.props.children,Go)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var x=cs(this.props.children,Go);if(x&&typeof x.props.shared=="boolean"){var b=x.props.shared?"axis":"item";return i.indexOf(b)>=0?b:s}return s}},{key:"getMouseInfo",value:function(x){if(!this.container)return null;var b=this.container,w=b.getBoundingClientRect(),C=dZe(w),_={chartX:Math.round(x.pageX-C.left),chartY:Math.round(x.pageY-C.top)},$=w.width/b.offsetWidth||1,k=this.inRange(_.chartX,_.chartY,$);if(!k)return null;var A=this.state,P=A.xAxisMap,O=A.yAxisMap,R=this.getTooltipEventType();if(R!=="axis"&&P&&O){var B=Yd(P).scale,F=Yd(O).scale,L=B&&B.invert?B.invert(_.chartX):null,H=F&&F.invert?F.invert(_.chartY):null;return ve(ve({},_),{},{xValue:L,yValue:H})}var te=_4(this.state,this.props.data,this.props.layout,k);return te?ve(ve({},_),te):null}},{key:"inRange",value:function(x,b){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,_=x/w,$=b/w;if(C==="horizontal"||C==="vertical"){var k=this.state.offset,A=_>=k.left&&_<=k.left+k.width&&$>=k.top&&$<=k.top+k.height;return A?{x:_,y:$}:null}var P=this.state,O=P.angleAxisMap,R=P.radiusAxisMap;if(O&&R){var B=Yd(O);return QL({x:_,y:$},B)}return null}},{key:"parseEventsOfWrapper",value:function(){var x=this.props.children,b=this.getTooltipEventType(),w=cs(x,Go),C={};w&&b==="axis"&&(w.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var _=Zw(this.props,this.handleOuterEvent);return ve(ve({},_),C)}},{key:"addListener",value:function(){P$.on(O$,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){P$.removeListener(O$,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(x,b,w){for(var C=this.state.formattedGraphicalItems,_=0,$=C.length;_<$;_++){var k=C[_];if(k.item===x||k.props.key===x.key||b===Fi(k.item.type)&&w===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var x=this.clipPathId,b=this.state.offset,w=b.left,C=b.top,_=b.height,$=b.width;return K.createElement("defs",null,K.createElement("clipPath",{id:x},K.createElement("rect",{x:w,y:C,height:_,width:$})))}},{key:"getXScales",value:function(){var x=this.state.xAxisMap;return x?Object.entries(x).reduce(function(b,w){var C=w4(w,2),_=C[0],$=C[1];return ve(ve({},b),{},ut({},_,$.scale))},{}):null}},{key:"getYScales",value:function(){var x=this.state.yAxisMap;return x?Object.entries(x).reduce(function(b,w){var C=w4(w,2),_=C[0],$=C[1];return ve(ve({},b),{},ut({},_,$.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(x){var b;return(b=this.state.xAxisMap)===null||b===void 0||(b=b[x])===null||b===void 0?void 0:b.scale}},{key:"getYScaleByAxisId",value:function(x){var b;return(b=this.state.yAxisMap)===null||b===void 0||(b=b[x])===null||b===void 0?void 0:b.scale}},{key:"getItemByXY",value:function(x){var b=this.state,w=b.formattedGraphicalItems,C=b.activeItem;if(w&&w.length)for(var _=0,$=w.length;_<$;_++){var k=w[_],A=k.props,P=k.item,O=P.type.defaultProps!==void 0?ve(ve({},P.type.defaultProps),P.props):P.props,R=Fi(P.type);if(R==="Bar"){var B=(A.data||[]).find(function(te){return Lot(x,te)});if(B)return{graphicalItem:k,payload:B}}else if(R==="RadialBar"){var F=(A.data||[]).find(function(te){return QL(x,te)});if(F)return{graphicalItem:k,payload:F}}else if(IC(k,C)||TC(k,C)||qy(k,C)){var L=Nlt({graphicalItem:k,activeTooltipItem:C,itemData:O.data}),H=O.activeIndex===void 0?L:O.activeIndex;return{graphicalItem:ve(ve({},k),{},{childIndex:H}),payload:qy(k,C)?O.data[L]:k.props.data[L]}}}return null}},{key:"render",value:function(){var x=this;if(!zM(this))return null;var b=this.props,w=b.children,C=b.className,_=b.width,$=b.height,k=b.style,A=b.compact,P=b.title,O=b.desc,R=S4(b,hft),B=nt(R,!1);if(A)return K.createElement(s4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},K.createElement(XN,Ig({},B,{width:_,height:$,title:P,desc:O}),this.renderClipPath(),VM(w,this.renderMap)));if(this.props.accessibilityLayer){var F,L;B.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,B.role=(L=this.props.role)!==null&&L!==void 0?L:"application",B.onKeyDown=function(te){x.accessibilityManager.keyboardEvent(te)},B.onFocus=function(){x.accessibilityManager.focus()}}var H=this.parseEventsOfWrapper();return K.createElement(s4,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},K.createElement("div",Ig({className:xt("recharts-wrapper",C),style:ve({position:"relative",cursor:"default",width:_,height:$},k)},H,{ref:function(V){x.container=V}}),K.createElement(XN,Ig({},B,{width:_,height:$,title:P,desc:O,style:Eft}),this.renderClipPath(),VM(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(N.Component);return ut(p,"displayName",n),ut(p,"defaultProps",ve({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),ut(p,"getDerivedStateFromProps",function(g,y){var v=g.dataKey,x=g.data,b=g.children,w=g.width,C=g.height,_=g.layout,$=g.stackOffset,k=g.margin,A=y.dataStartIndex,P=y.dataEndIndex;if(y.updateId===void 0){var O=$4(g);return ve(ve(ve({},O),{},{updateId:0},h(ve(ve({props:g},O),{},{updateId:0}),y)),{},{prevDataKey:v,prevData:x,prevWidth:w,prevHeight:C,prevLayout:_,prevStackOffset:$,prevMargin:k,prevChildren:b})}if(v!==y.prevDataKey||x!==y.prevData||w!==y.prevWidth||C!==y.prevHeight||_!==y.prevLayout||$!==y.prevStackOffset||!Tf(k,y.prevMargin)){var R=$4(g),B={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},F=ve(ve({},_4(y,x,_)),{},{updateId:y.updateId+1}),L=ve(ve(ve({},R),B),F);return ve(ve(ve({},L),h(ve({props:g},L),y)),{},{prevDataKey:v,prevData:x,prevWidth:w,prevHeight:C,prevLayout:_,prevStackOffset:$,prevMargin:k,prevChildren:b})}if(!qN(b,y.prevChildren)){var H,te,V,Q,se=cs(b,mh),le=se&&(H=(te=se.props)===null||te===void 0?void 0:te.startIndex)!==null&&H!==void 0?H:A,ue=se&&(V=(Q=se.props)===null||Q===void 0?void 0:Q.endIndex)!==null&&V!==void 0?V:P,ce=le!==A||ue!==P,re=!ht(x),ge=re&&!ce?y.updateId:y.updateId+1;return ve(ve({updateId:ge},h(ve(ve({props:g},y),{},{updateId:ge,dataStartIndex:le,dataEndIndex:ue}),y)),{},{prevChildren:b,dataStartIndex:le,dataEndIndex:ue})}return null}),ut(p,"renderActiveDot",function(g,y,v){var x;return N.isValidElement(g)?x=N.cloneElement(g,y):vt(g)?x=g(y):x=K.createElement(CC,y),K.createElement(qt,{className:"recharts-active-dot",key:v},x)}),function(y){return K.createElement(p,y)}},Bft=HQ({chartName:"LineChart",GraphicalChild:gb,axisComponents:[{axisType:"xAxis",AxisComp:jC},{axisType:"yAxis",AxisComp:MC}],formatAxisMap:ict}),zft=HQ({chartName:"PieChart",GraphicalChild:ol,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:NC},{axisType:"radiusAxis",AxisComp:$C}],formatAxisMap:uat,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Uft=["Pernas","Braços","Ombros","Peito","Costas","Abdômen"],Vft={Agachamento:"Pernas","Leg Press":"Pernas","Rosca Bíceps":"Braços",Tríceps:"Braços"};function xT(t){const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-n);const r=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-r)/864e5+1)/7)}function N4(t){const e=new Date(t+"T00:00:00Z"),n=xT(e),r=e.getUTCFullYear();return{week:n,year:r}}const Wft=[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}];function Wm(t){const e=new Set;return(t||[]).filter(n=>{const r=`${n.exercise_name}-${n.series_number}-${n.repetition_number}`;return e.has(r)?!1:(e.add(r),!0)})}function Gft(t,e){var r;let n={};if(typeof window<"u"){const a=localStorage.getItem("parametrosTreino");a&&(n=JSON.parse(a))}return(!n||!n[t]||!n[t][e])&&(n={Iniciante:{Agachamento:{anguloMax:120,anguloMin:60,amplitude:60,velocidadeSubida:1,velocidadeDescida:1.2,tempoExecucao:2.2},"Rosca Bíceps":{anguloMax:110,anguloMin:40,amplitude:70,velocidadeSubida:.8,velocidadeDescida:1,tempoExecucao:1.8},Supino:{anguloMax:100,anguloMin:30,amplitude:70,velocidadeSubida:1.1,velocidadeDescida:1.2,tempoExecucao:2.3}},"IFBB Pro":{Agachamento:{anguloMax:130,anguloMin:50,amplitude:80,velocidadeSubida:.9,velocidadeDescida:1.1,tempoExecucao:2},"Rosca Bíceps":{anguloMax:120,anguloMin:30,amplitude:90,velocidadeSubida:.7,velocidadeDescida:.9,tempoExecucao:1.6},Supino:{anguloMax:110,anguloMin:20,amplitude:90,velocidadeSubida:1,velocidadeDescida:1.1,tempoExecucao:2.1}}}),((r=n==null?void 0:n[t])==null?void 0:r[e])||null}function Hft(t,e,n){if(!n)return{boas:0,total:0};let r=0,a=0;return t.forEach(s=>{const i=(s.extra_data||{})[e];i!=null&&typeof i=="number"&&(a++,i>=n*.95&&i<=n*1.05&&r++)}),{boas:r,total:a}}const qft=()=>{const t=zn(),[e,n]=N.useState("semana"),[r,a]=N.useState(new Date().getFullYear()),[s,o]=N.useState(xT(new Date)),[i,l]=N.useState(""),[u,c]=N.useState(null),[d,f]=N.useState({}),[h,p]=N.useState(!0),[g,y]=N.useState(null),[v,x]=N.useState(null),[b,w]=N.useState(!1),[C,_]=N.useState(null),[$,k]=N.useState(null),A=K.useRef(null);function P(){if(A.current){const J=A.current.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:J,behavior:"smooth"})}}const[O,R]=K.useState("minAngle");function B(J){switch(J){case"minAngle":return"Ângulo Mínimo (º)";case"maxAngle":return"Ângulo Máximo (º)";case"executionTime":return"Tempo Execução (s)";case"amplitude":return"Amplitude (º)";case"upVelocity":return"Vel. Subida (º/s)";case"downVelocity":return"Vel. Descida (º/s)";default:return""}}const[F,L]=K.useState(1),[H,te]=N.useState(null),[V,Q]=N.useState(Ea[0]),[se,le]=N.useState(0),[ue,ce]=N.useState(!0);N.useEffect(()=>{(async()=>{p(!0);const{data:ae}=await Pt.from("workout_history").select("id, date").order("date",{ascending:!1}),{data:U}=await Pt.from("workout_sets").select("workout_id, exercise_name, series_number, completed"),oe={};(ae||[]).forEach(ye=>{const be=ye.date.split("T")[0];oe[be]||(oe[be]=[]);const he=(U||[]).filter(De=>De.workout_id===ye.id);oe[be].push(...he.map(De=>({...De,area:Vft[De.exercise_name]||"Outros"})))}),f(oe),p(!1)})()},[]);const re=Object.keys(d);let ge=[];e==="semana"?ge=re.filter(J=>{const ae=new Date(J+"T00:00:00Z");return xT(ae)===s&&ae.getUTCFullYear()===r}):e==="dia"&&i&&(ge=[i]);const Se=Uft.map(J=>{let ae=[];if(e==="semana"){const U=s,oe=r;re.forEach(ye=>{const{week:be,year:he}=N4(ye);be===U&&he===oe&&(d[ye]||[]).filter(Ve=>Ve.area===J).forEach(Ve=>{if(!Ve.exercise_name)return;let Ye=ae.find(Ze=>Ze.nome===Ve.exercise_name&&Ze.semana===U&&Ze.ano===oe);if(!Ye){console.log("datasFiltradas",ge);const Ze=ge.map(rn=>(d[rn]||[]).filter(an=>an.exercise_name===Ve.exercise_name&&an.area===J)).flat();console.log("setsDaSemana",Ze);const It=Array.from(new Set(Ze.map(rn=>rn.series_number))).filter(rn=>rn!=null).sort((rn,an)=>rn-an);ae.push({nome:Ve.exercise_name,area:J,semana:U,ano:oe,series:0,seriesExecutadas:It}),Ye=ae[ae.length-1]}Ve.completed&&(Ye.series+=1)})})}else ge.forEach(U=>{const oe=(d[U]||[]).filter(be=>be.area===J),ye={};oe.forEach(be=>{if(be.exercise_name){if(!ye[be.exercise_name]){const{week:he,year:De}=N4(U);ye[be.exercise_name]={nome:be.exercise_name,area:J,semana:he,ano:De,series:0,seriesExecutadas:[]}}be.completed&&(ye[be.exercise_name].series+=1)}}),ae=ae.concat(Object.values(ye))});return{area:J,exercicios:ae}}),Ne=Array.from({length:53},(J,ae)=>ae+1),we=N.useCallback(async J=>{x(J),w(!0),y(null),_(null),k(null);let ae=[];if(e==="semana"){let be=function(It,rn){const an=new Date(rn,0,1+(It-1)*7),ar=an.getDay(),Nr=an;ar<=4?Nr.setDate(an.getDate()-an.getDay()+1):Nr.setDate(an.getDate()+8-an.getDay());const Zr=new Date(Nr),Te=new Date(Nr);return Te.setDate(Zr.getDate()+7),{start:Zr,end:Te}};const{start:he,end:De}=be(J.semana,J.ano),Ve=he.toISOString().split("T")[0]+"T00:00:00",Ye=De.toISOString().split("T")[0]+"T00:00:00",{data:Ze}=await Pt.from("workout_history").select("id, date").gte("date",Ve).lt("date",Ye);ae=Ze||[]}else if(J.data){const be=J.data+"T00:00:00",he=new Date(new Date(J.data).getTime()+24*60*60*1e3).toISOString().split("T")[0]+"T00:00:00",{data:De}=await Pt.from("workout_history").select("id, date").gte("date",be).lt("date",he);ae=De||[]}if(console.log("workout_history retornados:",ae),_(ae),!ae||ae.length===0){y([]),w(!1),setTimeout(P,100);return}let U=[];if(e==="semana"){const be=ae.map(De=>De.id),{data:he}=await Pt.from("workout_sets").select("id, workout_id, exercise_name, series_number").in("workout_id",be).eq("exercise_name",J.nome);U=he||[]}else if(e==="dia"){const be=ae[0].id,{data:he}=await Pt.from("workout_sets").select("id, workout_id, exercise_name, series_number").eq("workout_id",be).eq("exercise_name",J.nome);U=he||[]}if(console.log("workout_sets retornados:",U),k(U),!U||U.length===0){y([]),w(!1),setTimeout(P,100);return}const oe=U.map(be=>be.id);console.log("set_id usados:",oe);let ye=[];if(oe.length>0){const{data:be}=await Pt.from("workout_metrics").select("*").in("set_id",oe);ye=be||[];const he={};U.forEach(De=>{he[De.id]=De}),ye=ye.map(De=>{var Ve,Ye;return{...De,workout_id:(Ve=he[De.set_id])==null?void 0:Ve.workout_id,series_number:((Ye=he[De.set_id])==null?void 0:Ye.series_number)??1}})}if(console.log("métricas retornadas:",ye),e==="dia"){const be={};U.forEach(he=>{be[he.id]=he.series_number||1}),ye=ye.map(he=>({...he,series_number:be[he.set_id]||1})).sort((he,De)=>{const Ve=he.series_number||1,Ye=De.series_number||1;if(Ve!==Ye)return Ve-Ye;const Ze=he.repetition_number||1,It=De.repetition_number||1;return Ze-It})}y(ye),w(!1),setTimeout(P,100)},[e,re]);if(g&&g.length>0)if(e==="semana"){const J=ge.map(oe=>(d[oe]||[]).filter(ye=>ye.exercise_name===(v==null?void 0:v.nome))).flat(),ae=Array.from(new Set(J.map(oe=>oe.series_number))).filter(oe=>oe!=null).sort((oe,ye)=>oe-ye);Math.max(...J.map(oe=>oe.repetitions||1),1);const U=[];ae.forEach(oe=>{const ye=g.filter(he=>he.series_number===oe).map(he=>he.repetition_number||1),be=ye.length>0?Math.max(...ye):1;for(let he=1;he<=be;he++){const De=g.find(Ve=>Ve.series_number===oe&&Ve.repetition_number===he);U.push({serie:oe,rep:he,metrica:De})}}),U.map((oe,ye)=>{var he;const be=((he=oe.metrica)==null?void 0:he.extra_data)||{};return{label:`S${oe.serie}-R${oe.rep}`,minAngle:be.minAngle!==void 0?Number(be.minAngle):null,maxAngle:be.maxAngle!==void 0?Number(be.maxAngle):null,executionTime:be.executionTime!==void 0?Number(be.executionTime):null,amplitude:be.amplitude!==void 0?Number(be.amplitude):null,upVelocity:be.upVelocity!==void 0?Number(be.upVelocity):null,downVelocity:be.downVelocity!==void 0?Number(be.downVelocity):null}})}else e==="dia"&&[...g].filter(ae=>(ae.series_number||1)===F).sort((ae,U)=>{const oe=ae.repetition_number||1,ye=U.repetition_number||1;return oe-ye}).map((ae,U)=>{const oe=ae.extra_data||{};return{label:`S${ae.series_number||1}-R${ae.repetition_number||U+1}`,minAngle:oe.minAngle!==void 0?Number(oe.minAngle):null,maxAngle:oe.maxAngle!==void 0?Number(oe.maxAngle):null,executionTime:oe.executionTime!==void 0?Number(oe.executionTime):null,amplitude:oe.amplitude!==void 0?Number(oe.amplitude):null,upVelocity:oe.upVelocity!==void 0?Number(oe.upVelocity):null,downVelocity:oe.downVelocity!==void 0?Number(oe.downVelocity):null}});N.useEffect(()=>{v&&console.log("selectedMetrics para renderização:",g)},[v,g]);let de=[];return e==="dia"&&g&&g.length>0&&(de=[...g].filter(J=>(J.series_number||1)===F).sort((J,ae)=>{const U=J.repetition_number||1,oe=ae.repetition_number||1;return U-oe})),m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex flex-col items-center justify-center",children:m.jsxs("div",{className:"flex flex-col md:flex-row w-full max-w-6xl gap-6",children:[m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 w-full md:w-1/2 max-w-md",children:[m.jsxs("div",{className:"mb-4 flex items-center",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-2xl font-bold text-center flex-1",children:"Minhas métricas"})]}),m.jsxs("div",{className:"flex gap-4 mb-6 justify-center",children:[m.jsx(pe,{variant:e==="semana"?"default":"outline",onClick:()=>n("semana"),children:"Semana/Ano"}),m.jsx(pe,{variant:e==="dia"?"default":"outline",onClick:()=>n("dia"),children:"Dia"})]}),e==="semana"?m.jsxs("div",{className:"flex gap-4 mb-6 justify-center",children:[m.jsx("select",{value:s,onChange:J=>o(Number(J.target.value)),className:"border rounded px-2 py-1",children:Ne.map(J=>m.jsxs("option",{value:J,children:["Semana ",J]},J))}),m.jsx("select",{value:r,onChange:J=>a(Number(J.target.value)),className:"border rounded px-2 py-1",children:[r-1,r,r+1].map(J=>m.jsx("option",{value:J,children:J},J))})]}):m.jsx("div",{className:"flex gap-4 mb-6 justify-center",children:m.jsxs("select",{value:i,onChange:J=>l(J.target.value),className:"border rounded px-2 py-1",children:[m.jsx("option",{value:"",children:"Selecione o dia"}),re.map(J=>m.jsx("option",{value:J,children:J},J))]})}),h?m.jsx("div",{className:"text-center",children:"Carregando..."}):m.jsx("div",{className:"space-y-2",children:Se.map(({area:J,exercicios:ae})=>m.jsxs("div",{className:"bg-gray-100 rounded p-3",children:[m.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>c(u===J?null:J),children:[m.jsx("span",{className:"font-semibold",children:J}),u===J?m.jsx(dV,{}):m.jsx(fV,{})]}),u===J&&m.jsxs("ul",{className:"mt-2 space-y-1",children:[ae.length===0&&m.jsx("li",{className:"text-gray-400 text-sm",children:"Nenhum exercício registrado"}),ae.map((U,oe)=>e==="semana"?m.jsx("li",{className:"flex items-start gap-4 px-2 py-1 rounded cursor-pointer",onClick:()=>we(U),children:m.jsx("div",{className:"flex-1",children:m.jsxs("span",{className:"block text-left",children:[m.jsx("span",{className:"font-semibold",children:U.area})," - ",U.nome," (Semana ",U.semana,"/",U.ano,")",U.seriesExecutadas&&U.seriesExecutadas.length>0&&m.jsx("ul",{className:"ml-4 mt-1 text-xs text-gray-600 list-disc",children:U.seriesExecutadas.map(ye=>m.jsxs("li",{children:["Série ",ye]},ye))})]})})},U.nome+U.semana+U.ano):m.jsx("li",{className:"flex items-start gap-4 px-2 py-1 rounded cursor-pointer",onClick:()=>we({nome:U.nome,data:ge[0]}),children:m.jsx("div",{className:"flex-1",children:m.jsxs("span",{className:"block text-left",children:[U.nome,ge[0]?` (${new Date(ge[0]+"T00:00:00").toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})`:""]})})},U.nome+U.semana+U.ano))]})]},J))})]}),v&&m.jsxs("div",{ref:A,className:"bg-white rounded-lg shadow-md p-6 w-full md:w-1/2 max-w-2xl flex flex-col",children:[m.jsxs("div",{className:"mb-2 font-bold text-lg text-center text-formfit-blue",children:[v.nome," ",e==="semana"&&v.semana&&v.ano?`(Semana ${v.semana}/${v.ano})`:"",e==="dia"&&v.data?` (${new Date(v.data+"T00:00:00").toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})})`:""]}),b?m.jsx("div",{className:"text-center text-sm text-gray-500",children:"Carregando métricas..."}):e==="dia"?m.jsx(m.Fragment,{children:m.jsx("div",{style:{overflowX:"auto",maxWidth:"100%"},children:(()=>{if(!de||de.length===0)return m.jsxs("table",{className:"text-xs w-full min-w-max",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"py-1 px-2 text-left",children:"Indicador"}),m.jsx("th",{className:"py-1 px-2 text-left",children:"Repetição 1"})]})}),m.jsx("tbody",{children:m.jsx("tr",{children:m.jsx("td",{colSpan:10,children:"Nenhuma métrica encontrada."})})})]});const J=Array.from(new Set(de.map(oe=>oe.repetition_number||1))),ae={};J.forEach(oe=>{ae[oe]=de.find(ye=>(ye.repetition_number||1)===oe)});const U=[{key:"minAngle",label:"Ângulo Mínimo",sufixo:"º",casas:1},{key:"maxAngle",label:"Ângulo Máximo",sufixo:"º",casas:1},{key:"executionTime",label:"Tempo Execução",sufixo:"",casas:2},{key:"amplitude",label:"Amplitude",sufixo:"º",casas:1},{key:"upVelocity",label:"Vel. Subida",sufixo:"º/s",casas:2},{key:"downVelocity",label:"Vel. Descida",sufixo:"º/s",casas:2}];return m.jsxs("table",{className:"text-xs w-full min-w-max",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"py-1 px-2 text-left",children:"Indicador"}),J.map((oe,ye)=>m.jsxs("th",{className:"py-1 px-2 text-center",children:["Repetição ",oe]},ye))]})}),m.jsx("tbody",{children:U.map((oe,ye)=>m.jsxs("tr",{children:[m.jsx("td",{className:"py-1 px-2 font-semibold",children:oe.label}),J.map((be,he)=>{const De=ae[be],Ve=(De==null?void 0:De.extra_data)||{};let Ye="-";return De&&Ve[oe.key]!==void 0&&Ve[oe.key]!==null&&(Ye=typeof Ve[oe.key]=="number"?Number(Ve[oe.key]).toFixed(oe.casas):Ve[oe.key],oe.sufixo&&(Ye+=oe.sufixo)),m.jsx("td",{className:"py-1 px-2 text-center",children:Ye},he)})]},ye))})]})})()})}):e==="semana"?m.jsx(m.Fragment,{children:m.jsx("div",{style:{overflowX:"auto",maxWidth:"100%"},children:(()=>{const J=Wm(g);if(!J||J.length===0)return m.jsxs("table",{className:"text-xs w-full min-w-max",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"py-1 px-2 text-left",children:"Indicador"}),m.jsx("th",{className:"py-1 px-2 text-left",children:"Repetição 1"})]})}),m.jsx("tbody",{children:m.jsx("tr",{children:m.jsx("td",{colSpan:10,children:"Nenhuma métrica encontrada."})})})]});const ae=[...J].sort((be,he)=>{const De=be.series_number||1,Ve=he.series_number||1;if(De!==Ve)return De-Ve;const Ye=be.repetition_number||1,Ze=he.repetition_number||1;return Ye-Ze}),U=Array.from(new Set(ae.map(be=>be.repetition_number||1))),oe={};U.forEach(be=>{oe[be]=ae.find(he=>(he.repetition_number||1)===be)});const ye=[{key:"minAngle",label:"Ângulo Mínimo",sufixo:"º",casas:1},{key:"maxAngle",label:"Ângulo Máximo",sufixo:"º",casas:1},{key:"executionTime",label:"Tempo Execução",sufixo:"",casas:2},{key:"amplitude",label:"Amplitude",sufixo:"º",casas:1},{key:"upVelocity",label:"Vel. Subida",sufixo:"º/s",casas:2},{key:"downVelocity",label:"Vel. Descida",sufixo:"º/s",casas:2}];return m.jsxs("table",{className:"text-xs w-full min-w-max",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"py-1 px-2 text-left",children:"Indicador"}),U.map((be,he)=>m.jsxs("th",{className:"py-1 px-2 text-center",children:["Repetição ",be]},he))]})}),m.jsx("tbody",{children:ye.map((be,he)=>m.jsxs("tr",{children:[m.jsx("td",{className:"py-1 px-2 font-semibold",children:be.label}),U.map((De,Ve)=>{const Ye=oe[De],Ze=(Ye==null?void 0:Ye.extra_data)||{};let It="-";return Ye&&Ze[be.key]!==void 0&&Ze[be.key]!==null&&(It=typeof Ze[be.key]=="number"?Number(Ze[be.key]).toFixed(be.casas):Ze[be.key],be.sufixo&&(It+=be.sufixo)),m.jsx("td",{className:"py-1 px-2 text-center",children:It},Ve)})]},he))})]})})()})}):null,m.jsxs("div",{className:"mt-6",children:[m.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[m.jsx("label",{htmlFor:"indicador-grafico",className:"font-medium text-sm",children:"Indicador:"}),m.jsxs("select",{id:"indicador-grafico",className:"border rounded px-2 py-1 text-sm",value:O,onChange:J=>R(J.target.value),children:[m.jsx("option",{value:"minAngle",children:"Ângulo Mínimo"}),m.jsx("option",{value:"maxAngle",children:"Ângulo Máximo"}),m.jsx("option",{value:"executionTime",children:"Tempo Execução"}),m.jsx("option",{value:"amplitude",children:"Amplitude"}),m.jsx("option",{value:"upVelocity",children:"Vel. Subida"}),m.jsx("option",{value:"downVelocity",children:"Vel. Descida"})]})]}),(e==="dia"?de.length>0:Wm(g).length>0)&&m.jsx("div",{style:{width:"100%",height:300},children:m.jsx(aZe,{width:"100%",height:300,children:m.jsxs(Bft,{data:(e==="dia"?de:Wm(g)).map((J,ae)=>{const U=J.extra_data||{};return{label:`S${J.series_number||1}-R${J.repetition_number||ae+1}`,minAngle:U.minAngle!==void 0?Number(U.minAngle):null,maxAngle:U.maxAngle!==void 0?Number(U.maxAngle):null,executionTime:U.executionTime!==void 0?Number(U.executionTime):null,amplitude:U.amplitude!==void 0?Number(U.amplitude):null,upVelocity:U.upVelocity!==void 0?Number(U.upVelocity):null,downVelocity:U.downVelocity!==void 0?Number(U.downVelocity):null}}),margin:{top:20,right:30,left:0,bottom:0},children:[m.jsx(jC,{dataKey:"label"}),m.jsx(MC,{domain:["auto","auto"]}),m.jsx(Go,{formatter:J=>J!=null?Number(J).toFixed(2):"-"}),m.jsx(gb,{type:"monotone",dataKey:O,stroke:"#2563eb",strokeWidth:2,dot:{r:3},activeDot:{r:5}})]})})}),v&&(e==="dia"?de.length:Wm(g).length)>0&&(()=>{const ae=Gft(V||"Iniciante",v.nome),oe=ae?ae[{minAngle:"anguloMin",maxAngle:"anguloMax",executionTime:"tempoExecucao",amplitude:"amplitude",upVelocity:"velocidadeSubida",downVelocity:"velocidadeDescida"}[O]]:null,ye=e==="dia"?de:Wm(g),{boas:be,total:he}=Hft(ye,O,oe),De=[{name:"Boa Execução",value:be},{name:"Fora do Ideal",value:he-be}],Ve=["#22c55e","#ef4444"];return m.jsxs("div",{className:"flex flex-col items-center mt-8",children:[m.jsxs("h3",{className:"font-semibold mb-2 text-sm",children:["Proporção de execuções boas (",B(O),")"]}),m.jsxs(zft,{width:220,height:220,children:[m.jsx(ol,{data:De,cx:110,cy:110,innerRadius:50,outerRadius:90,fill:"#8884d8",paddingAngle:2,dataKey:"value",label:({name:Ye,percent:Ze})=>`${Ye}: ${(Ze*100).toFixed(0)}%`,children:De.map((Ye,Ze)=>m.jsx(dC,{fill:Ve[Ze%Ve.length]},`cell-${Ze}`))}),m.jsx(vc,{})]}),m.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Considera execuções dentro de ±5% do parâmetro como boas"})]})})()]})]})]})}),m.jsx(rr,{}),H&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Configurar Execução"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsx("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:V,onChange:J=>Q(J.target.value),children:Ea.map(J=>m.jsx("option",{value:J,children:J},J))})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{se>0&&le(se-1),ce(!1)},disabled:ue||se===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:ue?"Sem carga":`${se} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{le(se+1),ce(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:ue?"default":"outline",className:ue?"bg-purple-600 text-white":"",onClick:()=>{ce(!0),le(0)},children:"Sem carga"})]})]}),m.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[m.jsx(pe,{variant:"outline",onClick:()=>te(null),children:"Cancelar"}),m.jsx(pe,{className:"bg-green-600 hover:bg-green-700 text-white font-bold",onClick:()=>{const J=Wft.find(ae=>ae.name===H.exercicio.nome||ae.id===H.exercicio.id)||{id:H.exercicio.id,name:H.exercicio.nome};localStorage.setItem("currentExercise",JSON.stringify({id:J.id,name:J.name,modelo:V,carga:ue?null:se,area:H.exercicio.area||"",semana:H.exercicio.semana,ano:H.exercicio.ano,data:H.exercicio.data})),te(null),t("/workout-flow/execution")},children:"Iniciar"})]})]})})]})},Kft={Pernas:[{id:"agachamento",name:"Agachamento"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"}],Braços:[{id:"curl",name:"Rosca Bíceps"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"}],Peito:[{id:"pushup",name:"Flexão de Braço"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"}],Costas:[{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"}],Abdômen:[{id:"abdominal",name:"Abdominal"}],Ombros:[{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}]};function Xft(){return new URLSearchParams(Po().search)}const Yft=()=>{const t=zn(),n=Xft().get("treino")||"",[r,a]=N.useState([]),[s,o]=N.useState(null),[i,l]=N.useState(null),[u,c]=N.useState(Ea[0]),[d,f]=N.useState(0),[h,p]=N.useState(!0),[g,y]=N.useState([]);N.useEffect(()=>{if(!n){console.error('Parâmetro "treino" não encontrado na URL.'),o("Parâmetro de treino não informado. Volte e selecione um treino personalizado."),a([]);return}try{const x=typeof window<"u"?JSON.parse(localStorage.getItem("treinosPersonalizados")||"[]"):[];if(!Array.isArray(x))throw new Error("Formato inválido nos treinos salvos.");const b=x.find(C=>C.nome===n);if(!b||!Array.isArray(b.treinos))throw new Error("Treino não encontrado.");let w=[];b.treinos.forEach(C=>{(Kft[C.area]||[]).forEach(_=>{(C.exercicios||[]).includes(_.id)&&w.push({area:C.area,ex:_})})}),a(w),o(null)}catch{o("Não foi possível carregar os treinos personalizados. Por favor, configure novamente seu treino personalizado."),a([])}},[n]),N.useEffect(()=>{(async()=>{const{data:{user:b}}=await Pt.auth.getUser();if(b){const{data:w,error:C}=await Pt.from("treino_ia").select("*").eq("user_id",b.id);!C&&w&&(y(w),localStorage.setItem("treinosIA",JSON.stringify(w)))}})()},[]);const v=(x,b)=>{if(b<0||b>=r.length)return;const w=[...r],[C]=w.splice(x,1);w.splice(b,0,C),a(w)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex flex-col items-center justify-center",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 w-full max-w-md",children:[m.jsxs("div",{className:"mb-4 flex items-center",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>t(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsxs("h1",{className:"text-2xl font-bold text-center flex-1",children:["Treino Personalizado - ",n]})]}),m.jsxs("div",{className:"mb-6",children:[m.jsx("div",{className:"font-semibold mb-2",children:"Exercícios do dia:"}),s?m.jsx("div",{className:"text-red-600 text-center font-semibold py-4",children:s}):m.jsx("ul",{className:"space-y-2",children:r.map((x,b)=>m.jsxs("li",{className:"flex items-center justify-between bg-gray-100 rounded px-3 py-2",children:[m.jsxs("div",{children:[m.jsx("span",{className:"font-medium",children:x.ex.name}),m.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",x.area,")"]})]}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>v(b,b-1),disabled:b===0,children:m.jsx(CE,{})}),m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>v(b,b+1),disabled:b===r.length-1,children:m.jsx(SE,{})}),m.jsx(pe,{variant:"default",size:"icon",onClick:()=>{l({exercicio:x.ex,area:x.area}),c(Ea[0]),f(0),p(!0)},children:m.jsx(ko,{})})]})]},x.ex.id+b))})]})]})}),i&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:m.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full",children:[m.jsx("h2",{className:"text-lg font-bold mb-4",children:"Configurar Execução"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Modelo de treino"}),m.jsx("select",{className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-formfit-blue",value:u,onChange:x=>c(x.target.value),children:Ea.map(x=>m.jsx("option",{value:x,children:x},x))})]}),m.jsxs("div",{className:"mb-4",children:[m.jsx("label",{className:"block mb-2 font-medium",children:"Carga"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{d>0&&f(d-1),p(!1)},disabled:h||d===0,children:"-"}),m.jsx("span",{className:"text-2xl font-bold min-w-[3rem] text-center",children:h?"Sem carga":`${d} kg`}),m.jsx(pe,{type:"button",variant:"outline",size:"icon",onClick:()=>{f(d+1),p(!1)},children:"+"}),m.jsx(pe,{type:"button",variant:h?"default":"outline",className:h?"bg-purple-600 text-white":"",onClick:()=>{p(!0),f(0)},children:"Sem carga"})]})]}),m.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[m.jsx(pe,{variant:"outline",onClick:()=>l(null),children:"Cancelar"}),m.jsx(pe,{className:"bg-green-600 hover:bg-green-700 text-white font-bold",onClick:()=>{const x=_=>nO(_||"").toLowerCase(),w=[{id:"squat",name:"Agachamento"},{id:"agachamento",name:"Agachamento"},{id:"push-up",name:"Flexão de Braço"},{id:"pushup",name:"Flexão de Braço"},{id:"flexao",name:"Flexão de Braço"},{id:"biceps-curl",name:"Rosca Bíceps"},{id:"curl",name:"Rosca Bíceps"},{id:"afundo",name:"Avanço"},{id:"leg-press",name:"Leg Press"},{id:"cadeira-extensora",name:"Cadeira Extensora"},{id:"hammer-curl",name:"Rosca Hammer"},{id:"triceps",name:"Extensão de Tríceps"},{id:"rosca-triceps",name:"Rosca Tríceps"},{id:"supino",name:"Supino"},{id:"crossover",name:"Crossover"},{id:"crossover-baixo",name:"Crossover Baixo"},{id:"remada",name:"Remada"},{id:"lat-push",name:"Lat Push"},{id:"lat-pull",name:"Lat Pull"},{id:"seated-row",name:"Seated Row"},{id:"abdominal",name:"Abdominal"},{id:"levantamento-lateral",name:"Levantamento Lateral"},{id:"levantamento-frontal",name:"Levantamento Frontal"},{id:"desenvolvimento",name:"Desenvolvimento"},{id:"crucifixo-invertido",name:"Crucifixo Invertido"}].find(_=>x(_.id)===x(i.exercicio.id)||x(_.name)===x(i.exercicio.name))||{id:x(i.exercicio.id),name:i.exercicio.name},C={id:w.id,name:w.name,modelo:u,carga:h?null:d,area:i.area};console.log("Salvando no localStorage (personalizado):",C),localStorage.setItem("currentExercise",JSON.stringify(C)),l(null),t("/workout-flow/execution")},children:"Iniciar"})]})]})}),m.jsx(rr,{})]})},Qft=()=>{const[t,e]=N.useState(!0),[n,r]=N.useState(!1),[a,s]=N.useState(null),[o,i]=N.useState({}),[l,u]=N.useState(""),c=zn(),{toast:d}=Xr();N.useEffect(()=>{(async()=>{e(!0);const{data:{user:g},error:y}=await Pt.auth.getUser();if(!g||y){d({title:"Faça login para acessar o perfil",variant:"destructive"}),c("/login");return}s(g);const{data:v}=await Pt.from("user_profiles").select("*").eq("id",g.id).single();i(v||{}),e(!1)})()},[c,d]);const f=p=>{i({...o,[p.target.name]:p.target.value})},h=async p=>{p.preventDefault(),r(!0);const{error:g}=await Pt.from("user_profiles").upsert({id:a.id,full_name:o.full_name,age:Number(o.age),weight:o.weight?Number(o.weight):null,height:o.height?Number(o.height):null,phone:o.phone||null,email:o.email||a.email});if(g){d({title:"Erro ao salvar perfil",description:g.message,variant:"destructive"}),r(!1);return}if(l){const{error:y}=await Pt.auth.updateUser({password:l});if(y){d({title:"Erro ao atualizar senha",description:y.message,variant:"destructive"}),r(!1);return}}d({title:"Perfil atualizado com sucesso!"}),r(!1),u("")};return t?m.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Carregando..."}):m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex items-center justify-center py-8",children:m.jsxs("div",{className:"w-full max-w-md",children:[m.jsxs("div",{className:"mb-4 flex items-center",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>c(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Meu Perfil"})]}),m.jsxs("form",{className:"bg-white rounded-lg shadow-md p-8 w-full space-y-6",onSubmit:h,children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Nome"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"text",name:"full_name",value:o.full_name||"",onChange:f,required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Idade"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"number",name:"age",min:10,max:120,value:o.age||"",onChange:f,required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Peso (kg)"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"number",name:"weight",min:20,max:300,value:o.weight||"",onChange:f})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Altura (cm)"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"number",name:"height",min:100,max:250,value:o.height||"",onChange:f})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Telefone"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"tel",name:"phone",value:o.phone||"",onChange:f})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"E-mail"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"email",name:"email",value:o.email||a.email||"",onChange:f,required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"block font-medium",children:"Nova Senha"}),m.jsx("input",{className:"border rounded px-3 py-2 w-full",type:"password",name:"senha",value:l,onChange:p=>u(p.target.value),placeholder:"Deixe em branco para não alterar"})]}),m.jsx(pe,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold",disabled:n,children:n?"Salvando...":"Salvar"})]})]})}),m.jsx(rr,{})]})},D$=["Iniciante","Resistência","Aesthetics","Glúteos +","IFBB Pro","Pilates Slim"],j$=["Agachamento","Rosca Bíceps","Supino","Flexão de Braço","Tríceps","Leg Press","Avanço","Remada","Abdominal","Desenvolvimento"],Jft={Iniciante:{Agachamento:{carga:"Corpo livre",anguloMax:120,anguloMin:60,amplitude:60,velocidadeSubida:1,velocidadeDescida:1.2,tempoExecucao:2.2},"Rosca Bíceps":{carga:"Leve",anguloMax:110,anguloMin:40,amplitude:70,velocidadeSubida:.8,velocidadeDescida:1,tempoExecucao:1.8},Supino:{carga:"Leve",anguloMax:100,anguloMin:30,amplitude:70,velocidadeSubida:1.1,velocidadeDescida:1.2,tempoExecucao:2.3}},"IFBB Pro":{Agachamento:{carga:"Alta",anguloMax:130,anguloMin:50,amplitude:80,velocidadeSubida:.9,velocidadeDescida:1.1,tempoExecucao:2},"Rosca Bíceps":{carga:"Alta",anguloMax:120,anguloMin:30,amplitude:90,velocidadeSubida:.7,velocidadeDescida:.9,tempoExecucao:1.6},Supino:{carga:"Alta",anguloMax:110,anguloMin:20,amplitude:90,velocidadeSubida:1,velocidadeDescida:1.1,tempoExecucao:2.1}}},Zft=()=>{if(typeof window<"u"){const t=localStorage.getItem("parametrosTreino");if(t)return JSON.parse(t)}return Jft},eht=async()=>{const{data:t,error:e}=await Pt.from("treino_parametros").select("*");if(e)return null;const n={};return t.forEach(r=>{n[r.modelo]||(n[r.modelo]={}),n[r.modelo][r.exercicio]={carga:r.carga||"",anguloMax:r.angulo_max??void 0,anguloMin:r.angulo_min??void 0,amplitude:r.amplitude??void 0,velocidadeSubida:r.velocidade_subida??void 0,velocidadeDescida:r.velocidade_descida??void 0,tempoExecucao:r.tempo_execucao??void 0}}),n},I4=async(t,e,n)=>{const{error:r}=await Pt.from("treino_parametros").upsert({modelo:t,exercicio:e,carga:n.carga,angulo_max:n.anguloMax,angulo_min:n.anguloMin,amplitude:n.amplitude,velocidade_subida:n.velocidadeSubida,velocidade_descida:n.velocidadeDescida,tempo_execucao:n.tempoExecucao,updated_at:new Date().toISOString()});return!r},tht=()=>{const[t,e]=N.useState(Zft()),[n,r]=N.useState(null),[a,s]=N.useState({}),[o,i]=N.useState(!1),[l,u]=N.useState({modelo:D$[0],ex:j$[0],carga:"",anguloMax:"",anguloMin:"",amplitude:"",velocidadeSubida:"",velocidadeDescida:"",tempoExecucao:""}),c=zn();N.useEffect(()=>{typeof window<"u"&&localStorage.setItem("parametrosTreino",JSON.stringify(t))},[t]),N.useEffect(()=>{eht().then(v=>{v&&Object.keys(v).length>0&&(e(v),typeof window<"u"&&localStorage.setItem("parametrosTreino",JSON.stringify(v)))})},[]);const d=(v,x)=>{r({modelo:v,ex:x}),s({...t[v][x]})},f=v=>{s({...a,[v.target.name]:v.target.value})},h=async(v,x)=>{const b={...a,anguloMax:a.anguloMax?Number(a.anguloMax):void 0,anguloMin:a.anguloMin?Number(a.anguloMin):void 0,amplitude:a.amplitude?Number(a.amplitude):void 0,velocidadeSubida:a.velocidadeSubida?Number(a.velocidadeSubida):void 0,velocidadeDescida:a.velocidadeDescida?Number(a.velocidadeDescida):void 0,tempoExecucao:a.tempoExecucao?Number(a.tempoExecucao):void 0};e(w=>({...w,[v]:{...w[v],[x]:b}})),await I4(v,x,b),r(null),s({})},p=()=>{i(!0),u({modelo:D$[0],ex:j$[0],carga:"",anguloMax:"",anguloMin:"",amplitude:"",velocidadeSubida:"",velocidadeDescida:"",tempoExecucao:""})},g=v=>{u({...l,[v.target.name]:v.target.value})},y=async()=>{const v={carga:l.carga,anguloMax:l.anguloMax?Number(l.anguloMax):void 0,anguloMin:l.anguloMin?Number(l.anguloMin):void 0,amplitude:l.amplitude?Number(l.amplitude):void 0,velocidadeSubida:l.velocidadeSubida?Number(l.velocidadeSubida):void 0,velocidadeDescida:l.velocidadeDescida?Number(l.velocidadeDescida):void 0,tempoExecucao:l.tempoExecucao?Number(l.tempoExecucao):void 0};e(x=>{const b={...x};return b[l.modelo]||(b[l.modelo]={}),b[l.modelo][l.ex]=v,b}),await I4(l.modelo,l.ex,v),i(!1)};return m.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[m.jsx(Un,{}),m.jsx("main",{className:"flex-grow flex flex-col items-center py-8",children:m.jsxs("div",{className:"w-full max-w-6xl bg-white rounded-lg shadow-md p-6 overflow-x-auto",children:[m.jsxs("div",{className:"mb-4 flex items-center",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:()=>c(-1),className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"formfit-heading text-center flex-1",children:"Parâmetros de Treino"})]}),m.jsxs("table",{className:"min-w-full border text-sm",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-gray-100",children:[m.jsx("th",{className:"border px-4 py-2",children:"Modelo"}),m.jsx("th",{className:"border px-4 py-2",children:"Exercício"}),m.jsx("th",{className:"border px-4 py-2",children:"Carga"}),m.jsx("th",{className:"border px-4 py-2",children:"Ângulo Máx"}),m.jsx("th",{className:"border px-4 py-2",children:"Ângulo Mín"}),m.jsx("th",{className:"border px-4 py-2",children:"Amplitude"}),m.jsx("th",{className:"border px-4 py-2",children:"Vel. Subida"}),m.jsx("th",{className:"border px-4 py-2",children:"Vel. Descida"}),m.jsx("th",{className:"border px-4 py-2",children:"Tempo Execução"}),m.jsx("th",{className:"border px-4 py-2",children:"Ação"})]})}),m.jsxs("tbody",{children:[Object.keys(t).map(v=>Object.keys(t[v]||{}).map((x,b)=>m.jsxs("tr",{className:b%2===0?"bg-white":"bg-gray-50",children:[m.jsx("td",{className:"border px-4 py-2 font-semibold",children:v}),m.jsx("td",{className:"border px-4 py-2",children:x}),n&&n.modelo===v&&n.ex===x?m.jsxs(m.Fragment,{children:[m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"carga",className:"w-24 border rounded px-1",value:a.carga,onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"anguloMax",type:"number",className:"w-16 border rounded px-1",value:a.anguloMax||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"anguloMin",type:"number",className:"w-16 border rounded px-1",value:a.anguloMin||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"amplitude",type:"number",className:"w-16 border rounded px-1",value:a.amplitude||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"velocidadeSubida",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:a.velocidadeSubida||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"velocidadeDescida",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:a.velocidadeDescida||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"tempoExecucao",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:a.tempoExecucao||"",onChange:f})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx(pe,{size:"sm",onClick:()=>h(v,x),children:"Salvar"})})]}):m.jsxs(m.Fragment,{children:[m.jsx("td",{className:"border px-4 py-2",children:t[v][x].carga}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].anguloMax??"-"}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].anguloMin??"-"}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].amplitude??"-"}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].velocidadeSubida??"-"}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].velocidadeDescida??"-"}),m.jsx("td",{className:"border px-4 py-2",children:t[v][x].tempoExecucao??"-"}),m.jsx("td",{className:"border px-4 py-2",children:m.jsx(pe,{size:"sm",variant:"outline",onClick:()=>d(v,x),children:"Editar"})})]})]},v+x))),o&&m.jsxs("tr",{className:"bg-green-50",children:[m.jsx("td",{className:"border px-2 py-2",children:m.jsx("select",{name:"modelo",value:l.modelo,onChange:g,className:"border rounded px-1",children:D$.map(v=>m.jsx("option",{value:v,children:v},v))})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("select",{name:"ex",value:l.ex,onChange:g,className:"border rounded px-1",children:j$.map(v=>m.jsx("option",{value:v,children:v},v))})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"carga",className:"w-24 border rounded px-1",value:l.carga,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"anguloMax",type:"number",className:"w-16 border rounded px-1",value:l.anguloMax,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"anguloMin",type:"number",className:"w-16 border rounded px-1",value:l.anguloMin,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"amplitude",type:"number",className:"w-16 border rounded px-1",value:l.amplitude,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"velocidadeSubida",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:l.velocidadeSubida,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"velocidadeDescida",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:l.velocidadeDescida,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx("input",{name:"tempoExecucao",type:"number",step:"0.01",className:"w-16 border rounded px-1",value:l.tempoExecucao,onChange:g})}),m.jsx("td",{className:"border px-2 py-2",children:m.jsx(pe,{size:"sm",onClick:y,children:"Salvar"})})]})]})]}),m.jsx("div",{className:"mt-4 flex justify-end",children:m.jsx(pe,{size:"sm",variant:"outline",onClick:p,disabled:o,children:"Adicionar linha"})}),m.jsx("div",{className:"mt-8 text-gray-500 text-center text-sm",children:"* Estes parâmetros são exemplos e podem ser ajustados conforme a metodologia do treinador ou atualização do app."})]})}),m.jsx(rr,{})]})};var pR="Tabs",[nht,nmt]=Hp(pR,[z2]),qQ=z2(),[rht,mR]=nht(pR),KQ=N.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:s,orientation:o="horizontal",dir:i,activationMode:l="automatic",...u}=t,c=aO(i),[d,f]=qp({prop:r,onChange:a,defaultProp:s});return m.jsx(rht,{scope:n,baseId:xg(),value:d,onValueChange:f,orientation:o,dir:c,activationMode:l,children:m.jsx(nn.div,{dir:c,"data-orientation":o,...u,ref:e})})});KQ.displayName=pR;var XQ="TabsList",YQ=N.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...a}=t,s=mR(XQ,n),o=qQ(n);return m.jsx(u7,{asChild:!0,...o,orientation:s.orientation,dir:s.dir,loop:r,children:m.jsx(nn.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:e})})});YQ.displayName=XQ;var QQ="TabsTrigger",JQ=N.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...s}=t,o=mR(QQ,n),i=qQ(n),l=tJ(o.baseId,r),u=nJ(o.baseId,r),c=r===o.value;return m.jsx(c7,{asChild:!0,...i,focusable:!a,active:c,children:m.jsx(nn.button,{type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...s,ref:e,onMouseDown:Ht(t.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?o.onValueChange(r):d.preventDefault()}),onKeyDown:Ht(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(r)}),onFocus:Ht(t.onFocus,()=>{const d=o.activationMode!=="manual";!c&&!a&&d&&o.onValueChange(r)})})})});JQ.displayName=QQ;var ZQ="TabsContent",eJ=N.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:a,children:s,...o}=t,i=mR(ZQ,n),l=tJ(i.baseId,r),u=nJ(i.baseId,r),c=r===i.value,d=N.useRef(c);return N.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),m.jsx(vu,{present:a||c,children:({present:f})=>m.jsx(nn.div,{"data-state":c?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:f&&s})})});eJ.displayName=ZQ;function tJ(t,e){return`${t}-trigger-${e}`}function nJ(t,e){return`${t}-content-${e}`}var aht=KQ,rJ=YQ,aJ=JQ,sJ=eJ;const oJ=aht,gR=N.forwardRef(({className:t,...e},n)=>m.jsx(rJ,{ref:n,className:fn("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));gR.displayName=rJ.displayName;const lc=N.forwardRef(({className:t,...e},n)=>m.jsx(aJ,{ref:n,className:fn("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));lc.displayName=aJ.displayName;const uc=N.forwardRef(({className:t,...e},n)=>m.jsx(sJ,{ref:n,className:fn("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));uc.displayName=sJ.displayName;const sht=({exerciseId:t,onUploadComplete:e})=>{const[n,r]=N.useState(null),[a,s]=N.useState(null),[o,i]=N.useState(!1),[l,u]=N.useState(0),c=N.useRef(null),d=g=>{var v;const y=(v=g.target.files)==null?void 0:v[0];if(y&&y.type.startsWith("video/")){r(y);const x=URL.createObjectURL(y);s(x)}},f=g=>{g.preventDefault(),g.stopPropagation()},h=g=>{if(g.preventDefault(),g.stopPropagation(),g.dataTransfer.files&&g.dataTransfer.files[0]){const y=g.dataTransfer.files[0];if(y.type.startsWith("video/")){r(y);const v=URL.createObjectURL(y);s(v)}}},p=()=>{i(!0),u(0);const g=setInterval(()=>{u(y=>{const v=y+5;return v>=100?(clearInterval(g),setTimeout(()=>{i(!1),e()},500),100):v})},100)};return m.jsxs(bn,{children:[m.jsxs(wn,{children:[m.jsx(Sn,{children:"Upload de Vídeo"}),m.jsx(xs,{children:"Faça o upload de um vídeo do exercício executado por um profissional"})]}),m.jsxs(Cn,{className:"space-y-4",children:[m.jsx("input",{type:"file",ref:c,onChange:d,accept:"video/*",className:"hidden"}),a?m.jsxs("div",{className:"space-y-4",children:[m.jsx("div",{className:"rounded-lg overflow-hidden bg-black",children:m.jsx("video",{src:a,controls:!0,className:"w-full h-auto max-h-96 object-contain"})}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("p",{className:"text-sm text-gray-500 truncate flex-1 mr-2",children:n==null?void 0:n.name}),m.jsx(pe,{variant:"outline",size:"sm",onClick:()=>{r(null),s(null)},children:"Trocar"})]})]}):m.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>{var g;return(g=c.current)==null?void 0:g.click()},onDragOver:f,onDrop:h,children:m.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[m.jsx(yV,{className:"h-12 w-12 text-gray-400"}),m.jsx("h3",{className:"text-lg font-medium",children:"Arraste e solte seu vídeo aqui"}),m.jsx("p",{className:"text-sm text-gray-500",children:"Ou clique para selecionar um arquivo"}),m.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Formatos aceitos: MP4, MOV, WEBM (máx. 100MB)"})]})}),o&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Processando..."}),m.jsxs("span",{children:[l,"%"]})]}),m.jsx(Ol,{value:l})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[m.jsx(pe,{variant:"outline",disabled:o,children:"Cancelar"}),m.jsxs(pe,{onClick:p,disabled:!n||o,className:"flex items-center",children:[m.jsx(vV,{className:"mr-2 h-4 w-4"}),o?"Processando...":"Processar Vídeo"]})]})]})]})},Hd=[{time:0,keypoints:{shoulders:{x:50,y:20},elbows:{x:65,y:30},knees:{x:50,y:70},ankles:{x:50,y:90}}},{time:.5,keypoints:{shoulders:{x:50,y:22},elbows:{x:65,y:32},knees:{x:50,y:75},ankles:{x:50,y:90}}},{time:1,keypoints:{shoulders:{x:50,y:25},elbows:{x:65,y:35},knees:{x:50,y:80},ankles:{x:50,y:90}}},{time:1.5,keypoints:{shoulders:{x:50,y:30},elbows:{x:65,y:40},knees:{x:50,y:85},ankles:{x:50,y:90}}},{time:2,keypoints:{shoulders:{x:50,y:35},elbows:{x:65,y:45},knees:{x:50,y:70},ankles:{x:50,y:90}}},{time:2.5,keypoints:{shoulders:{x:50,y:25},elbows:{x:65,y:35},knees:{x:50,y:60},ankles:{x:50,y:90}}},{time:3,keypoints:{shoulders:{x:50,y:20},elbows:{x:65,y:30},knees:{x:50,y:70},ankles:{x:50,y:90}}}],oht=({exerciseId:t,onTrain:e})=>{const[n,r]=N.useState(!1),[a,s]=N.useState(0),o=()=>{r(!0),s(0);const l=setInterval(()=>{s(u=>u>=Hd.length-1?(clearInterval(l),r(!1),0):u+1)},200)},i=(l,u,c)=>{const{shoulders:d,elbows:f,knees:h,ankles:p}=u;l.beginPath(),l.arc(d.x,d.y-10,10,0,Math.PI*2),l.strokeStyle=c,l.lineWidth=2,l.stroke();const g={x:d.x,y:d.y+30};l.beginPath(),l.moveTo(d.x,d.y),l.lineTo(g.x,g.y),l.stroke(),l.beginPath(),l.moveTo(d.x-15,d.y+5),l.lineTo(f.x-15,f.y),l.stroke(),l.beginPath(),l.moveTo(d.x+15,d.y+5),l.lineTo(f.x+15,f.y),l.stroke(),l.beginPath(),l.moveTo(g.x-10,g.y),l.lineTo(h.x-10,h.y),l.lineTo(p.x-10,p.y),l.stroke(),l.beginPath(),l.moveTo(g.x+10,g.y),l.lineTo(h.x+10,h.y),l.lineTo(p.x+10,p.y),l.stroke(),[d,{x:d.x-15,y:d.y+5},{x:d.x+15,y:d.y+5},f,{x:f.x-15,y:f.y},{x:f.x+15,y:f.y},g,h,{x:h.x-10,y:h.y},{x:h.x+10,y:h.y},p,{x:p.x-10,y:p.y},{x:p.x+10,y:p.y}].forEach(v=>{l.beginPath(),l.arc(v.x,v.y,3,0,Math.PI*2),l.fillStyle=c,l.fill()})};return m.jsxs(bn,{children:[m.jsxs(wn,{children:[m.jsx(Sn,{children:"Visualizar Modelo"}),m.jsx(xs,{children:"Visualize e compare os modelos de referência"})]}),m.jsx(Cn,{className:"space-y-4",children:m.jsxs(oJ,{defaultValue:"reference",children:[m.jsxs(gR,{className:"grid grid-cols-2",children:[m.jsx(lc,{value:"reference",children:"Modelo de Referência"}),m.jsx(lc,{value:"comparison",children:"Comparação"})]}),m.jsxs(uc,{value:"reference",className:"space-y-4",children:[m.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[m.jsx("canvas",{width:"300",height:"300",className:"w-full h-64 bg-white rounded border",ref:l=>{if(l){const u=l.getContext("2d");if(u){u.clearRect(0,0,l.width,l.height);const c=Hd[a];c&&i(u,c.keypoints,"#4361EE")}}}}),m.jsxs("div",{className:"flex justify-between items-center mt-4",children:[m.jsxs("span",{className:"text-sm text-gray-500",children:["Frame ",a+1," de ",Hd.length]}),m.jsxs(pe,{onClick:o,disabled:n,size:"sm",children:[m.jsx(ko,{className:"h-4 w-4 mr-2"}),n?"Reproduzindo...":"Reproduzir Animação"]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Métricas do Modelo"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[m.jsx("div",{className:"font-medium text-sm text-gray-500",children:"Amplitude do Movimento"}),m.jsx("div",{className:"text-2xl font-bold",children:"85°"})]}),m.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[m.jsx("div",{className:"font-medium text-sm text-gray-500",children:"Tempo de Execução"}),m.jsx("div",{className:"text-2xl font-bold",children:"3.2s"})]}),m.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[m.jsx("div",{className:"font-medium text-sm text-gray-500",children:"Velocidade de Descida"}),m.jsx("div",{className:"text-2xl font-bold",children:"1.8s"})]}),m.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[m.jsx("div",{className:"font-medium text-sm text-gray-500",children:"Velocidade de Subida"}),m.jsx("div",{className:"text-2xl font-bold",children:"1.4s"})]})]}),m.jsx("div",{className:"flex justify-end pt-4",children:m.jsx(pe,{onClick:e,children:"Incorporar ao Modelo Ideal"})})]})]}),m.jsxs(uc,{value:"comparison",children:[m.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"text-center font-medium mb-2",children:"Modelo Atual"}),m.jsx("canvas",{width:"300",height:"300",className:"w-full h-48 bg-white rounded border",ref:l=>{if(l){const u=l.getContext("2d");if(u){u.clearRect(0,0,l.width,l.height);const c=Hd[a];c&&i(u,c.keypoints,"#4361EE")}}}})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-center font-medium mb-2",children:"Upload Recente"}),m.jsx("canvas",{width:"300",height:"300",className:"w-full h-48 bg-white rounded border",ref:l=>{if(l){const u=l.getContext("2d");if(u){u.clearRect(0,0,l.width,l.height);const c=Hd[a];if(c){const d=JSON.parse(JSON.stringify(c.keypoints));d.knees.y+=5,d.elbows.x-=5,i(u,d,"#EA384C")}}}}})]})]}),m.jsxs("div",{className:"flex justify-between items-center mt-4",children:[m.jsxs("span",{className:"text-sm text-gray-500",children:["Frame ",a+1," de ",Hd.length]}),m.jsxs(pe,{onClick:o,disabled:n,size:"sm",children:[m.jsx(ko,{className:"h-4 w-4 mr-2"}),n?"Reproduzindo...":"Reproduzir Animação"]})]})]}),m.jsxs("div",{className:"bg-white p-4 rounded-lg border mt-4",children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Análise de Diferenças"}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Alinhamento do joelho"}),m.jsx("span",{className:"text-amber-600 font-medium",children:"85% similar"})]}),m.jsx("div",{className:"h-2 bg-gray-200 rounded-full mt-1",children:m.jsx("div",{className:"h-2 bg-amber-500 rounded-full",style:{width:"85%"}})})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Ângulo do cotovelo"}),m.jsx("span",{className:"text-red-600 font-medium",children:"72% similar"})]}),m.jsx("div",{className:"h-2 bg-gray-200 rounded-full mt-1",children:m.jsx("div",{className:"h-2 bg-red-500 rounded-full",style:{width:"72%"}})})]}),m.jsxs("div",{children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Postura das costas"}),m.jsx("span",{className:"text-green-600 font-medium",children:"94% similar"})]}),m.jsx("div",{className:"h-2 bg-gray-200 rounded-full mt-1",children:m.jsx("div",{className:"h-2 bg-green-500 rounded-full",style:{width:"94%"}})})]})]})]})]})]})})]})},T4=[{id:"squat",name:"Agachamento",description:"Treino para pernas e glúteos"},{id:"pushup",name:"Flexão de Braço",description:"Treino para peito e braços"},{id:"curl",name:"Rosca Bíceps",description:"Treino para bíceps"},{id:"lunge",name:"Avanço",description:"Treino para pernas e glúteos"},{id:"plank",name:"Prancha",description:"Treino para core e abdômen"}],iht=()=>{var u;const t=zn(),{toast:e}=Xr(),[n,r]=N.useState(null),[a,s]=N.useState("lista"),o=c=>{r(c),s("upload")},i=()=>{n?r(null):t("/dashboard")},l=()=>{e({title:"Modelo sendo treinado",description:"O modelo de referência está sendo atualizado com os novos dados."})};return m.jsxs("div",{className:"min-h-screen bg-gray-50",children:[m.jsx(Un,{}),m.jsxs("main",{className:"container mx-auto py-6 px-4",children:[m.jsxs("div",{className:"flex items-center mb-6",children:[m.jsx(pe,{variant:"ghost",size:"icon",onClick:i,className:"mr-2",children:m.jsx(pr,{className:"h-5 w-5"})}),m.jsx("h1",{className:"text-2xl font-bold",children:n?`Modelo de ${(u=T4.find(c=>c.id===n))==null?void 0:u.name}`:"Modelos de Exercícios"})]}),n?m.jsxs(oJ,{defaultValue:"lista",value:a,onValueChange:s,className:"w-full",children:[m.jsxs(gR,{className:"grid grid-cols-4 mb-6",children:[m.jsxs(lc,{value:"lista",children:[m.jsx(_re,{className:"h-4 w-4 mr-2"}),"Estatísticas"]}),m.jsxs(lc,{value:"upload",children:[m.jsx(yV,{className:"h-4 w-4 mr-2"}),"Upload"]}),m.jsxs(lc,{value:"visualizar",children:[m.jsx(vV,{className:"h-4 w-4 mr-2"}),"Visualizar"]}),m.jsxs(lc,{value:"download",children:[m.jsx(b_,{className:"h-4 w-4 mr-2"}),"Download"]})]}),m.jsx(uc,{value:"lista",className:"mt-0",children:m.jsxs(bn,{children:[m.jsxs(wn,{children:[m.jsx(Sn,{children:"Estatísticas do Modelo"}),m.jsx(xs,{children:"Detalhes sobre o modelo de referência atual"})]}),m.jsx(Cn,{children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[m.jsx("span",{className:"font-medium",children:"Status:"}),m.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-sm",children:"Ativo"})]}),m.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[m.jsx("span",{className:"font-medium",children:"Vídeos de treinamento:"}),m.jsx("span",{children:"3"})]}),m.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[m.jsx("span",{className:"font-medium",children:"Última atualização:"}),m.jsx("span",{children:"10/05/2025"})]}),m.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[m.jsx("span",{className:"font-medium",children:"Precisão estimada:"}),m.jsx("span",{children:"87%"})]})]})})]})}),m.jsx(uc,{value:"upload",className:"mt-0",children:m.jsx(sht,{exerciseId:n,onUploadComplete:()=>{e({title:"Upload concluído",description:"Seu vídeo foi carregado e está pronto para ser processado."}),s("visualizar")}})}),m.jsx(uc,{value:"visualizar",className:"mt-0",children:m.jsx(oht,{exerciseId:n,onTrain:l})}),m.jsx(uc,{value:"download",className:"mt-0",children:m.jsxs(bn,{children:[m.jsxs(wn,{children:[m.jsx(Sn,{children:"Download do Modelo"}),m.jsx(xs,{children:"Baixe o modelo de referência para uso local"})]}),m.jsxs(Cn,{className:"space-y-4",children:[m.jsx("p",{children:"Você pode baixar o modelo de referência treinado para este exercício para uso offline ou importação em outro sistema."}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs(bn,{children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{className:"text-base",children:"Modelo Completo"})}),m.jsx(Cn,{className:"pt-0",children:m.jsx("p",{className:"text-sm text-gray-500",children:"Inclui todas as métricas e dados de referência"})}),m.jsx(yc,{children:m.jsxs(pe,{className:"w-full",children:[m.jsx(b_,{className:"mr-2 h-4 w-4"}),"Download (.json)"]})})]}),m.jsxs(bn,{children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{className:"text-base",children:"Modelo Otimizado"})}),m.jsx(Cn,{className:"pt-0",children:m.jsx("p",{className:"text-sm text-gray-500",children:"Versão compacta para dispositivos móveis"})}),m.jsx(yc,{children:m.jsxs(pe,{className:"w-full",children:[m.jsx(b_,{className:"mr-2 h-4 w-4"}),"Download (.lite)"]})})]})]})]})]})})]}):m.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[m.jsx("p",{className:"text-gray-600 mb-4",children:"Selecione um exercício para gerenciar seu modelo de referência."}),T4.map(c=>m.jsxs(bn,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>o(c.id),children:[m.jsx(wn,{className:"pb-2",children:m.jsx(Sn,{children:c.name})}),m.jsx(Cn,{children:m.jsx(xs,{children:c.description})})]},c.id))]})]})]})};var lht="VisuallyHidden",yR=N.forwardRef((t,e)=>m.jsx(nn.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));yR.displayName=lht;var vR="ToastProvider",[xR,uht,cht]=r7("Toast"),[iJ,rmt]=Hp("Toast",[cht]),[dht,LC]=iJ(vR),lJ=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:o}=t,[i,l]=N.useState(null),[u,c]=N.useState(0),d=N.useRef(!1),f=N.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${vR}\`. Expected non-empty \`string\`.`),m.jsx(xR.Provider,{scope:e,children:m.jsx(dht,{scope:e,label:n,duration:r,swipeDirection:a,swipeThreshold:s,toastCount:u,viewport:i,onViewportChange:l,onToastAdd:N.useCallback(()=>c(h=>h+1),[]),onToastRemove:N.useCallback(()=>c(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:f,children:o})})};lJ.displayName=vR;var uJ="ToastViewport",fht=["F8"],bT="toast.viewportPause",wT="toast.viewportResume",cJ=N.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=fht,label:a="Notifications ({hotkey})",...s}=t,o=LC(uJ,n),i=uht(n),l=N.useRef(null),u=N.useRef(null),c=N.useRef(null),d=N.useRef(null),f=Aa(e,d,o.onViewportChange),h=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;N.useEffect(()=>{const y=v=>{var b;r.length!==0&&r.every(w=>v[w]||v.code===w)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),N.useEffect(()=>{const y=l.current,v=d.current;if(p&&y&&v){const x=()=>{if(!o.isClosePausedRef.current){const _=new CustomEvent(bT);v.dispatchEvent(_),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const _=new CustomEvent(wT);v.dispatchEvent(_),o.isClosePausedRef.current=!1}},w=_=>{!y.contains(_.relatedTarget)&&b()},C=()=>{y.contains(document.activeElement)||b()};return y.addEventListener("focusin",x),y.addEventListener("focusout",w),y.addEventListener("pointermove",x),y.addEventListener("pointerleave",C),window.addEventListener("blur",x),window.addEventListener("focus",b),()=>{y.removeEventListener("focusin",x),y.removeEventListener("focusout",w),y.removeEventListener("pointermove",x),y.removeEventListener("pointerleave",C),window.removeEventListener("blur",x),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const g=N.useCallback(({tabbingDirection:y})=>{const x=i().map(b=>{const w=b.ref.current,C=[w,...$ht(w)];return y==="forwards"?C:C.reverse()});return(y==="forwards"?x.reverse():x).flat()},[i]);return N.useEffect(()=>{const y=d.current;if(y){const v=x=>{var C,_,$;const b=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!b){const k=document.activeElement,A=x.shiftKey;if(x.target===y&&A){(C=u.current)==null||C.focus();return}const R=g({tabbingDirection:A?"backwards":"forwards"}),B=R.findIndex(F=>F===k);M$(R.slice(B+1))?x.preventDefault():A?(_=u.current)==null||_.focus():($=c.current)==null||$.focus()}};return y.addEventListener("keydown",v),()=>y.removeEventListener("keydown",v)}},[i,g]),m.jsxs(sVe,{ref:l,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&m.jsx(ST,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});M$(y)}}),m.jsx(xR.Slot,{scope:n,children:m.jsx(nn.ol,{tabIndex:-1,...s,ref:f})}),p&&m.jsx(ST,{ref:c,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});M$(y)}})]})});cJ.displayName=uJ;var dJ="ToastFocusProxy",ST=N.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...a}=t,s=LC(dJ,n);return m.jsx(yR,{"aria-hidden":!0,tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const i=o.relatedTarget;!((u=s.viewport)!=null&&u.contains(i))&&r()}})});ST.displayName=dJ;var BC="Toast",hht="toast.swipeStart",pht="toast.swipeMove",mht="toast.swipeCancel",ght="toast.swipeEnd",fJ=N.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:a,onOpenChange:s,...o}=t,[i=!0,l]=qp({prop:r,defaultProp:a,onChange:s});return m.jsx(vu,{present:n||i,children:m.jsx(xht,{open:i,...o,ref:e,onClose:()=>l(!1),onPause:to(t.onPause),onResume:to(t.onResume),onSwipeStart:Ht(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ht(t.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Ht(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ht(t.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});fJ.displayName=BC;var[yht,vht]=iJ(BC,{onClose(){}}),xht=N.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:a,open:s,onClose:o,onEscapeKeyDown:i,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:f,onSwipeEnd:h,...p}=t,g=LC(BC,n),[y,v]=N.useState(null),x=Aa(e,F=>v(F)),b=N.useRef(null),w=N.useRef(null),C=a||g.duration,_=N.useRef(0),$=N.useRef(C),k=N.useRef(0),{onToastAdd:A,onToastRemove:P}=g,O=to(()=>{var L;(y==null?void 0:y.contains(document.activeElement))&&((L=g.viewport)==null||L.focus()),o()}),R=N.useCallback(F=>{!F||F===1/0||(window.clearTimeout(k.current),_.current=new Date().getTime(),k.current=window.setTimeout(O,F))},[O]);N.useEffect(()=>{const F=g.viewport;if(F){const L=()=>{R($.current),u==null||u()},H=()=>{const te=new Date().getTime()-_.current;$.current=$.current-te,window.clearTimeout(k.current),l==null||l()};return F.addEventListener(bT,H),F.addEventListener(wT,L),()=>{F.removeEventListener(bT,H),F.removeEventListener(wT,L)}}},[g.viewport,C,l,u,R]),N.useEffect(()=>{s&&!g.isClosePausedRef.current&&R(C)},[s,C,g.isClosePausedRef,R]),N.useEffect(()=>(A(),()=>P()),[A,P]);const B=N.useMemo(()=>y?xJ(y):null,[y]);return g.viewport?m.jsxs(m.Fragment,{children:[B&&m.jsx(bht,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:B}),m.jsx(yht,{scope:n,onClose:O,children:gS.createPortal(m.jsx(xR.ItemSlot,{scope:n,children:m.jsx(aVe,{asChild:!0,onEscapeKeyDown:Ht(i,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:m.jsx(nn.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Ht(t.onKeyDown,F=>{F.key==="Escape"&&(i==null||i(F.nativeEvent),F.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:Ht(t.onPointerDown,F=>{F.button===0&&(b.current={x:F.clientX,y:F.clientY})}),onPointerMove:Ht(t.onPointerMove,F=>{if(!b.current)return;const L=F.clientX-b.current.x,H=F.clientY-b.current.y,te=!!w.current,V=["left","right"].includes(g.swipeDirection),Q=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,se=V?Q(0,L):0,le=V?0:Q(0,H),ue=F.pointerType==="touch"?10:2,ce={x:se,y:le},re={originalEvent:F,delta:ce};te?(w.current=ce,I0(pht,d,re,{discrete:!1})):E4(ce,g.swipeDirection,ue)?(w.current=ce,I0(hht,c,re,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(L)>ue||Math.abs(H)>ue)&&(b.current=null)}),onPointerUp:Ht(t.onPointerUp,F=>{const L=w.current,H=F.target;if(H.hasPointerCapture(F.pointerId)&&H.releasePointerCapture(F.pointerId),w.current=null,b.current=null,L){const te=F.currentTarget,V={originalEvent:F,delta:L};E4(L,g.swipeDirection,g.swipeThreshold)?I0(ght,h,V,{discrete:!0}):I0(mht,f,V,{discrete:!0}),te.addEventListener("click",Q=>Q.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),bht=t=>{const{__scopeToast:e,children:n,...r}=t,a=LC(BC,e),[s,o]=N.useState(!1),[i,l]=N.useState(!1);return Cht(()=>o(!0)),N.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),i?null:m.jsx(lO,{asChild:!0,children:m.jsx(yR,{...r,children:s&&m.jsxs(m.Fragment,{children:[a.label," ",n]})})})},wht="ToastTitle",hJ=N.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return m.jsx(nn.div,{...r,ref:e})});hJ.displayName=wht;var Sht="ToastDescription",pJ=N.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return m.jsx(nn.div,{...r,ref:e})});pJ.displayName=Sht;var mJ="ToastAction",gJ=N.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?m.jsx(vJ,{altText:n,asChild:!0,children:m.jsx(bR,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${mJ}\`. Expected non-empty \`string\`.`),null)});gJ.displayName=mJ;var yJ="ToastClose",bR=N.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,a=vht(yJ,n);return m.jsx(vJ,{asChild:!0,children:m.jsx(nn.button,{type:"button",...r,ref:e,onClick:Ht(t.onClick,a.onClose)})})});bR.displayName=yJ;var vJ=N.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...a}=t;return m.jsx(nn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:e})});function xJ(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),_ht(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...xJ(r))}}),e}function I0(t,e,n,{discrete:r}){const a=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?fK(a,s):a.dispatchEvent(s)}var E4=(t,e,n=0)=>{const r=Math.abs(t.x),a=Math.abs(t.y),s=r>a;return e==="left"||e==="right"?s&&r>n:!s&&a>n};function Cht(t=()=>{}){const e=to(t);eh(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function _ht(t){return t.nodeType===t.ELEMENT_NODE}function $ht(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function M$(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var kht=lJ,bJ=cJ,wJ=fJ,SJ=hJ,CJ=pJ,_J=gJ,$J=bR;const Nht=kht,kJ=N.forwardRef(({className:t,...e},n)=>m.jsx(bJ,{ref:n,className:fn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));kJ.displayName=bJ.displayName;const Iht=bE("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),NJ=N.forwardRef(({className:t,variant:e,...n},r)=>m.jsx(wJ,{ref:r,className:fn(Iht({variant:e}),t),...n}));NJ.displayName=wJ.displayName;const Tht=N.forwardRef(({className:t,...e},n)=>m.jsx(_J,{ref:n,className:fn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));Tht.displayName=_J.displayName;const IJ=N.forwardRef(({className:t,...e},n)=>m.jsx($J,{ref:n,className:fn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:m.jsx(xV,{className:"h-4 w-4"})}));IJ.displayName=$J.displayName;const TJ=N.forwardRef(({className:t,...e},n)=>m.jsx(SJ,{ref:n,className:fn("text-sm font-semibold",t),...e}));TJ.displayName=SJ.displayName;const EJ=N.forwardRef(({className:t,...e},n)=>m.jsx(CJ,{ref:n,className:fn("text-sm opacity-90",t),...e}));EJ.displayName=CJ.displayName;function Eht(){const{toasts:t}=Xr();return m.jsxs(Nht,{children:[t.map(function({id:e,title:n,description:r,action:a,...s}){return m.jsxs(NJ,{...s,children:[m.jsxs("div",{className:"grid gap-1",children:[n&&m.jsx(TJ,{children:n}),r&&m.jsx(EJ,{children:r})]}),a,m.jsx(IJ,{})]},e)}),m.jsx(kJ,{})]})}const Aht=()=>{const{pathname:t}=Po();return N.useEffect(()=>{window.scrollTo(0,0)},[t]),null};function Pht(){return m.jsxs(wne,{children:[m.jsx(Aht,{}),m.jsxs(pne,{children:[m.jsx(un,{path:"/",element:m.jsx(Lre,{})}),m.jsx(un,{path:"/treinos",element:m.jsx(gWe,{})}),m.jsx(un,{path:"/treinos/exercicios/:areaId",element:m.jsx(OM,{})}),m.jsx(un,{path:"/treino-guiado",element:m.jsx(vWe,{})}),m.jsx(un,{path:"/treino-guiado/exercicios/:areaId",element:m.jsx(OM,{})}),m.jsx(un,{path:"/primeiro-acesso",element:m.jsx(WUe,{})}),m.jsx(un,{path:"/onboarding/availability",element:m.jsx(hUe,{})}),m.jsx(un,{path:"/login",element:m.jsx(xWe,{})}),m.jsx(un,{path:"/dashboard",element:m.jsx(wWe,{})}),m.jsx(un,{path:"/workout",element:m.jsx(Jze,{})}),m.jsx(un,{path:"/exercise-models",element:m.jsx(iht,{})}),m.jsx(un,{path:"/onboarding/level",element:m.jsx(pUe,{})}),m.jsx(un,{path:"/onboarding/profile",element:m.jsx(mUe,{})}),m.jsx(un,{path:"/onboarding/registration",element:m.jsx(gUe,{})}),m.jsx(un,{path:"/workout-flow/muscle-groups",element:m.jsx(mWe,{})}),m.jsx(un,{path:"/workout-flow/exercises",element:m.jsx(GUe,{})}),m.jsx(un,{path:"/workout-flow/execution",element:m.jsx(YUe,{})}),m.jsx(un,{path:"/workout-flow/summary",element:m.jsx(PM,{})}),m.jsx(un,{path:"/subscription",element:m.jsx(Zze,{})}),m.jsx(un,{path:"/workout/summary",element:m.jsx(PM,{})}),m.jsx(un,{path:"/cadastro",element:m.jsx(SWe,{})}),m.jsx(un,{path:"/treino-personalizado",element:m.jsx($We,{})}),m.jsx(un,{path:"/meus-treinos",element:m.jsx(qft,{})}),m.jsx(un,{path:"/treino-personalizado-execucao",element:m.jsx(Yft,{})}),m.jsx(un,{path:"/treino-ia",element:m.jsx(eze,{})}),m.jsx(un,{path:"/perfil",element:m.jsx(Qft,{})}),m.jsx(un,{path:"/parametros-treino",element:m.jsx(tht,{})}),m.jsx(un,{path:"*",element:m.jsx(Bre,{})})]}),m.jsx(Eht,{})]})}GU(document.getElementById("root")).render(m.jsx(Pht,{}));export{z_ as G,I2 as M,Fpt as a,Ut as b,f$e as f,Lpt as g,B2e as s,Bpt as w};
